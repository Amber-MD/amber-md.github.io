<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN" "http://www.w3.org/Math/DTD/mathml2/xhtml-math11-f.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="GENERATOR" content="LyX 2.2.2" />
<meta http-equiv="Content-type" content="text/html; charset=UTF-8" />
<title>CPPTRAJ</title>
<style type="text/css">
/* LyX Provided Styles */
table { border-collapse: collapse; display: inline-block; }
td { border: 1px solid black; padding: 0.5ex; }
div.bibtexentry { margin-left: 2em; text-indent: -2em; }
span.bibtexlabel:before{ content: "["; }
span.bibtexlabel:after{ content: "] "; }

/* Layout-provided Styles */
del.strikeout {
  text-decoration: line-through;
}
h1.title {
font-size: x-large;
margin-bottom: 1ex;
text-align: center;

}
div.author {
font-size: large;
margin-top: 1.3ex;
margin-bottom: 0.7ex;
text-align: center;

}
div.standard {
margin-bottom: 2ex;
}
div.plain_layout {
text-align: left;

}
ol.enumerate {
margin-top: 0.7ex;
margin-bottom: 0.7ex;
margin-left: 3ex;
text-align: left;

}
h3.subsection {
font-weight: bold;
font-size: large;
margin-top: 0.9ex;
margin-bottom: 0.5ex;
text-align: left;

}
dl.description dt { font-weight: bold; }
h2.section {
font-weight: bold;
font-size: x-large;
margin-top: 1.3ex;
margin-bottom: 0.7ex;
text-align: left;

}
div.lyx_code {
font-family: monospace;
margin-top: 0.5ex;
margin-bottom: 0.5ex;
margin-left: 3ex;
margin-right: 3ex;
text-align: left;

}
h4.subsubsection {
font-weight: bold;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.4ex;
text-align: left;

}
h4.subsubsection_ {
font-weight: bold;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.4ex;
text-align: left;

}
ul.itemize {
margin-top: 0.7ex;
margin-bottom: 0.7ex;
margin-left: 3ex;
text-align: left;

}
span.flex_url {
font-family: monospace;
}
 div.toc {
   margin: 2em 0em;
   border-style: solid;
   border-width: 2px 0px;
   padding: 1em 0em;
 }
 h2.tochead { font-size: x-large; font-weight: bold; }
 div.lyxtoc-0 {
   margin: 2em 0em 0em 0em;
   font-size: xx-large;
   font-weight: bold;
 }
 div.lyxtoc-1 {
   margin: 1em 0em 0em 0em;
   font-size: x-large;
   font-weight: bold;
 }
 div.lyxtoc-2 {
   margin: 0em 0.1em 0em 1em;
   font-size: large;
   font-weight: normal;
 }
 div.lyxtoc-3 { margin: 0em 0.1em 0em 0.5em; font-size: medium; }
 div.lyxtoc-4 { margin: 0em 0.1em 0em 0.5em; }
 div.lyxtoc-5 { margin: 0em 0.1em 0em 0.5em; }
 div.lyxtoc-6 { margin: 0em 0.1em 0em 0.5em; }
 a.tocentry {
   text-decoration: none;
   color: black;
 }
 a.tocentry:visited { color: black; }
div.float {
border: 2px solid black;
text-align: center;
}
div.float-caption {
text-align: center;
border: 2px solid black;
padding: 1ex;
margin: 1ex;
}
span.index {
font-size: small;
}


</style>
</head>
<body dir="auto">
<h1 class="title"><a id="magicparlabel-1"></a>CPPTRAJ</h1>
<div class="author"><a id="magicparlabel-2"></a>Daniel R. Roe</div>
<div class="standard" style="text-align: center;"><a id="magicparlabel-3"></a><span class="flex_url">https://github.com/Amber-MD/cpptraj</span></div>


<div class="toc"><h2 class="tochead section">Table of Contents</h2>



<div class="lyxtoc-1"><div class="lyxtoc-2"><div class="lyxtoc-3"><a href="#magicparlabel-22" class="tocentry">0.1 Manual Syntax Format</a>
</div>
</div>

<div class="lyxtoc-2"><a href="#magicparlabel-29" class="tocentry">1 Running Cpptraj</a>


<div class="lyxtoc-3"><a href="#magicparlabel-31" class="tocentry">1.1 Command Line Syntax</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-56" class="tocentry">1.2 Commands</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-76" class="tocentry">1.3 Batch mode</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-78" class="tocentry">1.4 Interactive mode</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-85" class="tocentry">1.5 Trajectory Processing Run</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-91" class="tocentry">1.6 Parallelization</a>
</div>
</div>

<div class="lyxtoc-2"><a href="#magicparlabel-128" class="tocentry">2 General Concepts</a>


<div class="lyxtoc-3"><a href="#magicparlabel-129" class="tocentry">2.1 Units</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-194" class="tocentry">2.2 Atom Mask Selection Syntax</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-238" class="tocentry">2.3 Ranges</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-240" class="tocentry">2.4 Parameter/Reference Tagging</a>
</div>
</div>

<div class="lyxtoc-2"><a href="#magicparlabel-257" class="tocentry">3 Variables and Control Structures</a>


<div class="lyxtoc-3"><a href="#magicparlabel-305" class="tocentry">3.1 for</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-324" class="tocentry">3.2 set</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-340" class="tocentry">3.3 show</a>
</div>
</div>

<div class="lyxtoc-2"><a href="#magicparlabel-343" class="tocentry">4 Data Sets and Data Files</a>


<div class="lyxtoc-3"><a href="#magicparlabel-675" class="tocentry">4.1 Data Set Selection Syntax</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-689" class="tocentry">4.2 Data Set Math</a>
</div>
</div>

<div class="lyxtoc-2"><a href="#magicparlabel-973" class="tocentry">5 Data File Options</a>


<div class="lyxtoc-3"><a href="#magicparlabel-994" class="tocentry">5.1 Standard Data File Options</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-1017" class="tocentry">5.2 Grace Data File Options</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-1025" class="tocentry">5.3 Gnuplot Data File Options</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-1043" class="tocentry">5.4 Amber REM Log Options</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-1051" class="tocentry">5.5 Amber MDOUT Options</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-1053" class="tocentry">5.6 Evecs File Options</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-1058" class="tocentry">5.7 Vector psuedo-traj Options</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-1065" class="tocentry">5.8 OpenDX file options</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-1071" class="tocentry">5.9 CCP4 file options</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-1075" class="tocentry">5.10 Charmm REPD log options</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-1080" class="tocentry">5.11 Amber Constant pH Out options</a>
</div>
</div>

<div class="lyxtoc-2"><a href="#magicparlabel-1085" class="tocentry">6 Coordinates (COORDS) Data Set Commands</a>


<div class="lyxtoc-3"><a href="#magicparlabel-1189" class="tocentry">6.1 combinecrd</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-1200" class="tocentry">6.2 crdaction</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-1205" class="tocentry">6.3 createcrd</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-1207" class="tocentry">6.4 crdout</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-1212" class="tocentry">6.5 loadcrd</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-1218" class="tocentry">6.6 loadtraj</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-1222" class="tocentry">6.7 permutedihedrals</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-1261" class="tocentry">6.8 reference</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-1263" class="tocentry">6.9 rotatedihedral</a>
</div>
</div>

<div class="lyxtoc-2"><a href="#magicparlabel-1282" class="tocentry">7 General Commands</a>


<div class="lyxtoc-3"><a href="#magicparlabel-1531" class="tocentry">7.1 activeref</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-1538" class="tocentry">7.2 calc</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-1545" class="tocentry">7.3 clear</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-1549" class="tocentry">7.4 create</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-1556" class="tocentry">7.5 createset</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-1563" class="tocentry">7.6 datafile</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-1570" class="tocentry">7.7 datafilter</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-1580" class="tocentry">7.8 dataset</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-1979" class="tocentry">7.9 debug | prnlev</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-1987" class="tocentry">7.10 ensextension</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-1991" class="tocentry">7.11 exit | quit</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-1993" class="tocentry">7.12 go | run</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-1995" class="tocentry">7.13 help</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-2002" class="tocentry">7.14 list</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-2006" class="tocentry">7.15 noexitonerror</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-2013" class="tocentry">7.16 noprogress</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-2020" class="tocentry">7.17 precision</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-2035" class="tocentry">7.18 readdata</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-2048" class="tocentry">7.19 readensembledata</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-2061" class="tocentry">7.20 readinput</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-2068" class="tocentry">7.21 removedata</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-2071" class="tocentry">7.22 rst</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-2093" class="tocentry">7.23 runanalysis</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-2096" class="tocentry">7.24 select</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-2105" class="tocentry">7.25 selectds</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-2111" class="tocentry">7.26 sortensembledata</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-2115" class="tocentry">7.27 write | writedata</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-2118" class="tocentry">7.28 System Commands</a>
</div>
</div>

<div class="lyxtoc-2"><a href="#magicparlabel-2126" class="tocentry">8 Topology File Commands</a>


<div class="lyxtoc-3"><a href="#magicparlabel-2436" class="tocentry">8.1 angleinfo | angles | printangles</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-2441" class="tocentry">8.2 atominfo | atoms | printatoms</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-2446" class="tocentry">8.3 bondinfo | bonds | printbonds</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-2451" class="tocentry">8.4 change</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-2460" class="tocentry">8.5 charge</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-2463" class="tocentry">8.6 comparetop</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-2475" class="tocentry">8.7 dihedralinfo | dihedrals | printdihedrals</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-2482" class="tocentry">8.8 mass</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-2485" class="tocentry">8.9 molinfo</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-2490" class="tocentry">8.10 parm</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-2515" class="tocentry">8.11 parmbox</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-2536" class="tocentry">8.12 parminfo </a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-2543" class="tocentry">8.13 parmstrip</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-2553" class="tocentry">8.14 parmwrite</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-2566" class="tocentry">8.15 resinfo</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-2580" class="tocentry">8.16 scaledihedralk</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-2583" class="tocentry">8.17 solvent</a>
</div>
</div>

<div class="lyxtoc-2"><a href="#magicparlabel-2586" class="tocentry">9 Trajectory File Commands</a>


<div class="lyxtoc-3"><a href="#magicparlabel-2942" class="tocentry">9.1 ensemble</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-2964" class="tocentry">9.2 ensemblesize</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-2967" class="tocentry">9.3 reference</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-2993" class="tocentry">9.4 trajin </a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-3047" class="tocentry">9.5 trajout</a>
</div>
</div>

<div class="lyxtoc-2"><a href="#magicparlabel-3140" class="tocentry">10 Action Commands</a>


<div class="lyxtoc-3"><a href="#magicparlabel-4141" class="tocentry">10.1 angle</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-4153" class="tocentry">10.2 areapermol</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-4163" class="tocentry">10.3 atomiccorr</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-4176" class="tocentry">10.4 atomicfluct | rmsf</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-4210" class="tocentry">10.5 atommap</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-4231" class="tocentry">10.6 autoimage</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-4243" class="tocentry">10.7 average</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-4270" class="tocentry">10.8 avgcoord</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-4272" class="tocentry">10.9 bounds</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-4289" class="tocentry">10.10 box</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-4297" class="tocentry">10.11 center</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-4311" class="tocentry">10.12 check | checkoverlap | checkstructure</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-4336" class="tocentry">10.13 checkchirality</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-4350" class="tocentry">10.14 closest | closestwaters</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-4376" class="tocentry">10.15 cluster</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-4378" class="tocentry">10.16 clusterdihedral</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-4403" class="tocentry">10.17 contacts</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-4408" class="tocentry">10.18 createcrd</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-4416" class="tocentry">10.19 createreservoir</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-4429" class="tocentry">10.20 density</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-4454" class="tocentry">10.21 diffusion</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-4500" class="tocentry">10.22 dihedral </a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-4515" class="tocentry">10.23 dihedralscan</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-4517" class="tocentry">10.24 dipole</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-4523" class="tocentry">10.25 distance </a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-4549" class="tocentry">10.26 drms | drmsd (distance RMSD)</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-4574" class="tocentry">10.27 dssp</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-4576" class="tocentry">10.28 energy</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-4634" class="tocentry">10.29 esander</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-4649" class="tocentry">10.30 filter</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-4665" class="tocentry">10.31 fixatomorder</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-4668" class="tocentry">10.32 fiximagedbonds</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-4672" class="tocentry">10.33 gist (Grid Inhomogeneous Solvation Theory)</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-4897" class="tocentry">10.34 grid</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-4954" class="tocentry">10.35 hbond</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-5022" class="tocentry">10.36 image</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-5047" class="tocentry">10.37 jcoupling</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-5075" class="tocentry">10.38 lessplit</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-5081" class="tocentry">10.39 lie</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-5093" class="tocentry">10.40 lipidorder</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-5117" class="tocentry">10.41 lipidscd</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-5130" class="tocentry">10.42 makestructure</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-5400" class="tocentry">10.43 mask</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-5416" class="tocentry">10.44 matrix</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-5441" class="tocentry">10.45 mindist</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-5443" class="tocentry">10.46 minimage</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-5456" class="tocentry">10.47 molsurf</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-5473" class="tocentry">10.48 multidihedral</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-5495" class="tocentry">10.49 multivector</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-5505" class="tocentry">10.50 nastruct</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-5606" class="tocentry">10.51 nativecontacts</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-5670" class="tocentry">10.52 outtraj</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-5691" class="tocentry">10.53 pairdist</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-5694" class="tocentry">10.54 pairwise</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-5721" class="tocentry">10.55 principal</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-5740" class="tocentry">10.56 projection</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-5762" class="tocentry">10.57 pucker </a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-5789" class="tocentry">10.58 radgyr | rog</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-5807" class="tocentry">10.59 radial | rdf</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-5838" class="tocentry">10.60 randomizeions</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-5844" class="tocentry">10.61 replicatecell</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-5858" class="tocentry">10.62 rms | rmsd</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-5919" class="tocentry">10.63 rms2d | 2drms</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-5921" class="tocentry">10.64 rmsavgcorr</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-5923" class="tocentry">10.65 rmsf | atomicfluct</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-5925" class="tocentry">10.66 rotate</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-5947" class="tocentry">10.67 rotdif</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-5955" class="tocentry">10.68 runavg | runningaverage</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-5966" class="tocentry">10.69 scale</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-5969" class="tocentry">10.70 secstruct</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-6170" class="tocentry">10.71 spam</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-6192" class="tocentry">10.72 setvelocity</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-6205" class="tocentry">10.73 stfcdiffusion</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-6222" class="tocentry">10.74 strip</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-6244" class="tocentry">10.75 surf</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-6262" class="tocentry">10.76 symmrmsd</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-6284" class="tocentry">10.77 temperature</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-6292" class="tocentry">10.78 trans | translate</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-6295" class="tocentry">10.79 unstrip</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-6318" class="tocentry">10.80 unwrap</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-6333" class="tocentry">10.81 vector</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-6366" class="tocentry">10.82 velocityautocorr</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-6389" class="tocentry">10.83 volmap</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-6411" class="tocentry">10.84 volume</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-6416" class="tocentry">10.85 watershell</a>
</div>
</div>

<div class="lyxtoc-2"><a href="#magicparlabel-6431" class="tocentry">11 Analysis Commands</a>


<div class="lyxtoc-3"><a href="#magicparlabel-6983" class="tocentry">11.1 autocorr</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-6994" class="tocentry">11.2 avg</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-7019" class="tocentry">11.3 calcstate</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-7070" class="tocentry">11.4 cluster</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-7225" class="tocentry">11.5 cphstats</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-7248" class="tocentry">11.6 corr | correlationcoe</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-7266" class="tocentry">11.7 crank | crankshaft</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-7277" class="tocentry">11.8 crdfluct</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-7284" class="tocentry">11.9 crosscorr</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-7290" class="tocentry">11.10 curvefit</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-7324" class="tocentry">11.11 diagmatrix</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-7361" class="tocentry">11.12 divergence</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-7364" class="tocentry">11.13 fft</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-7371" class="tocentry">11.14 hist | histogram</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-7416" class="tocentry">11.15 integrate</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-7419" class="tocentry">11.16 ired</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-7458" class="tocentry">11.17 kde</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-7473" class="tocentry">11.18 lifetime</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-7524" class="tocentry">11.19 lowestcurve</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-7533" class="tocentry">11.20 meltcurve</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-7536" class="tocentry">11.21 modes</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-7607" class="tocentry">11.22 multicurve</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-7631" class="tocentry">11.23 multihist</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-7647" class="tocentry">11.24 phipsi</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-7660" class="tocentry">11.25 regress</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-7678" class="tocentry">11.26 remlog</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-7704" class="tocentry">11.27 rms2d | 2drms</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-7733" class="tocentry">11.28 rmsavgcorr</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-7758" class="tocentry">11.29 rotdif</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-7816" class="tocentry">11.30 runningavg</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-7825" class="tocentry">11.31 spline</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-7835" class="tocentry">11.32 statistics | stat</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-7875" class="tocentry">11.33 ti</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-7897" class="tocentry">11.34 timecorr</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-7939" class="tocentry">11.35 vectormath</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-7951" class="tocentry">11.36 wavelet</a>
</div>
</div>

<div class="lyxtoc-2"><a href="#magicparlabel-8010" class="tocentry">12 Analysis Examples</a>


<div class="lyxtoc-3"><a href="#magicparlabel-8012" class="tocentry">12.1 Cartesian covariance matrix calculation and projection (PCA)</a>
</div>

<div class="lyxtoc-3"><a href="#magicparlabel-8031" class="tocentry">12.2 Dihedral covariance matrix calculation and projection for backbone phi/psi (PCA)</a>
</div>
</div>
</div>
</div>


<div class="standard"><a id="magicparlabel-9"></a><em>Cpptraj</em>[<a href="#LyXCite-Roe13"><span class="bib-numericallabel">28</span></a>] (the successor to <em>ptraj</em>) is the main program in Amber for processing coordinate trajectories and data files. <i>Cpptraj</i> has been developed to be almost completely backwards-compatible with <i>ptraj</i> input. In general, if a command in <i>ptraj</i> has been implemented in <i>cpptraj</i> it should produce similar results, although the output format may be different. <em><i>A notable exception is the </i></em><i><b>hbond</b><em> command</em></i>, for which the syntax is quite different (see <a href="#subsec_cpptraj_hbond">10.35</a> for details).<em> Cpptraj</em> is at least as fast as <em>ptraj</em>
 was, and is in many cases significantly faster, particularly when 
processing NetCDF trajectories. In addition, several actions have been 
parallelized with OpenMP to take advantage of multi-core machines for 
even more speedup (see section <a href="#subsec_CpptrajOpenMP">1.6.2</a>), and ensembles of trajectories can be processed in parallel with MPI (see section <a href="#subsec_CpptrajMPI">1.6.1</a>). Currently the only functionality from <em>ptraj</em> not implemented in <em>cpptraj</em> are certain clustering algorithms.</div>

<div class="standard"><a id="magicparlabel-10"></a>Here are several notable features of <em>cpptraj</em>:</div>

<ol class="enumerate"><a id="magicparlabel-11"></a><li class="enumerate_item">Trajectories with different topologies can be processed in the same run.</li>
<li class="enumerate_item">Several actions/analyses in <em>cpptraj</em> are OpenMP parallelized; see section <a href="#subsec_CpptrajOpenMP">1.6.2</a> for more details.</li>
<li class="enumerate_item">Trajectory and ensemble reads can be MPI parallelized.</li>
<li class="enumerate_item">Almost any file read or written by <em>cpptraj</em>
 can be compressed (with the exception of the NetCDF trajectory format).
 So for example gzipped/bzipped topology files can be read, and data 
files can be written out as gzip/bzip2 files. Compression is detected 
automatically when reading, and is determined by the filename extension 
(.gz and .bz2 respectively) on writing.</li>
<li class="enumerate_item">The format of output data files can be 
specified by extension. For example, data files can be written in 
xmgrace format if the filename given has a '.agr' extension. A 
trajectory can be written in DCD format if the '.dcd' extension is used.</li>
<li class="enumerate_item">Multiple output trajectories can be specified, and can be written during action processing (as opposed to only after) via the <b><i>outtraj</i></b> command. In addition, output files can be directed to write only specific frames from the input trajectories.</li>
<li class="enumerate_item">Multiple reference structures can be specified. Specific frames from trajectories may be used as a reference structure.</li>
<li class="enumerate_item">The <b><i>rmsd</i></b> action allows 
specification of a separate mask for the reference structure. In 
addition, per-residue RMSD can be calculated easily. </li>
<li class="enumerate_item">Actions that modify coordinates and topology such as the <b><i>strip</i></b>/<b><i>closest</i></b> actions can often write an accompanying fully-functional stripped topology file. </li>
<li class="enumerate_item">Users usually are able to fine-tune the output format of data files declared in actions using the “<b>out</b>”
 keyword (for example, the precision of the numbers can be changed). In 
addition, users can control which data sets are written to which files 
(e.g. if two actions specify the same data file with the 'out' keyword, 
data from both actions will be written to that data file).</li>
<li class="enumerate_item">Users can manipulate data sets using mathematical expressions (with some limitations), see <a href="#subsec_cpptraj_Data_Set_Math">4.2</a> for details.</li>
</ol>
<h3 class="subsection"><a id="magicparlabel-22"></a><span class="subsection_label">0.1</span> Manual Syntax Format</h3>
<div class="standard"><a id="magicparlabel-23"></a>The syntax presented in this manual uses the following conventions:</div>

<dl class="description"><a id="magicparlabel-24"></a><dt class="description_label">&lt;&gt;</dt>
<dd class="description_item"> Denotes a variable.</dd>
<dt class="description_label">[]</dt>
<dd class="description_item"> Denotes something is optional.</dd>
<dt class="description_label">{|}</dt>
<dd class="description_item"> Denotes several choices separated by the '|' character; one of the choices must be specified.</dd>
<dt class="description_label">...</dt>
<dd class="description_item"> Denotes the preceding option can be repeated.</dd>
</dl>
<div class="standard"><a id="magicparlabel-28"></a>Everything else is as printed. </div>
<h2 class="section"><a id="magicparlabel-29"></a><span class="section_label">1</span> Running Cpptraj</h2>
<div class="standard"><a id="magicparlabel-30"></a><i>Cpptraj</i> can be run in either “interactive mode” or in “batch mode”. </div>
<h3 class="subsection"><a id="magicparlabel-31"></a><span class="subsection_label">1.1</span> Command Line Syntax</h3>

<div class="lyx_code"><a id="magicparlabel-32"></a><div class="lyx_code_item">cpptraj [-p &lt;Top0&gt;] [-i &lt;Input0&gt;] [-y &lt;trajin&gt;] [-x &lt;trajout&gt;]</div>
<div class="lyx_code_item">        [-c &lt;reference&gt;]</div>
<div class="lyx_code_item">        [-h | --help] [-V | --version] [--defines] [-debug &lt;#&gt;]</div>
<div class="lyx_code_item">        [--interactive] [--log &lt;logfile&gt;] [-tl]</div>
<div class="lyx_code_item">        [-ms &lt;mask&gt;] [-mr &lt;mask&gt;] [--mask &lt;mask&gt;] [--resmask &lt;mask&gt;]
<br />

</div>

<dl class="description"><a id="magicparlabel-37"></a><dt class="description_label">-p &lt;Top0&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Load &lt;Top0&gt; as a topology file. May be specified more than once.</span></dd>
<dt class="description_label">-i &lt;Input0&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Read input from &lt;Input0&gt;. May be specified more than once.</span></dd>
<dt class="description_label">-y &lt;trajin&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Read from trajectory file &lt;trajin&gt;; same as input 'trajin &lt;trajin&gt;'.</span></dd>
<dt class="description_label">-x &lt;trajout&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write trajectory file &lt;trajout&gt;; same as input 'trajout &lt;trajout&gt;'.</span></dd>
<dt class="description_label">-c &lt;reference&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Read &lt;reference&gt; as reference coordinates; same as input 'reference &lt;reference&gt;'.</span></dd>
<dt class="description_label">-h | –help</dt>
<dd class="description_item"><span style="font-family:monospace;"> Print command line help and exit.</span></dd>
<dt class="description_label">-V | –version</dt>
<dd class="description_item"><span style="font-family:monospace;"> Print version and exit.</span></dd>
<dt class="description_label">–defines</dt>
<dd class="description_item"><span style="font-family:monospace;"> Print compiler defines and exit.</span></dd>
<dt class="description_label">-debug &lt;#&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Set global debug level to &lt;#&gt;; same as input 'debug &lt;#&gt;'.</span></dd>
<dt class="description_label">–interactive</dt>
<dd class="description_item"><span style="font-family:monospace;"> Force interactive mode.</span></dd>
<dt class="description_label">–log &lt;logfile&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Record commands to &lt;logfile&gt; (interactive mode only). Default is 'cpptraj.log'.</span></dd>
<dt class="description_label">-tl</dt>
<dd class="description_item"><span style="font-family:monospace;"> Print length of trajectories specified with '-y' to STDOUT. The total number of frames is written out as 'Frames: &lt;X&gt;'</span></dd>
<dt class="description_label">-ms &lt;mask&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Print selected atom numbers to STDOUT. Selected atoms are written out as 'Selected= 1 2 3 ...'</span></dd>
<dt class="description_label">-mr</dt>
<dd class="description_item"><span style="font-family:monospace;"> &lt;mask&gt; : Print selected residue numbers to STDOUT. Selected residues are written out as 'Selected= 1 2 3 ...'</span></dd>
<dt class="description_label">–mask &lt;mask&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Print detailed atom selection to STDOUT.</span></dd>
<dt class="description_label">–resmask</dt>
<dd class="description_item"><span style="font-family:monospace;"> &lt;mask&gt; : Print detailed residue selection to STDOUT.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-53"></a>For backwards compatibility with <i>ptraj</i>, the following syntax is also accepted:</div>

<div class="lyx_code"><a id="magicparlabel-54"></a><div class="lyx_code_item">cpptraj &lt;Top&gt; &lt;Input&gt;</div>
</div>
<div class="standard"><a id="magicparlabel-55"></a>Note that unlike <i>ptraj</i>, in <i>cpptraj</i>
 it is not required that a topology file be specified on the command 
line as long as one is specified in the input file with the 'parm' 
keyword. Multiple topology/input files can be specified by use of 
multiple '-p' and '-i' flags. All topology and coordinate flags will be 
processed before any input flags.</div>
<h3 class="subsection"><a id="magicparlabel-56"></a><span class="subsection_label">1.2</span> Commands</h3>
<div class="standard"><a id="magicparlabel-57"></a>Input to <i>cpptraj</i>
 is in the form of commands, which can be categorized in to 2 types: 
immediate and queued. Immediate commands are executed as soon as they 
are encountered. Queued commands are initialized when they are 
encountered, but are not executed until a Run is executed via a <b><i>run</i></b> or <b><i>go</i></b> command. Actions, Analyses, and Trajectory commands (except <em><b>reference</b></em>) are queued commands; however, they can also be run immediately via commands such as <b><i>crdaction</i></b><i>,</i> <b><i>runanalysis</i></b><i>,</i> <em><b>loadcrd</b></em>, etc. See <a href="#sec_Coordinates_as_a">6</a> for more details.</div>

<div class="standard"><a id="magicparlabel-58"></a>Commands fall into seven categories:</div>

<dl class="description"><a id="magicparlabel-59"></a><dt class="description_label">General</dt>
<dd class="description_item"> (Immediate) These commands are executed immediately when entered.</dd>
<dt class="description_label">System</dt>
<dd class="description_item"> (Immediate) These are unix system commands (e.g. 'ls', 'pwd', etc).</dd>
<dt class="description_label">Coords</dt>
<dd class="description_item"> (Immediate) These commands are used to manipulate COORDS data sets; see <a href="#sec_Coordinates_as_a">6</a> for more details.</dd>
<dt class="description_label">Trajectory</dt>
<dd class="description_item"> (Queued) These commands prepare cpptraj for reading or writing trajectories during a Run.</dd>
<dt class="description_label">Topology</dt>
<dd class="description_item"> (Immediate) These commands are used to read, write, and modify topology information.</dd>
<dt class="description_label">Action</dt>
<dd class="description_item"> (Queued) These commands specify actions that will be performed on coordinate frames read in from trajectories during a Run.</dd>
<dt class="description_label">Analysis</dt>
<dd class="description_item"> (Queued) These commands specify analyses 
that will be performed on data that has been either generated from a Run
 or read in from an external source.</dd>
</dl>
<div class="standard"><a id="magicparlabel-66"></a>In addition to normal commands, <em>cpptraj</em> now has the ability to perform certain basic math operations, even on data sets. See <a href="#subsec_cpptraj_Data_Set_Math">4.2</a> for more details.</div>

<div class="standard"><a id="magicparlabel-67"></a>Commands in <i>cpptraj</i>
 can be read in from an input file or from the interactive command 
prompt. A '#' anywhere on a line denotes a comment; anything after '#' 
will be ignored no matter where it occurs. A '\' allows the continuation
 of one line to another. For example, the input:</div>

<div class="lyx_code"><a id="magicparlabel-68"></a><div class="lyx_code_item"># Sample input</div>
<div class="lyx_code_item">trajin mdcrd # This is a trajectory</div>
<div class="lyx_code_item">rms first out rmsd.dat \</div>
<div class="lyx_code_item">    :1-10</div>
</div>
<div class="standard"><a id="magicparlabel-72"></a>Translates to:</div>

<div class="lyx_code"><a id="magicparlabel-73"></a><div class="lyx_code_item">trajin mdcrd</div>
<div class="lyx_code_item">rms first out rmsd.dat :1-10</div>
</div>
<div class="standard"><a id="magicparlabel-75"></a>If in interactive 
mode, 'help &lt;command&gt;' can be used to get the associated keywords 
as well as an abbreviated description of the command. Most commands have
 a corresponding test which also serves as an example of how to use the 
command. See $AMBERHOME/AmberTools/test/cpptraj/README for more details.</div>
<h3 class="subsection"><a id="magicparlabel-76"></a><span class="subsection_label">1.3</span> Batch mode</h3>
<div class="standard"><a id="magicparlabel-77"></a>In “batch” mode, 
cpptraj is executed from the command line with one or more input files 
containing commands to be processed or STDIN. The syntax of &lt;input 
file&gt; is similar to that of <i>ptraj</i>. Keywords specifying 
different commands are given one per line. Lines beginning with '#' are 
ignored as comments. Lines can also be continued through use of the '\' 
character. This is the only allowed mode for cpptraj.MPI.</div>
<h3 class="subsection"><a id="magicparlabel-78"></a><span class="subsection_label">1.4</span> Interactive mode</h3>
<div class="standard"><a id="magicparlabel-79"></a>In “interactive mode”
 users can enter commands in a UNIX-like shell. Interactive mode is 
useful for running short and simple analyses or for trying out new kinds
 of analyses. If <em>cpptraj</em> is run with '–interactive', no arguments, or no specified input file:</div>

<div class="lyx_code"><a id="magicparlabel-80"></a><div class="lyx_code_item">cpptraj</div>
<div class="lyx_code_item">cpptraj --interactive</div>
<div class="lyx_code_item">cpptraj &lt;parm file&gt;</div>
<div class="lyx_code_item">cpptraj -p &lt;parm file&gt;</div>
</div>
<div class="standard"><a id="magicparlabel-84"></a>this brings up the 
interactive interface. This interface supports command history (via the 
up and down arrows) and tab completion for commands and file names. If 
no log file name has been given (with '–log &lt;logfile&gt;'), all 
commands used in interactive mode will be logged to a file named 
'cpptraj.log', which can subsequently be used as input if desired. 
Command histories will be read from any existing logs.</div>
<h3 class="subsection"><a id="magicparlabel-85"></a><span class="subsection_label">1.5</span> Trajectory Processing “Run”</h3>
<div class="standard"><a id="magicparlabel-86"></a>Like <i>ptraj</i>, a trajectory processing “Run” is one of the main ways to run <i>cpptraj</i>.
 First the Run is set up via commands read in from an input file or the 
interactive prompt. Trajectories are then read in one frame at a time 
(or in the case of ensemble processing all frames from a given step are 
read). Actions are performed on the coordinates stored in the frame, 
after which any output coordinates are written. At the end of the run, 
any data sets generated are written, and any queued Analyses are 
performed.</div>
<h4 class="subsubsection"><a id="magicparlabel-87"></a><span class="subsubsection_label">1.5.1</span> Actions and multiple topologies</h4>
<div class="standard"><a id="magicparlabel-88"></a>Since <em>cpptraj</em>
 supports multiple topology files, during a Run actions are set up every
 time the topology changes in order to recalculate things like what 
atoms are in a mask etc. Actions that are not valid for the current 
topology are skipped for that topology. So for example given two 
topology files with 100 residues, if the first topology file processed 
includes a ligand named MOL and the second one does not, the action:</div>

<div class="lyx_code"><a id="magicparlabel-89"></a><div class="lyx_code_item">distance :80 :MOL out D_80-to-MOL.dat</div>
</div>
<div class="standard"><a id="magicparlabel-90"></a>will be valid for the first topology but not for the second, so it will be skipped as long as the second topology is active.</div>
<h3 class="subsection"><a id="magicparlabel-91"></a><span class="subsection_label">1.6</span> Parallelization</h3>
<div class="standard"><a id="magicparlabel-92"></a><em>Cpptraj</em> has 
many levels of parallelization that can be enabled via the '-mpi', 
'-openmp', and/or '-cuda' configure flags for MPI, OpenMP, and CUDA 
parallelization respectively. At the highest level, trajectory and 
ensemble reads are parallelized with MPI. In addition, certain time 
consuming actions have been parallelized with OpenMP and/or CUDA.</div>

<div class="standard"><a id="magicparlabel-93"></a>Note that any 
combination of the '-openmp', '-cuda', and '-mpi' flags may be used to 
generate a hybrid MPI/OpenMP/CUDA binary; however this may require 
additional runtime setup (e.g. setting OMP_NUM_THREADS for OpenMP) to 
work properly and not oversubscribe cores. </div>
<h4 class="subsubsection"><a id="magicparlabel-94"></a><span class="subsubsection_label">1.6.1</span> MPI Trajectory Parallelization<a id="subsec_CpptrajMPI"></a>
</h4>
<div class="standard"><a id="magicparlabel-95"></a><i>Cpptraj</i> has two levels of MPI parallelization for reading input trajectories. The first is for '<em><b>trajin</b></em>'
 trajectory input, where the trajectory read is divided as evenly as 
possible among all input frames. For example, if given two trajectories 
of 1000 frames each and 4 MPI threads, thread 0 reads frames 1-500 of 
trajectory 1, thread 1 reads frames 501-1000 of trajectory 1, thread 2 
reads frames 1-500 of trajectory 2, and thread 3 reads frames 501-1000 
of trajectory 2.</div>

<div class="standard"><a id="magicparlabel-96"></a><em><i>The second is for </i></em><i><b>'ensemble'</b></i>
 trajectory input, where the reading/processing/writing of each member 
of the ensemble is divided up among MPI threads. The number of MPI 
threads must be a multiple of the ensemble size. If the number of 
threads is greater than the ensemble size then the processing of each 
ensemble member will be divided among MPI threads. For example, given an
 ensemble of 4 trajectories and 8 threads, threads 0 and 1 are assigned 
to the first ensemble trajectory, threads 2 and 3 are assigned to the 
second ensemble trajectory, and so on. When using ensemble mode in 
parallel it is recommended that the <em><b>ensemblesize</b></em> command be used prior to any ensemble command as this will make set up far more efficient.</div>

<div class="standard"><a id="magicparlabel-97"></a>In order to use the MPI version, Amber/<em>cpptraj</em> should be configured with the '-mpi' flag. You can tell if <em>cpptraj</em> has been compiled with MPI as it will print 'MPI' in the title, and/or by calling 'cpptraj —defines' and looking for '-DMPI'. </div>
<h4 class="subsubsection"><a id="magicparlabel-98"></a><span class="subsubsection_label">1.6.2</span> OpenMP Parallelization<a id="subsec_CpptrajOpenMP"></a>
</h4>
<div class="standard"><a id="magicparlabel-99"></a>Some of the more time-consuming actions/analyses in <i>cpptraj</i>
 have been parallelized with OpenMP to take advantage of machines with 
multiple cores. In order to use OpenMP parallelization Amber/<em>cpptraj</em> should be configured with the '-openmp' flag. You can easily tell if <i>cpptraj</i>
 has been compiled with OpenMP as it will print 'OpenMP' in the title, 
and/or by calling 'cpptraj —defines' and looking for '-D_OPENMP'. The 
following actions/analyses have been OpenMP parallelized:</div>

<div class="lyx_code"><a id="magicparlabel-100"></a><div class="lyx_code_item">2drms/rms2d</div>
<div class="lyx_code_item">atomiccorr</div>
<div class="lyx_code_item">checkstructure</div>
<div class="lyx_code_item">closest</div>
<div class="lyx_code_item">cluster (pair-wise distance calculation and sieved frame restore only)</div>
<div class="lyx_code_item">dssp/secstruct</div>
<div class="lyx_code_item">energy</div>
<div class="lyx_code_item">gist (non-bonded calculation)</div>
<div class="lyx_code_item">hbond</div>
<div class="lyx_code_item">kde</div>
<div class="lyx_code_item">lipidscd</div>
<div class="lyx_code_item">mask (distance-based masks only)</div>
<div class="lyx_code_item">matrix (coordinate covariance matrices only)</div>
<div class="lyx_code_item">minimage</div>
<div class="lyx_code_item">radial</div>
<div class="lyx_code_item">replicatecell</div>
<div class="lyx_code_item">rmsavgcorr</div>
<div class="lyx_code_item">spam</div>
<div class="lyx_code_item">surf</div>
<div class="lyx_code_item">velocityautocorr</div>
<div class="lyx_code_item">volmap</div>
<div class="lyx_code_item">watershell</div>
<div class="lyx_code_item">wavelet</div>
</div>
<div class="standard"><a id="magicparlabel-123"></a>By default OpenMP <i>cpptraj</i>
 will use all available cores. The number of OpenMP threads can be 
controlled by setting the OMP_NUM_THREADS environment variable.</div>
<h4 class="subsubsection"><a id="magicparlabel-124"></a><span class="subsubsection_label">1.6.3</span> CUDA Parallelization</h4>
<div class="standard"><a id="magicparlabel-125"></a>Some time-consuming 
actions in cpptraj have been parallelized with CUDA to take advantage of
 machines with NVIDIA GPUs. In order to use CUDA parallelization 
Amber/cpptraj should be configured with the '-cuda' flag. You can easily
 tell if cpptraj has been compiled with CUDA as it will print 'CUDA' and
 details on the current graphics device in the title, and/or by calling 
'cpptraj —defines' and looking for '-DCUDA'. The following actions have 
been CUDA parallelized:</div>

<div class="lyx_code"><a id="magicparlabel-126"></a><div class="lyx_code_item">closest</div>
<div class="lyx_code_item">watershell</div>
</div>
<h2 class="section"><a id="magicparlabel-128"></a><span class="section_label">2</span> General Concepts</h2>
<h3 class="subsection"><a id="magicparlabel-129"></a><span class="subsection_label">2.1</span> Units</h3>
<div class="standard"><a id="magicparlabel-130"></a>Cpptraj uses the AKMA system of units. The execption is time, which is typically expressed in ps (except where noted).
<br />

</div>



<div class="standard" style="text-align: center;"><a id="magicparlabel-131"></a><table><tbody><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-154"></a><b>Variable</b></div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-157"></a><b>Unit</b></div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-160"></a>Length</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-163"></a>Angstrom</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-166"></a>Energy</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-169"></a>kcal/mol</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-172"></a>Mass</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-175"></a>AMU</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-178"></a>Charge</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-181"></a>electron</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-184"></a>Time</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-187"></a>ps (typically)</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-190"></a>Force</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-193"></a>kcal/mol*Angstrom</div>
</td>
</tr></tbody>
</table>
</div>
<h3 class="subsection"><a id="magicparlabel-194"></a><span class="subsection_label">2.2</span> Atom Mask Selection Syntax</h3>
<div class="standard"><a id="magicparlabel-195"></a>The mask syntax is similar to <i>ptraj</i>. Note that the characters '<span style="font-family:monospace;">:</span>', '<span style="font-family:monospace;">@</span>', and '<span style="font-family:monospace;">*</span>'
 are reserved for masks and should not be used in output file or data 
set names. All masks are case-sensitive. Either names or numbers can be 
used. Masks can contain ranges (denoted with '<span style="font-family:monospace;">-</span>') and comma separated lists. The logical operands '<span style="font-family:monospace;">&amp;</span>' (and), '<span style="font-family:monospace;">|</span>' (or), and '<span style="font-family:monospace;">!</span>' (not) are also supported. </div>

<div class="standard"><a id="magicparlabel-196"></a>The syntax for elementary selections is the following:</div>

<dl class="description"><a id="magicparlabel-197"></a><dt class="description_label">@{atom numlist}</dt>
<dd class="description_item"> e.g. '@12,17', '@54-85', '@12,54-85,90'</dd>
<dt class="description_label">@{atom namelist}</dt>
<dd class="description_item"> e.g. '@CA', '@CA,C,O,N,H'</dd>
<dt class="description_label">@%{atom type name}</dt>
<dd class="description_item"> e.g. '@%CT'</dd>
<dt class="description_label">@/{atom_element_name}</dt>
<dd class="description_item"> e.g. '@/N'</dd>
<dt class="description_label">:{residue numlist}</dt>
<dd class="description_item"> e.g. ':1-10', ':1,3,5', ':1-3,5,7-9'</dd>
<dt class="description_label">:{residue namelist}</dt>
<dd class="description_item"> e.g. ':LYS', ':ARG,ALA,GLY'</dd>
<dt class="description_label">:/{chain id}</dt>
<dd class="description_item"> e.g. ':/B', ':/A,D'. Requires chain ID information be present in the topology.</dd>
<dt class="description_label">:;{pdb residue number}</dt>
<dd class="description_item"> e.g. ':;2-4,8'. Requires a PDB loaded as topology, or Amber topology with embedded PDB information (see <a href="#subsec_parmed_addPDB">subsec:parmed_addPDB</a>).</dd>
<dt class="description_label">^{molecule numlist}</dt>
<dd class="description_item"> e.g. '^1-10', ':23,84,111'</dd>
<dt class="description_label">&lt;mask&gt;&lt;distance op&gt;&lt;distance&gt;</dt>
<dd class="description_item"> Selection by distance, see below.</dd>
</dl>
<div class="standard"><a id="magicparlabel-207"></a>Several wildcard characters are supported:</div>

<dl class="description"><a id="magicparlabel-208"></a><dt class="description_label">'*'</dt>
<dd class="description_item"> Zero or more characters.</dd>
<dt class="description_label">'='</dt>
<dd class="description_item"> Same as '*'</dd>
<dt class="description_label">'?'</dt>
<dd class="description_item"> One character.</dd>
</dl>
<div class="standard"><a id="magicparlabel-211"></a>The wildcards can 
also be used with numbers or other mask characters, e.g. ':?0' means 
“:10,20,30,40,50,60,70,80,90”, ':*' means all residues and '@*' means 
all atoms. </div>

<div class="standard"><a id="magicparlabel-212"></a>Compound expressions of the following type are allowed:</div>

<div class="lyx_code"><a id="magicparlabel-213"></a><div class="lyx_code_item">:{residue numlist | namelist}@{atom namelist | numlist}</div>
</div>
<div class="standard"><a id="magicparlabel-214"></a>and are processed as: </div>

<div class="lyx_code"><a id="magicparlabel-215"></a><div class="lyx_code_item">:{residue numlist | namelist} &amp; @{atom namelist | numlist}</div>
</div>
<div class="standard"><a id="magicparlabel-216"></a>e.g. ':1-10@CA' is equivalent to “:1-10 &amp; @CA”.</div>

<div class="standard"><a id="magicparlabel-217"></a>More examples: </div>

<dl class="description"><a id="magicparlabel-218"></a><dt class="description_label">:ALA,TRP</dt>
<dd class="description_item"> All alanine and tryptophan residues. </dd>
<dt class="description_label">:5,10@CA</dt>
<dd class="description_item"> CA carbon in residues 5 and 10.</dd>
<dt class="description_label">:*&amp;!@H=</dt>
<dd class="description_item"> All non-hydrogen atoms (equivalent to "!@H="). </dd>
<dt class="description_label">@CA,C,O,N,H</dt>
<dd class="description_item"> All backbone atoms. </dd>
<dt class="description_label">!@CA,C,O,N,H</dt>
<dd class="description_item"> All non-backbone atoms (=sidechains for proteins only). </dd>
<dt class="description_label">:1-500@O&amp;!(:WAT|:LYS,ARG)</dt>
<dd class="description_item"> All backbone oxygens in residues 1-500 but not in water, lysine or arginine residues.</dd>
<dt class="description_label">^1-2:ASP</dt>
<dd class="description_item"> All residues named 'ASP' in the first two molecules.</dd>
<dt class="description_label">:/A,D@CA</dt>
<dd class="description_item"> All atoms named 'CA' in chains A and D.</dd>
</dl>
<h4 class="subsubsection_"><a id="magicparlabel-226"></a>Distance-based Masks</h4>
<div class="standard"><a id="magicparlabel-227"></a>There are two very important things to keep in mind when using distance based masks:</div>

<ol class="enumerate"><a id="magicparlabel-228"></a><li class="enumerate_item">Distance-based masks that update each frame are currently only supported by the <b><i>mask</i></b> action.</li>
<li class="enumerate_item">Selection by distance for everything but the <b><i>mask</i></b> action requires defining a reference frame with <b><i>reference</i></b>; distances are then calculated using the <u>specified reference frame only</u>. This reference frame can be changed using the <em><b>activeref</b></em> command.</li>
</ol>
<div class="standard"><a id="magicparlabel-230"></a>The syntax for selection by distance is a <b>&lt;mask&gt;</b> expression followed by a <b>&lt;distance operator&gt;</b> followed by a <b>&lt;distance&gt;</b> (which is in Angstroms). The <b>&lt;distance operator&gt;</b> consists of 2 characters: '<b>&lt;</b>' (within) or '<b>&gt;</b>' (without) followed by either '<b>^</b>' (molecules), '<b>:</b>' (residues), or '<b>@</b>' (atoms). For example, '<b>&lt;:</b>3.0'
 means “residues within 3.0 Angstroms” etc. For residue- and 
molecule-based distance selection, if any atom in that residue/molecule 
matches the given distance criterion, the entire residue/molecule is 
selected.</div>

<div class="standard"><a id="magicparlabel-231"></a>In plain language, the entire distance mask can be read as “Select <b>&lt;distance operator&gt;</b> <b>&lt;distance&gt;</b> of <b>&lt;mask&gt;</b>”. So for example, the mask expression:</div>

<div class="lyx_code"><a id="magicparlabel-232"></a><div class="lyx_code_item">:11-17&lt;@2.4</div>
</div>
<div class="standard"><a id="magicparlabel-233"></a>Means “Select atoms within 2.4 Å distance of atoms selected by ':11-17' (residues numbered 11 through 17)”. </div>

<div class="standard"><a id="magicparlabel-234"></a>To strip everything outside 3.0 Å (i.e. without 3.0 Å) from residue 4 using specified reference coordinates:</div>

<div class="lyx_code"><a id="magicparlabel-235"></a><div class="lyx_code_item">reference mol.rst7</div>
<div class="lyx_code_item">trajin mol.rst7</div>
<div class="lyx_code_item">strip !(:4&lt;:3.0)</div>
</div>
<h3 class="subsection"><a id="magicparlabel-238"></a><span class="subsection_label">2.3</span> Ranges</h3>
<div class="standard"><a id="magicparlabel-239"></a>For several commands
 some arguments are ranges (e.g. 'trajout onlyframes &lt;range&gt;', 
'nastruct resrange &lt;range&gt;', 'rmsd perres range &lt;range&gt;'); <b>THESE ARE NOT ATOM MASKS</b>.
 They are simple number ranges using '-' to specify a range and ',' to 
separate different ranges. For example 1-2,4-6,9 specifies 1 to 2, 4 to 
6, and 9, i.e. '1 2 4 5 6 9'.</div>
<h3 class="subsection"><a id="magicparlabel-240"></a><span class="subsection_label">2.4</span> Parameter/Reference Tagging<a id="subsec_Parameter_Reference_Tagging"></a>
</h3>
<div class="standard"><a id="magicparlabel-241"></a>Parameter and 
reference files may be 'tagged' (i.e. given a nickname); these tags can 
then be used in place of the file name itself. A tag in <i>cpptraj</i> 
is recognized by being bounded by brackets ('[' and ']'). This can be 
particularly useful when reading in many parameter or reference files. 
For example, when reading in multiple reference structures:</div>

<div class="lyx_code"><a id="magicparlabel-242"></a><div class="lyx_code_item">trajin Test1.crd</div>
<div class="lyx_code_item">reference 1LE1.NoWater.Xray.rst7 [xray]</div>
<div class="lyx_code_item">reference Test1.crd lastframe [last]</div>
<div class="lyx_code_item">reference Test2.crd 225 [open]</div>
<div class="lyx_code_item">rms Xray ref [xray] :2-12@CA out rmsd.dat</div>
<div class="lyx_code_item">rms Last ref [last] :2-12@CA out rmsd.dat</div>
<div class="lyx_code_item">rms Open ref [open] :2-12@CA out rmsd.dat</div>
</div>
<div class="standard"><a id="magicparlabel-249"></a>This defines three 
reference structures and gives them tags [xray], [last], and [open]. 
These reference structures can then be referred to by their tags instead
 of their filenames by any action that uses reference structures (in 
this case the RMSD action).</div>

<div class="standard"><a id="magicparlabel-250"></a>Similarly, this can be useful when reading in multiple parameter files:</div>

<div class="lyx_code"><a id="magicparlabel-251"></a><div class="lyx_code_item">parm tz2.ff99sb.tip3p.truncoct.parm7 [tz2-water]</div>
<div class="lyx_code_item">parm tz2.ff99sb.mbondi2.parm7 [tz2-nowater]</div>
<div class="lyx_code_item">trajin tz2.run1.explicit.nc parm [tz2-water]</div>
<div class="lyx_code_item">reference tz2.dry.rst7 parm [tz2-nowater] [tz2]</div>
<div class="lyx_code_item">rms ref [tz2] !(:WAT) out rmsd.dat</div>
</div>
<div class="standard"><a id="magicparlabel-256"></a>This defines two 
parm files and gives them tags [tz2-water] and [tz2-nowater], then reads
 in a trajectory associated with one, and a reference structure 
associated with the other. Note that in the 'reference' command there 
are two tags; the first goes along with the 'parm' keyword and specifies
 what parameter file the reference should use, the second is the tag 
given to the reference itself (as in the previous example) and is 
referred to in the subsequent RMSD action.</div>
<h2 class="section"><a id="magicparlabel-257"></a><span class="section_label">3</span> Variables and Control Structures</h2>
<div class="standard"><a id="magicparlabel-258"></a>As of version 18, 
CPPTRAJ has limited support for “script” variables and 'for' loops. 
Script variables are referred to by a dollar sign ('$') prefix and are 
replaced when they are processed. Note that to use script variables in 
CPPTRAJ input that is also inside e.g. a BASH script, they can be 
escaped with the '\' character, e.g.</div>

<div class="lyx_code"><a id="magicparlabel-259"></a><div class="lyx_code_item">#!/bin/bash</div>
<div class="lyx_code_item">TOP=MyTop.parm7</div>
<div class="lyx_code_item">cpptraj &lt;&lt;EOF</div>
<div class="lyx_code_item">set topname=$TOP</div>
<div class="lyx_code_item">parm \$topname</div>
<div class="lyx_code_item">EOF</div>
</div>
<div class="standard"><a id="magicparlabel-265"></a>Note that regular 
CPPTRAJ 1D Data Sets that contain a single value can be used as script 
variables (if the Data Set contains more than 1 value only the first 
value will be used).</div>



<div class="standard"><a id="magicparlabel-266"></a><table><tbody><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-283"></a><b>Command</b></div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-286"></a><b>Description</b></div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-289"></a>for</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-292"></a>Create a 'for' loop.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-295"></a>set</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-298"></a>Set or update a script variable.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-301"></a>show</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-304"></a>Show all current script variables and their values.</div>
</td>
</tr></tbody>
</table>
</div>
<h3 class="subsection"><a id="magicparlabel-305"></a><span class="subsection_label">3.1</span> for</h3>

<div class="lyx_code"><a id="magicparlabel-306"></a><div class="lyx_code_item">for { {atoms|residues|molecules|molfirstres|mollastres}</div>
<div class="lyx_code_item">	    &lt;var&gt; inmask &lt;mask&gt; [parm &lt;name&gt; | parmindex &lt;#&gt; | &lt;#&gt;] ... |</div>
<div class="lyx_code_item">	  &lt;var&gt;=&lt;start&gt;;[&lt;var&gt;&lt;end OP&gt;&lt;end&gt;;]&lt;var&gt;&lt;increment OP&gt;[&lt;value&gt;] ... }</div>
<div class="lyx_code_item">	END KEYWORD: 'done'</div>
<div class="lyx_code_item">  Available 'end OP'       : '&lt;' '&gt;'</div>
<div class="lyx_code_item">  Available 'increment OP' : '++', '--', '+=', '-='</div>

<dl class="description"><a id="magicparlabel-312"></a><dt class="description_label">atoms|residues|molecules|molfirstres|mollastres &lt;var&gt; inmask &lt;mask&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Loop 
over atoms/residues/molecules/first residue in molecules/last residue in
 molecules selected by the given mask expression, set as script variable
 <b>&lt;var&gt;</b>.</span>

<dl class="description"><a id="magicparlabel-313"></a><dt class="description_label">parm &lt;name&gt; | parmindex &lt;#&gt; &lt;#&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Select topology that <b>&lt;mask&gt;</b> should be based on (default first topology).</span></dd>
</dl>
</dd><dt class="description_label">&lt;var&gt;=&lt;start&gt;;[&lt;var&gt;&lt;end OP&gt;&lt;end&gt;;]&lt;var&gt;&lt;increment OP&gt;[&lt;value&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Loop over integer script variable <b>&lt;var&gt;</b> starting from <b>&lt;start&gt;</b>, optionally ending at <b>&lt;end&gt;</b>, increment by <b>&lt;value&gt;</b>.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-315"></a>Create a for loop 
using one or more mask expressions or integers. Loops can be nested, but
 currently inner loops cannot refer to output loop variables. Integer 
loops may be used without an end condition, but in that case at least 
one descriptor in the loop should have an end condition or refer to a 
mask. Loops are ended by the <b>done</b> keyword. Note that unlike C-style for loops the variable is not incremented on the final execution, so the final value of <b>&lt;var&gt;</b> will be <b>&lt;end&gt;</b> (or the last selection in the mask).</div>

<div class="standard"><a id="magicparlabel-316"></a>For example:</div>

<div class="lyx_code"><a id="magicparlabel-317"></a><div class="lyx_code_item">for atoms A0 inmask :1-3@CA i=1;i++</div>
<div class="lyx_code_item">  distance d$i :TCS $A0 out $i.dat</div>
<div class="lyx_code_item">done</div>
</div>
<div class="standard"><a id="magicparlabel-320"></a>This loops over all 
atoms in the mask expression ':1-3@CA' (all atoms named CA in residues 1
 to 3) and creates a variable named 'i' that starts from 1 and is 
incremented by 1 each iteration. Inside the loop, the mask selection is 
referred to by <b>$A0</b> and the integer by <b>$i</b>. This is equivalent to doing 3 distance commands like so:</div>

<div class="lyx_code"><a id="magicparlabel-321"></a><div class="lyx_code_item">distance d1 :TCS :1@CA out 1.dat</div>
<div class="lyx_code_item">distance d2 :TCS :2@CA out 2.dat</div>
<div class="lyx_code_item">distance d3 :TCS :3@CA out 3.dat</div>
</div>
<h3 class="subsection"><a id="magicparlabel-324"></a><span class="subsection_label">3.2</span> set</h3>

<div class="lyx_code"><a id="magicparlabel-325"></a><div class="lyx_code_item">set { &lt;variable&gt; &lt;OP&gt; &lt;value&gt; |</div>
<div class="lyx_code_item">	  &lt;variable&gt; &lt;OP&gt; {atoms|residues|molecules} inmask &lt;mask&gt;</div>
<div class="lyx_code_item">	    [parm &lt;name&gt; | parmindex &lt;#&gt; | &lt;#&gt;]</div>
<div class="lyx_code_item">	  &lt;variable&gt; &lt;OP&gt; trajinframes }</div>
<div class="lyx_code_item">  Available &lt;OP&gt; : '=', '+='</div>

<dl class="description"><a id="magicparlabel-330"></a><dt class="description_label">&lt;variable&gt; &lt;OP&gt; &lt;value&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Set or append a script variable.</span></dd>
<dt class="description_label">&lt;variable&gt; &lt;OP&gt; {atoms|residues|molecules} inmask &lt;mask&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Set/append a script variable to/by the total number of atoms/residues/molecules selected by given mask expression.</span>

<dl class="description"><a id="magicparlabel-332"></a><dt class="description_label">parm &lt;name&gt; | parmindex &lt;#&gt; | &lt;#&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Topology to which mask should correspond (default first).</span></dd>
</dl>
</dd><dt class="description_label">&lt;variable&gt; &lt;OP&gt; trajinframes</dt>
<dd class="description_item"><span style="font-family:monospace;"> Set/append a script variable to/by the total number of frames in trajectories currently loaded by <em><b>trajin</b></em> commands.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-334"></a>Set (&lt;OP&gt; = 
'=') or append (&lt;OP&gt; = '+=') a script variable. Script variables 
are referred to in CPPTRAJ input by using a dollar sign '$' prefix.</div>

<div class="standard"><a id="magicparlabel-335"></a>For example, the following input will print info for the last 10 atoms in a topology to 'last10.dat':</div>

<div class="lyx_code"><a id="magicparlabel-336"></a><div class="lyx_code_item">set Natom = atoms inmask * </div>
<div class="lyx_code_item">last10 = $Natom - 10</div>
<div class="lyx_code_item">show</div>
<div class="lyx_code_item">atoms "@$last10 - $Natom" out last10.dat</div>
</div>
<h3 class="subsection"><a id="magicparlabel-340"></a><span class="subsection_label">3.3</span> show</h3>

<div class="lyx_code"><a id="magicparlabel-341"></a><div class="lyx_code_item">show</div>
</div>
<div class="standard"><a id="magicparlabel-342"></a>Show all current script variables and their values.</div>
<h2 class="section"><a id="magicparlabel-343"></a><span class="section_label">4</span> Data Sets and Data Files</h2>
<div class="standard"><a id="magicparlabel-344"></a>In <i>cpptraj</i>, Actions and Analyses can generate one or more data sets which are available for further processing. For example, the <b><i>distance</i></b>
 command creates a data set containing distances vs time. The data set 
can be named by the user simply by specifying a non-keyword string as an
 additional argument. If no name is given, a default one will be 
generated based on the action name and data set number. For example:</div>

<div class="lyx_code"><a id="magicparlabel-345"></a><div class="lyx_code_item">distance d1-2 :1 :2 out d1-2.dat</div>
</div>
<div class="standard"><a id="magicparlabel-346"></a>will create a data set named “d1-2”. If a name is not specified, e.g.:</div>

<div class="lyx_code"><a id="magicparlabel-347"></a><div class="lyx_code_item">distance :1 :2 out d1-2.dat</div>
</div>
<div class="standard"><a id="magicparlabel-348"></a>the data set will be named “Dis_00000”.</div>

<div class="standard"><a id="magicparlabel-349"></a>Data files are created automatically by most commands, usually via the “<b>out</b>” keyword. Data files can also be explicitly created with the <b><i>write</i>/<i>writedata</i></b> and <b><i>create</i></b> commands. Data can also be read in from files via the <b><i>readdata</i></b> command. Cpptraj currently recognizes the formats listed in <a href="#tab_cpptraj_DataFile_formats">1</a>,
 although it cannot write in all formats. In addition, a data set must 
be valid for the data file format. For example, 3D data (such as a grid)
 can be written to an OpenDX format file but not a Grace format file. </div>

<div class="standard"><a id="magicparlabel-350"></a>The default file format is called 'Standard', which simply has data in columns, like <i>ptraj</i>,
 although multiple data sets can be directed to the same output file. 
The format of a file can be changed either by specifying a recognized 
keyword (either on the command line itself or later via a 'datafile' 
command) or by giving the file an extension corresponding to te format, 
so 'filename.agr' will output in Grace format, and 'filename.gnu' will 
output in Gnuplot contour, and so on. The xmgrace/gnuplot output is 
particularly nice for the secstruct sumout and rmsd perresout files. 
Additional options for data files can be found in <a href="#sec_Datafile_Commands">5</a>.</div>

<div class="standard"><a id="magicparlabel-351"></a>Any action using the
 “out” keyword will allow data sets from separate commands to be written
 into the same file. For example, the commands:</div>

<div class="lyx_code"><a id="magicparlabel-352"></a><div class="lyx_code_item">dihedral phi :1@C :2@N :2@CA :2@C out phipsi.dat</div>
<div class="lyx_code_item">dihedral psi :2@N :2@CA :2@C :3@N out phipsi.dat</div>
</div>
<div class="standard"><a id="magicparlabel-354"></a>will assign the “phi” and “psi” data sets generated from each action to the standard data output file “phipsi.dat”:</div>

<div class="lyx_code"><a id="magicparlabel-355"></a><div class="lyx_code_item">#Frame   phi   psi</div>
</div>



<div class="float-table"><div class="plain_layout" style="text-align: center;"><a id="magicparlabel-360"></a><table><tbody><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-447"></a><b>Format</b></div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-450"></a><b>Filename Extensions</b></div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-453"></a><b>Keyword</b></div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-456"></a><b>Valid Dimensions</b></div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-459"></a><b>Notes</b></div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-462"></a>Standard</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-465"></a>.dat</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-468"></a>dat</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-471"></a>1D, 2D, 3D</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-477"></a>Grace</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-480"></a>.agr, .xmgr</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-483"></a>grace</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-486"></a>1D</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-492"></a>Gnuplot</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-495"></a>.gnu</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-498"></a>gnu</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-501"></a>1D, 2D</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-507"></a>Xplor</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-510"></a>.xplor, .grid</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-513"></a>xplor</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-516"></a>3D</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-522"></a>OpenDX</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-525"></a>.dx</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-528"></a>opendx</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-531"></a>3D</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-537"></a>Amber REM log</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-540"></a>.log</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-543"></a>remlog</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-546"></a>-</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-549"></a>Read Only</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-552"></a>Amber MDOUT</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-555"></a>.mdout</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-558"></a>mdout</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-561"></a>-</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-564"></a>Energy information, Read Only</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-567"></a>Amber Evecs</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-570"></a>.evecs</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-573"></a>evecs</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-576"></a>Modes data set only</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-582"></a>Amber Constant pH output</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-585"></a>.cpout</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-588"></a>cpout</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-591"></a>pH data only</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-597"></a>Vector pseudo-traj</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-600"></a>.vectraj</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-603"></a>vectraj</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-606"></a>Vector data set only.</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-609"></a>Write Only</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-612"></a>Gromacs XVG</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-615"></a>.xvg</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-618"></a>xvg</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-621"></a>-</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-624"></a>Read Only</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-627"></a>CCP4</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-630"></a>.ccp4</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-633"></a>ccp4</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-636"></a>3D</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-642"></a>Charmm REPD log</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-645"></a>.exch</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-648"></a>charmmrepd</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-651"></a>-</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-654"></a>Read Only</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-657"></a>Charmm Output</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-660"></a>.charmmout</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-663"></a>charmmout</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-666"></a>-</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-669"></a>Energy information, Read Only</div>
</td>
</tr></tbody>
</table>
</div>

<div class="plain_layout"><a id="magicparlabel-670"></a><span class="float-caption-Standard float-caption float-caption-standard">Table 1:  <a id="tab_cpptraj_DataFile_formats"></a>
DataFile formats recognized by <i>cpptraj</i>. 'Valid Dimensions' shows what dimensions the format is valid for (e.g. you cannot write a 1D data set with OpenDX format).</span></div>
</div>

<h3 class="subsection"><a id="magicparlabel-675"></a><span class="subsection_label">4.1</span> Data Set Selection Syntax</h3>
<div class="standard"><a id="magicparlabel-676"></a>Many analysis commands can be used to analyze multiple data sets. The general format for selecting data sets is:</div>

<div class="lyx_code"><a id="magicparlabel-677"></a><div class="lyx_code_item">&lt;name&gt;[&lt;aspect&gt;]:&lt;index&gt;</div>
</div>
<div class="standard"><a id="magicparlabel-678"></a>The '*' character can be used as a wild-card for <i>entire</i> names (no partial matches).</div>

<ul class="itemize"><a id="magicparlabel-679"></a><li class="itemize_item"><b>&lt;name&gt;:</b> The data set name, usually specified in the action (e.g. in 'distance d0 @1 @2' the data set name is “d0”).</li>
<li class="itemize_item"><b>&lt;aspect&gt;:</b> Optional; this is set for certain data sets internally in order to easily select subsets of data. <b>The brackets are required</b>.
 For example, when using 'hbond series', both solute-solute and 
solute-solvent hydrogen bond time series may be generated. To select all
 solute-solute hydrogen bonds one would use the aspect “[solutehb]”; to 
select solute-solvent hydrogen bonds the aspect “[solventhb]” would be 
used. Aspects are hard-coded and are listed in the commands that use 
them.</li>
<li class="itemize_item"><b>&lt;index&gt;:</b> Optional; for actions 
that generate many data sets (such as 'rmsd perres') an index is used. 
Depending on the action, the index may correspond to atom #s, residue 
#s, etc. A number range (comma and/or dash separated) may be used.</li>
</ul>
<div class="standard"><a id="magicparlabel-682"></a>For example: to select all data sets with aspect “[shear]” named NA_00000:</div>

<div class="lyx_code"><a id="magicparlabel-683"></a><div class="lyx_code_item">NA_00000[shear]</div>
</div>
<div class="standard"><a id="magicparlabel-684"></a>To select all data sets with aspect “[stagger]” with any name, indices 1 and 3:</div>

<div class="lyx_code"><a id="magicparlabel-685"></a><div class="lyx_code_item">*[stagger]:1,3</div>
</div>
<div class="standard"><a id="magicparlabel-686"></a>In ensemble mode, data set selection has additional syntax:</div>

<div class="lyx_code"><a id="magicparlabel-687"></a><div class="lyx_code_item">&lt;name&gt;[&lt;aspect&gt;]:&lt;index&gt;%&lt;member&gt;</div>
</div>
<div class="standard"><a id="magicparlabel-688"></a>Where &lt;member&gt; is the ensemble member number starting from 0.</div>
<h3 class="subsection"><a id="magicparlabel-689"></a><span class="subsection_label">4.2</span> Data Set Math<a id="subsec_cpptraj_Data_Set_Math"></a>
</h3>
<div class="standard"><a id="magicparlabel-690"></a>As of version 15, <em>cpptraj</em> can perform basic math operations, even on data sets (with some limitations). Currently recognized operations are:
<br />

</div>



<div class="standard" style="text-align: center;"><a id="magicparlabel-691"></a><table><tbody><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-716"></a><b>Operation</b></div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-719"></a><b>Symbol</b></div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-722"></a>Minus</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-725"></a>-</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-728"></a>Plus</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-731"></a>+</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-734"></a>Divide</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-737"></a>/</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-740"></a>Multiply</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-743"></a>*</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-746"></a>Power</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-749"></a>^</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-752"></a>Negate</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-755"></a>-</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-758"></a>Assign</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-761"></a>=</div>
</td>
</tr></tbody>
</table>
</div>

<div class="standard"><a id="magicparlabel-762"></a>Several functions are also supported:
<br />

</div>



<div class="standard" style="text-align: center;"><a id="magicparlabel-763"></a><table><tbody><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-798"></a><b>Function</b></div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-801"></a><b>Form</b></div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-804"></a>Square Root</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-807"></a>sqrt()</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-810"></a>Exponential</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-813"></a>exp()</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-816"></a>Natural Logarithm</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-819"></a>ln()</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-822"></a>Absolute Value</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-825"></a>abs()</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-828"></a>Sine</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-831"></a>sin()</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-834"></a>Cosine</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-837"></a>cos()</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-840"></a>Tangent</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-843"></a>tan()</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-846"></a>Summation</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-849"></a>sum()</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-852"></a>Average</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-855"></a>avg()</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-858"></a>Standard Deviation</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-861"></a>stdev()</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-864"></a>Minimum</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-867"></a>min()</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-870"></a>Maximum</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-873"></a>max()</div>
</td>
</tr></tbody>
</table>
</div>

<div class="standard"><a id="magicparlabel-874"></a>Numbers can be 
expressed in scientific notation using “E” notation, e.g. 1E-5 = 
0.00001. The parser also recognizes PI as the number pi. Expressions can
 also be enclosed in parentheses. So for example, the following 
expression is valid:</div>

<div class="lyx_code"><a id="magicparlabel-875"></a><div class="lyx_code_item">&gt; 1 - ln(sin(PI/4) * 2)^2 </div>
<div class="lyx_code_item">Result: 0.879887</div>
</div>
<div class="standard"><a id="magicparlabel-877"></a>Results of numerical
 calculations like the above can be assigned to a variable (essentially a
 data set of size 1) for use in subsequent calculations, e.g.</div>

<div class="lyx_code"><a id="magicparlabel-878"></a><div class="lyx_code_item">&gt; R = 1 - ln(sin(PI/4) * 2)^2 </div>
<div class="lyx_code_item">Result stored in 'R' </div>
<div class="lyx_code_item">&gt; R + 1 Result: 1.879887</div>
</div>
<div class="standard"><a id="magicparlabel-881"></a>Data sets can be 
specified in expressions as well. Currently data sets in an expression 
must be of the same type and only 1D, 2D, and 3D data sets are 
supported. Functions are applied to each member of the data set. So for 
example, given two 1D data sets of the same size named D0 and D1, the 
following expression:</div>

<div class="lyx_code"><a id="magicparlabel-882"></a><div class="lyx_code_item">&gt; D2 = sqrt( D0 ) + D1</div>
</div>
<div class="standard"><a id="magicparlabel-883"></a>would take the 
square root of each member of D0, add it to the corresponding member of 
D1, and assign the result to D2. The following table lists which 
operations are valid for data set types. If a type is not listed it is 
not supported:
<br />

</div>



<div class="standard" style="text-align: center;"><a id="magicparlabel-884"></a><table><tbody><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-915"></a><b>Data Set Type</b></div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-918"></a><b>Supported Ops</b></div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-921"></a><b>Supported Funcs</b></div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-924"></a><b>Notes</b></div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-927"></a>1D (integer, double, float)</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-930"></a>All</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-933"></a>All</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-939"></a>1D (vector)</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-942"></a>+, -, *, /, =</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-945"></a>None</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-948"></a>'*' is dot product</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-951"></a>2D (matrices)</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-954"></a>+, -, /, *, =</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-957"></a>sum, avg, stdev, min, max</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-963"></a>3D (grids)</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-966"></a>+, -, /, *, =</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-969"></a>sum, avg, stdev, min, max</div>
</td>
<td valign="top" align="center">

</td>
</tr></tbody>
</table>
</div>
<h2 class="section"><a id="magicparlabel-973"></a><span class="section_label">5</span> Data File Options<a id="sec_Datafile_Commands"></a>
</h2>
<div class="standard"><a id="magicparlabel-974"></a>Data file output can
 be handled multiple ways in cpptraj. Output data files can be created 
by Actions/Analyses/Commands, or can be explicitly created with <em><b>writedata</b></em> (<a href="#subsec_cpptraj_writedata">7.27</a>) or <em><b>create</b></em> (<a href="#subsec_cpptraj_create">7.4</a>) commands. Reading data from files is only done via the <em><b>readdata</b></em> command (<a href="#subsec_cpptraj_readdata">7.18</a>).</div>

<div class="standard"><a id="magicparlabel-975"></a>In general, data files which have been declared with an <b>'out'</b> keyword will recognize data file write keywords on the same command line. For example, the <b>'time'</b> argument can be passed directly to the output from a <b><i>distance</i></b> command:</div>

<div class="lyx_code"><a id="magicparlabel-976"></a><div class="lyx_code_item">distance d0 :1 :2 out d0.agr time 0.001</div>
</div>
<div class="standard"><a id="magicparlabel-977"></a>The data file format
 can be changed from standard implicitly by using specific filename 
extensions or keywords. If the extension is not recognized or no keyword
 is give the default format is 'Standard'. Keywords and extensions for 
data file formats recognized by <i>cpptraj</i> are shown in <a href="#tab_cpptraj_DataFile_formats">1</a>.
 Note that the use of certain options may be restricted for certain data
 file formats. These options can also be passed to data files via the <em><b>datafile</b></em> command (<a href="#subsec_cpptraj_datafile_command">7.6</a>).</div>

<div class="lyx_code"><a id="magicparlabel-978"></a><div class="lyx_code_item">[&lt;format keyword&gt;]</div>
<div class="lyx_code_item">[{xlabel|ylabel|zlabel} &lt;label&gt;] [{xmin|ymin|zmin} &lt;min&gt;] [sort]</div>
<div class="lyx_code_item">[{xstep|ystep|zstep} &lt;step&gt;] [time &lt;dt&gt;] [prec &lt;width&gt;[.&lt;precision&gt;]]</div>
<div class="lyx_code_item">[xprec &lt;width&gt;[.&lt;precision&gt;]] [xfmt {double|scientific|general}]</div>
<div class="lyx_code_item">[noensextension]</div>

<dl class="description"><a id="magicparlabel-983"></a><dt class="description_label">{xlabel | ylabel | zlabel} &lt;label&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Set 
the x-axis label for the specified datafile to &lt;label&gt;. For 
regular data files this is the header for the first column of data. If 
the data is at least 2-dimensional 'datafile ylabel &lt;label&gt;' will 
likewise set the y-axis label.</span></dd>
<dt class="description_label">{xmin | ymin | zmin} &lt;min&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Set 
the starting X coordinate value to &lt;min&gt;. If the data is at least 
2-dimensional 'datafile ymin &lt;min&gt;' will likewise set the starting
 Y coordinate value.</span></dd>
<dt class="description_label">sort</dt>
<dd class="description_item"><span style="font-family:monospace;"> Sort data sets prior to write. Ordering is by name, aspect, then index (all descending).</span></dd>
<dt class="description_label">{xstep | ystep | zstep} &lt;step&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> 
Multiply each frame number by &lt;step&gt; (x coordinates). If the data 
is at least 2-dimensional 'datafile ystep &lt;step&gt;' will likewise 
multiply y coordinates by &lt;step&gt;.</span></dd>
<dt class="description_label">time &lt;dt&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Equivalent to the <i>ptraj</i> argument 'time' that could be specified with many actions. Multiplies frame numbers (x-axis) by &lt;dt&gt;.</span></dd>
<dt class="description_label">prec &lt;width&gt;[.&lt;precision&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Change the output format width (and optionally precision) of all sets <i>subsequently</i> added to the data file (i.e. does not change the precision of any data sets currently in the file). For example,</span></dd>
</dl>

<div class="lyx_code"><a id="magicparlabel-989"></a><div class="lyx_code_item">prec 12.4</div>
<div class="lyx_code_item">prec 10</div>
</div>

<dl class="description"><a id="magicparlabel-991"></a><dt class="description_label">xprec &lt;width&gt;[.&lt;precision&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Change output ordinate width and precision.</span></dd>
<dt class="description_label">xfmt {double|scientific|general}</dt>
<dd class="description_item"><span style="font-family:monospace;"> Change output ordinate format.</span></dd>
<dt class="description_label">[noensextension]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Omit ensemble extension in ensemble processing mode. <b>NOTE: THIS OPTION HAS NOT BEEN FULLY TESTED IN PARALLEL.</b></span></dd>
</dl>
</div>
<h3 class="subsection"><a id="magicparlabel-994"></a><span class="subsection_label">5.1</span> Standard Data File Options</h3>
<h4 class="subsubsection_"><a id="magicparlabel-995"></a>Write</h4>

<div class="lyx_code"><a id="magicparlabel-996"></a><div class="lyx_code_item">[invert] [noxcol] [noheader] [square2d] [nosquare2d]
<br />

</div>

<dl class="description"><a id="magicparlabel-997"></a><dt class="description_label">invert</dt>
<dd class="description_item"><span style="font-family:monospace;"> 
Normally, data is written out with X-values pertaining to frames (i.e. 
data over all trajectories is printed in columns). This command flips 
that behavior so that X-values pertain to data sets (i.e. data over all 
trajectories is printed in rows).</span></dd>
<dt class="description_label">noxcol</dt>
<dd class="description_item"><span style="font-family:monospace;"> 
Prevent printing of indices (i.e. the #Frame column in most datafiles) 
for the specified datafile. Useful e.g. if one would like a 2D plot such
 as phi vs psi. For example, given the input:
<br />

</span>

<div class="lyx_code"><a id="magicparlabel-999"></a><div class="lyx_code_item">dihedral phi :1@C :2@N :2@CA :2@C out phipsi.dat</div>
<div class="lyx_code_item">dihedral psi :2@N :2@CA :2@C :3@N out phipsi.dat</div>
<div class="lyx_code_item">datafile phipsi.dat noxcol</div>
</div>
<div class="standard"><a id="magicparlabel-1002"></a><i><span style="font-family:monospace;">Cpptraj</span></i><span style="font-family:monospace;"> will write a 2 column datafile containing only phi and psi, no frame numbers will be written.</span></div>
</dd><dt class="description_label">noheader</dt>
<dd class="description_item"><span style="font-family:monospace;"> Prevent printing of header line (e.g. '#Frame    D1') at the beginning of data file.</span></dd>
<dt class="description_label">square2d</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write 2D data as a square matrix, e.g.:
<br />

</span>

<div class="lyx_code"><a id="magicparlabel-1005"></a><div class="lyx_code_item">&lt;1,1&gt; &lt;2,1&gt; &lt;3,1&gt;</div>
<div class="lyx_code_item">&lt;1,2&gt; &lt;2,2&gt; &lt;3,2&gt;</div>
</div>
</dd><dt class="description_label">nosquare2d</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write 2D data in 3 columns as:
<br />

</span>

<div class="lyx_code"><a id="magicparlabel-1008"></a><div class="lyx_code_item">&lt;X&gt; &lt;Y&gt; &lt;Value&gt;</div>
</div>
</dd></dl>
</div>
<h4 class="subsubsection_"><a id="magicparlabel-1009"></a>Read</h4>

<div class="lyx_code"><a id="magicparlabel-1010"></a><div class="lyx_code_item">[index &lt;col&gt;] [read2d] [vector] [mat3x3]
<br />

</div>

<dl class="description"><a id="magicparlabel-1011"></a><dt class="description_label">index &lt;col&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use column &lt;col&gt; (starting from 1) as index column (1D data only).</span></dd>
<dt class="description_label">read1d</dt>
<dd class="description_item"><span style="font-family:monospace;"> Read data as 1D data sets (default).</span></dd>
<dt class="description_label">read2d</dt>
<dd class="description_item"><span style="font-family:monospace;"> Read data as 2D square matrix.</span></dd>
<dt class="description_label">vector</dt>
<dd class="description_item"><span style="font-family:monospace;"> Read 
data as vector. If indices are present they will be skipped. Assume 
first 3 columns after the index volumn are vector X, Y, and Z, and (if 
present) the next 3 columns contain vector origin X, Y, and Z.</span></dd>
<dt class="description_label">mat3x3</dt>
<dd class="description_item"><span style="font-family:monospace;"> Read 
data as 3x3 matrix. If indices are present they will be skipped. Assume 
matrices are in row major order on each line, i.e. M(1,1) M(1,2) ... 
M(3,2) M(3,3).</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-1016"></a>By default, 
standard data files are assumed to contain 1D data in columns. Data set 
legends will be read in if the file has a header line (denoted by '#'). 
Columns labeled '#Frame' are automatically considered the 'index' column
 and skipped. Data sets are stored as &lt;name&gt;:&lt;idx&gt; where 
&lt;name&gt; is the given data set name (the file name if not specified)
 and &lt;idx&gt; corresponds to the column the data was read from 
starting from 1. <i>Cpptraj</i> assumes the data increases monotonically
 and will automatically attempt to determine the dimensions of the data 
set(s); a warning will be printed if this is not successful.</div>
<h3 class="subsection"><a id="magicparlabel-1017"></a><span class="subsection_label">5.2</span> Grace Data File Options</h3>
<div class="standard"><a id="magicparlabel-1018"></a>For more information on Grace see <a href="http://plasma-gate.weizmann.ac.il/Grace/">http://plasma-gate.weizmann.ac.il/Grace/</a>.</div>
<h4 class="subsubsection_"><a id="magicparlabel-1019"></a>Write</h4>

<div class="lyx_code"><a id="magicparlabel-1020"></a><div class="lyx_code_item">[invert] [xydy]
<br />

</div>

<dl class="description"><a id="magicparlabel-1021"></a><dt class="description_label">invert</dt>
<dd class="description_item"><span style="font-family:monospace;"> 
Normally, data is written out with X-values pertaining to frames (i.e. 
data over all trajectories is printed in columns). This command flips 
that behavior so that X-values pertain to data sets.</span></dd>
<dt class="description_label">xydy</dt>
<dd class="description_item"><span style="font-family:monospace;"> Combine consecutive pairs of sets into XYDY sets.</span></dd>
</dl>
</div>
<h4 class="subsubsection_"><a id="magicparlabel-1023"></a>Read</h4>
<div class="standard"><a id="magicparlabel-1024"></a>Cpptraj will read 
set legends from grace files, and data sets are stored as 
&lt;name&gt;:&lt;idx&gt; where &lt;name&gt; is the given data set name 
(the file name if not specified) and &lt;idx&gt; corresponds to the set 
number the data was read from starting from 0.</div>
<h3 class="subsection"><a id="magicparlabel-1025"></a><span class="subsection_label">5.3</span> Gnuplot Data File Options</h3>
<div class="standard"><a id="magicparlabel-1026"></a>For more information on these options it helps to look at the PM3D options in the Gnuplot manual (see <a href="http://www.gnuplot.info/">http://www.gnuplot.info/</a>).</div>
<h4 class="subsubsection_"><a id="magicparlabel-1027"></a>Write</h4>

<div class="lyx_code"><a id="magicparlabel-1028"></a><div class="lyx_code_item">[nolabels] [usemap] [pm3d] [nopm3d] [jpeg] [noheader]</div>
<div class="lyx_code_item">[{xlabels|ylabels|zlabels} &lt;labellist&gt;]
<br />

</div>

<dl class="description"><a id="magicparlabel-1030"></a><dt class="description_label">nolabels</dt>
<dd class="description_item"><span style="font-family:monospace;"> Do not print axis labels.</span></dd>
<dt class="description_label">usemap</dt>
<dd class="description_item"><span style="font-family:monospace;"> pm3d output with 1 extra empty row/col (may improve look).</span></dd>
<dt class="description_label">pm3d</dt>
<dd class="description_item"><span style="font-family:monospace;"> Normal pm3d map output.</span></dd>
<dt class="description_label">nopm3d</dt>
<dd class="description_item"><span style="font-family:monospace;"> Turn off pm3d </span></dd>
<dt class="description_label">jpeg</dt>
<dd class="description_item"><span style="font-family:monospace;"> Plot will write to a JPEG file when used with gnuplot.</span></dd>
<dt class="description_label">binary</dt>
<dd class="description_item"><span style="font-family:monospace;"> Plot will be written in binary format.</span></dd>
<dt class="description_label">noheader</dt>
<dd class="description_item"><span style="font-family:monospace;"> Do not format plot; data output only.</span></dd>
<dt class="description_label">palette &lt;arg&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Change gnuplot pm3d palette to &lt;arg&gt;:</span>

<dl class="description"><a id="magicparlabel-1038"></a><dt class="description_label">'rgb'</dt>
<dd class="description_item"><span style="font-family:monospace;"> Red, yellow, green, cyan, blue, magenta, red.</span></dd>
<dt class="description_label">'kbvyw'</dt>
<dd class="description_item"><span style="font-family:monospace;"> Black, blue, violet, yellow, white.</span></dd>
<dt class="description_label">'bgyr'</dt>
<dd class="description_item"><span style="font-family:monospace;"> Blue, green, yellow, red.</span></dd>
<dt class="description_label">'gray'</dt>
<dd class="description_item"><span style="font-family:monospace;"> Grayscale. </span></dd>
</dl>
</dd><dt class="description_label">xlabels|ylabels|zlabels &lt;labellist&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Set x, y, or z axis labels with comma-separated list, e.g. 'xlabels X1,X2,X3'.</span></dd>
</dl>
</div>
<h3 class="subsection"><a id="magicparlabel-1043"></a><span class="subsection_label">5.4</span> Amber REM Log Options</h3>
<div class="standard"><a id="magicparlabel-1044"></a>Note that multiple REM logs can be specified in a single <b><i>readdata</i></b> command. See <a href="#subsec_cpptraj_remlog">11.26</a> for more on replica log analysis.</div>
<h4 class="subsubsection_"><a id="magicparlabel-1045"></a>Read</h4>

<div class="lyx_code"><a id="magicparlabel-1046"></a><div class="lyx_code_item">[nosearch] [dimfile &lt;file&gt;] [crdidx &lt;crd indices&gt;]
<br />

</div>

<dl class="description"><a id="magicparlabel-1047"></a><dt class="description_label">[nosearch]</dt>
<dd class="description_item"><span style="font-family:monospace;"> If specified do not automatically search for MREMD dimension logs.</span></dd>
<dt class="description_label">[dimfile &lt;file&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> remd.dim file for processing MREMD logs.</span></dd>
<dt class="description_label">[crdidx &lt;crd indices&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use comma-separated list of indices as the initial coordinate indices (H-REMD only). For example (4 replicas):
<br />

</span>

<div class="lyx_code"><a id="magicparlabel-1050"></a><div class="lyx_code_item">crdidx 4,2,3,1</div>
</div>
</dd></dl>
</div>
<h3 class="subsection"><a id="magicparlabel-1051"></a><span class="subsection_label">5.5</span> Amber MDOUT Options</h3>
<div class="standard"><a id="magicparlabel-1052"></a>Note that multiple MDOUT files can be specified in a single <b><i>readdata</i></b> command.</div>
<h3 class="subsection"><a id="magicparlabel-1053"></a><span class="subsection_label">5.6</span> Evecs File Options</h3>
<h4 class="subsubsection_"><a id="magicparlabel-1054"></a>Read</h4>

<div class="lyx_code"><a id="magicparlabel-1055"></a><div class="lyx_code_item">[ibeg &lt;firstmode&gt;] [iend &lt;lastmode&gt;]
<br />

</div>

<dl class="description"><a id="magicparlabel-1056"></a><dt class="description_label">ibeg &lt;firstmode&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Number of the first mode (or principal component) to read from evecs file. Default 1.</span></dd>
<dt class="description_label">iend &lt;lastmode&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> 
Number of the last mode (or principal component) to read from evecs 
file. Default is to read all for newer evecs files (generated by <i>cpptraj</i> version &gt; 12), 50 for older evecs files.</span></dd>
</dl>
</div>
<h3 class="subsection"><a id="magicparlabel-1058"></a><span class="subsection_label">5.7</span> Vector psuedo-traj Options</h3>
<div class="standard"><a id="magicparlabel-1059"></a>This can be used to write out a representation of a vector data set which can then be visualized. See <a href="#subsec_cpptraj_vector">10.81</a> for more on generating vector data sets.</div>
<h4 class="subsubsection_"><a id="magicparlabel-1060"></a>Write</h4>

<div class="lyx_code"><a id="magicparlabel-1061"></a><div class="lyx_code_item">[trajfmt &lt;format&gt;] [parmout &lt;file&gt;] [noorigin]
<br />

</div>

<dl class="description"><a id="magicparlabel-1062"></a><dt class="description_label">trajfmt &lt;format&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output pseudo-trajectory format. See <a href="#tab_cpptraj_trajformats">9</a> for trajectory format keywords.</span></dd>
<dt class="description_label">parmout &lt;file&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> File to write pseudo-trajectory topology to.</span></dd>
<dt class="description_label">[noorigin]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Do not write vector origin coordinates.</span></dd>
</dl>
</div>
<h3 class="subsection"><a id="magicparlabel-1065"></a><span class="subsection_label">5.8</span> OpenDX file options</h3>
<h4 class="subsubsection_"><a id="magicparlabel-1066"></a>Write</h4>

<div class="lyx_code"><a id="magicparlabel-1067"></a><div class="lyx_code_item">[bincenter] [gridwrap] [gridext]
<br />

</div>

<dl class="description"><a id="magicparlabel-1068"></a><dt class="description_label">bincenter</dt>
<dd class="description_item"><span style="font-family:monospace;"> Center grid points on bin centers instead of corners.</span></dd>
<dt class="description_label">gridwrap</dt>
<dd class="description_item"><span style="font-family:monospace;"> Like <b>'bincenter'</b>, but also wrap grid density. Useful when grid encompasses unit cell.</span></dd>
<dt class="description_label">gridext</dt>
<dd class="description_item"><span style="font-family:monospace;"> Like <b>'bincenter'</b>, but also print extra layer of empty bins.</span></dd>
</dl>
</div>
<h3 class="subsection"><a id="magicparlabel-1071"></a><span class="subsection_label">5.9</span> CCP4 file options</h3>
<h4 class="subsubsection_"><a id="magicparlabel-1072"></a>Write</h4>

<div class="lyx_code"><a id="magicparlabel-1073"></a><div class="lyx_code_item">[title &lt;title&gt;]
<br />

</div>

<dl class="description"><a id="magicparlabel-1074"></a><dt class="description_label">[title &lt;title&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Set CCP4 output title.</span></dd>
</dl>
</div>
<h3 class="subsection"><a id="magicparlabel-1075"></a><span class="subsection_label">5.10</span> Charmm REPD log options</h3>
<h4 class="subsubsection_"><a id="magicparlabel-1076"></a>Read</h4>

<div class="lyx_code"><a id="magicparlabel-1077"></a><div class="lyx_code_item">[nrep &lt;#&gt;] [crdidx &lt;crd indices&gt;]</div>

<dl class="description"><a id="magicparlabel-1078"></a><dt class="description_label">nrep &lt;#&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Total number of replicas.</span></dd>
<dt class="description_label">crdidx &lt;crd indices&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Comma-separated list of indices to use as initial coordinate indices.</span></dd>
</dl>
</div>
<h3 class="subsection"><a id="magicparlabel-1080"></a><span class="subsection_label">5.11</span> Amber Constant pH Out options<a id="subsec_cpptraj_cphdatafile"></a>
</h3>
<h4 class="subsubsection_"><a id="magicparlabel-1081"></a>Read</h4>

<div class="lyx_code"><a id="magicparlabel-1082"></a><div class="lyx_code_item">cpin &lt;file&gt;</div>

<dl class="description"><a id="magicparlabel-1083"></a><dt class="description_label">cpin &lt;file&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Constant pH input (CPIN) file name.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-1084"></a>Note that when 
reading in constant pH data the data set aspect will be set to the 
residue name and the index will be set to the residue number. When 
reading in constant pH REMD data the data is unsorted, and 
sortensembledata should be used to create sorted constant pH data sets 
(see <a href="#subsec_cpptraj_sortensembledata">7.26</a>).</div>
<h2 class="section"><a id="magicparlabel-1085"></a><span class="section_label">6</span> Coordinates (COORDS) Data Set Commands<a id="sec_Coordinates_as_a"></a>
</h2>
<div class="standard"><a id="magicparlabel-1086"></a>Coordinate I/O 
tends to be the most time-consuming part of trajectory analysis. In 
addition, many types of analyses (for example two-dimensional RMSD and 
cluster analysis) require using coordinate frames multiple times. To 
simplify this, trajectory coordinates may be saved as a separate data 
set via the <b><i>loadcrd</i></b> command or <b><i>createcrd</i></b> action. Any action can then be performed on the COORDS data set with the <b><i>crdaction</i></b> command. The <b><i>crdout</i></b> command can be used to write coordinates to an output trajectory (similar to <b><i>trajout</i></b>).</div>

<div class="standard"><a id="magicparlabel-1087"></a>Although COORDS 
data sets store everything internally with single-precision, they can 
still use a large amount of memory. Because of this there is a 
specialized type of COORDS data set called a TRAJ data set (trajectory),
 which functions exactly like a COORDS data set except all data is 
stored on disk. TRAJ data sets can be created with the <b><i>loadtraj</i></b> command. <em>TRAJ data sets cannot be modified.</em></div>

<div class="standard"><a id="magicparlabel-1088"></a>There are several analyses that can be performed using COORDS data sets, either as part of the normal analysis list or via the <b><i>runanalysis</i></b>
 command. Note that while these analyses can be run on specified COORDS 
data sets, if one is not specified a default COORDS data set will be 
created, made up of frames from <b><i>trajin</i></b> commands.</div>

<div class="standard"><a id="magicparlabel-1089"></a>As an example of 
where this might be useful is in the calculation of atomic positional 
fluctuations. Previously this required two steps: one to generate an 
average structure, then a second to rms-fit to that average structure 
prior to calculating the fluctuations. This can now be done in one pass 
with the following input:</div>

<div class="lyx_code"><a id="magicparlabel-1090"></a><div class="lyx_code_item">parm topology.parm7</div>
<div class="lyx_code_item">loadcrd mdcrd.nc</div>
<div class="lyx_code_item"># Generate average structure PDB, @CA only</div>
<div class="lyx_code_item">crdaction mdcrd.nc average avg.pdb @CA</div>
<div class="lyx_code_item"># Load average structure PDB as reference</div>
<div class="lyx_code_item">parm avg.pdb</div>
<div class="lyx_code_item">reference avg.pdb parm avg.pdb</div>
<div class="lyx_code_item"># RMS-fit to average structure PDB</div>
<div class="lyx_code_item">crdaction mdcrd.nc rms reference @CA</div>
<div class="lyx_code_item"># Calculate atomic fluctuations for @CA only</div>
<div class="lyx_code_item">crdaction mdcrd.nc atomicfluct out fluct.dat bfactor @CA</div>
</div>
<div class="standard"><a id="magicparlabel-1101"></a>The following COORDS data set commands are available:
<br />

</div>



<div class="standard" style="text-align: center;"><a id="magicparlabel-1102"></a><table><tbody><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1131"></a><b>Command</b></div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1134"></a><b>Description</b></div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1137"></a>combinecrd</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1140"></a>Combine two or more COORDS sets.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1143"></a>crdaction</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1146"></a>Run a single Action on a COORDS set.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1149"></a>crdout</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1152"></a>Write a COORDS set to a file.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1155"></a>createcrd</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1158"></a>(Action) Create a COORDS set during a Run.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1161"></a>loadcrd</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1164"></a>Create or append to a COORDS set from a file.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1167"></a>loadtraj</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1170"></a>Create special COORDS set where frames remain on disk.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1173"></a>permutedihedrals</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1176"></a>Rotate specified dihedral(s) in given COORDS set by specific interval or to random values.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1179"></a>reference</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1182"></a>Load a single trajectory frame as a reference.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1185"></a>rotatedihedral</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1188"></a>Rotate specified dihedral to specified value or by given increment.</div>
</td>
</tr></tbody>
</table>
</div>
<h3 class="subsection"><a id="magicparlabel-1189"></a><span class="subsection_label">6.1</span> combinecrd</h3>

<div class="lyx_code"><a id="magicparlabel-1190"></a><div class="lyx_code_item">combinecrd &lt;crd1&gt; &lt;crd2&gt; ... [parmname &lt;topname&gt;] [crdname &lt;crdname&gt;]
<br />

</div>

<dl class="description"><a id="magicparlabel-1191"></a><dt class="description_label">&lt;crdX&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> COORDS data set to combine, specify 2 or more.</span></dd>
<dt class="description_label">[parmname &lt;topname&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Name of combined Topology.</span></dd>
<dt class="description_label">[crdname &lt;crdname&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Name of combined COORDS data set.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-1194"></a>Combined two or more COORDS data sets into a single COORDS data set. Note that the resulting topology will most likely <b>not</b> be usable for MD simulations. Box information will be retained - the largest box dimensions will be used.</div>

<div class="standard"><a id="magicparlabel-1195"></a>For example, to load two MOL2 files as COORDS data sets, combine them, and write them out as a single MOL2:</div>

<div class="lyx_code"><a id="magicparlabel-1196"></a><div class="lyx_code_item">loadcrd Tyr.mol2 CRD1</div>
<div class="lyx_code_item">loadcrd Pry.mol2 CRD2</div>
<div class="lyx_code_item">combinedcrd CRD1 CRD2 parmname Parm-1-2 crdname CRD-1-2</div>
<div class="lyx_code_item">crdout CRD-1-2 Tyr.Pry.mol2</div>
</div>
<h3 class="subsection"><a id="magicparlabel-1200"></a><span class="subsection_label">6.2</span> crdaction<a id="subsec_cpptraj_crdaction"></a>
</h3>

<div class="lyx_code"><a id="magicparlabel-1201"></a><div class="lyx_code_item">crdaction &lt;crd set&gt; &lt;actioncmd&gt; [&lt;action args&gt;] [crdframes &lt;start&gt;,&lt;stop&gt;,&lt;offset&gt;]</div>
</div>
<div class="standard"><a id="magicparlabel-1202"></a>Perform action 
&lt;actioncmd&gt; on COORDS data set &lt;crd set&gt;. A subset of frames
 in the COORDS data set can be specified with 'crdframes'.</div>

<div class="standard"><a id="magicparlabel-1203"></a>For example, to 
calculate RMSD for a previously created COORDS data set named crd1 using
 frames 1 to the last, skipping every 10:</div>

<div class="lyx_code"><a id="magicparlabel-1204"></a><div class="lyx_code_item">crdaction crd1 rmsd first @CA out rmsd-ca.agr crdframes 1,last,10</div>
</div>
<h3 class="subsection"><a id="magicparlabel-1205"></a><span class="subsection_label">6.3</span> createcrd</h3>
<div class="standard"><a id="magicparlabel-1206"></a>This command is actually an Action that can be used to create COORDS data sets during trajectory processing, see <a href="#subsec_cpptraj_createcrd">10.18</a>.</div>
<h3 class="subsection"><a id="magicparlabel-1207"></a><span class="subsection_label">6.4</span> crdout</h3>

<div class="lyx_code"><a id="magicparlabel-1208"></a><div class="lyx_code_item">crdout &lt;crd set&gt; &lt;filename&gt; [&lt;trajout args&gt;] [crdframes &lt;start&gt;,&lt;stop&gt;,&lt;offset&gt;]</div>
</div>
<div class="standard"><a id="magicparlabel-1209"></a>Write COORDS data 
set &lt;crd set&gt; to trajectory named &lt;filename&gt;. A subset of 
frames in the COORDS data set can be specified with 'crdframes'.</div>

<div class="standard"><a id="magicparlabel-1210"></a>For example, to write frames 1 to 10 from a previously created COORDS data set named “crd1” to separate PDB files:</div>

<div class="lyx_code"><a id="magicparlabel-1211"></a><div class="lyx_code_item">crdout crd1 crd1.pdb multi crdframes 1,10</div>
</div>
<h3 class="subsection"><a id="magicparlabel-1212"></a><span class="subsection_label">6.5</span> loadcrd</h3>

<div class="lyx_code"><a id="magicparlabel-1213"></a><div class="lyx_code_item">loadcrd &lt;filename&gt; [parm &lt;parm&gt; | parmindex&lt;#&gt;] [&lt;trajin args&gt;] [name &lt;name&gt;]</div>
</div>
<div class="standard"><a id="magicparlabel-1214"></a>Immediately load 
trajectory &lt;filename&gt; as a COORDS data set named &lt;name&gt; 
(default base name of &lt;filename&gt;). If &lt;name&gt; is already 
present the coordinates will be appended to the existing data set.</div>

<div class="standard"><a id="magicparlabel-1215"></a>For example, to load frames from trajectories named 'traj1.nc' and 'traj2.nc' into a COORDS data set named Crd1:</div>

<div class="lyx_code"><a id="magicparlabel-1216"></a><div class="lyx_code_item">loadcrd traj1.nc name Crd1</div>
<div class="lyx_code_item">loadcrd traj2.nc name Crd2</div>
</div>
<h3 class="subsection"><a id="magicparlabel-1218"></a><span class="subsection_label">6.6</span> loadtraj</h3>

<div class="lyx_code"><a id="magicparlabel-1219"></a><div class="lyx_code_item">loadtraj name &lt;setname&gt; [&lt;filename&gt;]</div>
</div>
<div class="standard"><a id="magicparlabel-1220"></a>This command functions in two ways. If &lt;filename&gt; is not provided, all currently loaded input trajectories (from <b><i>trajin</i></b> commands) are added to TRAJ data set named &lt;setname&gt;. <b>Note that if the input trajectory list is cleared (via 'clear trajin') this will invalidate the TRAJ data set.</b>
 In addition, currently all trajectories must have the same number of 
atoms. Otherwise add trajectory &lt;filename&gt; to TRAJ data set 
&lt;setname&gt;.</div>

<div class="standard"><a id="magicparlabel-1221"></a>TRAJ data sets cannot be modified.</div>
<h3 class="subsection"><a id="magicparlabel-1222"></a><span class="subsection_label">6.7</span> permutedihedrals<a id="subsec_cpptraj_permutedihedrals"></a>
</h3>

<div class="lyx_code"><a id="magicparlabel-1223"></a><div class="lyx_code_item">permutedihedrals crdset &lt;COORDS set&gt; resrange &lt;range&gt; [{interval | random}]</div>
<div class="lyx_code_item">             	[outtraj &lt;filename&gt; [&lt;outfmt&gt;]] [crdout &lt;output COORDS&gt;] [&lt;dihedral types&gt;]</div>
<div class="lyx_code_item">  Options for 'random':</div>
<div class="lyx_code_item">	[rseed &lt;rseed&gt;] [out &lt;# problems file&gt; [&lt;set name&gt;]]</div>
<div class="lyx_code_item">	[ check [cutoff &lt;cutoff&gt;] [rescutoff &lt;rescutoff&gt;] [checkallresidues]</div>
<div class="lyx_code_item">	  [backtrack &lt;backtrack&gt;] [increment &lt;increment&gt;] [maxfactor &lt;max_factor&gt;] ]</div>
<div class="lyx_code_item">  Options for 'interval':</div>
<div class="lyx_code_item">	&lt;interval deg&gt;</div>
<div class="lyx_code_item">  &lt;dihedral types&gt; =  alpha beta gamma delta epsilon zeta nu1 nu2 h1p c2p chin phi psi chip omega     
<br />

</div>

<dl class="description"><a id="magicparlabel-1232"></a><dt class="description_label">crdset &lt;COORDS set&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> COORDS data set to operate on.</span></dd>
<dt class="description_label">resrange &lt;range&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Residue range to search for dihedrals.</span></dd>
<dt class="description_label">interval</dt>
<dd class="description_item"><span style="font-family:monospace;"> 
Rotate found dihedrals by &lt;interval&gt;. This is done in an ordered 
fashion so that every combination of dihedral rotations is sampled at 
least once.</span></dd>
<dt class="description_label">random</dt>
<dd class="description_item"><span style="font-family:monospace;"> Rotate each found dihedral randomly.</span></dd>
<dt class="description_label">[outtraj &lt;filename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Trajectory file to write coordinates to.
<br />

</span>

<dl class="description"><a id="magicparlabel-1237"></a><dt class="description_label">[&lt;outfmt&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Trajectory file format.</span></dd>
</dl>
</dd><dt class="description_label">[crdout &lt;output COORDS&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> COORDS data set to write coordinates to.</span></dd>
<dt class="description_label">&lt;dihedral type&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> One or more dihedral types to search for.</span></dd>
</dl>
<div class="standard"><a id="magicparlabel-1240"></a><span style="font-family:monospace;">Options for 'interval:</span></div>

<dl class="description"><a id="magicparlabel-1241"></a><dt class="description_label">&lt;interval deg&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Amount to rotate dihedral by each step.</span></dd>
</dl>
<div class="standard"><a id="magicparlabel-1242"></a><span style="font-family:monospace;">Options for 'random':</span></div>

<dl class="description"><a id="magicparlabel-1243"></a><dt class="description_label">[rseed &lt;rseed&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Random number seed.</span></dd>
<dt class="description_label">[out &lt;# problems file&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> File to write number of problems (clashes) each frame to.</span></dd>
<dt class="description_label">[&lt;set name&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Number of problems data set name.</span></dd>
<dt class="description_label">[check]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Check randomly rotated structure for clashes.
<br />

</span>

<dl class="description"><a id="magicparlabel-1247"></a><dt class="description_label">[cutoff &lt;cutoff&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Atom cutoff for checking for clashes (default 0.8 Å).</span></dd>
<dt class="description_label">[rescutoff &lt;cutoff&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Residue cutoff for checking for clashes (defualt 10.0 Å).</span></dd>
<dt class="description_label">[checkallresidues]</dt>
<dd class="description_item"><span style="font-family:monospace;"> If specified all residues checked for clashes, otherwise only residues up to the currently rotated dihedral check.</span></dd>
<dt class="description_label">[backtrack &lt;backtrack&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> If a 
clash is encountered at dihedral N and cannot be resolved, go to 
dihedral N-&lt;backtrack&gt; to try and resolve the clash (default 4).</span></dd>
<dt class="description_label">[increment &lt;increment&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> If a 
clash is encountered, first attempt to rotate dihedral by increment to 
resolve it; if it cannot be resolved by a full rotation the calculation 
will backtrack (default 1). </span></dd>
<dt class="description_label">[maxfactor &lt;max_factor&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> The maximum number of total attempted rotations will be &lt;max_factor&gt; * &lt;total # of dihedrals&gt; (default 2).</span></dd>
</dl>
</dd></dl>
</div>
<div class="standard"><a id="magicparlabel-1253"></a>Create a trajectory by rotating specified dihedrals in a structure by regular intervals (<b>interval</b>), or create 1 structure by randomly rotating specified dihedrals (<b>random</b>). When randomly rotating dihedrals steric clashes will be checked if <b>check</b>
 is specified; in such cases the algorithm will attempt to resolve the 
clash as best it can. If clashes are not being resolved you can increase
 the number of rotation attempts <i><span style="font-family:monospace;">cpptraj</span></i> will make by increasing <b>maxfactor</b>.</div>

<div class="standard"><a id="magicparlabel-1254"></a>For example, to 
rotate all backbone dihedrals in a protein with coordinates in a file 
named tz2.rst7 in -120 degree intervals and write the resulting 
trajectory in Amber format to rotations.mdcrd:</div>

<div class="lyx_code"><a id="magicparlabel-1255"></a><div class="lyx_code_item">reference tz2.rst7 [TZ2]</div>
<div class="lyx_code_item">permutedihedrals crdset [TZ2] interval -120 outtraj rotations.mdcrd phi psi</div>
</div>
<div class="standard"><a id="magicparlabel-1257"></a>To randomly rotate backbone dihedrals for the same structure and write to file random.mol2 in MOL2 format:</div>

<div class="lyx_code"><a id="magicparlabel-1258"></a><div class="lyx_code_item">reference tz2.rst7 [TZ2]</div>
<div class="lyx_code_item">permutedihedrals crdset [TZ2] random rseed 1 check maxfactor 10 phi psi \</div>
<div class="lyx_code_item">                 outtraj random.mol2 multi</div>
</div>
<h3 class="subsection"><a id="magicparlabel-1261"></a><span class="subsection_label">6.8</span> reference</h3>
<div class="standard"><a id="magicparlabel-1262"></a>Reference coordinates can now be used and manipulated like COORDS data sets. See <a href="#subsec_cpptraj_reference">9.3</a> for command syntax.</div>
<h3 class="subsection"><a id="magicparlabel-1263"></a><span class="subsection_label">6.9</span> rotatedihedral</h3>

<div class="lyx_code"><a id="magicparlabel-1264"></a><div class="lyx_code_item">rotatedihedral crdset &lt;COORDS set&gt; [frame &lt;#&gt;] [name &lt;output set name&gt;]</div>
<div class="lyx_code_item">               {value &lt;value&gt; | increment &lt;increment&gt;}</div>
<div class="lyx_code_item">               { &lt;mask1&gt; &lt;mask2&gt; &lt;mask3&gt; &lt;mask4&gt; |</div>
<div class="lyx_code_item">                 res &lt;#&gt; type &lt;dih type&gt; }</div>
<div class="lyx_code_item">&lt;dih type&gt; = alpha beta gamma delta epsilon zeta nu1 nu2 h1p c2p chin phi psi chip omega</div>

<dl class="description"><a id="magicparlabel-1269"></a><dt class="description_label">crdset &lt;COORDS set&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Coordinates data set to work on. If a TRAJ data set is specified, <b>name</b> must also be specified.</span></dd>
<dt class="description_label">[frame &lt;#&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Frame of the COORDS set to work on.</span></dd>
<dt class="description_label">[name &lt;output set name&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output COORDS set. If not specified the input COORDS set will be modified.</span></dd>
<dt class="description_label">value &lt;value&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Set specified dihedral to given value in degrees.</span></dd>
<dt class="description_label">increment &lt;increment&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Increment specified dihedral by increment in degrees.</span></dd>
<dt class="description_label">&lt;mask1&gt; &lt;mask2&gt; &lt;mask3&gt; &lt;mask4&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Define dihedral by atom masks. Each mask should only select one atom.</span></dd>
<dt class="description_label">res &lt;#&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Rotate dihedral specified by type in residue number &lt;#&gt;.</span></dd>
<dt class="description_label">type &lt;dih type&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Dihedral type to rotate in specified residue.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-1277"></a>Rotate the 
specified dihedral in given COORDS set to a target value or by given 
increment. For example, to set the protein chi dihedral in residue 8 to 
35 degrees and write out to a mol2 file:</div>

<div class="lyx_code"><a id="magicparlabel-1278"></a><div class="lyx_code_item">parm ../tz2.parm7</div>
<div class="lyx_code_item">loadcrd ../tz2.nc 1 1 name TZ2</div>
<div class="lyx_code_item">rotatedihedral crdset TZ2 value 35 res 8 type chip</div>
<div class="lyx_code_item">crdout TZ2 tz2.rotate.1.mol2 </div>
</div>
<h2 class="section"><a id="magicparlabel-1282"></a><span class="section_label">7</span> General Commands</h2>
<div class="standard"><a id="magicparlabel-1283"></a>The following general commands are available:
<br />

</div>



<div class="standard" style="text-align: center;"><a id="magicparlabel-1284"></a><table><tbody><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1353"></a><b>Command</b></div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1356"></a><b>Description</b></div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1359"></a>activeref</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1362"></a>Select the reference for distance-based masks.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1365"></a>calc</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1368"></a>Evaluate the given mathematical expression.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1371"></a>clear</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1374"></a>Clear various objects from the cpptraj state.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1377"></a>create</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1380"></a>Create (but do not yet write) a data file.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1383"></a>createset</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1386"></a>Create a dataset from a simple mathematical expression.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1389"></a>datafile</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1392"></a>Used to manipulate data files.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1395"></a>datafilter</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1398"></a>Filter data sets based on given criteria.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1401"></a>dataset</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1404"></a>Use to manipulate data sets.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1407"></a>debug | prnlev</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1410"></a>Set debug level. Higher levels give more info.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1413"></a>ensextension</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1416"></a>Enable/disable ensemble number extension for files in ensemble mode.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1419"></a>exit | quit</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1422"></a>Quit cpptraj.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1425"></a>go | run</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1428"></a>Start a trajectory processing Run.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1431"></a>help</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1434"></a>Provide help for commands.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1437"></a>list</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1440"></a>List various objects in the cpptraj state.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1443"></a>noexitonerror</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1446"></a>Attempt to continue even if errors are encountered.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1449"></a>noprogress</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1452"></a>Do not print a progress bar during a Run.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1455"></a>precision</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1458"></a>Change the output precision of data sets.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1461"></a>printdata</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1464"></a>Print data set to screen.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1467"></a>readdata</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1470"></a>Read data sets from files.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1473"></a>readensembledata</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1476"></a>Read data files in ensemble mode.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1479"></a>readinput</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1482"></a>Read cpptraj input from a file.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1485"></a>removedata</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1488"></a>Remove specified data set(s).</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1491"></a>rst</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1494"></a>Generate Amber-style distance/angle/torsion restraints.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1497"></a>runanalysis</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1500"></a>Run an analysis immediately or run all queued analyses.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1503"></a>select</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1506"></a>Print the results of an atom mask expression.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1509"></a>selectds</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1512"></a>Print the results of a data set selection expression.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1515"></a>silenceactions</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1518"></a>Prevent Actions from writing information to STDOUT.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1521"></a>sortensembledata</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1524"></a>Sort data sets using replica information (currently constant pH only).</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1527"></a>write | writedata</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1530"></a>Immediately write data to a file or write to all current data files.</div>
</td>
</tr></tbody>
</table>
</div>
<h3 class="subsection"><a id="magicparlabel-1531"></a><span class="subsection_label">7.1</span> activeref</h3>

<div class="lyx_code"><a id="magicparlabel-1532"></a><div class="lyx_code_item">activeref<a id="magicparlabel-1536"></a>
 &lt;#&gt;</div>
</div>
<div class="standard"><a id="magicparlabel-1537"></a>Set which reference
 structure should be used when setting up distance-based masks for 
everything but the 'mask' action. Numbering starts from 0, so 'activeref
 0' selects the first reference structure read in, 'activeref 1' selects
 the second, and so on.</div>
<h3 class="subsection"><a id="magicparlabel-1538"></a><span class="subsection_label">7.2</span> calc</h3>

<div class="lyx_code"><a id="magicparlabel-1539"></a><div class="lyx_code_item">calc &lt;expression&gt;</div>
<div class="lyx_code_item">	[prec &lt;width&gt;.&lt;precision&gt;] [format {double|general|scientific}]</div>

<dl class="description"><a id="magicparlabel-1541"></a><dt class="description_label">&lt;expression&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Mathematical expression to evaluate. See <a href="#subsec_cpptraj_Data_Set_Math">4.2</a> for details.</span></dd>
<dt class="description_label">prec &lt;width&gt;.&lt;precision&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Set the width and precision of the result.</span></dd>
<dt class="description_label">format {double|general|scientific}</dt>
<dd class="description_item"><span style="font-family:monospace;"> Set the format of the result.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-1544"></a>Evaluate the given mathematical expression. This version gives more control over the format of the output.</div>
<h3 class="subsection"><a id="magicparlabel-1545"></a><span class="subsection_label">7.3</span> clear</h3>

<div class="lyx_code"><a id="magicparlabel-1546"></a><div class="lyx_code_item">clear [{all | &lt;type&gt;}]</div>
<div class="lyx_code_item">      (&lt;type&gt; = actions,trajin,trajout,ref,parm,analysis,datafile,dataset)</div>
</div>
<div class="standard"><a id="magicparlabel-1548"></a>Clear list of 
indicated type, or all lists if 'all' specified. Note that when clearing
 actions or analyses, associated data sets and data files are not 
cleared and vice versa.</div>
<h3 class="subsection"><a id="magicparlabel-1549"></a><span class="subsection_label">7.4</span> create<a id="subsec_cpptraj_create"></a>
</h3>

<div class="lyx_code"><a id="magicparlabel-1550"></a><div class="lyx_code_item">create<a id="magicparlabel-1554"></a>
 &lt;filename&gt; &lt;datasetname0&gt; [&lt;datasetname1&gt; ...] [&lt;DataFile Options&gt;]</div>
</div>
<div class="standard"><a id="magicparlabel-1555"></a>Add specified data 
sets to the data file named &lt;filename&gt;; if the file does not 
exist, it will be added to the DataFileList. Data files created in this 
way are only written at the end of coordinate processing, analyses, or 
via the <em><b>'writedata'</b></em> command. See <a href="#sec_Datafile_Commands">5</a> for more data file format options.</div>
<h3 class="subsection"><a id="magicparlabel-1556"></a><span class="subsection_label">7.5</span> createset</h3>

<div class="lyx_code"><a id="magicparlabel-1557"></a><div class="lyx_code_item">createset &lt;expression&gt; [xmin &lt;min&gt;] xstep &lt;step&gt; nx &lt;nxvals&gt;</div>

<dl class="description"><a id="magicparlabel-1558"></a><dt class="description_label">expression</dt>
<dd class="description_item"><span style="font-family:monospace;"> 
Simple mathematical expression, must contain equals sign, can contain X 
(e.g. Y=2*X). If not enclosed in quotes must not contain whitespace.</span></dd>
<dt class="description_label">xmin &lt;min&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Minimum X value.</span></dd>
<dt class="description_label">xstep &lt;step&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> X step.</span></dd>
<dt class="description_label">nx &lt;nxvals&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Number of X values.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-1562"></a>Generate a data set from a simple mathematical expression.</div>
<h3 class="subsection"><a id="magicparlabel-1563"></a><span class="subsection_label">7.6</span> datafile<a id="subsec_cpptraj_datafile_command"></a>
</h3>

<div class="lyx_code"><a id="magicparlabel-1564"></a><div class="lyx_code_item">datafile<a id="magicparlabel-1568"></a>
 &lt;filename&gt; &lt;datafile arg&gt;</div>
</div>
<div class="standard"><a id="magicparlabel-1569"></a>Pass &lt;datafile arg&gt; to data file &lt;filename&gt;. See <a href="#sec_Datafile_Commands">5</a> for more details.</div>
<h3 class="subsection"><a id="magicparlabel-1570"></a><span class="subsection_label">7.7</span> datafilter<a id="subsec_cpptraj_datafilter"></a>
</h3>

<div class="lyx_code"><a id="magicparlabel-1571"></a><div class="lyx_code_item">datafilter &lt;dataset arg&gt; min &lt;min&gt; max &lt;max&gt; [out &lt;file&gt; [name &lt;setname&gt;]]
<br />

</div>

<dl class="description"><a id="magicparlabel-1572"></a><dt class="description_label">&lt;dataset arg&gt; min &lt;min&gt; max &lt;max&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Data set and min/max cutoffs to use; can specify more than once.</span></dd>
<dt class="description_label">[out &lt;file&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write out to file named &lt;file&gt;.</span></dd>
<dt class="description_label">[name &lt;setname&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Name of filter data set.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-1575"></a>Create a data set (optionally named &lt;setname&gt;) containing 1 for data within given <b>&lt;min&gt;</b> and <b>&lt;max&gt;</b> criteria for each specified data set. There must be at least one <b>&lt;min&gt;</b> and <b>&lt;max&gt;</b>
 argument, and can be as many as there are specified data sets. For 
example, to read in data from two separate files (d1.dat and a1.dat) and
 generate a filter data set named FILTER having 1 when d1 is between 0.0
 and 3.0 and a1 is between 135.0 and 180.0:</div>

<div class="lyx_code"><a id="magicparlabel-1576"></a><div class="lyx_code_item">readdata a1.dat name a1</div>
<div class="lyx_code_item">readdata d1.dat name d1</div>
<div class="lyx_code_item">datafilter d1 min 0.0 max 3.0 a1 min 135.0 max 180.0 out filter.dat name FILTER</div>
</div>
<div class="standard"><a id="magicparlabel-1579"></a>Note that a similar command that can be used with data generated by Actions during trajectory processing is <b><i>filter</i></b> (see page <a href="#subsec_cpptraj_filter">elsewhere</a>).</div>
<h3 class="subsection"><a id="magicparlabel-1580"></a><span class="subsection_label">7.8</span> dataset</h3>

<div class="lyx_code"><a id="magicparlabel-1581"></a><div class="lyx_code_item">dataset { legend &lt;legend&gt; &lt;set&gt; |</div>
<div class="lyx_code_item">          makexy &lt;Xset&gt; &lt;Yset&gt; [name &lt;name&gt;] |</div>
<div class="lyx_code_item">          vectorcoord {X|Y|Z} &lt;set&gt; [name &lt;name&gt;] |</div>
<div class="lyx_code_item">    	  cat &lt;set0&gt; &lt;set1&gt; ... [name &lt;name&gt;] [nooffset] |</div>
<div class="lyx_code_item">          make2d &lt;1D set&gt; cols &lt;ncols&gt; rows &lt;nrows&gt; [name &lt;name&gt;] |</div>
<div class="lyx_code_item">          {drop|keep}points {range &lt;range arg&gt; | [start &lt;#&gt;] [stop &lt;#&gt;] [offset &lt;#&gt;]}</div>
<div class="lyx_code_item">                   [name &lt;output set&gt;] &lt;set arg1&gt; ... |</div>
<div class="lyx_code_item">          remove &lt;criterion&gt; &lt;select&gt; &lt;value&gt; [and &lt;value2&gt;] [&lt;set selection&gt;] |</div>
<div class="lyx_code_item">          dim {xdim|ydim|zdim|ndim &lt;#&gt;} [label &lt;label&gt;] [min &lt;min&gt;] [step &lt;step&gt;] |</div>
<div class="lyx_code_item">          outformat {double|scientific|general} &lt;set arg1&gt; [&lt;set arg 2&gt; ...] |</div>
<div class="lyx_code_item">    	  [mode &lt;mode&gt;] [type &lt;type&gt;] &lt;set arg1&gt; [&lt;set arg 2&gt; ...] }</div>
<div class="lyx_code_item">  &lt;mode&gt;:  distance angle torsion pucker rms</div>
<div class="lyx_code_item">  &lt;type&gt;:  alpha beta gamma delta epsilon zeta pucker chi h1p c2p </div>
<div class="lyx_code_item">           phi psi pchi omega noe</div>
<div class="lyx_code_item">	    Options for 'type noe':</div>
<div class="lyx_code_item">    	  [bound &lt;lower&gt; bound &lt;upper&gt;] [rexp &lt;expected&gt;] [noe_strong] [noe_medium] [noe_weak]
<br />

</div>

<dl class="description"><a id="magicparlabel-1597"></a><dt class="description_label">[name &lt;name&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> New data set name for <b>makexy</b>/<b>vectorcoord/cat</b>/<b>make2d</b>/<b>droppoints</b>/<b>keeppoints</b>.</span></dd>
<dt class="description_label">legend &lt;legend&gt; &lt;set&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Set the legend for data set &lt;set&gt; to &lt;legend&gt;.</span></dd>
<dt class="description_label">makexy &lt;Xset&gt; &lt;Yset&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Create a new data set (optionally named &lt;name&gt;) with X values from &lt;Xset&gt; and Y values from &lt;Yset&gt;.</span></dd>
<dt class="description_label">vectorcoord {X|Y|Z} &lt;set&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Extract X/Y/Z coordinates from vector data set into a new 1D data set.</span></dd>
<dt class="description_label">cat &lt;set0&gt; &lt;set1&gt; ...</dt>
<dd class="description_item"><span style="font-family:monospace;"> Concatenate two or more data sets into a new data set (optionally named &lt;name&gt;).</span></dd>
<dt class="description_label">make2d &lt;1D set&gt; cols &lt;ncols&gt; rows &lt;nrows&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Convert 1D data set into row-major 2D data set with specified number of rows and columns.</span></dd>
<dt class="description_label">{drop|keep}points &lt;set arg1&gt; ...</dt>
<dd class="description_item"><span style="font-family:monospace;"> Drop or keep specified points from data set(s), optionally creating a new data set.</span>

<dl class="description"><a id="magicparlabel-1604"></a><dt class="description_label">range &lt;range arg&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Range of points to drop/keep.</span></dd>
<dt class="description_label">[start &lt;#&gt;] [stop &lt;#&gt;] [offset &lt;#&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Start/stop/offset values of points to drop/keep.</span></dd>
</dl>
</dd><dt class="description_label">remove &lt;criterion&gt; &lt;select&gt; &lt;value&gt; [and &lt;value2&gt;] [&lt;set selection&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Remove data sets from &lt;set selection&gt; according to specified criterion and selection.</span></dd>
</dl>

<div class="lyx_code"><a id="magicparlabel-1607"></a><div class="lyx_code_item">&lt;criterion&gt;:  'ifaverage' 'ifsize' 'ifmode' 'iftype'</div>
<div class="lyx_code_item">&lt;select&gt;   :  'equal' '==' 'notequal' '!=' 'lessthan' '&lt;' 'greaterthan' '&gt;' 'between' 'outside'</div>
</div>

<dl class="description"><a id="magicparlabel-1609"></a><dt class="description_label">dim {xdim|ydim|zdim|ndim &lt;#&gt;}</dt>
<dd class="description_item"><span style="font-family:monospace;"> Change specified dimension in set(s).</span>

<dl class="description"><a id="magicparlabel-1610"></a><dt class="description_label">label &lt;label&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Change dimension label to &lt;label&gt;</span></dd>
<dt class="description_label">min &lt;min&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Change dimension minimum to &lt;min&gt;.</span></dd>
<dt class="description_label">step &lt;step&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Change dimension step to &lt;step&gt;.</span></dd>
</dl>
</dd><dt class="description_label">[mode &lt;mode&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Set data set(s) mode to &lt;mode&gt;.</span></dd>
<dt class="description_label">[type &lt;type&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Set data set(s) type to 'type', useful for e.g. analysis with <b><i>statistics</i></b>. Note this can also be done with 'type &lt;type&gt;' for certain commands (<b><i>distance</i></b>, <b><i>dihedral</i></b>, <b><i>pucker</i></b> etc). Note that not every &lt;type&gt; is compatible with a given &lt;mode&gt;.</span></dd>
</dl>
<div class="standard"><a id="magicparlabel-1615"></a><span style="font-family:monospace;">Options for type noe only:</span></div>

<dl class="description"><a id="magicparlabel-1616"></a><dt class="description_label">[bound &lt;lower&gt; bound &lt;upper&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Lower and upper bounds for NOE (in Angstroms); must specify both.</span></dd>
<dt class="description_label">[rexp &lt;expected&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Expected value for NOE (in Angstroms); if not given '(&lt;lower&gt; + &lt;upper&gt;)' / 2.0 is used.</span></dd>
<dt class="description_label">[noe_strong]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Set lower and upper bounds to 1.8 and 2.9 Å respectively.</span></dd>
<dt class="description_label">[noe_medium]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Set lower and upper bounds to 2.9 and 3.5 Å respectively.</span></dd>
<dt class="description_label">[noe_weak]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Set lower and upper bounds to 3.5 and 5.0 Å respectively.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-1621"></a>Either set the 
legend for a single data set, create a new set with X values from one 
set and Y values from another, concatenate 2 or more sets, make a 2D set
 from 1D set, remove sets according to a certain criterion, or change 
the mode/type for one or more data sets.</div>

<div class="standard"><a id="magicparlabel-1622"></a>Setting the 
mode/type can be useful for cases where the data set is being read in 
from a file; for example when reading in a dihedral data set the type 
can be set to 'dihedral' so that various Analysis routines like <b><i>statistics</i></b> know to treat it as periodic. A brief description of possible modes and types follows:
<br />

</div>



<div class="standard" style="text-align: center;"><a id="magicparlabel-1623"></a><table><tbody><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1720"></a><b>Mode</b></div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1723"></a><b>Type</b></div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1726"></a><b>Description</b></div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1729"></a>distance</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1732"></a>noe</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1735"></a>NOE distance.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1738"></a>angle</div>
</td>
<td valign="top" align="center">

</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1744"></a>Angle.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1747"></a>torsion</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1750"></a>alpha</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1753"></a>Nucleic acid alpha.</div>
</td>
</tr><tr><td valign="top" align="center">

</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1759"></a>beta</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1762"></a>Nucleic acid beta.</div>
</td>
</tr><tr><td valign="top" align="center">

</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1768"></a>gamma</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1771"></a>Nucleic acid gamma.</div>
</td>
</tr><tr><td valign="top" align="center">

</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1777"></a>delta</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1780"></a>Nucleic acid delta.</div>
</td>
</tr><tr><td valign="top" align="center">

</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1786"></a>epsilon</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1789"></a>Nucleic acid epsilon.</div>
</td>
</tr><tr><td valign="top" align="center">

</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1795"></a>zeta</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1798"></a>Nucleic acid zeta.</div>
</td>
</tr><tr><td valign="top" align="center">

</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1804"></a>nu1</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1807"></a>Nucleic pucker (O4').</div>
</td>
</tr><tr><td valign="top" align="center">

</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1813"></a>nu2</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1816"></a>Nucleic pucker (C4').</div>
</td>
</tr><tr><td valign="top" align="center">

</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1822"></a>h1p</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1825"></a>Nucleic acid H1'.</div>
</td>
</tr><tr><td valign="top" align="center">

</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1831"></a>c2p</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1834"></a>Nucleic acid C2'.</div>
</td>
</tr><tr><td valign="top" align="center">

</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1840"></a>chin</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1843"></a>Nucleic acid chi.</div>
</td>
</tr><tr><td valign="top" align="center">

</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1849"></a>phi</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1852"></a>Protein Phi.</div>
</td>
</tr><tr><td valign="top" align="center">

</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1858"></a>psi</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1861"></a>Protein psi.</div>
</td>
</tr><tr><td valign="top" align="center">

</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1867"></a>chip</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1870"></a>Protein chi.</div>
</td>
</tr><tr><td valign="top" align="center">

</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1876"></a>omega</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1879"></a>Protein omega.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1882"></a>pucker</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1885"></a>pucker</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1888"></a>Sugar pucker.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1891"></a>rms</div>
</td>
<td valign="top" align="center">

</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1897"></a>RMSD.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1900"></a>matrix</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1903"></a>distance</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1906"></a>Distance matrix.</div>
</td>
</tr><tr><td valign="top" align="center">

</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1912"></a>covariance</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1915"></a>Cartesian covariance matrix.</div>
</td>
</tr><tr><td valign="top" align="center">

</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1921"></a>'mass-weighted covariance'</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1924"></a>Mass weighted Cartesian covariance matrix.</div>
</td>
</tr><tr><td valign="top" align="center">

</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1930"></a>correlation</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1933"></a>Dynamic cross correlation matrix.</div>
</td>
</tr><tr><td valign="top" align="center">

</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1939"></a>'distance covariance'</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1942"></a>Distance covariance matrix.</div>
</td>
</tr><tr><td valign="top" align="center">

</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1948"></a>IDEA</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1951"></a>IDEA matrix.</div>
</td>
</tr><tr><td valign="top" align="center">

</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1957"></a>IRED</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1960"></a>IRED matrix.</div>
</td>
</tr><tr><td valign="top" align="center">

</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1966"></a>'dihedral covariance'</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1969"></a>Dihedral covariance matrix.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1972"></a>vector</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1975"></a>IRED</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-1978"></a>IRED vector.</div>
</td>
</tr></tbody>
</table>
</div>
<h3 class="subsection"><a id="magicparlabel-1979"></a><span class="subsection_label">7.9</span> debug | prnlev</h3>

<div class="lyx_code"><a id="magicparlabel-1980"></a><div class="lyx_code_item">debug<a id="magicparlabel-1984"></a>
 [&lt;type&gt;] &lt;#&gt;</div>
<div class="lyx_code_item">      (&lt;type&gt; = actions,trajin,trajout,ref,parm,analysis,datafile,dataset)</div>
</div>
<div class="standard"><a id="magicparlabel-1986"></a>Set the level of 
debug information to print. In general the higher the &lt;#&gt; the more
 information that is printed. If &lt;type&gt; is specified only set the 
debug level for a specific area of <i>cpptraj.</i></div>
<h3 class="subsection"><a id="magicparlabel-1987"></a><span class="subsection_label">7.10</span> ensextension</h3>

<div class="lyx_code"><a id="magicparlabel-1988"></a><div class="lyx_code_item">ensextension {on|off}</div>
</div>
<div class="standard"><a id="magicparlabel-1989"></a>Turn printing of 
ensemble member number filename extensions on or off. By default 
ensemble extensions are printed in parallel and not in serial.</div>

<div class="standard"><a id="magicparlabel-1990"></a><b>NOTE: THE 'ensextension off' OPTION HAS NOT BEEN FULLY TESTED IN PARALLEL AND IS NOT CURRENTLY RECOMMENDED.</b></div>
<h3 class="subsection"><a id="magicparlabel-1991"></a><span class="subsection_label">7.11</span> exit | quit</h3>
<div class="standard"><a id="magicparlabel-1992"></a>Exit normally.</div>
<h3 class="subsection"><a id="magicparlabel-1993"></a><span class="subsection_label">7.12</span> go | run</h3>
<div class="standard"><a id="magicparlabel-1994"></a>Begin trajectory processing, followed by analysis and datafile write.</div>
<h3 class="subsection"><a id="magicparlabel-1995"></a><span class="subsection_label">7.13</span> help</h3>

<div class="lyx_code"><a id="magicparlabel-1996"></a><div class="lyx_code_item">help<a id="magicparlabel-2000"></a>
 {[&lt;command&gt;] | General | Action | Analysis | Topology | Trajectory}</div>
</div>
<div class="standard"><a id="magicparlabel-2001"></a>By itself, list all commands known to <i>cpptraj</i>.
 If given with a command, print help for that command. Otherwise, list 
all commands of a certain category (General, Action, Analysis, Topology,
 or Trajectory).</div>
<h3 class="subsection"><a id="magicparlabel-2002"></a><span class="subsection_label">7.14</span> list</h3>

<div class="lyx_code"><a id="magicparlabel-2003"></a><div class="lyx_code_item">list &lt;type&gt;</div>
<div class="lyx_code_item">     (&lt;type&gt; = actions,trajin,trajout,ref,parm,analysis,datafile,dataset)</div>
</div>
<div class="standard"><a id="magicparlabel-2005"></a>List the currently loaded objects of &lt;type&gt;.</div>
<h3 class="subsection"><a id="magicparlabel-2006"></a><span class="subsection_label">7.15</span> noexitonerror</h3>

<div class="lyx_code"><a id="magicparlabel-2007"></a><div class="lyx_code_item">noexitonerror<a id="magicparlabel-2011"></a>
</div>
</div>
<div class="standard"><a id="magicparlabel-2012"></a>Normally <i>cpptraj</i> will exit if actions fail to initialize properly. If <b><i>noexitonerror</i></b> is specified, <i>cpptraj</i> will attempt to continue past such errors. This is the default if in interactive mode.</div>
<h3 class="subsection"><a id="magicparlabel-2013"></a><span class="subsection_label">7.16</span> noprogress</h3>

<div class="lyx_code"><a id="magicparlabel-2014"></a><div class="lyx_code_item">noprogress<a id="magicparlabel-2018"></a>
</div>
</div>
<div class="standard"><a id="magicparlabel-2019"></a>Do not display read progress during trajectory processing. </div>
<h3 class="subsection"><a id="magicparlabel-2020"></a><span class="subsection_label">7.17</span> precision</h3>

<div class="lyx_code"><a id="magicparlabel-2021"></a><div class="lyx_code_item">precision<a id="magicparlabel-2025"></a>
 {&lt;filename&gt; | &lt;dataset arg&gt;} [&lt;width&gt;] [&lt;precision&gt;]</div>
</div>
<div class="standard"><a id="magicparlabel-2026"></a>Set the precision for all data sets in data file &lt;filename&gt; or data set(s) specified by &lt;dataset arg&gt; to <i>width.precision</i>,
 where width is the column width and precision is the number of digits 
after the decimal point. Note that the &lt;precision&gt; argument only 
applies to floating-point data sets.</div>

<div class="standard"><a id="magicparlabel-2027"></a>For example, if one wanted to set the precision of the output of an Rmsd calculation to 8.3, the input could be:</div>

<div class="lyx_code"><a id="magicparlabel-2028"></a><div class="lyx_code_item">trajin ../run0.nc </div>
<div class="lyx_code_item">rms first :10-260 out prec.dat </div>
<div class="lyx_code_item">precision prec.dat 8 3</div>
</div>
<div class="standard"><a id="magicparlabel-2031"></a>and the output would look like:</div>

<div class="lyx_code"><a id="magicparlabel-2032"></a><div class="lyx_code_item">#Frame RMSD_00000</div>
<div class="lyx_code_item">1 0.000</div>
<div class="lyx_code_item">2 0.630</div>
</div>
<h3 class="subsection"><a id="magicparlabel-2035"></a><span class="subsection_label">7.18</span> readdata<a id="subsec_cpptraj_readdata"></a>
</h3>

<div class="lyx_code"><a id="magicparlabel-2036"></a><div class="lyx_code_item">readdata<a id="magicparlabel-2040"></a>
 &lt;filename&gt;  [name &lt;dsname&gt;] [as &lt;fmt&gt;] [separate] [&lt;format options&gt;]
<br />

</div>

<dl class="description"><a id="magicparlabel-2041"></a><dt class="description_label">name &lt;dsname&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Name for read-in data set(s). Default is &lt;filename&gt;.</span></dd>
<dt class="description_label">as &lt;fmt&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Force &lt;filename&gt; to be read as a specific format using given format keyword.</span></dd>
<dt class="description_label">separate</dt>
<dd class="description_item"><span style="font-family:monospace;"> Read each file specified into separate data sets indexed from 0.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-2044"></a>Read data from file
 &lt;filename&gt; and store as data sets. For more information on 
formats currently recognized by cpptraj see <a href="#tab_cpptraj_DataFile_formats">1</a>. For format-specific options see <a href="#sec_Datafile_Commands">5</a>. For example, given the file calc.dat:</div>

<div class="lyx_code"><a id="magicparlabel-2045"></a><div class="lyx_code_item">#Frame  R0   D1</div>
<div class="lyx_code_item">1      1.7 2.22</div>
</div>
<div class="standard"><a id="magicparlabel-2047"></a>The command '<span style="font-family:monospace;">readdata calc.dat</span>' would read data into two data sets, calc.dat:2 (legend set to “R0”) and calc.dat:3 (legend set to “D1”).</div>
<h3 class="subsection"><a id="magicparlabel-2048"></a><span class="subsection_label">7.19</span> readensembledata<a id="subsec_cpptraj_readensembledata"></a>
</h3>

<div class="lyx_code"><a id="magicparlabel-2049"></a><div class="lyx_code_item">readensembledata &lt;filename&gt; [filenames &lt;additional files&gt;] [&lt;readdata args&gt;]</div>

<dl class="description"><a id="magicparlabel-2050"></a><dt class="description_label">&lt;filename&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Lowest replica file name.</span></dd>
<dt class="description_label">filenames &lt;additional files&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Specified additional members of the ensemble. If not specified ensemble members will be search for using numerical extensions.</span></dd>
<dt class="description_label">&lt;readdata args&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Additional data file arguments.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-2053"></a>Read data sets as an ensemble, i.e. each file is a different member of an ensemble. This command is MPI-aware.</div>

<div class="standard"><a id="magicparlabel-2054"></a>If one filename is 
given, it is assumed it is the "lowest" member of an ensemble with a 
numerical extension, e.g. 'file.001' and the remaining files are 
searched for automatically. Otherwise all other members of the ensemble 
can be specified with <b>'filenames'</b> and a comma-separated list e.g.
 'file.001 filenames file.002,file.003,file.004. For additional 
'readdata' arguments that can be passed in see <a href="#sec_Datafile_Commands">5</a>.</div>

<div class="standard"><a id="magicparlabel-2055"></a>For example, to read in data files named cpout.001 to cpout.006 automatically:</div>

<div class="lyx_code"><a id="magicparlabel-2056"></a><div class="lyx_code_item">readensembledata cpout.001 cpin cpin name PH</div>
</div>
<div class="standard"><a id="magicparlabel-2057"></a>Or specified:</div>

<div class="lyx_code"><a id="magicparlabel-2058"></a><div class="lyx_code_item">readensembledata cpout.001 \</div>
<div class="lyx_code_item">                 filenames cpout.002,cpout.003,cpout.004,cpout.005,cpout.006 \</div>
<div class="lyx_code_item">                 cpin cpin name PH </div>
</div>
<h3 class="subsection"><a id="magicparlabel-2061"></a><span class="subsection_label">7.20</span> readinput</h3>

<div class="lyx_code"><a id="magicparlabel-2062"></a><div class="lyx_code_item">readinput<a id="magicparlabel-2066"></a>
 &lt;filename&gt;</div>
</div>
<div class="standard"><a id="magicparlabel-2067"></a>Read <i>cpptraj</i> commands from file &lt;filename&gt;.</div>
<h3 class="subsection"><a id="magicparlabel-2068"></a><span class="subsection_label">7.21</span> removedata</h3>

<div class="lyx_code"><a id="magicparlabel-2069"></a><div class="lyx_code_item">removedata &lt;arg&gt;</div>
</div>
<div class="standard"><a id="magicparlabel-2070"></a>Remove data set corresponding to &lt;arg&gt;.</div>
<h3 class="subsection"><a id="magicparlabel-2071"></a><span class="subsection_label">7.22</span> rst</h3>

<div class="lyx_code"><a id="magicparlabel-2072"></a><div class="lyx_code_item">rst &lt;mask1&gt; &lt;mask2&gt; [&lt;mask3&gt;] [&lt;mask4&gt;]</div>
<div class="lyx_code_item">    r1 &lt;r1&gt; r2 &lt;r2&gt; r3 &lt;r3&gt; r4 &lt;r4&gt; rk2 &lt;rk2&gt; rk3 &lt;rk3&gt;</div>
<div class="lyx_code_item">    {[parm &lt;parmfile / tag&gt; | parmindex &lt;#&gt;]}</div>
<div class="lyx_code_item">    [{ref &lt;refname&gt; | refindex &lt;#&gt; | reference} [offset &lt;off&gt;] [width &lt;width&gt;]]</div>
<div class="lyx_code_item">    [out &lt;outfile&gt;]
<br />

</div>

<dl class="description"><a id="magicparlabel-2077"></a><dt class="description_label">&lt;mask1&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> (Required) First atom mask.</span></dd>
<dt class="description_label">&lt;mask2&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> (Required) Second atom mask. If only two masks assume distance restraint.</span></dd>
<dt class="description_label">[&lt;mask3&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> (Optional) Third atom mask. If 3 atom masks assume angle restraint.</span></dd>
<dt class="description_label">[&lt;mask4&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> (Optional) Fourth atom mask. If 4 atom masks assume dihedral restraint.</span></dd>
<dt class="description_label">rX &lt;rX&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Value of RX (X=1-4, default 0.0)</span></dd>
<dt class="description_label">rk2 &lt;rk2&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Value of RK2 (force constant to be applied when R is R1 &lt;= R &lt; R2)</span></dd>
<dt class="description_label">rk3 &lt;rk3&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Value of RK3 (force constant to be applied when R is R3 &lt;= R &lt; R4)</span></dd>
<dt class="description_label">[parm &lt;parmfile / tag&gt; | parmindex &lt;#&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Topology to be used for atom masks.</span></dd>
<dt class="description_label">{ref &lt;refname&gt; | refindex &lt;#&gt; | reference}</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use 
distance/angle/dihedral in reference structure to determine values for 
r1, r2, r3, and r4. The value of r2 is set to &lt;r2&gt; + &lt;off&gt;, 
r3 = r2, r1 = r2 - &lt;width&gt;, r4 = r3 + &lt;width&gt;.</span></dd>
<dt class="description_label">[offset &lt;off&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> (Reference only) Value to offset distance/angle/torsion in reference by (default 0.0).</span></dd>
<dt class="description_label">[width &lt;width&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> (Reference only) Width between r1 and r2, r3 and r4 (default 0.5).</span></dd>
<dt class="description_label">[out &lt;outfile&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write restraints to outfile. If not specified, write to STDOUT.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-2089"></a>Generate 
Amber-style distance restraints for use with nmropt=1. This is 
particularly useful for generating distance restraints based off of 
reference coordinates. For example to generate a distance restraint 
between two C5' atoms using the current distance between them in a 
reference structure, offsetting the distance by 1.0 Ang.:</div>

<div class="lyx_code"><a id="magicparlabel-2090"></a><div class="lyx_code_item">parm 30bp-longbox-tip3p-na.parm7</div>
<div class="lyx_code_item">reference 30bp-longbox.rst7 </div>
<div class="lyx_code_item">rst :1@C5' :31@C5' reference offset 1.0 rk2 10.0 rk3 10.0 out output</div>
</div>
<h3 class="subsection"><a id="magicparlabel-2093"></a><span class="subsection_label">7.23</span> runanalysis<a id="subsec_cpptraj_runanalysis"></a>
</h3>

<div class="lyx_code"><a id="magicparlabel-2094"></a><div class="lyx_code_item">runanalysis [&lt;analysiscmd&gt; [&lt;analysis args&gt;]]</div>
</div>
<div class="standard"><a id="magicparlabel-2095"></a>Run given analysis 
command immediately and write any data generated. If no command is given
 run any analysis currently set up. NOTE: When 'runanalysis' is 
specified alone, data is not automatically written; to write data 
generated with 'runanalysis' use the 'writedata' command (this allows 
multiple analysis runs between output if desired).</div>
<h3 class="subsection"><a id="magicparlabel-2096"></a><span class="subsection_label">7.24</span> select</h3>

<div class="lyx_code"><a id="magicparlabel-2097"></a><div class="lyx_code_item">select<a id="magicparlabel-2101"></a>
 &lt;mask&gt;</div>
</div>
<div class="standard"><a id="magicparlabel-2102"></a>Prints the number of selected atoms corresponding to the given mask, as well as the atom numbers with format:</div>

<div class="lyx_code"><a id="magicparlabel-2103"></a><div class="lyx_code_item">Selected= &lt;#atom1&gt; &lt;#atom2&gt; ...</div>
</div>
<div class="standard"><a id="magicparlabel-2104"></a>This does not affect the state in any way, but is intended for use in scripts etc. for testing the results of a mask expression.</div>
<h3 class="subsection"><a id="magicparlabel-2105"></a><span class="subsection_label">7.25</span> selectds</h3>

<div class="lyx_code"><a id="magicparlabel-2106"></a><div class="lyx_code_item">selectds &lt;dataset arg&gt;</div>
</div>
<div class="standard"><a id="magicparlabel-2107"></a>Show the results of a data set selection. Data set selection has the format:</div>

<div class="lyx_code"><a id="magicparlabel-2108"></a><div class="lyx_code_item">&lt;name&gt;[&lt;aspect&gt;]:&lt;index&gt;</div>
</div>
<div class="standard"><a id="magicparlabel-2109"></a>Either the 
[&lt;aspect&gt;] or the &lt;index&gt; arguments may be omitted. A '*' 
can be used in place of &lt;name&gt; or [&lt;aspect&gt;] as a wildcard. 
The &lt;index&gt; argument can be a single number or a range separated 
by '-' and ','.</div>

<div class="standard"><a id="magicparlabel-2110"></a>This command does 
not affect the state in any way, but is particularly useful in 
interactive mode for determining the results of a dataset argument.</div>
<h3 class="subsection"><a id="magicparlabel-2111"></a><span class="subsection_label">7.26</span> sortensembledata<a id="subsec_cpptraj_sortensembledata"></a>
</h3>

<div class="lyx_code"><a id="magicparlabel-2112"></a><div class="lyx_code_item">sortensembledata &lt;dset arg0&gt; [&lt;dset arg1&gt; ...]</div>

<dl class="description"><a id="magicparlabel-2113"></a><dt class="description_label">&lt;dset arg0&gt; [&lt;dset arg1&gt; ...]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Data set(s) to sort.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-2114"></a>Sort unsorted data sets. Currently only works for constant pH REMD data.</div>
<h3 class="subsection"><a id="magicparlabel-2115"></a><span class="subsection_label">7.27</span> write | writedata<a id="subsec_cpptraj_writedata"></a>
</h3>

<div class="lyx_code"><a id="magicparlabel-2116"></a><div class="lyx_code_item">write [&lt;filename&gt; &lt;datasetname0&gt; [&lt;datasetname1&gt; ...]] [&lt;DataFile Options&gt;]</div>
</div>
<div class="standard"><a id="magicparlabel-2117"></a>With no arguments, 
write all files currently in the data file list. Otherwise, write 
specified data set(s) to &lt;filename&gt;. This is like the 'create' 
command except a data file is not added to the data file list; it is 
written immediately. See <a href="#sec_Datafile_Commands">5</a> for more data file format options.</div>
<h3 class="subsection"><a id="magicparlabel-2118"></a><span class="subsection_label">7.28</span> System Commands</h3>
<div class="standard"><a id="magicparlabel-2119"></a>These commands call the equivalent external system commands. </div>

<dl class="description"><a id="magicparlabel-2120"></a><dt class="description_label">gnuplot &lt;args&gt;</dt>
<dd class="description_item"> Call <span style="font-family:monospace;">gnuplot</span> (if it is installed on your system) with the given arguments.</dd>
<dt class="description_label">head &lt;args&gt;</dt>
<dd class="description_item"> Call <span style="font-family:monospace;">head</span>, which lists the first few lines of a file.</dd>
<dt class="description_label">less &lt;args&gt;</dt>
<dd class="description_item"> Call <span style="font-family:monospace;">less</span>, which can be used to view the contents of a file.</dd>
<dt class="description_label">ls &lt;args&gt;</dt>
<dd class="description_item"> List the contents of a directory.</dd>
<dt class="description_label">pwd &lt;args&gt;</dt>
<dd class="description_item"> Print the current working directory.</dd>
<dt class="description_label">xmgrace &lt;args&gt;</dt>
<dd class="description_item"> Call <span style="font-family:monospace;">xmgrace</span> (if it is installed on your system) with the given arguments.</dd>
</dl>
<h2 class="section"><a id="magicparlabel-2126"></a><span class="section_label">8</span> Topology File Commands</h2>
<div class="standard"><a id="magicparlabel-2127"></a>These commands control the reading and writing of topology files. Cpptraj supports the following topology file formats:
<br />

</div>



<div class="standard" style="text-align: center;"><a id="magicparlabel-2128"></a><table><tbody><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2175"></a><b>Format</b></div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2178"></a><b>Keyword</b></div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2181"></a><b>Extension</b></div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2184"></a><b>Notes</b></div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2187"></a>Amber Topology</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2190"></a>amber</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2193"></a>.parm7</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2196"></a>Only fully-supported format.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2199"></a>PDB </div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2202"></a>pdb</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2205"></a>.pdb</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2208"></a>Read Only</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2211"></a>Mol2</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2214"></a>mol2</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2217"></a>.mol2</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2220"></a>Read Only</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2223"></a>CIF</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2226"></a>cif</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2229"></a>.cif</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2232"></a>Read Only</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2235"></a>Charmm PSF</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2238"></a>psf</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2241"></a>.psf</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2244"></a>Limited Write</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2247"></a>Gromacs Topology</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2250"></a>gromacs</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2253"></a>.top</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2256"></a>Limited Write</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2259"></a>SDF</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2262"></a>sdf</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2265"></a>.sdf</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2268"></a>Read Only</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2271"></a>Tinker ARC</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2274"></a>arc</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2277"></a>.arc</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2280"></a>Read Only</div>
</td>
</tr></tbody>
</table>
<a id="tab_cpptraj_Topology_formats"></a>
</div>

<div class="standard"><a id="magicparlabel-2281"></a>For most commands that require a topology one can be specified via two keywords:</div>

<dl class="description"><a id="magicparlabel-2282"></a><dt class="description_label">parm [&lt;name&gt;]</dt>
<dd class="description_item"> Select topology corresponding to given file name, tag, or name.</dd>
<dt class="description_label">parmindex [&lt;#&gt;]</dt>
<dd class="description_item"> Select topology by order in which it was loaded, starting from 0.</dd>
</dl>
<div class="standard"><a id="magicparlabel-2284"></a>The following topology related commands are available:
<br />

</div>



<div class="standard" style="text-align: center;"><a id="magicparlabel-2285"></a><table><tbody><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2330"></a><b>Command</b></div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2333"></a><b>Description</b></div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2336"></a>angleinfo, angles, printangles</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2339"></a>Print angle info for selected atoms.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2342"></a>atominfo, atoms, printatoms</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2345"></a>Print details for selected atoms.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2348"></a>bondinfo, bonds, printbonds</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2351"></a>Print bond info for selected atoms.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2354"></a>change</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2357"></a>Change specified parts of a topology.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2360"></a>charge</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2363"></a>Print total charge for selected atoms.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2366"></a>comparetop</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2369"></a>Compare two topologies and report differences.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2372"></a>dihedralinfo, dihedrals, printdihedrals</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2375"></a>Print dihedral info for selected atoms.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2378"></a>mass</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2381"></a>Print total mass for selected atoms.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2384"></a>molinfo</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2387"></a>Print molecule info for selected atoms.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2390"></a>parm</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2393"></a>Load a topology file.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2396"></a>parmbox</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2399"></a>Modify box info for a loaded topology.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2402"></a>parminfo</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2405"></a>Print details for selected topology.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2408"></a>parmstrip</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2411"></a>Remove selected atoms from topology.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2414"></a>parmwrite</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2417"></a>Write selected topology to file.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2420"></a>resinfo</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2423"></a>Print residue info for selected atoms.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2426"></a>scaledihedralk</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2429"></a>Scale selected dihedral force constants.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2432"></a>solvent</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2435"></a>Change which molecules are considered solvent.</div>
</td>
</tr></tbody>
</table>
</div>
<h3 class="subsection"><a id="magicparlabel-2436"></a><span class="subsection_label">8.1</span> angleinfo | angles | printangles</h3>

<div class="lyx_code"><a id="magicparlabel-2437"></a><div class="lyx_code_item">angleinfo [parm &lt;name&gt; | parmindex &lt;#&gt; | &lt;#&gt;] [&lt;mask&gt;] </div>
</div>
<div class="standard"><a id="magicparlabel-2438"></a>Print angle information of atoms in &lt;mask&gt; for selected topology (first loaded topology by default) with format:</div>

<div class="lyx_code"><a id="magicparlabel-2439"></a><div class="lyx_code_item"># Angle Kthet degrees atom names (numbers)</div>
</div>
<div class="standard"><a id="magicparlabel-2440"></a>Where <span style="font-family:monospace;">Angle</span> is the internal angle index, <span style="font-family:monospace;">Kthet</span> is the angle force constant, <span style="font-family:monospace;">degrees</span> is the angle equilibrium value, <span style="font-family:monospace;">atom names</span> shows the atoms involved in the angle with format <span style="font-family:monospace;">:&lt;residue num&gt;@&lt;atom name&gt;</span>, and <span style="font-family:monospace;">(numbers)</span> shows the atom indices involved in a comma-separated list. Atom types will be shown in the last column.</div>
<h3 class="subsection"><a id="magicparlabel-2441"></a><span class="subsection_label">8.2</span> atominfo | atoms | printatoms</h3>

<div class="lyx_code"><a id="magicparlabel-2442"></a><div class="lyx_code_item">atominfo [parm &lt;name&gt; | parmindex &lt;#&gt; | &lt;#&gt;] [&lt;mask&gt;]</div>
</div>
<div class="standard"><a id="magicparlabel-2443"></a>Print information on atoms in &lt;mask&gt; for selected topology (first loaded topology by default) with format:</div>

<div class="lyx_code"><a id="magicparlabel-2444"></a><div class="lyx_code_item">#Atom Name #Res Name #Mol Type Charge Mass GBradius El [rVDW] [eVDW]</div>
</div>
<div class="standard"><a id="magicparlabel-2445"></a>where <span style="font-family:monospace;">#Atom</span> is the internal atom index, the first <span style="font-family:monospace;">Name</span> column is the atom name, <span style="font-family:monospace;">#Res</span> is the atom's residue number, the second <span style="font-family:monospace;">Name</span> column is residue name, <span style="font-family:monospace;">#Mol</span> is the atom's molecule number, <span style="font-family:monospace;">Type</span> is the atom's type (certain topologies only), <span style="font-family:monospace;">Charge</span> is the atom charge (in units of electron charge), <span style="font-family:monospace;">Mass</span> is the atom's mass (in amu), <span style="font-family:monospace;">GBradius</span> is the generalized Born radius of the atom (Amber topologies only), and <span style="font-family:monospace;">El</span> is the 2 character element string. The final two columns are only shown if the topology contains non-bonded parameters: <span style="font-family:monospace;">rVDW</span> is the atom's Lennard-Jones radius and <span style="font-family:monospace;">eVDW</span> is the atom's Lennard-Jones epsilon.</div>
<h3 class="subsection"><a id="magicparlabel-2446"></a><span class="subsection_label">8.3</span> bondinfo | bonds | printbonds</h3>

<div class="lyx_code"><a id="magicparlabel-2447"></a><div class="lyx_code_item">bondinfo [parm &lt;name&gt; | parmindex &lt;#&gt; | &lt;#&gt;] [&lt;mask&gt;]</div>
</div>
<div class="standard"><a id="magicparlabel-2448"></a>Print bond information for atoms in &lt;mask&gt; for selected topology (first loaded topology by default) with format:</div>

<div class="lyx_code"><a id="magicparlabel-2449"></a><div class="lyx_code_item"># Bond Kb Req atom names (numbers)</div>
</div>
<div class="standard"><a id="magicparlabel-2450"></a>where <span style="font-family:monospace;">Bond</span> is the internal bond index, <span style="font-family:monospace;">Kb</span> is the bond force constant, <span style="font-family:monospace;">Req</span> is the bond equilibrium value (in Angstroms), <span style="font-family:monospace;">atom names</span> shows both atom names with format <span style="font-family:monospace;">:&lt;residue num&gt;@&lt;atom name&gt;</span>, and <span style="font-family:monospace;">(numbers)</span> shows both atom numbers in a comma-separated list. Atom types will be shown in the last column.</div>
<h3 class="subsection"><a id="magicparlabel-2451"></a><span class="subsection_label">8.4</span> change</h3>

<div class="lyx_code"><a id="magicparlabel-2452"></a><div class="lyx_code_item">change [parm &lt;name&gt; | parmindex &lt;#&gt; | &lt;#&gt;]</div>
<div class="lyx_code_item">	{ resname from &lt;mask&gt; to &lt;value&gt; |</div>
<div class="lyx_code_item">	  atomname from &lt;mask&gt; to &lt;value&gt; }</div>

<dl class="description"><a id="magicparlabel-2455"></a><dt class="description_label">parm &lt;name&gt; | parmindex &lt;#&gt; | &lt;#&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Topology to change.</span></dd>
<dt class="description_label">resname from &lt;mask&gt; to &lt;value&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Change residue names for residues in &lt;mask&gt; to the given &lt;value&gt;.</span></dd>
<dt class="description_label">atomname from &lt;mask&gt; to &lt;value&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Change atom names for atoms in &lt;mask&gt; to the given &lt;value&gt;.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-2458"></a>Change specified parts of the specified topology. For example, to change atoms named 'HN' to 'H' in topology 0:</div>

<div class="lyx_code"><a id="magicparlabel-2459"></a><div class="lyx_code_item">change parmindex 0 atomname from @HN to H</div>
</div>
<h3 class="subsection"><a id="magicparlabel-2460"></a><span class="subsection_label">8.5</span> charge</h3>

<div class="lyx_code"><a id="magicparlabel-2461"></a><div class="lyx_code_item">charge [parm &lt;name&gt; | parmindex &lt;#&gt; | &lt;#&gt;] &lt;mask&gt;</div>
</div>
<div class="standard"><a id="magicparlabel-2462"></a>Print the total 
charge of atoms in &lt;mask&gt; (in units of electron charge) for 
selected topology (first loaded topology by default).</div>
<h3 class="subsection"><a id="magicparlabel-2463"></a><span class="subsection_label">8.6</span> comparetop</h3>

<div class="lyx_code"><a id="magicparlabel-2464"></a><div class="lyx_code_item">comparetop {parm &lt;name&gt; | parmindex &lt;#&gt;} {parm &lt;name&gt; | parmindex &lt;#&gt;} [out &lt;file&gt;]</div>
<div class="lyx_code_item">           [atype] [lj] [bnd] [ang] [dih] [atoms]</div>

<dl class="description"><a id="magicparlabel-2466"></a><dt class="description_label">parm &lt;name&gt; | parmindex &lt;#&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Topologies to compare.</span></dd>
<dt class="description_label">out &lt;file&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Print results to file instead of screen.</span></dd>
<dt class="description_label">[atype]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Only report atom type differences.</span></dd>
<dt class="description_label">[lj]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Only report differences in Lennard-Jones parameters.</span></dd>
<dt class="description_label">[bnd]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Only report differences in bond parameters.</span></dd>
<dt class="description_label">[ang]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Only report differences in angle parameters.</span></dd>
<dt class="description_label">[dih]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Only report differences in dihedral parmeters.</span></dd>
<dt class="description_label">[atoms]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Only report differences in atom properties.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-2474"></a>Compare and report 
differences in atoms/parameters between two topologies. Differences are 
reported in standard 'diff' format, with '&lt;' prefix indicating the 
parameter is from the first topology and '&gt;' prefix indicating the 
parameter is from the second topology.</div>
<h3 class="subsection"><a id="magicparlabel-2475"></a><span class="subsection_label">8.7</span> dihedralinfo | dihedrals | printdihedrals</h3>

<div class="lyx_code"><a id="magicparlabel-2476"></a><div class="lyx_code_item">dihedralinfo [parm &lt;name&gt; | parmindex &lt;#&gt; | &lt;#&gt;] [&lt;mask&gt;] [and]</div>
</div>
<div class="standard"><a id="magicparlabel-2477"></a>Print dihedral information of atoms in &lt;mask&gt; for selected topology (first loaded topology by default) with format:</div>

<div class="lyx_code"><a id="magicparlabel-2478"></a><div class="lyx_code_item">#Dihedral pk phase pn atoms</div>
</div>
<div class="standard"><a id="magicparlabel-2479"></a>where <span style="font-family:monospace;">#Dihedral</span> is the internal dihedral index, <span style="font-family:monospace;">pk</span> is the dihedral force constant, <span style="font-family:monospace;">phase</span> is the dihedral phase, <span style="font-family:monospace;">pn</span> is the dihedral periodicity, and <span style="font-family:monospace;">atoms</span> shows the names of the atoms involved in the angle with format <span style="font-family:monospace;">:&lt;residue num&gt;@&lt;atom name&gt;</span>,
 followed by the atom indices involved in a comma-separated list. In 
addition if the dihedral is an end dihedral, improper dihedral, or both 
it will be prefaced with an <span style="font-family:monospace;">E</span>, <span style="font-family:monospace;">I</span>, or <span style="font-family:monospace;">B</span> respectively. Atom types will be shown in the last column.</div>

<div class="standard"><a id="magicparlabel-2480"></a>If the <b>and</b> 
keyword is specified then printed dihedrals must contain all atoms 
specified in the &lt;mask&gt;. For example, to only get dihedrals 
containing the atom types N3, CT, and OH:</div>

<div class="lyx_code"><a id="magicparlabel-2481"></a><div class="lyx_code_item">dihedrals @%N3,CT,OH and</div>
</div>
<h3 class="subsection"><a id="magicparlabel-2482"></a><span class="subsection_label">8.8</span> mass</h3>

<div class="lyx_code"><a id="magicparlabel-2483"></a><div class="lyx_code_item">[&lt;parmindex&gt;] [parm &lt;name&gt; | parmindex &lt;#&gt; | &lt;#&gt;] &lt;mask&gt;</div>
</div>
<div class="standard"><a id="magicparlabel-2484"></a>Print the total mass of atoms in &lt;mask&gt; (in amu) for selected topology (first loaded topology by default).</div>
<h3 class="subsection"><a id="magicparlabel-2485"></a><span class="subsection_label">8.9</span> molinfo</h3>

<div class="lyx_code"><a id="magicparlabel-2486"></a><div class="lyx_code_item">molinfo [parm &lt;name&gt; | parmindex &lt;#&gt; | &lt;#&gt;] [&lt;mask&gt;]</div>
</div>
<div class="standard"><a id="magicparlabel-2487"></a>Print molecule information for atoms in &lt;mask&gt; for selected topology (first loaded topology by default) with format:</div>

<div class="lyx_code"><a id="magicparlabel-2488"></a><div class="lyx_code_item">#Mol  Natom  #Res Name [SOLVENT]</div>
</div>
<div class="standard"><a id="magicparlabel-2489"></a>where <span style="font-family:monospace;">#Mol</span> is the molecule number, <span style="font-family:monospace;">Natom</span> is the number of atoms in the molecule, and <span style="font-family:monospace;">#Res</span> and <span style="font-family:monospace;">Name</span> are the residue number and residue name of the first residue in the molecule respectively. <span style="font-family:monospace;">SOLVENT</span> will be printed if the molecule is currently considered a solvent molecule.</div>
<h3 class="subsection"><a id="magicparlabel-2490"></a><span class="subsection_label">8.10</span> parm</h3>

<div class="lyx_code"><a id="magicparlabel-2491"></a><div class="lyx_code_item">parm<a id="magicparlabel-2495"></a>
 &lt;filename&gt; [{[TAG] | name &lt;setname&gt;}] [nobondsearch | bondsearch [&lt;offset&gt;]]
<br />

</div>

<dl class="description"><a id="magicparlabel-2496"></a><dt class="description_label">&lt;filename&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Parameter file to read in; format is auto-detected.</span></dd>
<dt class="description_label">'[TAG]'</dt>
<dd class="description_item"><span style="font-family:monospace;"> 
Optional tag (bounded in brackets) which can be referred to in place of 
the topology file name in order to simplify references to it (see <a href="#subsec_Parameter_Reference_Tagging">2.4</a> for examples of how to use tags).</span></dd>
<dt class="description_label">[name &lt;setname&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Optional name that can be used to refer to the topology in place of the file name.</span></dd>
<dt class="description_label">[bondsearch</dt>
<dd class="description_item"><span style="font-family:monospace;"> 
&lt;offset&gt;] Optional; when searching for bonds via geometry search 
(default for Topologies without bond information) add &lt;offset&gt; to 
distances (default 0.2 Å). Increase this if your system includes 
unusually long bonds.</span></dd>
<dt class="description_label">[nobondsearch]</dt>
<dd class="description_item"><span style="font-family:monospace;"> 
Optional; if specified do not search for bonds via geometry if Topology 
does not include bond information. May cause some actions to fail. </span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-2501"></a>Read in parameter file. The file format will be auto-detected. Current formats recognized by cpptraj are listed <a href="#tab_cpptraj_Topology_formats">elsewhere</a>.
 If the file does not contain bond information, cpptraj will attempt to 
assign bonds based on a simple distance search of atoms within and 
between residues. The distance cutoff for determining bonds between 
atoms depends on the elements of the two atoms in question, augmented by
 &lt;offset&gt;. Molecule information is then determined from bond 
information.</div>
<h4 class="subsubsection"><a id="magicparlabel-2502"></a><span class="subsubsection_label">8.10.1</span> <em>PDB format:</em></h4>

<div class="lyx_code"><a id="magicparlabel-2503"></a><div class="lyx_code_item">[pqr] [readbox] [noconect]
<br />

</div>

<dl class="description"><a id="magicparlabel-2504"></a><dt class="description_label">[pqr]:</dt>
<dd class="description_item"><span style="font-family:monospace;"> Read charge and radius information from the occupancy and B-factor columns.</span></dd>
<dt class="description_label">[readbox]:</dt>
<dd class="description_item"><span style="font-family:monospace;"> Read unit cell information from CRYST1 record if present.</span></dd>
<dt class="description_label">[noconect]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Do not read in CONECT records from PDB file.</span></dd>
</dl>
</div>
<h4 class="subsubsection_"><a id="magicparlabel-2507"></a>IMPORTANT NOTES FOR PDB FILES</h4>
<div class="standard"><a id="magicparlabel-2508"></a>In some older 
format PDB files (before version 3), certain atoms may contain the 
asterisk ('*') character in their name (e.g. 'C1*' in a nucleic acid 
backbone). Since in <i>cpptraj</i> the asterisk is a reserved character 
for atom masks all asterisks in PDB atom names are replaced with single 
quote (') to avoid issues with the mask parser. So in a structure with 
an atom named C1*, to select it use the mask “@C1'”.</div>

<div class="standard"><a id="magicparlabel-2509"></a>Sometimes PDB files can contain alternate coordinates for the same atom in a residue, e.g.:</div>

<div class="lyx_code"><a id="magicparlabel-2510"></a><div class="lyx_code_item">ATOM    806  CA ACYS A 105       6.460 -34.012 -21.801  0.49 32.23 </div>
<div class="lyx_code_item">ATOM    807  CB ACYS A 105       6.054 -33.502 -20.415  0.49 35.28</div>
<div class="lyx_code_item">ATOM    808  CA BCYS A 105       6.468 -34.015 -21.815  0.51 32.42</div>
<div class="lyx_code_item">ATOM    809  CB BCYS A 105       6.025 -33.499 -20.452  0.51 35.38</div>
</div>
<div class="standard"><a id="magicparlabel-2514"></a>If this is the case <i>cpptraj</i>
 will print a warning about duplicate atom names but will take no other 
action. Both residues are considered 'CYS' and the mask ':CYS@CA' would 
select both atom 806 and 809. Residue insertion codes are read in but 
also not used by the mask parser.</div>
<h3 class="subsection"><a id="magicparlabel-2515"></a><span class="subsection_label">8.11</span> parmbox</h3>

<div class="lyx_code"><a id="magicparlabel-2516"></a><div class="lyx_code_item">parmbox<a id="magicparlabel-2520"></a>
 [parm &lt;name&gt; | parmindex &lt;#&gt; | &lt;#&gt;] [nobox] [truncoct]</div>
<div class="lyx_code_item">    	[x &lt;xval&gt;] [y &lt;yval&gt;] [z &lt;zval&gt;] [alpha &lt;a&gt;] [beta &lt;b&gt;] [gamma &lt;g&gt;]
<br />

</div>

<dl class="description"><a id="magicparlabel-2522"></a><dt class="description_label">[parm &lt;name&gt; | parmindex &lt;#&gt; | &lt;#&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Name/tag or index of topology to modify. Default is first loaded topology.</span></dd>
<dt class="description_label">[nobox]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Remove box information.</span></dd>
<dt class="description_label">[truncoct]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Set truncated octahedon angles with lengths equal to &lt;xval&gt;.</span></dd>
<dt class="description_label">[x &lt;xval&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Box X length.</span></dd>
<dt class="description_label">[y &lt;yval&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Box Y length.</span></dd>
<dt class="description_label">[z &lt;zval&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Box Z length.</span></dd>
<dt class="description_label">[alpha &lt;a&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Box alpha angle.</span></dd>
<dt class="description_label">[beta &lt;b&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Box beta angle.</span></dd>
<dt class="description_label">[gamma &lt;g&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Box gamma angle.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-2531"></a>Modify the box 
information for specified topology. Overwrites any box information if 
present with specified values; any that are not specified will remain 
unchanged. Note that unlike the <b><i>box</i></b> action this command 
affect box information immediately. This can be useful for e.g. removing
 box information from a parm when stripping solvent:</div>

<div class="lyx_code"><a id="magicparlabel-2532"></a><div class="lyx_code_item">parm mol.water.parm7</div>
<div class="lyx_code_item">parmstrip :WAT</div>
<div class="lyx_code_item">parmbox nobox</div>
<div class="lyx_code_item">parmwrite out strip.mol.nobox.parm7</div>
</div>
<h3 class="subsection"><a id="magicparlabel-2536"></a><span class="subsection_label">8.12</span> parminfo </h3>

<div class="lyx_code"><a id="magicparlabel-2537"></a><div class="lyx_code_item">parminfo<a id="magicparlabel-2541"></a>
 [parm &lt;name&gt; | parmindex &lt;#&gt; | &lt;#&gt;] [&lt;mask&gt;]</div>
</div>
<div class="standard"><a id="magicparlabel-2542"></a>Print a summary of information contained in the specified topology (first loaded topology by default) .</div>
<h3 class="subsection"><a id="magicparlabel-2543"></a><span class="subsection_label">8.13</span> parmstrip</h3>

<div class="lyx_code"><a id="magicparlabel-2544"></a><div class="lyx_code_item">parmstrip<a id="magicparlabel-2548"></a>
 &lt;mask&gt; [parm &lt;name&gt; | parmindex &lt;#&gt; | &lt;#&gt;]</div>
</div>
<div class="standard"><a id="magicparlabel-2549"></a>Strip atoms in <b>&lt;mask&gt;</b> from specified topology (by default the first topology loaded). Note that unlike the <em><b>strip</b></em> Action, this permanently modifies the topology for as long as <em>cpptraj</em> is running, so this should not be used if the topology is being used to read or write a trajectory via <em><b>trajin</b></em>/<em><b>trajout</b></em>.
 This command can be used to quickly created stripped Amber topology 
files. For example, to strip all residues name WAT from a topology and 
write a new topology:</div>

<div class="lyx_code"><a id="magicparlabel-2550"></a><div class="lyx_code_item">parm mol.water.parm7</div>
<div class="lyx_code_item">parmstrip :WAT</div>
<div class="lyx_code_item">parmwrite out strip.mol.parm7</div>
</div>
<h3 class="subsection"><a id="magicparlabel-2553"></a><span class="subsection_label">8.14</span> parmwrite</h3>

<div class="lyx_code"><a id="magicparlabel-2554"></a><div class="lyx_code_item">parmwrite<a id="magicparlabel-2558"></a>
 out &lt;filename&gt; [{parm &lt;name&gt; | parmindex &lt;#&gt; | &lt;#&gt; | crdset &lt;setname&gt;}]</div>
<div class="lyx_code_item">          [&lt;fmt&gt;] [nochamber]
<br />

</div>

<dl class="description"><a id="magicparlabel-2560"></a><dt class="description_label">&lt;filename&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> File to write to.</span></dd>
<dt class="description_label">[parm &lt;name&gt; | parmindex &lt;#&gt; | &lt;#&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Topology to write out.</span></dd>
<dt class="description_label">[crdset &lt;setname&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write topology from specified COORDS data set.</span></dd>
<dt class="description_label">[&lt;fmt&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Format keyword. If not specified the file name extension will be used. Default is Amber Topology.</span></dd>
<dt class="description_label">[nochamber]</dt>
<dd class="description_item"><span style="font-family:monospace;"> (Amber topology only) Remove any CHAMBER information from the topology.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-2565"></a>Write out specified topology (first topology loaded by default) to <b>&lt;filename&gt;</b> with format <b>&lt;fmt&gt;</b> (Amber topology if not specified). Note that the Amber topology format is the only fully supported format for topology writes.</div>
<h3 class="subsection"><a id="magicparlabel-2566"></a><span class="subsection_label">8.15</span> resinfo</h3>

<div class="lyx_code"><a id="magicparlabel-2567"></a><div class="lyx_code_item">resinfo<a id="magicparlabel-2571"></a>
 [parm &lt;name&gt; | parmindex &lt;#&gt; | &lt;#&gt;] [&lt;mask&gt;] [short]</div>
</div>
<div class="standard"><a id="magicparlabel-2572"></a>Print residue information for atoms in &lt;mask&gt; for selected topology (first loaded topology by default) with format:</div>

<div class="lyx_code"><a id="magicparlabel-2573"></a><div class="lyx_code_item">#Res  Name First  Last Natom #Orig #Mol</div>
</div>
<div class="standard"><a id="magicparlabel-2574"></a>where <span style="font-family:monospace;">#Res</span> is the residue number, <span style="font-family:monospace;">Name</span> is the residue name, <span style="font-family:monospace;">First</span> and <span style="font-family:monospace;">Last</span> are the first and last atom numbers of the residue, <span style="font-family:monospace;">Natom</span> is the total number of atoms in the residue, <span style="font-family:monospace;">#Orig</span> is the original residue number (in PDB files), and #Mol is the molecule number.</div>

<div class="standard"><a id="magicparlabel-2575"></a>If short is 
specified then residues will be printed out in a condensed format. Each 
residue name will be shortened to 1 character, and residues are printed 
out in groups of 10, 5 groups to a line, with each line beginning with a
 residue number, e.g.</div>

<div class="lyx_code"><a id="magicparlabel-2576"></a><div class="lyx_code_item">&gt; resinfo short 4 </div>
<div class="lyx_code_item">1        MGFLAGKKIL ITGLLSNKSI AYGIAKAMHR EGAELAFTYV GQFKDRVEKL </div>
<div class="lyx_code_item">51       CAEFNPAAVL PCDVISDQEI KDLFVELGKV WDGLDAIVHS IAFAPRDQLE </div>
</div>
<div class="standard"><a id="magicparlabel-2579"></a>If the 1 character name for a residue is unknown it will be shown as the first letter of the residue name in lower-case.</div>
<h3 class="subsection"><a id="magicparlabel-2580"></a><span class="subsection_label">8.16</span> scaledihedralk</h3>

<div class="lyx_code"><a id="magicparlabel-2581"></a><div class="lyx_code_item">scaledihedralk [parm &lt;name&gt; | parmindex &lt;#&gt;] &lt;scale factor&gt; [&lt;mask&gt; [useall]]</div>
</div>
<div class="standard"><a id="magicparlabel-2582"></a>Scale dihedral force constants for dihderals selected by &lt;mask&gt; for specified topology. If <b>useall</b>
 is specified all atoms in &lt;mask&gt; must be present to select a 
dihedral, otherwise any atom in &lt;mask&gt; will selected a dihedral.</div>
<h3 class="subsection"><a id="magicparlabel-2583"></a><span class="subsection_label">8.17</span> solvent<a id="subsec_cpptraj_solvent"></a>
</h3>

<div class="lyx_code"><a id="magicparlabel-2584"></a><div class="lyx_code_item">solvent [parm &lt;name&gt; | parmindex &lt;#&gt; | &lt;#&gt;] { &lt;mask&gt; | none }</div>
</div>
<div class="standard"><a id="magicparlabel-2585"></a>Set solvent for selected topology (first loaded topology by default) based on <b>&lt;mask&gt;</b>, or set nothing as solvent if <b>none</b> is specified.</div>
<h2 class="section"><a id="magicparlabel-2586"></a><span class="section_label">9</span> Trajectory File Commands</h2>
<div class="standard"><a id="magicparlabel-2587"></a>These commands control the reading and writing of trajectory files. There are three trajectory types in <i>cpptraj</i>: input, output, and reference. In <i>cpptraj</i>,
 trajectories are always associated with a topology file. If a topology 
file is not specified, a trajectory file will be associated with the 
first topology file loaded by default (this is true for both input and 
output trajectories.</div>

<div class="standard"><a id="magicparlabel-2588"></a>Cpptraj currently understands the following trajectory file formats:
<br />

</div>



<div class="standard" style="text-align: center;"><a id="magicparlabel-2589"></a><table><tbody><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2672"></a><b>Format</b></div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2675"></a><b>Keyword(s)</b></div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2678"></a><b>Extension</b></div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2681"></a><b>Notes</b></div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2684"></a>Amber Trajectory</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2687"></a>crd</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2690"></a>.crd</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2693"></a>Default format if keywords/extensions not recognized.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2696"></a>Amber NetCDF</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2699"></a>cdf, netcdf</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2702"></a>.nc</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2705"></a>No compression.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2708"></a>Amber Restart</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2711"></a>restart</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2714"></a>.rst7</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2720"></a>Amber NetCDF Restart</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2723"></a>ncrestart, restartnc</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2726"></a>.ncrst</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2732"></a>Charmm DCD</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2735"></a>dcd, charmm</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2738"></a>.dcd</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2744"></a>Charmm COR</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2747"></a>cor</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2750"></a>.cor</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2753"></a>Read Only</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2756"></a>PDB</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2759"></a>pdb</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2762"></a>.pdb</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2768"></a>Mol2</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2771"></a>mol2</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2774"></a>.mol2</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2780"></a>Scripps Binpos</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2783"></a>binpos</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2786"></a>.binpos</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2792"></a>Gromacs TRR</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2795"></a>trr</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2798"></a>.trr</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2804"></a>Gromacs GRO</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2807"></a>gro</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2810"></a>.gro</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2813"></a>Read Only</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2816"></a>Gromacs XTC</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2819"></a>xtc</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2822"></a>.xtc</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2828"></a>CIF</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2831"></a>cif</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2834"></a>.cif</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2837"></a>Read Only</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2840"></a>Tinker ARC</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2843"></a>arc</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2846"></a>.arc</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2849"></a>Read Only</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2852"></a>SQM Input</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2855"></a>sqm</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2858"></a>.sqm</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2861"></a>Write Only</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2864"></a>SDF</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2867"></a>sdf</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2870"></a>.sdf</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2873"></a>Read Only</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2876"></a>LMOD Conflib</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2879"></a>conflib</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2882"></a>.conflib</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2885"></a>Read Only, Detection by extension</div>
</td>
</tr></tbody>
</table>
<a id="tab_cpptraj_trajformats"></a>
</div>

<div class="standard"><a id="magicparlabel-2886"></a>The following trajectory-related commands are available:
<br />

</div>



<div class="standard" style="text-align: center;"><a id="magicparlabel-2887"></a><table><tbody><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2908"></a><b>Command</b></div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2911"></a><b>Description</b></div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2914"></a>ensemble</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2917"></a>Set up a trajectory ensemble for reading during a run.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2920"></a>ensemblesize</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2923"></a>(MPI only) specify number of members expected in subsequent <em><b>ensemble</b></em> commands.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2926"></a>reference</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2929"></a>Read in a reference structure.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2932"></a>trajin</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2935"></a>Set up a trajectory for reading during a Run.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2938"></a>trajout</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-2941"></a>Set up an output trajectory or ensemble for writing during a Run.</div>
</td>
</tr></tbody>
</table>
</div>
<h3 class="subsection"><a id="magicparlabel-2942"></a><span class="subsection_label">9.1</span> ensemble</h3>

<div class="lyx_code"><a id="magicparlabel-2943"></a><div class="lyx_code_item">ensemble &lt;file0&gt; {[&lt;start&gt;] [&lt;stop&gt; | last] [offset]} | lastframe</div>
<div class="lyx_code_item">         [parm &lt;parmfile / tag&gt; | parmindex &lt;#&gt;]</div>
<div class="lyx_code_item">         [trajnames &lt;file1&gt;,&lt;file2&gt;,...,&lt;fileN&gt;</div>
<div class="lyx_code_item">         [remlog &lt;remlogfile&gt; [nstlim &lt;nstlim&gt; ntwx &lt;ntwx&gt;]]
<br />

</div>

<dl class="description"><a id="magicparlabel-2947"></a><dt class="description_label">&lt;file0&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Lowest replica filename.</span></dd>
<dt class="description_label">[&lt;start&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Frame to begin reading ensemble at (default 1).</span></dd>
<dt class="description_label">[&lt;stop&gt; | last]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Frame to stop reading ensemble at; if not specified or 'last' specified, end of trajectories.</span></dd>
<dt class="description_label">[&lt;offset&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Offset for reading in trajectory frames (default 1).</span></dd>
<dt class="description_label">[lastframe]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Select only the final frame of the trajectories.</span></dd>
<dt class="description_label">[parm &lt;parmfile&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Topology filename/tag to associate with trajectories (default first topology).</span></dd>
<dt class="description_label">[parmindex &lt;#&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Index of Topology to associate with trajectories (default 0, first topology).</span></dd>
<dt class="description_label">[trajnames &lt;file1&gt;,...,&lt;fileN&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Do not automatically search for additional replica trajectories; use comma-separated list of trajectory names.</span></dd>
<dt class="description_label">[remlog &lt;remlogfile&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> For H-REMD trajectories only, use specified REMD log file to sort trajectories by coordinate index (instead of by Hamiltonian).
<br />

</span>

<dl class="description"><a id="magicparlabel-2956"></a><dt class="description_label">[nstlim &lt;nstlim&gt; ntwx &lt;ntwx&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> If 
trajectory and REMD log were not written at the same rate, these are the
 values for nstlim (steps between each exchange) and ntwx (steps between
 trajectory write) used in the REMD simulation.</span></dd>
</dl>
</dd></dl>
</div>
<div class="standard"><a id="magicparlabel-2957"></a>Read in and process trajectories as an ensemble. Similar to '<b><i>trajin</i></b>
 remdtraj', except instead of processing one frame at a target 
temperature, process all frames. This means that action and trajout 
commands apply to the entire ensemble; note however that not all actions
 currently function in <b><i>'ensemble'</i></b> mode. For example, to 
read in a replica ensemble, convert it to temperature trajectories, and 
calculate a distance at each temperature:</div>

<div class="lyx_code"><a id="magicparlabel-2958"></a><div class="lyx_code_item">parm ala2.99sb.mbondi2.parm7</div>
<div class="lyx_code_item">ensemble rem.crd.000 trajnames rem.crd.001,rem.crd.002,rem.crd.003  </div>
<div class="lyx_code_item">trajout temp.crd</div>
<div class="lyx_code_item">distance d1 out d1.ensemble.dat @1 @21</div>
</div>
<div class="standard"><a id="magicparlabel-2962"></a>This will output 4 
temperature trajectories named 'temp.crd.X', where X ranges from 0 to 3 
with 0 corresponding to the lowest temperature, and 'd1.ensemble.dat' 
containing 4 columns, each corresponding to a temperature. If run with 
MPI, data will be written to separate files named 'd1.ensemble.dat.X', 
similar to the output trajectories.</div>

<div class="standard"><a id="magicparlabel-2963"></a>Note that in parallel (i.e. MPI) users should specify the <em><b>ensemblesize</b></em> command prior to <em><b>ensemble</b></em> in order to improve set up efficiency.</div>
<h3 class="subsection"><a id="magicparlabel-2964"></a><span class="subsection_label">9.2</span> ensemblesize</h3>

<div class="lyx_code"><a id="magicparlabel-2965"></a><div class="lyx_code_item">ensemblesize &lt;#&gt;</div>
</div>
<div class="standard"><a id="magicparlabel-2966"></a>This command is MPI only. It is used to set the expected number of members in any subsequent <em><b>ensemble</b></em> command, which dramatically improves set up efficiency.</div>
<h3 class="subsection"><a id="magicparlabel-2967"></a><span class="subsection_label">9.3</span> reference<a id="subsec_cpptraj_reference"></a>
</h3>

<div class="lyx_code"><a id="magicparlabel-2968"></a><div class="lyx_code_item">reference<a id="magicparlabel-2972"></a>
 &lt;name&gt; [&lt;frame#&gt;] [&lt;mask&gt;] ([tag]) [lastframe] [crdset]</div>
<div class="lyx_code_item">          [parm &lt;parmfile / tag&gt; | parmindex &lt;#&gt;]
<br />

</div>

<dl class="description"><a id="magicparlabel-2974"></a><dt class="description_label">&lt;name&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> File 
name (or COORDS set name if 'crdset' specified) to read in as reference;
 any trajectory recognized by 'trajin' can be used.</span></dd>
<dt class="description_label">[&lt;frame#&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Frame number to use (default 1).</span></dd>
<dt class="description_label">[&lt;mask&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Only load atoms corresponding to &lt;mask&gt; from reference.</span></dd>
<dt class="description_label">([tag])</dt>
<dd class="description_item"><span style="font-family:monospace;"> Tag to give this reference file, e.g. “[MyRef]”; BRACKETS MUST BE INCLUDED.</span></dd>
<dt class="description_label">[lastframe]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use last frame of reference.</span></dd>
<dt class="description_label">[crdset]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use for COORDS data set named &lt;name&gt; instead of file.</span></dd>
<dt class="description_label">[parm &lt;parmfile/tag&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Topology filename/tag to associate with reference (default first topology).</span></dd>
<dt class="description_label">[parmindex &lt;#&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Index of Topology to associate with reference (default 0, first topology).</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-2982"></a>Use specified 
trajectory as reference coordinates. For trajectories with multiple 
frames, the first frame is used if a specific frame is not specified. An
 optional tag can be given (bounded in brackets) which can then be used 
in place of the name (see <a href="#subsec_Parameter_Reference_Tagging">2.4</a> for examples of how to use tags). If desired, an atom mask can be used to read in only specified atoms from a reference.</div>

<div class="standard"><a id="magicparlabel-2983"></a>Reference 
coordinates are now considered COORDS data sets and can be used anywhere
 a COORDS data set could, which allows reference structures to be 
manipulated once they are loaded. For example, a reference structure 
could be centered on the origin like so:</div>

<div class="lyx_code"><a id="magicparlabel-2984"></a><div class="lyx_code_item">reference tz2.rst7 [MyRef]</div>
<div class="lyx_code_item">crdaction [MyRef] center origin</div>
</div>
<div class="standard"><a id="magicparlabel-2986"></a>Note that the 
'average' keyword has been deprecated for reference. If desired, an 
averaged reference COORDS data set can be created from a trajectory 
using the 'average' command like so:</div>

<div class="lyx_code"><a id="magicparlabel-2987"></a><div class="lyx_code_item">parm myparm.parm7</div>
<div class="lyx_code_item">trajin mytraj.nc</div>
<div class="lyx_code_item">rms first :1-12</div>
<div class="lyx_code_item">average crdset RefAvg</div>
<div class="lyx_code_item">run</div>
<div class="lyx_code_item">rms ToAvg reference :1-12 out ToAvg.dat</div>
</div>
<h3 class="subsection"><a id="magicparlabel-2993"></a><span class="subsection_label">9.4</span> trajin <a id="subsec_cpptraj_trajin"></a>
</h3>

<div class="lyx_code"><a id="magicparlabel-2994"></a><div class="lyx_code_item">trajin<a id="magicparlabel-2998"></a>
 &lt;filename&gt; {[&lt;start&gt; [&lt;stop&gt; | last] [&lt;offset&gt;]]} | lastframe</div>
<div class="lyx_code_item">       [parm &lt;parmfile / tag&gt; | parmindex &lt;#&gt;]</div>
<div class="lyx_code_item">       [mdvel &lt;velocities&gt;] [mdfrc &lt;forces&gt;]</div>
<div class="lyx_code_item">       [ &lt;Format Options&gt; ]</div>
<div class="lyx_code_item">       [ remdtraj {remdtrajtemp &lt;Temperature&gt; | remdtrajidx &lt;idx1,idx2,...&gt; </div>
<div class="lyx_code_item">                   | remdtrajvalues &lt;value1,value2,...&gt;}</div>
<div class="lyx_code_item">                  [trajnames &lt;file1&gt;,&lt;file2&gt;,...,&lt;fileN&gt;] ]
<br />

</div>

<dl class="description"><a id="magicparlabel-3005"></a><dt class="description_label">&lt;filename&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Trajectory file to read in.</span></dd>
<dt class="description_label">[&lt;start&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Frame to begin reading at (default 1).</span></dd>
<dt class="description_label">[&lt;stop&gt; | last]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Frame to stop reading at; if not specified or 'last' specified, end of trajectory.</span></dd>
<dt class="description_label">[&lt;offset&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Offset for reading in trajectory frames (default 1).</span></dd>
<dt class="description_label">[lastframe]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Select only the final frame of the trajectory.</span></dd>
<dt class="description_label">[parm &lt;parmfile/tag&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Topology filename/tag to associate with trajectory (default first topology).</span></dd>
<dt class="description_label">[parmindex &lt;#&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Index of Topology to associate with trajectory (default 0, first topology).</span></dd>
<dt class="description_label">[mdvel &lt;velocities&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use velocities from specified file.</span></dd>
<dt class="description_label">[mdfrc &lt;forces&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use forces from specified file.</span></dd>
<dt class="description_label">[&lt;Format Options&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> See below.</span></dd>
<dt class="description_label">[remdtraj]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Read &lt;filename&gt; as the first replica in a group of replica trajectories.
<br />

</span>

<dl class="description"><a id="magicparlabel-3016"></a><dt class="description_label">remdtrajtemp &lt;Temperature&gt; | remdtrajidx &lt;idx1,idx2,...&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use 
frames at &lt;Temperature&gt; (for temperature replica trajectories) or 
index &lt;idx1,idx2,...&gt; (for Hamiltonian replica trajectories); For 
Multidimensional REMD simulations, multiple values are comma-separated.</span></dd>
<dt class="description_label">remdtrajvalues &lt;value1,value2,...&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use 
frames at &lt;value1,value2,...&gt; (for Multidimensional REMD 
trajectories). Each value may correspond to either temperature, pH, 
Redox Potential or Hamiltonian index. The values need to be entered in 
the same order as the dimensions in the Multidimensional REMD 
simulation. For example, for T,pH-REMD value1 would correspond to a 
temperature and value2 to a pH. In the command, the values are 
comma-separated.</span></dd>
<dt class="description_label">[trajnames &lt;file1&gt;,...,&lt;fileN&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Do not automatically search for additional replica trajectories; use comma-separated list of trajectory names.</span></dd>
</dl>
</dd></dl>
</div>
<div class="standard"><a id="magicparlabel-3019"></a>Read in trajectory specified by filename. See page <a href="#tab_cpptraj_trajformats">elsewhere</a>
 for currently recognized trajectory file formats. If just the 
&lt;start&gt; argument is given, all frames from &lt;start&gt; to the 
last frame of the trajectory will be read. To read in a trajectory with 
offsets where the last frame # is not known, specify the <b>last</b> keyword instead of a &lt;stop&gt; argument, e.g.</div>

<div class="lyx_code"><a id="magicparlabel-3020"></a><div class="lyx_code_item">trajin Test1.crd 10 last 2</div>
</div>
<div class="standard"><a id="magicparlabel-3021"></a>This will process 
Test1.crd from frame 10 to the last frame, skipping by 2 frames. To 
explicitly select only the last frame, specify the <b>lastframe</b> keyword:</div>

<div class="lyx_code"><a id="magicparlabel-3022"></a><div class="lyx_code_item">trajin Test1.crd lastframe</div>
</div>
<div class="standard"><a id="magicparlabel-3023"></a>Here is an example of loading in multiple trajectories which have difference topology files:</div>

<div class="lyx_code"><a id="magicparlabel-3024"></a><div class="lyx_code_item">parm top0.parm7</div>
<div class="lyx_code_item">parm top1.parm7</div>
<div class="lyx_code_item">parm top2.parm7 [top2]</div>
<div class="lyx_code_item">parm top3.parm7</div>
<div class="lyx_code_item">trajin Test0.crd</div>
<div class="lyx_code_item">trajin Test1.crd parm top1.parm7</div>
<div class="lyx_code_item">trajin Test2.crd parm [top2]</div>
<div class="lyx_code_item">trajin Test3.crd parmindex 3</div>
</div>
<div class="standard"><a id="magicparlabel-3032"></a>Test0.crd is 
associated with top0.parm7; since no parm was specified it defaulted to 
the first parm read in. Test1.crd was associated with top1.parm7 by 
filename, Test2.crd was associated with top2.parm7 by its tag, and 
finally Test3.crd was associated with top3.parm7 by its index (based on 
the order it was read in).</div>
<h4 class="subsubsection_"><a id="magicparlabel-3033"></a>Replica Trajectory Processing</h4>
<div class="standard"><a id="magicparlabel-3034"></a>If the <b>remdtraj</b>
 keyword is specified the trajectory is treated as belonging to the 
lowest # replica of a group of REMD trajectories. The remaining replicas
 can be either automatically detected by following a naming convention 
of &lt;REMDFILENAME&gt;.X, where X is the replica number, or explicitly 
specified in a comma-separated list following the <b>trajnames</b> keyword. All trajectories will be processed at the same time, but only frames with a temperature matching the one specified by <b>remdtrajtemp</b> or <b>remdtrajidx</b>
 will be processed. For example, to process replica trajectories 
rem.001, rem.002, rem.003, and rem.004, grabbing only the frames at 
temperature 300.0 (assuming that this is a temperature in the ensemble):</div>

<div class="lyx_code"><a id="magicparlabel-3035"></a><div class="lyx_code_item">trajin rem.001 remdtraj remdtrajtemp 300</div>
</div>
<div class="standard"><a id="magicparlabel-3036"></a>or</div>

<div class="lyx_code"><a id="magicparlabel-3037"></a><div class="lyx_code_item">trajin rem.001 remdtraj remdtrajtemp 300 trajnames rem.002,rem.003,rem.004</div>
</div>
<div class="standard"><a id="magicparlabel-3038"></a>Note that the <b>remdout</b> keyword is deprecated. For this functionality see the <b>ensemble</b> keyword.</div>
<h4 class="subsubsection"><a id="magicparlabel-3039"></a><span class="subsubsection_label">9.4.1</span> <em>Options for Amber NetCDF, Amber NC Restart, Amber Restart:</em></h4>

<div class="lyx_code"><a id="magicparlabel-3040"></a><div class="lyx_code_item">  [usevelascoords] [usefrcascoords]
<br />

</div>

<dl class="description"><a id="magicparlabel-3041"></a><dt class="description_label">usevelascoords</dt>
<dd class="description_item"><span style="font-family:monospace;"> Read in velocities in place of coordinates if present.</span></dd>
<dt class="description_label">usefrcascoords</dt>
<dd class="description_item"><span style="font-family:monospace;"> Read in forces in place of coordinates if present.</span></dd>
</dl>
</div>
<h4 class="subsubsection"><a id="magicparlabel-3043"></a><span class="subsubsection_label">9.4.2</span> <em>Options for CHARMM DCD:</em></h4>

<div class="lyx_code"><a id="magicparlabel-3044"></a><div class="lyx_code_item">[{ucell | shape}]</div>

<dl class="description"><a id="magicparlabel-3045"></a><dt class="description_label">ucell</dt>
<dd class="description_item"><span style="font-family:monospace;"> Force reading of box information as unit cell (for e.g. NAMD DCD trajectories).</span></dd>
<dt class="description_label">shape</dt>
<dd class="description_item"><span style="font-family:monospace;"> Force reading of box information as shape matrix.</span></dd>
</dl>
</div>
<h3 class="subsection"><a id="magicparlabel-3047"></a><span class="subsection_label">9.5</span> trajout<a id="subsec_cpptraj_trajout"></a>
</h3>

<div class="lyx_code"><a id="magicparlabel-3048"></a><div class="lyx_code_item">trajout<a id="magicparlabel-3052"></a>
 &lt;filename&gt; [&lt;format&gt;] [append] [nobox] [novelocity]</div>
<div class="lyx_code_item">        [notemperature] [notime] [noforce] [noreplicadim]</div>
<div class="lyx_code_item">        [parm &lt;parmfile&gt; | parmindex &lt;#&gt;] [onlyframes &lt;range&gt;] [title &lt;title&gt;]</div>
<div class="lyx_code_item">        [onlymembers &lt;memberlist&gt;]</div>
<div class="lyx_code_item">        [start &lt;start&gt;] [stop &lt;stop&gt;] [offset &lt;offset&gt;]</div>
<div class="lyx_code_item">        [ &lt;Format Options&gt; ]
<br />

</div>

<dl class="description"><a id="magicparlabel-3058"></a><dt class="description_label">&lt;filename&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Trajectory file to write to.</span></dd>
<dt class="description_label">[&lt;format&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Keyword specifying output format (see Table <a href="#tab_cpptraj_trajformats">elsewhere</a>). If not specified format will be determined from extension, otherwise default to Amber trajectory.</span></dd>
<dt class="description_label">[append]</dt>
<dd class="description_item"><span style="font-family:monospace;"> If &lt;filename&gt; exists, frames will be appended to &lt;filename&gt;.</span></dd>
<dt class="description_label">[nobox]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Do not write box coordinates to trajectory.</span></dd>
<dt class="description_label">[novelocity]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Do not write velocities to trajectory.</span></dd>
<dt class="description_label">[notemperature]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Do not write temperature to trajectory.</span></dd>
<dt class="description_label">[notime]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Do not write time to trajectory.</span></dd>
<dt class="description_label">[noreplicadim]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Do not write replica dimensions to trajectory.</span></dd>
<dt class="description_label">[parm &lt;parmfile&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Topology filename/tag to associate with trajectory (default first topology).</span></dd>
<dt class="description_label">[parmindex &lt;#&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Index of Topology to associate with trajectory (default 0, first topology).</span></dd>
<dt class="description_label">[onlyframes &lt;range&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write only the specified input frames to &lt;filename&gt;.</span></dd>
<dt class="description_label">[title &lt;title&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output trajectory title.</span></dd>
<dt class="description_label">[onlymembers &lt;memberlist&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Ensemble processing only; only write from specified members (starting from 0).</span></dd>
<dt class="description_label">[start &lt;start&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Begin output at frame &lt;start&gt; (1 by default).</span></dd>
<dt class="description_label">[stop &lt;stop&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> End output at frame &lt;stop&gt; (last frame by default).</span></dd>
<dt class="description_label">[offset &lt;offset&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Skip &lt;offset&gt; frames between each output (1 by default).</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-3074"></a>During a run, write
 frames to trajectory specified by filename in specified file format 
(Amber trajectory if none specified) after all Action processing has 
occurred. To write out trajectories within the Action queue see the 
outtraj Action (<a href="#subsec_cpptraj_outtraj">10.52</a>). See page <a href="#tab_cpptraj_trajformats">elsewhere</a>
 for currently recognized output trajectory formats and their associated
 keyword(s). Note that now the file type can be determined from the 
output extension if not specified by a keyword. Multiple output 
trajectories of any format can be specified. </div>

<div class="standard"><a id="magicparlabel-3075"></a><b>Frames will be 
written to the output trajectory when the parameter file being processed
 matches the parameter file the output trajectory was set up with.</b> So given the input:</div>

<div class="lyx_code"><a id="magicparlabel-3076"></a><div class="lyx_code_item">parm top0.parm7</div>
<div class="lyx_code_item">parm top1.parm7 [top1]</div>
<div class="lyx_code_item">trajin input0.crd</div>
<div class="lyx_code_item">trajin input1.crd parm [top1]</div>
<div class="lyx_code_item">trajout output.crd parm [top1]</div>
</div>
<div class="standard"><a id="magicparlabel-3081"></a>only frames read in
 from input1.crd (which is associated with top1.parm7) will be written 
to output.crd. The trajectory input0.crd is associated with top0.parm7; 
since no output trajectory is associated with top0.parm7 no frames will 
be written when processing top0.parm7/input0.crd.</div>

<div class="standard"><a id="magicparlabel-3082"></a>If <b>onlyframes</b> is specified, only input frames matching the specified range will be written out. For example, given the input:</div>

<div class="lyx_code"><a id="magicparlabel-3083"></a><div class="lyx_code_item">trajin input.crd 1 10</div>
<div class="lyx_code_item">trajout output.crd onlyframes 2,5-7</div>
</div>
<div class="standard"><a id="magicparlabel-3085"></a>only frames 2, 5, 6, and 7 from input.crd will be written to output.crd.</div>
<h4 class="subsubsection"><a id="magicparlabel-3086"></a><span class="subsubsection_label">9.5.1</span> <i>Options for pdb format:</i></h4>

<div class="lyx_code"><a id="magicparlabel-3087"></a><div class="lyx_code_item">  [model | multi] [dumpq | parse | vdw] [chainid &lt;ID&gt;]</div>
<div class="lyx_code_item">  [pdbres] [pdbatom] [pdbv3] [teradvance]
<br />

</div>

<dl class="description"><a id="magicparlabel-3089"></a><dt class="description_label">model</dt>
<dd class="description_item"><span style="font-family:monospace;"> (Default) Frames will be written to a single PDB file separated by MODEL/ENDMDL keywords.</span></dd>
<dt class="description_label">multi</dt>
<dd class="description_item"><span style="font-family:monospace;"> Each frame will be written to a separate file with the frame # appended to &lt;filename&gt;.</span></dd>
<dt class="description_label">dumpq</dt>
<dd class="description_item"><span style="font-family:monospace;"> PQR format; write charges (in units of e-) and GB radii to occupancy and B-factor columns respectively.</span></dd>
<dt class="description_label">parse</dt>
<dd class="description_item"><span style="font-family:monospace;"> PQR format; write charges and PARSE radii to occupancy/B-factor columns.</span></dd>
<dt class="description_label">vdw</dt>
<dd class="description_item"><span style="font-family:monospace;"> PQR format; write charges and vdW radii to occupancy/B-factor columns.</span></dd>
<dt class="description_label">pdbres:</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use PDB V3 residue names.</span></dd>
<dt class="description_label">pdbatom:</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use PDB V3 atom names.</span></dd>
<dt class="description_label">pdbv3:</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use PDB V3 residue/atom names.</span></dd>
<dt class="description_label">teradvance:</dt>
<dd class="description_item"><span style="font-family:monospace;"> Increment record (atom) number for TER records (not done by default).</span></dd>
<dt class="description_label">terbyres:</dt>
<dd class="description_item"><span style="font-family:monospace;"> Print TER cards based on residue sequence instead of molecules.</span></dd>
<dt class="description_label">pdbter:</dt>
<dd class="description_item"><span style="font-family:monospace;"> Print TER cards according to original PDB TER (if available).</span></dd>
<dt class="description_label">noter:</dt>
<dd class="description_item"><span style="font-family:monospace;"> Do not write TER cards.</span></dd>
<dt class="description_label">chainid &lt;ID&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write PDB file with chain ID &lt;ID&gt;.</span></dd>
<dt class="description_label">sg &lt;group&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Space group for CRYST1 record; only used if box coordinates written.</span></dd>
<dt class="description_label">include_ep</dt>
<dd class="description_item"><span style="font-family:monospace;"> Include extra points.</span></dd>
<dt class="description_label">conect</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write CONECT records for all bonds.</span></dd>
<dt class="description_label">keepext</dt>
<dd class="description_item"><span style="font-family:monospace;"> Keep filename extension; write '&lt;name&gt;.&lt;num&gt;.&lt;ext&gt;' instead (implies 'multi'). </span></dd>
</dl>
</div>
<h4 class="subsubsection"><a id="magicparlabel-3106"></a><span class="subsubsection_label">9.5.2</span> <i>Options for Amber ASCII format:</i></h4>

<div class="lyx_code"><a id="magicparlabel-3107"></a><div class="lyx_code_item">  [remdtraj] [highprecision]
<br />

</div>

<dl class="description"><a id="magicparlabel-3108"></a><dt class="description_label">remdtraj</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write
 REMD header to trajectory that includes temperature: 'REMD 
&lt;Replica&gt; &lt;Step&gt; &lt;Total_Steps&gt; &lt;Temperature&gt;'. 
Since <i>cpptraj</i> has no concept of replica number, 0 is printed for 
&lt;Replica&gt;. &lt;Step&gt; and &lt;Total_Steps&gt; are set to the 
current frame #.</span></dd>
<dt class="description_label">highprecision:</dt>
<dd class="description_item"><span style="font-family:monospace;"> 
(EXPERT USE ONLY) Write with 8.6 precision instead of 8.3. Note that 
since the width does not change, the precision of large coords may be 
lower than 6.</span></dd>
</dl>
</div>
<h4 class="subsubsection"><a id="magicparlabel-3110"></a><span class="subsubsection_label">9.5.3</span> <i>Options for Amber NetCDF format:</i></h4>

<div class="lyx_code"><a id="magicparlabel-3111"></a><div class="lyx_code_item">  [remdtraj] [velocity] [force]
<br />

</div>

<dl class="description"><a id="magicparlabel-3112"></a><dt class="description_label">remdtraj</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write replica temperature to trajectory.</span></dd>
<dt class="description_label">velocity</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write only velocity information in trajectory.</span></dd>
<dt class="description_label">force</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write only force information in trajectory.</span></dd>
<dt class="description_label">mdcrd</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write coordinates to trajectory (only required with mdvel/mdfrc).</span></dd>
</dl>
</div>
<h4 class="subsubsection"><a id="magicparlabel-3116"></a><span class="subsubsection_label">9.5.4</span> <i>Options for Amber Restart/NetCDF Restart format:</i></h4>

<div class="lyx_code"><a id="magicparlabel-3117"></a><div class="lyx_code_item">  [remdtraj] [novelocity] [notime] [time0 &lt;initial time&gt;] [dt &lt;timestep&gt;]
<br />

</div>

<dl class="description"><a id="magicparlabel-3118"></a><dt class="description_label">remdtraj</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write replica temperature to restart. Note that this will automatically include time in the restart file (see the <b>time0</b> keyword).</span></dd>
<dt class="description_label">time0 &lt;initial time&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Time for first frame (default 1.0).</span></dd>
<dt class="description_label">dt &lt;timestep&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Time step between frames (default 1.0). Time is calculated as t=(time0+frame)*dt.</span></dd>
<dt class="description_label">keepext</dt>
<dd class="description_item"><span style="font-family:monospace;"> Keep filename extension; write '&lt;name&gt;.&lt;num&gt;.&lt;ext&gt;' instead.</span></dd>
</dl>
</div>
<h4 class="subsubsection"><a id="magicparlabel-3122"></a><span class="subsubsection_label">9.5.5</span> <em>Options for CHARMM DCD:</em></h4>

<div class="lyx_code"><a id="magicparlabel-3123"></a><div class="lyx_code_item">[x64] [ucell]</div>

<dl class="description"><a id="magicparlabel-3124"></a><dt class="description_label">x64</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use 8 byte block size (default 4 bytes).</span></dd>
<dt class="description_label">ucell</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write older (v21) format trajectory that stores unit cell params instead of shape matrix.</span></dd>
</dl>
</div>
<h4 class="subsubsection"><a id="magicparlabel-3126"></a><span class="subsubsection_label">9.5.6</span> <em>Options for GROMACS TRX/XTC format:</em></h4>

<div class="lyx_code"><a id="magicparlabel-3127"></a><div class="lyx_code_item">[dt &lt;time step&gt;]</div>

<dl class="description"><a id="magicparlabel-3128"></a><dt class="description_label">dt</dt>
<dd class="description_item"><span style="font-family:monospace;"> Time step tp multiply set numbers by (default 1.0). Ignored if time already present.</span></dd>
</dl>
</div>
<h4 class="subsubsection"><a id="magicparlabel-3129"></a><span class="subsubsection_label">9.5.7</span> <i>Options for mol2 format:</i></h4>

<div class="lyx_code"><a id="magicparlabel-3130"></a><div class="lyx_code_item">  [single | multi] [sybyltype] [keepext]
<br />

</div>

<dl class="description"><a id="magicparlabel-3131"></a><dt class="description_label">single</dt>
<dd class="description_item"><span style="font-family:monospace;"> (Default) Frames will be written to a single Mol2 file separated by MOLECULE keywords.</span></dd>
<dt class="description_label">multi</dt>
<dd class="description_item"><span style="font-family:monospace;"> Each frame will be written to a separate file with the frame # appended to &lt;filename&gt;.</span></dd>
<dt class="description_label">sybyltype</dt>
<dd class="description_item"><span style="font-family:monospace;"> Convert Amber atom types (if present) to SYBYL types. Requires $AMBERHOME is set.</span></dd>
<dt class="description_label">sybylatom</dt>
<dd class="description_item"><span style="font-family:monospace;"> File containing Amber to SYBYL atom type correspondance (optional).</span></dd>
<dt class="description_label">sybylbond</dt>
<dd class="description_item"><span style="font-family:monospace;"> File containing Amber to SYBYL bond type correspondance (optional).</span></dd>
<dt class="description_label">keepext</dt>
<dd class="description_item"><span style="font-family:monospace;"> Keep filename extension; write '&lt;name&gt;.&lt;num&gt;.&lt;ext&gt;' instead (implies 'multi').</span></dd>
</dl>
</div>
<h4 class="subsubsection"><a id="magicparlabel-3137"></a><span class="subsubsection_label">9.5.8</span> Options for SQM input format:</h4>

<div class="lyx_code"><a id="magicparlabel-3138"></a><div class="lyx_code_item">  [charge &lt;c&gt;]
<br />

</div>

<dl class="description"><a id="magicparlabel-3139"></a><dt class="description_label">charge &lt;c&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Set total integer charge. If not specified it will be calculated from atomic charges.</span></dd>
</dl>
</div>
<h2 class="section"><a id="magicparlabel-3140"></a><span class="section_label">10</span> Action Commands<a id="sec_cpptraj_actions"></a>
</h2>
<div class="standard"><a id="magicparlabel-3141"></a>Actions in <em>cpptraj</em> operate on frames read in by the <em><b>trajin</b></em> or <em><b>ensemble</b></em> commands one at a time and extract derived data, modify the coordinates/topology in some way, or both. Most Actions in <i>cpptraj</i> function exactly the way they do in <i>ptraj</i> and are backwards-compatible. Some Action commands in <em>cpptraj</em> have extra functionality compared to <em>ptraj</em> (such as the per-residue RMSD function of the <em><b>rmsd</b></em> Action, or the ability to write out stripped topologies for visualization in the <em><b>strip</b></em> Action), while other Actions produce slightly different output (like the <em><b>hbond</b></em>/<em><b>secstruct</b></em> Actions).</div>

<div class="standard"><a id="magicparlabel-3142"></a>Unlike some other 
command types, when an Action command is issued it is by default added 
to the Action queue and is not executed until trajectory processing is 
started (e.g. by a <em><b>run</b></em> or <em><b>go</b></em> command). However, Actions can be executed immediately on COORDS data sets via the <em><b>crdaction</b></em> command (<a href="#subsec_cpptraj_crdaction">6.2</a>).</div>

<div class="standard"><a id="magicparlabel-3143"></a>When a frame is 
modified by an Action, it is modified for every Action that follows them
 during trajectory processing. For example, given a solvated system with
 water residues named WAT and the following Action commands:</div>

<div class="lyx_code"><a id="magicparlabel-3144"></a><div class="lyx_code_item">rmsd R1 first :WAT out water-rmsd.dat</div>
<div class="lyx_code_item">strip :WAT</div>
<div class="lyx_code_item">rmsd R2 first :WAT out water-rmsd-2.dat</div>
</div>
<div class="standard"><a id="magicparlabel-3147"></a>the first <em><b>rms</b></em> command will be valid, but the second <em><b>rms</b></em> command will not since all residues named WAT are removed from the state by the <em><b>strip</b></em> command.</div>

<div class="standard"><a id="magicparlabel-3148"></a>The following 
Actions are available. If an Action may modify coordinate/topology 
information for subsequent Actions it is denoted with an X in the <b><span style="font-family:monospace;">Mod</span></b> column.
<br />

</div>




<div class="standard" style="text-align: center;"><a id="magicparlabel-3149"></a><div class="longtable" style="text-align: center;"><table><tbody><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3405"></a><b>Command</b></div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3408"></a><b>Description</b></div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3411"></a><b>Mod</b></div>
</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3414"></a>angle</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3417"></a>Calculate the angle between three points.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3423"></a>areapermol</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3426"></a>Calculate area per molecule for molecules in a specified plane.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3432"></a>atomiccorr</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3435"></a>Calculate average correlation between motions of specified atoms.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3441"></a>atomicfluct, rmsf</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3444"></a>Calculate root mean square fluctuation of specified atoms/residues.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3450"></a>atommap</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3453"></a>Attempt to create a map between atoms in molecules with different atom ordering.</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3456"></a>X</div>
</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3459"></a>autoimage</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3462"></a>Automatically re-image coordinates.</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3465"></a>X</div>
</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3468"></a>average</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3471"></a>Calculate average structure.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3477"></a>bounds</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3480"></a>Calculate the min/max coordinates for specified atoms. Can be used to create grid data sets.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3486"></a>box</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3489"></a>Set or overwrite box information for frames.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3495"></a>center</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3498"></a>Center specified coordinates to box center or onto reference structure.</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3501"></a>X</div>
</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3504"></a>check, checkoverlap,</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3507"></a>Check for bad atomic overlaps or bond lengths. </div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3513"></a> checkstructure</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3516"></a>Can be used to skip corrupted frames.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3522"></a>checkchirality</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3525"></a>Report chirality around alpha carbons in amino acids (L, D).</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3531"></a>closest, closestwaters</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3534"></a>Retain only the specified number of solvent molecules closest to specified solute.</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3537"></a>X</div>
</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3540"></a>clusterdihedral</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3543"></a>Assign frames into clusters based on binning of backbone dihedral angles in amino acids.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3549"></a>contacts</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3552"></a>Older version of <em><b>nativecontacts</b></em>, retained for backwards compatibility.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3558"></a>createcrd</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3561"></a>Create a COORDS data set from input frames.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3567"></a>createreservoir</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3570"></a>Create a structure reservoir for use with reservoir REMD simulations.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3576"></a>density</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3579"></a>Calculate density along a coordinate.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3585"></a>diffusion</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3588"></a>Calculate translational diffusion of molecules.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3594"></a>dihedral</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3597"></a>Calculate the dihedral angle using four points.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3603"></a>dipole</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3606"></a>Bin dipoles of solvent molecules in 3D grid. Not well tested, may be obsolete.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3612"></a>distance</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3615"></a>Calculate the distance between two points.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3621"></a>drms, drmsd</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3624"></a>Calculate the RMSD of distance pairs within selected atoms.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3630"></a>dssp, secstruct</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3633"></a>Calculate secondary structure content using the DSSP algorithm</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3639"></a>energy</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3642"></a>Calculate simple bond, angle, dihedral, and non-bonded energy terms (no PME).</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3648"></a>esander</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3651"></a>Calculate energies using via SANDER; requires compilation with the SANDER API.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3657"></a>filter</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3660"></a>Filter frames for subsequent Actions using data sets and user defined criteria.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3666"></a>fixatomorder</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3669"></a>Fix atom ordering so that all atoms in molecules are sequential.</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3672"></a>X</div>
</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3675"></a>fiximagedbonds</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3678"></a>Fix bonds which have been split across periodic boundaries by imaging.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3684"></a>gist</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3687"></a>Perform grid inhomogenous solvation theory.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3693"></a>grid</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3696"></a>Bin selected atoms on a 3D grid.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3702"></a>hbond</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3705"></a>Calculate hydrogen bonds using geometric criteria.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3711"></a>image</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3714"></a>Re-image coordinates. The <em><b>autoimage</b></em> command typically provides better results.</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3717"></a>X</div>
</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3720"></a>jcoupling</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3723"></a>Calculate J-coupling values from specified dihedral angles.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3729"></a>lessplit</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3732"></a>Split/average frames from LES trajectories.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3738"></a>lie</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3741"></a>Calculate linear interaction energy between user-specified ligand and surroundings.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3747"></a>lipidorder</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3750"></a>Calculate order parameters for lipids in planar membranes.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3756"></a>lipidscd</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3759"></a>Calculate lipid order parameters SCD (|&lt;P2&gt;|) for lipid chains. Automatically identifies lipids.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3765"></a>makestructure</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3768"></a>Modify structure by applying dihedral values to specified residues.</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3771"></a>X</div>
</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3774"></a>mask</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3777"></a>Print the results of selection by specified atom mask. Good for distnace-based masks.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3783"></a>matrix</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3786"></a>Calculate a matrix of the specified type from input coordinates.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3792"></a>minimage</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3795"></a>Calculate minimum non-self imaged distance between atoms in specified masks.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3801"></a>molsurf</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3804"></a>Calculate Connolly surface area of specified atoms. Cannot do partial surface areas.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3810"></a>multidihedral</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3813"></a>Calculate multiple dihedral angles of specified/given types.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3819"></a>multivector</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3822"></a>Calculate multiple vectors between specified atoms.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3828"></a>nastruct</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3831"></a>Perform nucelic acid structure analysis.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3837"></a>nativecontacts</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3840"></a>Calculate native contacts within a region or between two regions using a given reference. </div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">

</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3849"></a>Can also be used to get min/max distances between groups of atoms.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3855"></a>outtraj</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3858"></a>Write frames to a trajectory file within a list of Actions.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3864"></a>pairdist</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3867"></a>Calculate pair distribution function.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3873"></a>pairwise</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3876"></a>Calculate pair-wise non-bonded energies.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3882"></a>principal</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3885"></a>Calculate and optionally align system along principal axes.</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3888"></a>X</div>
</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3891"></a>projection</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3894"></a>Project coordinates along given eigenvectors.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3900"></a>pucker</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3903"></a>Calculate ring pucker using five or six points.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3909"></a>radgyr, rog</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3912"></a>Calculate radius of gyration (and optionally tensor) for specified atoms.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3918"></a>radial, rdf</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3921"></a>Calculate radial distribution function.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3927"></a>randomizeions</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3930"></a>Swap specified ions with randomly selected solvent molecules.</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3933"></a>X</div>
</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3936"></a>replicatecell</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3939"></a>Replicate unit cell in specified (or all) directions for specfied atoms and write to trajectory.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3945"></a>rms, rmsd</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3948"></a>Perform best fit of coordinates to reference and calculate coordinate RMSD.</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3951"></a>X</div>
</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">

</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3957"></a> Fitting can be disabled.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3963"></a>rotate</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3966"></a>Rotate the system around X/Y/Z axes, a specified axis, or via given rotation matrices.</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3969"></a>X</div>
</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3972"></a>runavg, </div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3975"></a>Calculate the running average of coordinates over specified window size.</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3978"></a>X</div>
</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3981"></a>runningaverage</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">

</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3990"></a>scale</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3993"></a>Scale coordinates in X/Y/Z directions by specified factors.</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3996"></a>X</div>
</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-3999"></a>setvelocity</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4002"></a>Set velocities for specified atoms using Maxwellian distribution based on given temperature.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4008"></a>spam</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4011"></a>SPAM method for estimating relative free energies of waters in hydration shell around proteins.</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4014"></a>X</div>
</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4017"></a>stfcdiffusion</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4020"></a>Alternative translational diffusion calculation which can calculate diffusion in specified regions.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4026"></a>strip</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4029"></a>Remove specified atoms from the system.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4035"></a>surf</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4038"></a>Calculate the LCPO surface area of specified atoms. Can do partial surface areas.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4044"></a>symmrmsd</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4047"></a>Calculate symmetry-corrected RMSD.</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4050"></a>X</div>
</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4053"></a>temperature</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4056"></a>Calculate system temperature using velocities of specified atoms.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4062"></a>trans, translate</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4065"></a>Translate specified atoms by specified amounts in X/Y/Z directions.</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4068"></a>X</div>
</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4071"></a>unstrip</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4074"></a>Undo all previous <em><b>strip</b></em> Action commands.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4080"></a>unwrap</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4083"></a>Reverse of <em><b>image</b></em>; unwrap selected atoms so they have continuous trajectories.</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4086"></a>X</div>
</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4089"></a>vector</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4092"></a>Calculate various types of vector quantities.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4098"></a>velocityautocorr</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4101"></a>Calculate velocity autocorrelation function.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4107"></a>volmap</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4110"></a>Create volumetric map for specified coordinates; similar to <em><b>grid</b></em> but takes</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">

</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4119"></a> into account atomic radii. Similar to VMD <em><b>volmap</b></em>.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4125"></a>volume</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4128"></a>Calculate unit cell volume.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td style="width: 1.3in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4134"></a>watershell</div>
</td>
<td style="width: 4.5in;" valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4137"></a>Calculate the number of waters in the first and second solvation shells based on distance critera.</div>
</td>
<td valign="top" align="center">

</td>
</tr></tbody>
</table>
</div>
</div>
<h3 class="subsection"><a id="magicparlabel-4141"></a><span class="subsection_label">10.1</span> angle</h3>

<div class="lyx_code"><a id="magicparlabel-4142"></a><div class="lyx_code_item">angle<a id="magicparlabel-4146"></a>
 [&lt;dataset name&gt;] &lt;mask1&gt; &lt;mask2&gt; &lt;mask3&gt; [out &lt;filename&gt;] [mass]
<br />

</div>

<dl class="description"><a id="magicparlabel-4147"></a><dt class="description_label">[&lt;dataset name&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output data set name.</span></dd>
<dt class="description_label">&lt;maskX&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Three atom masks selecting atom(s) to calculate angle for.</span></dd>
<dt class="description_label">[out &lt;filename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output file name.</span></dd>
<dt class="description_label">[mass]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use center of mass of atoms in &lt;maskX&gt; instead of geometric center.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-4151"></a>Calculate angle (in
 degrees) between atoms in &lt;mask1&gt;, &lt;mask2&gt;, and 
&lt;mask3&gt;. For example, to calculate the angle between the first 
three atoms in the system:</div>

<div class="lyx_code"><a id="magicparlabel-4152"></a><div class="lyx_code_item">angle A123 @1 @2 @3 out A123.agr</div>
</div>
<h3 class="subsection"><a id="magicparlabel-4153"></a><span class="subsection_label">10.2</span> areapermol</h3>

<div class="lyx_code"><a id="magicparlabel-4154"></a><div class="lyx_code_item">areapermol [&lt;name&gt;] {[&lt;mask1&gt;] [nlayers &lt;#&gt;] | nmols &lt;#&gt;} [out &lt;filename&gt;] [{xy | xz | yz}]
<br />

</div>

<dl class="description"><a id="magicparlabel-4155"></a><dt class="description_label">[&lt;name&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Data set name.</span></dd>
<dt class="description_label">[&lt;mask1&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Atom mask for selecting molecules. If any atom in a molecule is selected the whole molecule is selected.</span></dd>
<dt class="description_label">[nlayers &lt;#&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Number of layers of molecules. Total number of molecules used will be # molecules divided by # layers.</span></dd>
<dt class="description_label">[nmols &lt;#&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> If &lt;mask1&gt; is not specified, the number of molecules to use when calculating area per molecule.</span></dd>
<dt class="description_label">[out &lt;filename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output file name.</span></dd>
<dt class="description_label">[{xy|xz|yz}]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Cross-section of box to calculate area of. Default is X-Y.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-4161"></a>Calculate area per 
molecule as Area / # molecules. The area is determined from the 
specified cross-section of the box (X-Y by default). Currently the 
calculation is only guaranteed to work properly with orthorhombic unit 
cells. For example, to get the area per molecule of residues named “OL” 
which are arranged in 2 layers:</div>

<div class="lyx_code"><a id="magicparlabel-4162"></a><div class="lyx_code_item">areapermol OL_area :OL nlayers 2 out apm.dat</div>
</div>
<h3 class="subsection"><a id="magicparlabel-4163"></a><span class="subsection_label">10.3</span> atomiccorr</h3>

<div class="lyx_code"><a id="magicparlabel-4164"></a><div class="lyx_code_item">atomiccorr [&lt;mask&gt;] out &lt;filename&gt; [cut &lt;cutoff&gt;] [min &lt;min spacing&gt;]</div>
<div class="lyx_code_item">           [byatom | byres]
<br />

</div>

<dl class="description"><a id="magicparlabel-4166"></a><dt class="description_label">&lt;mask&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Atoms to calculate motion vectors for.</span></dd>
<dt class="description_label">out &lt;filename&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> File to write results to.</span></dd>
<dt class="description_label">cut &lt;cutoff&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Only print correlations with absolute value greater than &lt;cutoff&gt;.</span></dd>
<dt class="description_label">min &lt;min spacing&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Only calculate correlations for motion vectors spaced &lt;min spacing&gt; apart.</span></dd>
<dt class="description_label">byatom</dt>
<dd class="description_item"><span style="font-family:monospace;"> Default; calculate atomic motion vectors.</span></dd>
<dt class="description_label">byres</dt>
<dd class="description_item"><span style="font-family:monospace;"> Calculate motion vectors for entire residues (selected atoms in residues only).</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-4172"></a>Calculate average 
correlations between the motion of atoms in &lt;mask&gt;. For each 
frame, a motion vector is calculated for each selected atom from its 
previous position to its current position. For each pair of motion 
vectors <i>Va</i> and <i>Vb</i>, the average correlation between those vectors is calculated as the average of the dot product of those vectors over all <i>N</i> frames. 
<br />

</div>

<div class="standard" style="text-align: center;"><a id="magicparlabel-4173"></a><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>A</mi><mi>v</mi><mi>g</mi><mi>C</mi><mi>o</mi><mi>r</mi><mi>r</mi><mo form="prefix" fence="true" stretchy="true" symmetric="true">(</mo>

   <mrow><mi>a</mi><mo>,</mo><mi>b</mi>
   </mrow>
<mo form="postfix" fence="true" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
   <mfrac>
    <mrow>
     <mrow><mo> ∑ </mo>
      <msub>
       <mrow><mi>V</mi>
       </mrow>
       <mrow><mi>a</mi>
       </mrow>
      </msub><mo form="prefix" fence="true" stretchy="true" symmetric="true">(</mo>
<mi>i</mi>
<mo form="postfix" fence="true" stretchy="true" symmetric="true">)</mo>
<mo> ⋅ </mo>
      <msub>
       <mrow><mi>V</mi>
       </mrow>
       <mrow><mi>b</mi>
       </mrow>
      </msub><mo form="prefix" fence="true" stretchy="true" symmetric="true">(</mo>
<mi>i</mi>
<mo form="postfix" fence="true" stretchy="true" symmetric="true">)</mo>

     </mrow>
    </mrow>
    <mrow><mi>N</mi>
    </mrow>
   </mfrac>
  </mrow>
 </mrow></math></div>

<div class="standard"><a id="magicparlabel-4174"></a>The value of 
AvgCorr can range from 1.0 (correlated) to 0.0 (no correlation) to -1.0 
(anti-correlated). For example, to calculate the correlation of motion 
vectors between residues 1 to 13, writing to a Gnuplot-readable 
formatted file:</div>

<div class="lyx_code"><a id="magicparlabel-4175"></a><div class="lyx_code_item">atomiccorr :1-13 out acorr.gnu byres</div>
</div>
<h3 class="subsection"><a id="magicparlabel-4176"></a><span class="subsection_label">10.4</span> atomicfluct | rmsf<a id="subsec_cpptraj_atomicfluct"></a>
</h3>

<div class="lyx_code"><a id="magicparlabel-4177"></a><div class="lyx_code_item">atomicfluct<a id="magicparlabel-4181"></a>
 [out &lt;filename&gt;] [&lt;mask&gt;] [byres | byatom | bymask] [bfactor]</div>
<div class="lyx_code_item">            [calcadp [adpout &lt;file&gt;]]</div>
<div class="lyx_code_item">            [start &lt;start&gt;] [stop &lt;stop&gt;] [offset &lt;offset&gt;]
<br />

</div>

<dl class="description"><a id="magicparlabel-4184"></a><dt class="description_label">out &lt;filename&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write data to file named &lt;filename&gt;</span></dd>
<dt class="description_label">[&lt;mask&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Calculate fluctuations for atoms in &lt;mask&gt; (all if not specified).</span></dd>
<dt class="description_label">byres</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output the average (mass-weighted) fluctuation by residue.</span></dd>
<dt class="description_label">bymask</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output the average (mass-weighted) fluctuation for all atoms in &lt;mask&gt;.</span></dd>
<dt class="description_label">byatom (default)</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output the fluctuation by atom.</span></dd>
<dt class="description_label">[bfactor]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Calculate atomic positional fluctuations squared and weight by <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mfrac>
    <mrow><mn>8</mn>
    </mrow>
    <mrow><mn>3</mn>
    </mrow>
   </mfrac>
   <msup>
    <mrow><mi> π </mi>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msup>
  </mrow>
 </mrow></math>; this is similar but not necessarily equivalent to the calculation of crystallographic B-factors.</span></dd>
<dt class="description_label">[calcadp [adpout &lt;file&gt;]]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Calculate anisotropic displacement parameters and optionally output them to &lt;file&gt;.</span></dd>
<dt class="description_label">[&lt;start&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Frame to begin calculation at (default 1).</span></dd>
<dt class="description_label">[&lt;stop&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Frame to end calculation at (default last).</span></dd>
<dt class="description_label">[&lt;offset&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Frames to skip between calculations (default 1).</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-4194"></a>Compute the atomic positional fluctuations (also referred to as root-mean-square fluctuations, RMSF) for atoms specified in the <b>&lt;mask&gt;</b>.
 Note that RMS fitting is not done implicitly. If you want fluctuations 
without rotations or translations (for example to the average 
structure), perform an RMS fit to the average structure (best) or the 
first structure (see <b><i>rmsd</i></b>) prior to this calculation. The units are (Å) for RMSF or Å<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup><mrow/>
   <mrow>
    <mstyle mathvariant="normal"><mn>2</mn>
    </mstyle>
   </mrow>
  </msup>
 </mrow></math> × <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mfrac>
   <mrow><mn>8</mn>
   </mrow>
   <mrow><mn>3</mn>
   </mrow>
  </mfrac>
 </mrow></math><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup>
   <mrow><mi> π </mi>
   </mrow>
   <mrow><mn>2</mn>
   </mrow>
  </msup>
 </mrow></math> if <b>bfactor</b> is specified.</div>

<div class="standard"><a id="magicparlabel-4195"></a>If <b>byres</b> or <b>bymask</b>
 are specified, the mass-weighted average of atomic fluctuations of each
 atom for either each residue or the entire mask will be calculated 
respectively:
<br />

</div>

<div class="standard" style="text-align: center;"><a id="magicparlabel-4196"></a><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mo form="prefix" fence="true" stretchy="true" symmetric="true">⟨</mo>

   <mrow><mi>F</mi><mi>l</mi><mi>u</mi><mi>c</mi><mi>t</mi>
   </mrow>
<mo form="postfix" fence="true" stretchy="true" symmetric="true">⟩</mo>
<mo>=</mo>
   <mfrac>
    <mrow>
     <mrow><mo> ∑ </mo><mi>A</mi><mi>t</mi><mi>o</mi><mi>m</mi><mi>F</mi><mi>l</mi><mi>u</mi><mi>c</mi>
      <msub>
       <mrow><mi>t</mi>
       </mrow>
       <mrow><mi>i</mi>
       </mrow>
      </msub><mo>*</mo><mi>M</mi><mi>a</mi><mi>s</mi>
      <msub>
       <mrow><mi>s</mi>
       </mrow>
       <mrow><mi>i</mi>
       </mrow>
      </msub>
     </mrow>
    </mrow>
    <mrow>
     <mrow><mo> ∑ </mo><mi>M</mi><mi>a</mi><mi>s</mi>
      <msub>
       <mrow><mi>s</mi>
       </mrow>
       <mrow><mi>i</mi>
       </mrow>
      </msub>
     </mrow>
    </mrow>
   </mfrac>
  </mrow>
 </mrow></math></div>

<div class="standard"><a id="magicparlabel-4197"></a>If <b>calcadp</b> is specified, anisotropic displacement factors for atoms will be calculated and written to the file specified by <b>adpout</b> (or STDOUT if not specified) using PDB ANISOU record format. Note that <b>calcadp</b> automatically implies <b>bfactor</b>.</div>

<div class="standard"><a id="magicparlabel-4198"></a>With <em>cpptraj</em>
 it is possible to perform coordinate averaging, the fit to average 
coordinates, and the atomic fluctuation calculation in a single 
execution like so:</div>

<div class="lyx_code"><a id="magicparlabel-4199"></a><div class="lyx_code_item">parm myparm.parm7</div>
<div class="lyx_code_item">trajin mytrajectory.crd</div>
<div class="lyx_code_item">rms first</div>
<div class="lyx_code_item">average crdset MyAvg</div>
<div class="lyx_code_item">run</div>
<div class="lyx_code_item">rms ref MyAvg</div>
<div class="lyx_code_item">atomicfluct out fluct.agr</div>
</div>
<div class="standard"><a id="magicparlabel-4206"></a>To write the mass-weighted B-factors for the protein backbone atoms C, CA, and N, averaged by residue use the command:</div>

<div class="lyx_code"><a id="magicparlabel-4207"></a><div class="lyx_code_item">atomicfluct out back.agr @C,CA,N byres bfactor</div>
</div>
<div class="standard"><a id="magicparlabel-4208"></a>To write the RMSF or atomic positional fluctuations of the same atoms, use the command:</div>

<div class="lyx_code"><a id="magicparlabel-4209"></a><div class="lyx_code_item">atomicfluct out backbone-atoms.agr @C,CA,N</div>
</div>
<h3 class="subsection"><a id="magicparlabel-4210"></a><span class="subsection_label">10.5</span> atommap</h3>

<div class="lyx_code"><a id="magicparlabel-4211"></a><div class="lyx_code_item">atommap<a id="magicparlabel-4215"></a>
 &lt;target&gt; &lt;reference&gt; [mapout &lt;filename&gt;] [maponly]
<br />

        [rmsfit [ rmsout &lt;rmsout&gt; ]]
<br />

</div>

<dl class="description"><a id="magicparlabel-4216"></a><dt class="description_label">&lt;target&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Reference structure whose atoms will be remapped.</span></dd>
<dt class="description_label">&lt;reference&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Reference structure that <b>&lt;target&gt;</b> should be mapped to.</span></dd>
<dt class="description_label">mapout &lt;filename&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write atom map to &lt;filename&gt; with format:
<br />

TargetAtomNumber TargetAtomName ReferenceAtomNumber ReferenceAtomName
<br />

Target atoms that cannot be mapped to a reference atom are denoted “—”.</span></dd>
<dt class="description_label">maponly</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write atom map but do not reorder atoms.</span></dd>
<dt class="description_label">rmsfit</dt>
<dd class="description_item"><span style="font-family:monospace;"> Any 
input frames using the same topology as &lt;target&gt; will be RMS fit 
to &lt;reference&gt; using whatever atoms could be mapped.
<br />

</span>

<dl class="description"><a id="magicparlabel-4221"></a><dt class="description_label">rmsout &lt;rmsout&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> If rmsfit specified, write resulting RMSDs to &lt;rmsout&gt;.</span></dd>
</dl>
</dd></dl>
</div>
<div class="standard"><a id="magicparlabel-4222"></a>Attempt to map the 
atoms of &lt;target&gt; to those of &lt;reference&gt; based on 
structural similarity. This is useful e.g. when there are two files 
containing the same structure but with different atom names or atom 
ordering. Both &lt;target&gt; and &lt;reference&gt; need to have been 
read in with a previous <b><i>reference</i></b> command. The state will 
then be modified so that any trajectory read in with the same parameter 
file as &lt;target&gt; will have its atoms mapped (i.e. reordered) to 
match those of &lt;reference&gt;. If the number of atoms that can be 
mapped in &lt;target&gt; are less than those in &lt;reference&gt;, the 
reference structure specified by &lt;reference&gt; will be modified to 
include only mapped atoms; this is useful if for example the reference 
structure is protonated with respect to the target. The <b>rmsfit</b> 
keyword is useful in cases where the atom mapping will not be complete 
(e.g. two ligands with the same scaffold but different substituents).</div>

<div class="standard"><a id="magicparlabel-4223"></a>For example, say 
you have the same ligand structure in two files, Ref.mol2 and Lig.mol2, 
but the atom ordering in each file is different. To map the atoms in 
Lig.mol2 onto those of Ref.mol2 so that Lig.mol2 has the same ordering 
as Ref.mol2:</div>

<div class="lyx_code"><a id="magicparlabel-4224"></a><div class="lyx_code_item">parm Lig.mol2 </div>
<div class="lyx_code_item">reference Lig.mol2</div>
<div class="lyx_code_item">parm Ref.mol2 </div>
<div class="lyx_code_item">reference Ref.mol2 parmindex 1</div>
<div class="lyx_code_item">atommap Lig.mol2 Ref.mol2 mapout atommap.dat</div>
<div class="lyx_code_item">trajin Lig.mol2 </div>
<div class="lyx_code_item">trajout Lig.reordered.mol2 mol2</div>
</div>
<h3 class="subsection"><a id="magicparlabel-4231"></a><span class="subsection_label">10.6</span> autoimage</h3>

<div class="lyx_code"><a id="magicparlabel-4232"></a><div class="lyx_code_item">autoimage [&lt;mask&gt; | anchor &lt;mask&gt; [fixed &lt;mask&gt;] [mobile &lt;mask&gt;]]</div>
<div class="lyx_code_item">          [origin] [firstatom] [familiar | triclinic]
<br />

</div>

<dl class="description"><a id="magicparlabel-4234"></a><dt class="description_label">[&lt;mask&gt; | anchor &lt;mask&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Atoms to image around; this is the region that will be centered. Default is the entire first molecule.</span></dd>
<dt class="description_label">[fixed &lt;mask&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Molecules that should remain 'fixed' to the anchor region; default is all non-ion/non-solvent molecules.</span></dd>
<dt class="description_label">[mobile &lt;mask&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Molecules that can be freely imaged; default is all ion/solvent molecules.</span></dd>
<dt class="description_label">[origin]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Center anchor region at the origin; if not specified, center at box center.</span></dd>
<dt class="description_label">[firstatom]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Image based on molecule first atom; default is to image by molecule center of mass.</span></dd>
<dt class="description_label">[familiar]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Image to familiar truncated-octahedral shape; this is on by default if the original cell is truncated octahedron.</span></dd>
<dt class="description_label">[triclinic]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Force general triclinic imaging.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-4241"></a>Automatically center and image (by molecule) a trajectory with periodic boundaries. For most cases just specifying <b><i>'autoimage'</i></b> alone is sufficient. The atoms of the <b>'anchor'</b> region (default the entire first molecule) will be centered; all <b>'fixed'</b> molecules will be imaged only if imaging brings them closer to the <b>'anchor'</b> molecule (default for <b>'fixed'</b> molecules is all non-solvent non-ion molecules). All other molecules (referred to as <b>'mobile'</b>) will be imaged freely.</div>

<div class="standard"><a id="magicparlabel-4242"></a>The autoimage 
command works for the majority of systems; however, for very densely 
packed systems the default anchor (entire first molecule) may not be 
appropriate. In these cases, it is recommended to choose as the anchor a
 small region which should lie near the center of your system. For 
example, in a protein dimer system one could choose a single residue 
that is near the center of the interface between the two monomers.</div>
<h3 class="subsection"><a id="magicparlabel-4243"></a><span class="subsection_label">10.7</span> average<a id="subsec_cpptraj_average"></a>
</h3>

<div class="lyx_code"><a id="magicparlabel-4244"></a><div class="lyx_code_item">average<a id="magicparlabel-4248"></a>
 {crdset &lt;set name&gt; | &lt;filename&gt;} [&lt;mask&gt;]</div>
<div class="lyx_code_item">        [start &lt;start&gt;] [stop &lt;stop&gt;] [offset &lt;offset&gt;]</div>
<div class="lyx_code_item">        [Trajout Args]
<br />

</div>

<dl class="description"><a id="magicparlabel-4251"></a><dt class="description_label">&lt;filename&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> If specified, write averaged coordinates to &lt;filename&gt; (not compatible with crdset).</span></dd>
<dt class="description_label">crdset &lt;set name&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> If specified, save averaged coordinates to COORDS set &lt;set name&gt; (not compatible with &lt;filename&gt;).</span></dd>
<dt class="description_label">[&lt;mask&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Average coordinates in &lt;mask&gt; (all atoms if not specified).</span></dd>
<dt class="description_label">[&lt;start&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Frame to begin calculation at (default 1).</span></dd>
<dt class="description_label">[&lt;stop&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Frame to end calculation at (default last).</span></dd>
<dt class="description_label">[&lt;offset&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Frames to skip between calculations (default 1).</span></dd>
<dt class="description_label">[Trajout args]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output trajectory format argument(s) (default Amber Trajectory).</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-4258"></a>Calculate the average of input coordinates and write out to file named <b>&lt;filename&gt;</b> or save to COORDS set named <b>&lt;set name&gt;</b> in any trajectory format <i>cpptraj</i> recognizes (Amber Trajectory if not specified). If the number of atoms in <b>&lt;mask&gt;</b> are less than the total number of atoms, the topology will be stripped to match <b>&lt;mask&gt;</b>. </div>

<div class="standard"><a id="magicparlabel-4259"></a>Note that since 
coordinates are being averaged over many frames, resulting structures 
may appear distorted. For example, if one averages the coordinates of a 
freely rotating methyl group the average position of the hydrogen atoms 
will be close to the center of rotation. Also note that typically one 
will want to remove global rotational and translation movement prior to 
this command by using e.g. the <em><b>rms</b></em> (<a href="#subsec_cpptraj_rmsd">10.62</a>) command.</div>

<div class="standard"><a id="magicparlabel-4260"></a>Any arguments that are valid for the <b><i>trajout</i></b> command (<a href="#subsec_cpptraj_trajout">9.5</a>)
 can be passed to this command in order to control the format of the 
output coordinates. For example, to write out a PDB file containing the 
averaged coordinates over all frames:</div>

<div class="lyx_code"><a id="magicparlabel-4261"></a><div class="lyx_code_item">average test.pdb pdb</div>
</div>
<div class="standard"><a id="magicparlabel-4262"></a>To write out a mol2 file containing only the averaged coordinates of residues 1 to 10 for frames 1 to 100:</div>

<div class="lyx_code"><a id="magicparlabel-4263"></a><div class="lyx_code_item">average test.mol2 mol2 start 1 stop 100 :1-10</div>
</div>
<div class="standard"><a id="magicparlabel-4264"></a>To create an average structure of atoms named CA and then use it as a reference for an rms command in a subsequent run:</div>

<div class="lyx_code"><a id="magicparlabel-4265"></a><div class="lyx_code_item">trajin Input.nc</div>
<div class="lyx_code_item">average crdset MyAvg @CA</div>
<div class="lyx_code_item">run</div>
<div class="lyx_code_item">rms ref MyAvg @CA out RmsToAvg.dat</div>
<div class="lyx_code_item">run</div>
</div>
<h3 class="subsection"><a id="magicparlabel-4270"></a><span class="subsection_label">10.8</span> avgcoord</h3>
<div class="standard"><a id="magicparlabel-4271"></a>This command is deprecated. Use 'vector center' (optionally with keyword 'magnitude') instead.</div>
<h3 class="subsection"><a id="magicparlabel-4272"></a><span class="subsection_label">10.9</span> bounds<a id="subsec_cpptraj_bounds"></a>
</h3>

<div class="lyx_code"><a id="magicparlabel-4273"></a><div class="lyx_code_item">bounds [&lt;mask&gt;] [out &lt;filename&gt;]</div>
<div class="lyx_code_item">       [dx &lt;dx&gt; [dy &lt;dy&gt;] [dz &lt;dz&gt;] name &lt;gridname&gt; [offset &lt;bin offset&gt;]]
<br />

</div>

<dl class="description"><a id="magicparlabel-4275"></a><dt class="description_label">[&lt;mask&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Mask of atoms to determine bounds of.</span></dd>
<dt class="description_label">[out &lt;filename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> File to write bounds to (default STDOUT if not specified).</span></dd>
<dt class="description_label">[dx &lt;dx&gt; [dy &lt;dy&gt;] [dz &lt;dz&gt;]]</dt>
<dd class="description_item"><span style="font-family:monospace;"> 
Triggers creation of a grid data set from bounds. Spacings of generated 
grid in the X, Y and Z directions. If only dx is specified &lt;dx&gt; 
will be used for &lt;dy&gt; and &lt;dz&gt; as well.</span></dd>
<dt class="description_label">[name &lt;gridname&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Name of generated data sets.</span></dd>
<dt class="description_label">[offset &lt;bin offset&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Number of bins to add/subtract in each direction to generated grid.</span></dd>
</dl>
<div class="standard"><a id="magicparlabel-4280"></a><span style="font-family:monospace;">DataSets Generated</span></div>

<dl class="description"><a id="magicparlabel-4281"></a><dt class="description_label">&lt;gridname&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> The 3D grid (only if 'dx' etc specified).</span></dd>
<dt class="description_label">&lt;gridname&gt;[xmin]</dt>
<dd class="description_item"><span style="font-family:monospace;"> The minimum x coordinate encountered.</span></dd>
<dt class="description_label">&lt;gridname&gt;[xmax]</dt>
<dd class="description_item"><span style="font-family:monospace;"> The maximum x coordinate encountered.</span></dd>
<dt class="description_label">&lt;gridname&gt;[ymin]</dt>
<dd class="description_item"><span style="font-family:monospace;"> The minimum y coordinate encountered.</span></dd>
<dt class="description_label">&lt;gridname&gt;[ymax]</dt>
<dd class="description_item"><span style="font-family:monospace;"> The maximum y coordinate encountered.</span></dd>
<dt class="description_label">&lt;gridname&gt;[zmin]</dt>
<dd class="description_item"><span style="font-family:monospace;"> The minimum z coordinate encountered.</span></dd>
<dt class="description_label">&lt;gridname&gt;[zmax]</dt>
<dd class="description_item"><span style="font-family:monospace;"> The maximum z coordinate encountered.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-4288"></a>Calculate the boundaries (i.e. the max/min X/Y/Z coordinates) of atoms in <b>&lt;mask&gt;</b> and write to <b>&lt;filename&gt;</b> (STDOUT if not specified). Useful for determining dimensions for the <b><i>grid</i></b> command, and can be used to generate a grid data set that can be used by <b><i>grid</i></b> (see <a href="#subsec_cpptraj_grid">10.34</a>).</div>
<h3 class="subsection"><a id="magicparlabel-4289"></a><span class="subsection_label">10.10</span> box</h3>

<div class="lyx_code"><a id="magicparlabel-4290"></a><div class="lyx_code_item">box [x &lt;xval&gt;] [y &lt;yval&gt;] [z &lt;zval&gt;] [alpha &lt;a&gt;] [beta &lt;b&gt;] [gamma &lt;g&gt;]</div>
<div class="lyx_code_item">    [nobox] [truncoct]
<br />

</div>

<dl class="description"><a id="magicparlabel-4292"></a><dt class="description_label">[x &lt;xval&gt;] [y &lt;yval&gt;] [z &lt;zval&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Change box length(s) to specified value(s).</span></dd>
<dt class="description_label">[alpha &lt;a&gt;] [beta &lt;b&gt;] [gamma &lt;g&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Change box angle(s) to specified value(s).</span></dd>
<dt class="description_label">[nobox]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Remove any existing box information.</span></dd>
<dt class="description_label">[truncoct]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Set box angles to truncated octahedron.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-4296"></a>Modify box 
information during trajectory processing. Note that this will 
permanently modify the box information for topology files during 
trajectory processing as well. It is possible to modify any number of 
the box parameters (e.g. only the Z length can be modified if desired 
while leaving all other parameters intact).</div>
<h3 class="subsection"><a id="magicparlabel-4297"></a><span class="subsection_label">10.11</span> center</h3>

<div class="lyx_code"><a id="magicparlabel-4298"></a><div class="lyx_code_item">center<a id="magicparlabel-4302"></a>
 [&lt;mask&gt;] [origin] [mass] </div>
<div class="lyx_code_item">       [ reference | ref &lt;name&gt; | refindex &lt;#&gt; [&lt;refmask&gt;]]
<br />

</div>

<dl class="description"><a id="magicparlabel-4304"></a><dt class="description_label">[&lt;mask&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Center based on atoms in mask; default is all atoms.</span></dd>
<dt class="description_label">[origin]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Center to origin (0, 0, 0); default is center to box center (X/2, Y/2, Z/2).</span></dd>
<dt class="description_label">[mass]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use center of mass instead of geometric center.</span></dd>
<dt class="description_label">[reference | ref &lt;name&gt; | refindex &lt;#&gt; [&lt;refmask]]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Center using coordinates in specified reference structure selected by &lt;refmask&gt; (&lt;mask&gt; if not specified.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-4308"></a>Move all atoms so that the center of the atoms in <b>&lt;mask&gt;</b> is centered at the specified location: box center (default), coordinate origin, or reference coordinates.</div>

<div class="standard"><a id="magicparlabel-4309"></a>For example, to move all coordinates so that the center of mass of residue 1 is at the center of the box:</div>

<div class="lyx_code"><a id="magicparlabel-4310"></a><div class="lyx_code_item">center :1 mass</div>
</div>
<h3 class="subsection"><a id="magicparlabel-4311"></a><span class="subsection_label">10.12</span> check | checkoverlap | checkstructure</h3>

<div class="lyx_code"><a id="magicparlabel-4312"></a><div class="lyx_code_item">check<a id="magicparlabel-4316"></a>
 [&lt;mask&gt;] [around &lt;mask2&gt;] [reportfile &lt;report&gt;] [noimage] [skipbadframes]</div>
<div class="lyx_code_item">      [offset &lt;offset&gt;] [cut &lt;cut&gt;] [nobondcheck] [silent]
<br />

</div>

<dl class="description"><a id="magicparlabel-4318"></a><dt class="description_label">[&lt;mask&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Check structure of atoms in &lt;mask&gt; (all if not specified).</span></dd>
<dt class="description_label">[around &lt;mask2&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> If specified, only check for problems between atoms in &lt;mask&gt; and atoms in &lt;mask2&gt;.</span></dd>
<dt class="description_label">[reportfile &lt;report&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write any problems found to &lt;report&gt; (STDOUT if not specified).</span></dd>
<dt class="description_label">[noimage]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Do not image distances.</span></dd>
<dt class="description_label">[skipbadframes]</dt>
<dd class="description_item"><span style="font-family:monospace;"> If errors are encountered for a frame, subsequent actions/trajectory output will be skipped.</span></dd>
<dt class="description_label">[offset &lt;offset&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Report bond lengths greater than the equilibrium value plus &lt;offset&gt; (default 1.0 Å)</span></dd>
<dt class="description_label">[cut &lt;cut&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Report atoms closer than &lt;cut&gt; (default 0.8 Å).</span></dd>
<dt class="description_label">[nobondcheck]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Check overlaps only.</span></dd>
<dt class="description_label">[silent]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Do not print information for bad frames - useful in conjunction with the <b>skipbadframes</b> option.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-4327"></a>Check the structure
 and report problems related to atomic overlap/unusual bond length. 
Problems are reported when any two atoms in the mask are closer than <b>&lt;cut&gt;</b>. If bonds are being checked then bond lengths greater than their equilibrium value + <b>&lt;offset&gt;</b>
 are reported as well. This command can also be used to skip corrupted 
frames in a trajectory during processing. For example, if this message 
is encountered:</div>

<div class="lyx_code"><a id="magicparlabel-4328"></a><div class="lyx_code_item">Warning: Frame 10 coords 1 &amp; 2 overlap at origin; may be corrupt.</div>
</div>
<div class="standard"><a id="magicparlabel-4329"></a>One could use <b><i>check</i></b> so that e.g. a subsequent <b><i>distance</i></b> command is not processed for bad frames:</div>

<div class="lyx_code"><a id="magicparlabel-4330"></a><div class="lyx_code_item">check @1,2 skipbadframes silent</div>
<div class="lyx_code_item">distance d1 :1 :10</div>
</div>
<div class="standard"><a id="magicparlabel-4332"></a>Usually frame 
corruption can be detected using only a few atoms, but this may not 
catch all types of corruption. The more atoms that are used the better 
the corruption detection will be, but the slower it will be to process 
the command. Typically a good procedure to follow when corruption is 
suspected is to run <b><i>check</i></b> using all important atoms (e.g. all solute heavy atoms) with the <b>skipbadframes</b> keyword followed by a <b><i>trajout</i></b> command to write all non-corrupt frames, for example:</div>

<div class="lyx_code"><a id="magicparlabel-4333"></a><div class="lyx_code_item">trajin corrupted.crd</div>
<div class="lyx_code_item">check :1-13 skipbadframes silent</div>
<div class="lyx_code_item">trajout fixed.corrupted.nc</div>
</div>
<h3 class="subsection"><a id="magicparlabel-4336"></a><span class="subsection_label">10.13</span> checkchirality</h3>

<div class="lyx_code"><a id="magicparlabel-4337"></a><div class="lyx_code_item">checkchirality [&lt;name&gt;] [&lt;mask&gt;] [out &lt;filename&gt;]
<br />

</div>

<dl class="description"><a id="magicparlabel-4338"></a><dt class="description_label">[&lt;name&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Data set name.</span></dd>
<dt class="description_label">[&lt;mask&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Atoms to check.</span></dd>
<dt class="description_label">[out &lt;filename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> File to write results to.</span></dd>
</dl>
<div class="standard"><a id="magicparlabel-4341"></a><span style="font-family:monospace;">DataSet Aspects:</span></div>

<dl class="description"><a id="magicparlabel-4342"></a><dt class="description_label">[L]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Number of frames 'L' for each residue.</span></dd>
<dt class="description_label">[D]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Number of frames 'D' for each residue.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-4344"></a>Check the chirality
 around the alpha carbon in amino acid residues selected by 
&lt;mask&gt;. Note that cpptraj expects atom names to correspond to the 
PDB V3 standard: N, CA, C, CB. For each residue, the number of frames in
 which the amino acid is 'L' or 'D' will be recorded. For example, to 
check the chirality of all amino acids in a system and write to a file 
named chiral.dat with data set name DPDP:</div>

<div class="lyx_code"><a id="magicparlabel-4345"></a><div class="lyx_code_item">checkchirality DPDP out chiral.dat</div>
</div>
<div class="standard"><a id="magicparlabel-4346"></a>Output will have format similar to:</div>

<div class="lyx_code"><a id="magicparlabel-4347"></a><div class="lyx_code_item">#Res      DPDP[L]  DPDP[D]</div>
<div class="lyx_code_item">   2.000      100        0</div>
</div>
<div class="standard"><a id="magicparlabel-4349"></a>So in this example residue 2 was 'L' for 100 frames and 'D' for 0 frames.</div>
<h3 class="subsection"><a id="magicparlabel-4350"></a><span class="subsection_label">10.14</span> closest | closestwaters</h3>

<div class="lyx_code"><a id="magicparlabel-4351"></a><div class="lyx_code_item">closest<a id="magicparlabel-4355"></a>
 &lt;# to keep&gt; &lt;mask&gt; [noimage] [first | oxygen] [center]</div>
<div class="lyx_code_item">        [closestout &lt;filename&gt;] [name &lt;setname&gt;] [outprefix &lt;parmprefix&gt;]
<br />

</div>
<div class="lyx_code_item">        [parmout &lt;file&gt;]</div>

<dl class="description"><a id="magicparlabel-4358"></a><dt class="description_label">&lt;# to keep&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Number of solvent molecules to keep around &lt;mask&gt;</span></dd>
<dt class="description_label">&lt;mask&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Mask of atoms to search for closest waters around.</span></dd>
<dt class="description_label">[noimage]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Do not perform imaging; only recommended if trajectory has previously been imaged.</span></dd>
<dt class="description_label">[first | oxygen]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Calculate distances between all atoms in <b>&lt;mask&gt;</b> and the first atom of solvent only (recommended for standard water models as it will increase speed of calculation).</span></dd>
<dt class="description_label">[center]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Search for waters closest to center of <b>&lt;mask&gt;</b> instead of each atom in <b>&lt;mask&gt;</b>.</span></dd>
<dt class="description_label">[closestout &lt;filename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write information on the closest solvent molecules to <b>&lt;filename&gt;</b>.</span></dd>
<dt class="description_label">[outprefix &lt;prefix&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write corresponding topology to file with name prefix <b>&lt;prefix&gt;</b>.</span></dd>
<dt class="description_label">[parmout &lt;file&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write corresponding topology to file with name &lt;file&gt;.</span></dd>
</dl>
<div class="standard"><a id="magicparlabel-4366"></a><span style="font-family:monospace;">DataSet Aspects:</span></div>

<dl class="description"><a id="magicparlabel-4367"></a><dt class="description_label">[Frame]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Frame number.</span></dd>
<dt class="description_label">[Mol]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Original solvent molecule number.</span></dd>
<dt class="description_label">[Dist]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Solvent molecule distance in Å.</span></dd>
<dt class="description_label">[FirstAtm]</dt>
<dd class="description_item"><span style="font-family:monospace;"> First atom number of original solvent molecule.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-4371"></a>Similar to the <b><i>strip</i></b>
 command, but modify coordinate frame and topology by keeping only the 
specified number of closest solvent molecules to the region specified by
 the given mask. Solvent molecules can be determined automatically by <i>cpptraj</i> (by default residues named WAT, HOH, or TIP3) or can be specified prior via the <b><i>solvent</i></b> command (<a href="#subsec_cpptraj_solvent">8.17</a>). The format of the <b>closestout</b> file is:</div>

<div class="lyx_code"><a id="magicparlabel-4372"></a><div class="lyx_code_item">Frame    Molecule    Distance    FirstAtom#</div>
</div>
<div class="standard"><a id="magicparlabel-4373"></a>For example, to 
obtain the 10 closest waters to residues 1-268 by distance to the first 
atom of the waters, write out which waters were closest for each frame 
to a file called “closestmols.dat”, and write out the stripped topology 
with prefix “closest” containing only the solute and 10 waters:</div>

<div class="lyx_code"><a id="magicparlabel-4374"></a><div class="lyx_code_item">closest 10 :1-268 first closestout closestmols.dat outprefix closest</div>
</div>
<div class="standard"><a id="magicparlabel-4375"></a>As of version 17 this command is CUDA-enabled in CUDA versions of CPPTRAJ.</div>
<h3 class="subsection"><a id="magicparlabel-4376"></a><span class="subsection_label">10.15</span> cluster</h3>
<div class="standard"><a id="magicparlabel-4377"></a>Although the <b>'cluster'</b> command can still be specified as an action, it is now considered an analysis. See <a href="#subsec_cpptraj_cluster_analysis">11.4</a>.</div>
<h3 class="subsection"><a id="magicparlabel-4378"></a><span class="subsection_label">10.16</span> clusterdihedral</h3>

<div class="lyx_code"><a id="magicparlabel-4379"></a><div class="lyx_code_item">clusterdihedral<a id="magicparlabel-4383"></a>
 [phibins &lt;N&gt;] [psibins &lt;M&gt;] [out &lt;outfile&gt;] </div>
<div class="lyx_code_item">                [dihedralfile &lt;dfile&gt; | &lt;mask&gt;]</div>
<div class="lyx_code_item">                [framefile &lt;framefile&gt;] [clusterinfo &lt;infofile&gt;]</div>
<div class="lyx_code_item">                [clustervtime &lt;cvtfile&gt;] [cut &lt;CUT&gt;]</div>
</div>
<div class="standard"><a id="magicparlabel-4387"></a>Cluster frames in a
 trajectory using dihedral angles. To define which dihedral angles will 
be used for clustering either an atom mask or an input file specified by
 the <b>dihedralfile</b> keyword should be used. If dihedral file is used, each line in the file should contain a dihedral to be binned with format:</div>

<div class="lyx_code"><a id="magicparlabel-4388"></a><div class="lyx_code_item">ATOM#1 ATOM#2 ATOM#3 ATOM#4 #BINS</div>
</div>
<div class="standard"><a id="magicparlabel-4389"></a>where the ATOM 
arguments are the atom numbers (starting from 1) defining the dihedral 
and #BINS is the number of bins to be used (so if #BINS=10 the width of 
each bin will be 36º). If an atom mask is specified, only protein 
backbone dihedrals (Phi and Psi defined using atom names C-N-CA-C and 
N-CA-C-N) within the mask will be used, with the bin sizes specified by 
the phibins and psibins keywords (default for each is 10 bins).</div>

<div class="standard"><a id="magicparlabel-4390"></a>Output will either be written to STDOUT or the file specified by the <b>out</b>
 keyword. First, information about which dihedrals were clustered will 
be printed. Then the number of clusters will be printed, followed by 
detailed information of each cluster. The clusters are sorted from most 
populated to least populated. Each cluster line has format</div>

<div class="lyx_code"><a id="magicparlabel-4391"></a><div class="lyx_code_item">Cluster CLUSTERNUM CLUSTERPOP [ dihedral1bin, dihedral2bin ... dihedralNbin ]</div>
</div>
<div class="standard"><a id="magicparlabel-4392"></a>followed by a list of frame numbers that belong to that cluster. If a cutoff is specified by <b>cut</b>, only clusters with population greater than CUT will be printed.</div>

<div class="standard"><a id="magicparlabel-4393"></a>If specified by the <b>clustervtime</b> keyword, the number of clusters for each frame will be printed to &lt;cvtfile&gt;. If specified by the <b>framefile</b> keyword, a file containing cluster information for each frame will be written with format</div>

<div class="lyx_code"><a id="magicparlabel-4394"></a><div class="lyx_code_item">Frame CLUSTERNUM CLUSTERSIZE DIHEDRALBINID</div>
</div>
<div class="standard"><a id="magicparlabel-4395"></a>where DIHEDRALBINID
 is a number that identifies the unique combination of dihedral bins 
this cluster belongs to (specifically it is a 
3*number-of-dihedral-characters long number composed of the individual 
dihedral bins).</div>

<div class="standard"><a id="magicparlabel-4396"></a>If specified by the <b>clusterinfo</b>
 keyword, a file containing information on each dihedral and each 
cluster will be printed. This file can be read by SANDER for use with 
REMD with a structure reservoir (-rremd=3). The file, which is 
essentially a simplified version of the main output file, has the 
following format:</div>

<div class="lyx_code"><a id="magicparlabel-4397"></a><div class="lyx_code_item">#DIHEDRALS</div>
<div class="lyx_code_item">dihedral1_atom1 dihedral1_atom2 dihedral1_atom3 dihedral1_atom4</div>
<div class="lyx_code_item">...</div>
<div class="lyx_code_item">#CLUSTERS</div>
<div class="lyx_code_item">CLUSTERNUM1 CLUSTERSIZE1 DIHEDRALBINID1</div>
<div class="lyx_code_item">...</div>
</div>
<h3 class="subsection"><a id="magicparlabel-4403"></a><span class="subsection_label">10.17</span> contacts</h3>

<div class="lyx_code"><a id="magicparlabel-4404"></a><div class="lyx_code_item">contacts [ first | reference | ref &lt;ref&gt; | refindex &lt;#&gt; ] [byresidue]</div>
<div class="lyx_code_item">         [out &lt;filename&gt;] [time &lt;interval&gt;] [distance &lt;cutoff&gt;] [&lt;mask&gt;]</div>
</div>
<div class="standard"><a id="magicparlabel-4406"></a>NOTE: Users are encouraged to try the <em><b>nativecontacts</b></em> command (<a href="#subsec_cpptraj_nativecontacts">elsewhere</a>), an update version of this command.</div>

<div class="standard"><a id="magicparlabel-4407"></a>For each atom given in <i>mask</i>, calculate the number of other atoms (contacts) within the distance <i>cutoff</i>. The default cutoff is 7.0 A. Only atoms in <i>mask</i> are potential interaction partners (e.g., a mask @CA will evaluate only contacts between CA atoms). The results are dumped to <i>filename</i> if the keyword “<span style="font-family:monospace;">out</span>” is specified. Thereby, the time between snapshots is taken to be <i>interval</i>.
 In addition to the number of overall contacts, the number of native 
contacts is also determined. Native contacts are those that have been 
found either in the first snapshot of the trajectory (if the keyword “<span style="font-family:monospace;">first</span>” is specified) or in a reference structure (if the keyword “<span style="font-family:monospace;">reference</span>” is specified). Finally, if the keyword “<span style="font-family:monospace;">byresidue</span>” is provided, results are output on a per-residue basis for each snapshot, whereby the number of native contacts is written to <i>filename</i>.native.</div>
<h3 class="subsection"><a id="magicparlabel-4408"></a><span class="subsection_label">10.18</span> createcrd<a id="subsec_cpptraj_createcrd"></a>
</h3>

<div class="lyx_code"><a id="magicparlabel-4409"></a><div class="lyx_code_item">createcrd [&lt;name&gt;] [ parm &lt;name&gt; | parmindex &lt;#&gt; ]</div>
</div>
<div class="standard"><a id="magicparlabel-4410"></a>This command 
creates a COORDS data set named &lt;name&gt; using trajectory frames 
that are associated with the specified topology.</div>

<div class="standard"><a id="magicparlabel-4411"></a>For example, to 
save frames that have been previously RMS-fit to a reference structure 
into a COORDS set named MyCrd you would use the input:</div>

<div class="lyx_code"><a id="magicparlabel-4412"></a><div class="lyx_code_item">rms reference :1-12@CA</div>
<div class="lyx_code_item">createcrd MyCrd</div>
<div class="lyx_code_item">strip :6-8</div>
</div>
<div class="standard"><a id="magicparlabel-4415"></a>Note that here the <em><b>strip</b></em> command will have no effect on the coordinates saved in MyCrd since it occurs after the <em><b>createcrd</b></em> command.</div>
<h3 class="subsection"><a id="magicparlabel-4416"></a><span class="subsection_label">10.19</span> createreservoir</h3>

<div class="lyx_code"><a id="magicparlabel-4417"></a><div class="lyx_code_item">createreservoir &lt;filename&gt; ene &lt;energy data set&gt; [bin &lt;cluster bin data set&gt;]</div>
<div class="lyx_code_item">                temp0 &lt;temp0&gt; iseed &lt;iseed&gt; [velocity]</div>
<div class="lyx_code_item">                [parm &lt;parmfile&gt; | parmindex &lt;#&gt;] [title &lt;title&gt;]
<br />

</div>

<dl class="description"><a id="magicparlabel-4420"></a><dt class="description_label">&lt;filename&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> File name of the reservoir to create.</span></dd>
<dt class="description_label">ene &lt;energy data set&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Data set with energies corresponding to frames.</span></dd>
<dt class="description_label">[bin &lt;cluster bin data set&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Data set with bin numbers (for RREMD=3).</span></dd>
<dt class="description_label">temp0 &lt;temp0&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Reservoir temperature.</span></dd>
<dt class="description_label">iseed &lt;iseed&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Reservoir random number seed.</span></dd>
<dt class="description_label">[velocity]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Include velocities in the reservoir.</span></dd>
<dt class="description_label">[parm &lt;parmfile&gt; | parmindex &lt;#&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Associated topology.</span></dd>
<dt class="description_label">[title &lt;title&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Reservoir title.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-4428"></a>Create structure 
reservoir for use with reservoir REMD simulations using energies in 
&lt;energy data set&gt;, temperature &lt;temp0&gt; and random seed 
&lt;iseed&gt; Include velocities if [velocity] is specified. If 
&lt;cluster bin data set&gt; is specified from e.g. a previous 
'clusterdihedral' command, the reservoir can be used for non-Boltzmann 
reservoir REMD (rremd==3).</div>
<h3 class="subsection"><a id="magicparlabel-4429"></a><span class="subsection_label">10.20</span> density</h3>

<div class="lyx_code"><a id="magicparlabel-4430"></a><div class="lyx_code_item">density [out &lt;filename&gt;] [name &lt;set name&gt;] [delta &lt;resolution&gt;] [x|y|z]</div>
<div class="lyx_code_item">        [number|mass|charge|electron] [efile &lt;filename&gt;]</div>
<div class="lyx_code_item">        [&lt;mask1&gt; ... &lt;maskN&gt;]
<br />

</div>

<dl class="description"><a id="magicparlabel-4433"></a><dt class="description_label">out</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output file for histogram: relative distances vs. densities for each mask. </span></dd>
<dt class="description_label">delta</dt>
<dd class="description_item"><span style="font-family:monospace;"> Resolution, i.e. determines number of slices. (0.25 Å) </span></dd>
<dt class="description_label">x|y|z</dt>
<dd class="description_item"><span style="font-family:monospace;"> Coordinate for density calculation. (z) </span></dd>
<dt class="description_label">number|mass|charge|electron</dt>
<dd class="description_item"><span style="font-family:monospace;"> 
Number, mass, partial charge (q) or electron (Ne - q) density. To 
convert the electron density to e-/Å3 divide by the (average) area 
spanned by the other two dimensions. (number)</span></dd>
<dt class="description_label">mask1 ... maskN</dt>
<dd class="description_item"><span style="font-family:monospace;"> Arbitrary number of masks for atom selection; a dataset is created and the output will contain entries for each mask.</span></dd>
</dl>
<div class="standard"><a id="magicparlabel-4438"></a><span style="font-family:monospace;">DataSet Aspects:</span></div>

<dl class="description"><a id="magicparlabel-4439"></a><dt class="description_label">[avg]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Average density over coordinate.</span></dd>
<dt class="description_label">[sd]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Standard deviation of density over coordinate.</span></dd>
</dl>
<div class="lyx_code_item"></div>
</div>
<div class="standard"><a id="magicparlabel-4442"></a>If no arguments are
 specified, calculate the total system density. Otherwise, calculate 
specified density for system. Defaults are shown in parentheses above. 
The format of the file is as follows. Comments are lines starting with 
'#' or empty lines. All other lines must contain the atom type followed 
by an integer number for the electron number. Entries must be separated 
by spaces or '='. Example input:</div>

<div class="lyx_code"><a id="magicparlabel-4443"></a><div class="lyx_code_item">density out number_density.dat number delta 0.25 ":POPC@P1" ":POPC@N" \</div>
<div class="lyx_code_item">        ":POPC@C2" ":POPC"</div>
<div class="lyx_code_item">density out mass_density.dat mass delta 0.25 ":POPC@P1" ":POPC@N" \</div>
<div class="lyx_code_item">        ":POPC@C2" ":POPC"</div>
<div class="lyx_code_item">density out charge_density.dat charge delta 0.25 ":POPC@P1" ":POPC@N" \</div>
<div class="lyx_code_item">        ":POPC@C2" ":POPC"</div>
<div class="lyx_code_item">density out electron_density.dat electron delta 0.25 efile Nelec.in \</div>
<div class="lyx_code_item">        ":POPC@P1" ":POPC@N" ":POPC@C2" ":POPC" ":TIP3" \</div>
<div class="lyx_code_item">        ":POPC | :TIP3" "*"</div>
<div class="lyx_code_item">density out ion_density.dat number delta 0.25 ":SOD" ":CLA"</div>
</div>
<div class="standard"><a id="magicparlabel-4453"></a>See also $AMBERHOME/AmberTools/test/cpptraj/Test_Density.</div>
<h3 class="subsection"><a id="magicparlabel-4454"></a><span class="subsection_label">10.21</span> diffusion</h3>
<div class="standard"><a id="magicparlabel-4455"></a><em>Note that although the syntax for <b>diffusion</b> has changed as of version 16, the old syntax is still supported.</em></div>

<div class="lyx_code"><a id="magicparlabel-4456"></a><div class="lyx_code_item">diffusion [{out &lt;filename&gt; | separateout &lt;suffix&gt;}] [time &lt;time per frame&gt;] [noimage]</div>
<div class="lyx_code_item">      	[&lt;mask&gt;] [&lt;set name&gt;] [individual] [diffout &lt;filename&gt;] [nocalc]
<br />

</div>

<dl class="description"><a id="magicparlabel-4458"></a><dt class="description_label">[out &lt;filename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write mean-square displacement (MSD) data set output to file specified by &lt;filename&gt;.</span></dd>
<dt class="description_label">[separateout &lt;suffix&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write each MSD data set type to files with suffix &lt;suffix&gt;; see description below.</span></dd>
<dt class="description_label">[time &lt;time_per_frame&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Time in-between each coordinate frame in ps; default is 1.0.</span></dd>
<dt class="description_label">[noimage]</dt>
<dd class="description_item"><span style="font-family:monospace;"> If specified do not perform imaging. If this is specified coordinates should be unwrapped prior to this command.</span></dd>
<dt class="description_label">[&lt;mask&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Mask of atoms to calculate diffusion for; default all atoms.</span></dd>
<dt class="description_label">[&lt;set name&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> MSD data set name.</span></dd>
<dt class="description_label">[individual]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write diffusion for each individual atom as well as average diffusion for atoms in mask.</span></dd>
<dt class="description_label">[diffout &lt;filename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write diffusion contants calculated from fits of MSD data sets to &lt;filename&gt;.</span></dd>
<dt class="description_label">[nocalc]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Do not calculate diffusion constants.</span></dd>
</dl>
<div class="standard"><a id="magicparlabel-4467"></a><span style="font-family:monospace;">DataSet Aspects:</span></div>

<dl class="description"><a id="magicparlabel-4468"></a><dt class="description_label">[X]</dt>
<dd class="description_item"><span style="font-family:monospace;"> MSD(s) in the X direction.</span></dd>
<dt class="description_label">[Y]</dt>
<dd class="description_item"><span style="font-family:monospace;"> MSD(s) in the Y direction.</span></dd>
<dt class="description_label">[Z]</dt>
<dd class="description_item"><span style="font-family:monospace;"> MSD(s) in the Z direction.</span></dd>
<dt class="description_label">[R]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Overall MSD(s).</span></dd>
<dt class="description_label">[A]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Overall displacement(s).</span></dd>
<dt class="description_label">[D]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Diffusion constants.</span></dd>
<dt class="description_label">[Label]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Diffusion constant lablels.</span></dd>
<dt class="description_label">[Slope]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Linear regression slopes.</span></dd>
<dt class="description_label">[Intercept]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Linear refression Y-intercepts.</span></dd>
<dt class="description_label">[Corr]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Linear regression correlation coefficients.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-4478"></a>Compute mean square displacement (MSD) plots (using distance traveled from initial position) for the atoms in <b>&lt;mask&gt;</b>. By default only the diffusion averaged over all atoms in <b>&lt;mask&gt;</b> is calculated; if <b>individual</b> is specified diffusion for individual atoms is calculated as well. </div>

<div class="standard"><a id="magicparlabel-4479"></a>In order to 
correctly calculate diffusion molecules should take continuous paths, so
 imaging of atoms is autoimatically performed. If the trajectory is 
already unwrapped (or the unwrap command is used prior to this command) 
the <b>noimage</b> keyword can be used. </div>

<div class="standard"><a id="magicparlabel-4480"></a>The following types of displacements are calculated. If <b>separateout</b> is specfied the following files will be created:</div>

<dl class="description"><a id="magicparlabel-4481"></a><dt class="description_label">x_&lt;suffix&gt;</dt>
<dd class="description_item"> Mean square displacement(s) in the X direction (in Å<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup><mrow/>
   <mrow>
    <mstyle mathvariant="normal"><mn>2</mn>
    </mstyle>
   </mrow>
  </msup>
 </mrow></math>/ps).</dd>
<dt class="description_label">y_&lt;suffix&gt;</dt>
<dd class="description_item"> Mean square displacement(s) in the Y direction (in Å<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup><mrow/>
   <mrow>
    <mstyle mathvariant="normal"><mn>2</mn>
    </mstyle>
   </mrow>
  </msup>
 </mrow></math>/ps).</dd>
<dt class="description_label">z_&lt;suffix&gt;</dt>
<dd class="description_item"> Mean square displacement(s) in the Z direction (in Å<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup><mrow/>
   <mrow>
    <mstyle mathvariant="normal"><mn>2</mn>
    </mstyle>
   </mrow>
  </msup>
 </mrow></math>/ps).</dd>
<dt class="description_label">r_&lt;suffix&gt;</dt>
<dd class="description_item"> Overall mean square displacement(s) (in Å<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup><mrow/>
   <mrow>
    <mstyle mathvariant="normal"><mn>2</mn>
    </mstyle>
   </mrow>
  </msup>
 </mrow></math>/ps).</dd>
<dt class="description_label">a_&lt;suffix&gt;</dt>
<dd class="description_item"> Total distance traveled (in Å/ps).</dd>
</dl>
<div class="standard"><a id="magicparlabel-4486"></a>The diffusion coefficient <b><i>D</i></b> can be calculated using the Einstein relation:</div>

<div class="standard"><a id="magicparlabel-4487"></a><math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mn>2</mn><mi>n</mi><mi>D</mi><mo>=</mo>
   <msub>
    <mrow><mo> lim </mo>
    </mrow>
    <mrow>
     <mrow><mi>t</mi><mo> → </mo><mi> ∞ </mi>
     </mrow>
    </mrow>
   </msub>
   <mfrac>
    <mrow>
     <mrow><mi>M</mi><mi>S</mi><mi>D</mi>
     </mrow>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </mfrac>
  </mrow>
 </mrow></math></div>

<div class="standard"><a id="magicparlabel-4488"></a>Where <b><i>n</i></b> is the number of dimensions; for overall MSD n = 3, for single dimension MSD (e.g. X) n = 1, etc. Unless <b>nocalc</b> is specified, the diffusion constant is calculated automatically from MSD data sets (and written to the file specified by <b>diffout</b>) in the following manner. The slope the plot of MSD versus time is obtained via linear regression. To convert from units of Å<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup><mrow/>
   <mrow>
    <mstyle mathvariant="normal"><mn>2</mn>
    </mstyle>
   </mrow>
  </msup>
 </mrow></math>/ps to 1x10<sup class="script_superscript">-5</sup> cm<sup class="script_superscript">2</sup>/s,
 the slope is multiplied by 10.0/(2n). Both the calculated diffusion 
constants as well as the results of the fit are reported.</div>

<div class="standard"><a id="magicparlabel-4497"></a>Due to the fact 
that diffusion is currently calculated from initial positions only, 
diffusion calculated for small numbers of atoms will be inherently 
stochastic, so the results are most sensible when averaged over many 
atoms; for example, the diffusion of water should be calculated using 
all waters in the system.</div>

<div class="standard"><a id="magicparlabel-4498"></a>For example, to calculate the diffusion of water in a system:</div>

<div class="lyx_code"><a id="magicparlabel-4499"></a><div class="lyx_code_item">diffusion :WAT@O out WAT_O.agr WAT_O diffout DC.dat</div>
</div>
<h3 class="subsection"><a id="magicparlabel-4500"></a><span class="subsection_label">10.22</span> dihedral </h3>

<div class="lyx_code"><a id="magicparlabel-4501"></a><div class="lyx_code_item">dihedral<a id="magicparlabel-4505"></a>
 [&lt;name&gt;] &lt;mask1&gt; &lt;mask2&gt; &lt;mask3&gt; &lt;mask4&gt; [out &lt;filename&gt;] [mass]</div>
<div class="lyx_code_item">         [type {alpha|beta|gamma|delta|epsilon|zeta|chi|c2p|h1p|phi|psi|omega|pchi}]</div>
<div class="lyx_code_item">         [range360]
<br />

</div>

<dl class="description"><a id="magicparlabel-4508"></a><dt class="description_label">[&lt;name&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output data set name.</span></dd>
<dt class="description_label">&lt;maskX&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Four atom masks selecting atom(s) to calculate dihedral for.</span></dd>
<dt class="description_label">[out &lt;filename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output file name.</span></dd>
<dt class="description_label">[mass]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use center of mass of atoms in &lt;maskX&gt;; default is geometric center.</span></dd>
<dt class="description_label">[range360]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output dihedral angle values from 0 to 360 degrees instead of -180 to 180 degrees.</span></dd>
<dt class="description_label">[type &lt;type&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Label dihedral as &lt;type&gt; for use with <b><i>statistics</i></b> analysis; note 'chi' is nucleic acid chi and 'pchi' is protein chi.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-4514"></a>Calculate dihedral 
angle (in degrees) between the planes defined by atoms in &lt;mask1&gt;,
 &lt;mask2&gt;, &lt;mask3&gt; and &lt;mask2&gt;, &lt;mask3&gt;, 
&lt;mask4&gt;.</div>
<h3 class="subsection"><a id="magicparlabel-4515"></a><span class="subsection_label">10.23</span> dihedralscan</h3>
<div class="standard"><a id="magicparlabel-4516"></a>This command has been replaced by <em><b>permutedihedrals</b></em>; see <a href="#subsec_cpptraj_permutedihedrals">6.7</a>. To calculate multiple dihedral angles see the <em><b>multidihedral</b></em> command.</div>
<h3 class="subsection"><a id="magicparlabel-4517"></a><span class="subsection_label">10.24</span> dipole</h3>

<div class="lyx_code"><a id="magicparlabel-4518"></a><div class="lyx_code_item">dipole
 &lt;filename&gt; {data &lt;dsname&gt; | &lt;nx&gt; &lt;dx&gt; 
&lt;ny&gt; &lt;dy&gt; &lt;nz&gt; &lt;dz&gt; [gridcenter &lt;cx&gt; 
&lt;cy&gt; &lt;cz&gt;]}</div>
<div class="lyx_code_item">   	[box|origin|center &lt;mask&gt;] [negative] [name &lt;gridname&gt;]</div>
<div class="lyx_code_item">       &lt;mask1&gt; {origin | box} [max &lt;max_percent&gt;]</div>
</div>
<div class="standard"><a id="magicparlabel-4521"></a>NOTE: This command is not well-tested and may be obsolete.</div>

<div class="standard"><a id="magicparlabel-4522"></a>Same as <b><span style="font-family:sans-serif;">grid</span></b> (see <a href="#subsec_cpptraj_grid">10.34</a>
 below) except that dipoles of the solvent molecules are binned. The 
output file format is for Chris Bayly's discern delegate program that 
comes with Midas/Plus. Consult the code in Action_Dipole.cpp for more 
information.<i> </i></div>
<h3 class="subsection"><a id="magicparlabel-4523"></a><span class="subsection_label">10.25</span> distance </h3>

<div class="lyx_code"><a id="magicparlabel-4524"></a><div class="lyx_code_item">distance<a id="magicparlabel-4528"></a>
 [&lt;name&gt;] &lt;mask1&gt; [&lt;mask2&gt;] [point &lt;X&gt; &lt;Y&gt; &lt;Z&gt;]</div>
<div class="lyx_code_item">         [ reference | ref &lt;name&gt; | refindex &lt;#&gt; ]</div>
<div class="lyx_code_item">     	[out &lt;filename&gt;] [geom] [noimage] [type noe]</div>
<div class="lyx_code_item">	Options for 'type noe':</div>
<div class="lyx_code_item">	  [bound &lt;lower&gt; bound &lt;upper&gt;] [rexp &lt;expected&gt;] [noe_strong] [noe_medium] [noe_weak]
<br />

</div>

<dl class="description"><a id="magicparlabel-4533"></a><dt class="description_label">[&lt;name&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output data set name</span></dd>
<dt class="description_label">&lt;mask1&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Atom mask selecting atom(s) to calculate distance between.</span></dd>
<dt class="description_label">&lt;mask2&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> If specified, second atom mask selection atom(s) to calculate distance from &lt;mask1&gt;.</span></dd>
<dt class="description_label">point &lt;X&gt; &lt;Y&gt; &lt;Z&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> If specified instead of second mask, calculate distance between &lt;mask1&gt; and specified XYZ coordinates.</span></dd>
<dt class="description_label">reference | ref &lt;name&gt; | refindex &lt;#&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> If specified, calculate distance between &lt;mask1&gt; and &lt;mask2&gt; in specified reference.</span></dd>
<dt class="description_label">[out &lt;filename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output filename.</span></dd>
<dt class="description_label">[geom]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use geometric center of atoms in &lt;mask1&gt;/&lt;mask2&gt;; default is to use center of mass.</span></dd>
<dt class="description_label">[noimage]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Do not image distances across periodic boundaries.</span></dd>
<dt class="description_label">[type noe]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Mark distance as 'noe' for use with <b><i>statistics</i></b> analysis.
<br />

</span>

<dl class="description"><a id="magicparlabel-4542"></a><dt class="description_label">[bound &lt;lower&gt; bound &lt;upper&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Lower and upper bounds for NOE (in Angstroms); must specify both.</span></dd>
<dt class="description_label">[rexp &lt;expected&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Expected value for NOE (in Angstroms); if not given '(&lt;lower&gt; + &lt;upper&gt;)' / 2.0 is used.</span></dd>
<dt class="description_label">[noe_strong]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Set lower and upper bounds to 1.8 and 2.9 Å respectively.</span></dd>
<dt class="description_label">[noe_medium]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Set lower and upper bounds to 2.9 and 3.5 Å respectively.</span></dd>
<dt class="description_label">[noe_weak]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Set lower and upper bounds to 3.5 and 5.0 Å respectively.</span></dd>
</dl>
</dd></dl>
</div>
<div class="standard"><a id="magicparlabel-4547"></a>Calculate distance 
between the center of mass of atoms in &lt;mask1&gt; to atoms in 
&lt;mask2&gt;, between atoms in &lt;mask1&gt; and atoms in &lt;mask2&gt;
 in specified reference, or atoms in &lt;mask1&gt; and the specified 
point. If <b>geom</b> is specified use the geometric center instead. For periodic systems imaging is turned on by default; the <b>noimage</b> keyword disables imaging.</div>

<div class="standard"><a id="magicparlabel-4548"></a>A distance can be labeled using '<span style="font-family:monospace;">type noe</span>' for further analysis as an NOE using the <b><i>'statistics'</i></b> analysis command (<a href="#subsec_cpptraj_statistics">11.32</a>).</div>
<h3 class="subsection"><a id="magicparlabel-4549"></a><span class="subsection_label">10.26</span> drms | drmsd (distance RMSD)</h3>

<div class="lyx_code"><a id="magicparlabel-4550"></a><div class="lyx_code_item">drmsd<a id="magicparlabel-4554"></a>
 [&lt;dataset name&gt;] [&lt;mask&gt; [&lt;refmask&gt;]] [out &lt;filename&gt;]
<br />

      [ first | ref &lt;refname&gt; | refindex &lt;#&gt; | 
<br />

        reftraj &lt;trajname&gt; [parm &lt;trajparm&gt; | parmindex &lt;parm#&gt;] ]
<br />

</div>

<dl class="description"><a id="magicparlabel-4555"></a><dt class="description_label">[&lt;dataset name&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output data set name.</span></dd>
<dt class="description_label">[&lt;mask&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Atoms to calculate DRMSD for.</span></dd>
<dt class="description_label">[&lt;refmask&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Mask corresponding to atoms in reference; if not specified, &lt;mask&gt; is used.</span></dd>
<dt class="description_label">[out &lt;filename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output file name.</span></dd>
<dt class="description_label">[first]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use the first trajectory frame processed as reference.</span></dd>
<dt class="description_label">[reference]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use the first previously read in reference structure.</span></dd>
<dt class="description_label">[ref &lt;refname&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use previously read in reference structure specified by &lt;refname&gt;.</span></dd>
<dt class="description_label">[refindex &lt;#&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use previously read in reference structure specified by &lt;#&gt; (based on order read in).</span></dd>
<dt class="description_label">previous</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use frame prior to current frame as reference.</span></dd>
<dt class="description_label">reftraj &lt;name&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use 
frames from COORDS set &lt;name&gt; or read in from trajectory file 
&lt;name&gt; as references. Each frame from &lt;name&gt; is used in 
turn, so that frame 1 is compared to frame 1 from &lt;name&gt;, frame 2 
is compared to frame 2 from &lt;name&gt; and so on. If &lt;trajname&gt; 
runs out of frames before processing is complete, the last frame of 
&lt;trajname&gt; continues to be used as the reference.
<br />

</span>

<dl class="description"><a id="magicparlabel-4565"></a><dt class="description_label">parm &lt;parmname&gt; | parmindex &lt;#&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> If <b>reftraj</b> specifies a file associate trajectory &lt;name&gt; with specified topology; if not specified the first topology is used.</span></dd>
</dl>
</dd></dl>
</div>
<div class="standard"><a id="magicparlabel-4566"></a>Calculate the distance RMSD (i.e. the RMSD of all pairs of internal distances) between atoms in the frame defined by <b>&lt;mask&gt;</b> (all if no <b>&lt;mask&gt;</b> specified) to atoms in a reference defined by <b>&lt;refmask&gt;</b> (<b>&lt;mask&gt;</b> if <b>&lt;refmask&gt;</b> not specified). Both <b>&lt;mask&gt;</b> and <b>&lt;refmask&gt;</b> must specify the same number of atoms, otherwise an error will occur. </div>

<div class="standard"><a id="magicparlabel-4567"></a>Because this method
 compares pairs of internal distances and not absolute coordinates, it 
is not sensitive to translations and rotations the way that a no-fit 
RMSD calculation is. It can be more time consuming however, as (N<sup class="script_superscript">2</sup>-N)/2 distances must be calculated and compared for both the target and reference structures. </div>

<div class="standard"><a id="magicparlabel-4572"></a>For example, to get the DRMSD of a residue named LIG to its structure in the first frame read in:</div>

<div class="lyx_code"><a id="magicparlabel-4573"></a><div class="lyx_code_item">drmsd :LIG first out drmsd.dat</div>
</div>
<h3 class="subsection"><a id="magicparlabel-4574"></a><span class="subsection_label">10.27</span> dssp</h3>
<div class="standard"><a id="magicparlabel-4575"></a>See <a href="#subsec_cpptraj_secstruct">10.70</a>.</div>
<h3 class="subsection"><a id="magicparlabel-4576"></a><span class="subsection_label">10.28</span> energy</h3>

<div class="lyx_code"><a id="magicparlabel-4577"></a><div class="lyx_code_item">energy [&lt;name&gt;] [&lt;mask1&gt;] [out &lt;filename&gt;]</div>
<div class="lyx_code_item">   	[bond] [angle] [dihedral] {[nb14] | [e14] | [v14]}</div>
<div class="lyx_code_item">   	{[nonbond] | [elec] [vdw]} [kinetic [ketype {vel|vv}] [dt &lt;dt&gt;]]</div>
<div class="lyx_code_item">   	[ etype { simple |</div>
<div class="lyx_code_item">   	          directsum [npoints &lt;N&gt;] |</div>
<div class="lyx_code_item">   	          ewald [cut &lt;cutoff&gt;] [dsumtol &lt;dtol&gt;] [rsumtol &lt;rtol&gt;]</div>
<div class="lyx_code_item">   	                [ewcoeff &lt;coeff&gt;] [maxexp &lt;max&gt;] [skinnb &lt;skinnb&gt;]</div>
<div class="lyx_code_item">   	                [mlimits &lt;X&gt;,&lt;Y&gt;,&lt;Z&gt;] [erfcdx &lt;dx&gt;]</div>
<div class="lyx_code_item">   	          pme [cut &lt;cutoff&gt;] [dsumtol &lt;dtol&gt;] [order &lt;order&gt;]</div>
<div class="lyx_code_item">   	              [ewcoeff &lt;coeff&gt;] [skinnb &lt;skinnb&gt;]</div>
<div class="lyx_code_item">   	              [nfft &lt;nfft1&gt;,&lt;nfft2&gt;,&lt;nfft3&gt;] [erfcdx &lt;dx&gt;]</div>
<div class="lyx_code_item">   	        } ] 
<br />

</div>

<dl class="description"><a id="magicparlabel-4589"></a><dt class="description_label">[&lt;name&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Data set name.</span></dd>
<dt class="description_label">[&lt;mask1&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Mask of atoms to calculate energy for.</span></dd>
<dt class="description_label">[out &lt;filename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> File to write results to.</span></dd>
<dt class="description_label">[bond]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Calculate bond energy.</span></dd>
<dt class="description_label">[angle]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Calculate angle energy.</span></dd>
<dt class="description_label">[dihedral]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Calculate dihedral energy.</span></dd>
<dt class="description_label">[nb14]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Calculate nonbonded 1-4 energy.</span></dd>
<dt class="description_label">[e14]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Calculate 1-4 electrostatics.</span></dd>
<dt class="description_label">[v14]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Calculate 1-4 van der Waals.</span></dd>
<dt class="description_label">[nonbond]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Calculate nonbonded energy (electrostatics and van der Waals).</span></dd>
<dt class="description_label">[elec]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Calculate electrostatic energy.</span></dd>
<dt class="description_label">[vdw]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Calculate van der Waals energy.</span></dd>
<dt class="description_label">[etype &lt;type&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Calculate electrostatics via specified type.</span></dd>
<dt class="description_label">[simple]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use simple Coulomb term for electrostatics, no cutoff.</span></dd>
<dt class="description_label">[directsum]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use direct summation method for electrostatics.</span>

<dl class="description"><a id="magicparlabel-4604"></a><dt class="description_label">[npoints &lt;N&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Number of cells in each direction to calculate the direct sum.</span></dd>
</dl>
</dd><dt class="description_label">[ewald]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use 
Ewald summation for electrostatics. If van der Waals energy will be 
calculated a long-range correction for periodicity will be applied.</span>

<dl class="description"><a id="magicparlabel-4606"></a><dt class="description_label">cut &lt;cutoff&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Direct space cutoff in Angstroms (default 8.0).</span></dd>
<dt class="description_label">dsumtol &lt;dtol&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Direct sum tolerance (default 0.00001). Used to determine Ewald coefficient.</span></dd>
<dt class="description_label">rsumtol &lt;rtol&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Reciprocal sum tolerance (default 0.00005). Used to determine number of reciprocal space vectors.</span></dd>
<dt class="description_label">ewcoeff &lt;coeff&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Ewald coefficient in 1/Ang.</span></dd>
<dt class="description_label">skinnb</dt>
<dd class="description_item"><span style="font-family:monospace;"> Used to determine pairlist atoms (added to cut, so pairlist cutoff is <b>cut</b> + <b>skinnb</b>); included in order to maintain consistency with results from sander. </span></dd>
<dt class="description_label">mlimits &lt;X&gt;,&lt;Y&gt;,&lt;Z&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Explicitly set the number of reciprocal space vectors in each dimension. Will be determined automatically if not specified.</span></dd>
</dl>
</dd><dt class="description_label">[pme]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use 
particle mesh Ewald for electrostatics. If van der Waals energy will be 
calculated a long-range correction for periodicity will be applied.</span>

<dl class="description"><a id="magicparlabel-4613"></a><dt class="description_label">cut &lt;cutoff&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Direct space cutoff in Angstroms (default 8.0).</span></dd>
<dt class="description_label">dsumtol &lt;dtol&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Direct sum tolerance (default 0.00001). Used to determine Ewald coefficient.</span></dd>
<dt class="description_label">order &lt;order&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Spline order for charges.</span></dd>
<dt class="description_label">ewcoeff &lt;coeff&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Ewald coefficient in 1/Ang.</span></dd>
<dt class="description_label">skinnb</dt>
<dd class="description_item"><span style="font-family:monospace;"> Used to determine pairlist atoms (added to cut, so pairlist cutoff is <b>cut</b> + <b>skinnb</b>); included in order to maintain consistency with results from sander. </span></dd>
<dt class="description_label">nfft &lt;nfft1&gt;,&lt;nfft2&gt;,&lt;nfft3&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Explicitly set the number of FFT grid points in each dimension. Will be determined automatically if not specified.</span></dd>
</dl>
</dd></dl>
<div class="standard"><a id="magicparlabel-4619"></a><span style="font-family:monospace;">DataSet Aspects:</span></div>

<dl class="description"><a id="magicparlabel-4620"></a><dt class="description_label">[bond]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Bond energy.</span></dd>
<dt class="description_label">[angle]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Angle energy.</span></dd>
<dt class="description_label">[dih]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Dihedral energy.</span></dd>
<dt class="description_label">[vdw14]</dt>
<dd class="description_item"><span style="font-family:monospace;"> 1-4 van der Waals energy.</span></dd>
<dt class="description_label">[elec14]</dt>
<dd class="description_item"><span style="font-family:monospace;"> 1-4 electrostatic energy.</span></dd>
<dt class="description_label">[vdw]</dt>
<dd class="description_item"><span style="font-family:monospace;"> van der Waals energy.</span></dd>
<dt class="description_label">[elec]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Electrostatic energy.</span></dd>
<dt class="description_label">[total]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Total energy.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-4628"></a>Calculate the 
energy for atoms in &lt;mask&gt;. If no terms are specified, all terms 
are calculated. Note that the non-bonded energy terms for <b>'simple'</b>
 do not take into account periodicity and there is no distance cut-off. 
Electrostatics can also be determined via the direct sum, Ewald, or 
particle-mesh Ewald summation procedures. The particle mesh Ewald 
functionality requires that CPPTRAJ be compiled with FFTW and a C++11 
compliant compiler.</div>

<div class="standard"><a id="magicparlabel-4629"></a>Calculation of 
energy terms requires that the associated topology file have parameters 
for any of the calculated terms, so for example angle calculations are 
not possible when using a PDB file as a topology, etc. All nonbonded 
calculations methods other than <b>simple</b> require unit cell parameters.</div>

<div class="standard"><a id="magicparlabel-4630"></a>For example, to calculate all energy terms and write to a Grace-format file:</div>

<div class="lyx_code"><a id="magicparlabel-4631"></a><div class="lyx_code_item">parm DPDP.parm7 </div>
<div class="lyx_code_item">trajin DPDP.nc </div>
<div class="lyx_code_item">energy DPDP out ene.agr </div>
</div>
<h3 class="subsection"><a id="magicparlabel-4634"></a><span class="subsection_label">10.29</span> esander</h3>

<div class="lyx_code"><a id="magicparlabel-4635"></a><div class="lyx_code_item">esander [&lt;name&gt;] [out &lt;filename&gt;] [saveforces] [parmname &lt;file&gt;] [keepfiles]</div>
<div class="lyx_code_item">        [&lt;namelist vars&gt; ...]
<br />

</div>

<dl class="description"><a id="magicparlabel-4637"></a><dt class="description_label">[&lt;name&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Data set name.</span></dd>
<dt class="description_label">[out &lt;filename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> File to write results to.</span></dd>
<dt class="description_label">[saveforces]</dt>
<dd class="description_item"><span style="font-family:monospace;"> If specified, save forces to frames. Requires writing frames in NetCDF format.</span></dd>
<dt class="description_label">[parmname &lt;file&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Name of temporary topology file (default: 'CpptrajEsander.parm7').</span></dd>
<dt class="description_label">[keepfiles]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Keep temporary topology file after program execution.</span></dd>
<dt class="description_label">[&lt;namelist vars&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Namelist variables supported by the sander API in format 'var &lt;value&gt;'; see below.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-4643"></a>Calculate energies 
for input frames using the sander API. It requires compilation with the 
SANDER API (sanderlib). This can be considered as a faster alternative 
to energy post-processing with sander (imin = 5). Currently the 
following sander namelist variables are supported: <b>extidel</b>, <b>intdiel</b>, <b>rgbmax</b>, <b>saltcon</b>, <b>cut</b>, <b>dielc</b>, <b>igb</b>, <b>alpb</b>, <b>gbsa</b>, <b>lj1264</b>, <b>ipb</b>, <b>inp</b>, <b>vdwmeth</b>, <b>ew_type</b>, <b>ntb</b>, <b>ntf</b>, <b>ntc</b>. See <a href="#chap_sander">chap:sander</a> for details.</div>

<div class="standard"><a id="magicparlabel-4644"></a>If ntb/cut/igb are 
not specified cpptraj will attempt to pick reasonable values based on 
the input system. The defaults for a non-periodic system are ntb=0, 
cut=9999.0, igb=1. The defaults for a periodic system are ntb=1, 
cut=8.0, igb=0. This currently requires writing a temporary Amber 
topology, the name of which can be set by <b>parmname</b>. If <b>keepfiles</b> is specified this temporary topology will not be deleted after execution.</div>

<div class="standard"><a id="magicparlabel-4645"></a>For example, to calculate energies for a non-periodic system using igb=1 (the default) with GB surface area turned on (gbsa=1):</div>

<div class="lyx_code"><a id="magicparlabel-4646"></a><div class="lyx_code_item">parm DPDP.parm7</div>
<div class="lyx_code_item">trajin DPDP.nc</div>
<div class="lyx_code_item">esander DPDP out Edpdp.dat gbsa 1 </div>
</div>
<h3 class="subsection"><a id="magicparlabel-4649"></a><span class="subsection_label">10.30</span> filter<a id="subsec_cpptraj_filter"></a>
</h3>

<div class="lyx_code"><a id="magicparlabel-4650"></a><div class="lyx_code_item">filter &lt;dataset1 arg&gt; min &lt;min1&gt; max &lt;max1&gt;</div>
<div class="lyx_code_item">       [&lt;dataset2 arg&gt; min &lt;min2&gt; max &lt;max2&gt; ...]</div>
<div class="lyx_code_item">       [out &lt;file&gt; [name &lt;setname&gt;]]
<br />

</div>

<dl class="description"><a id="magicparlabel-4653"></a><dt class="description_label">&lt;datasetX arg&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Data set name(s) to use for filtering</span></dd>
<dt class="description_label">min &lt;minX&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Allow values greater than &lt;min&gt; in dataset X.</span></dd>
<dt class="description_label">max &lt;maxX&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Allow values greater than &lt;max&gt; in dataset X.</span></dd>
<dt class="description_label">[out &lt;file&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> File containing 1 for frames that were allowed, 0 for frames that were filtered.</span></dd>
<dt class="description_label">[name &lt;setname&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Filtered data set name containing 1 for allowed frames, 0 for filtered frames.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-4658"></a>For all following actions, only include frames that are between <b>&lt;min&gt;</b> and <b>&lt;max&gt;</b> of data sets in <b>&lt;dataset arg&gt;</b>. There must be at least one <b>&lt;min&gt;</b> and <b>&lt;max&gt;</b> argument, and there must be as many <b>&lt;min&gt;</b>/<b>&lt;max&gt;</b>
 arguments as there are specified data sets. For example, to write only 
frames in-between an RMSD of 0.7-0.8 Angstroms for a given input 
trajectory:</div>

<div class="lyx_code"><a id="magicparlabel-4659"></a><div class="lyx_code_item">trajin ../tz2.truncoct.nc</div>
<div class="lyx_code_item">rms R1 first :2-11</div>
<div class="lyx_code_item">filter R1 min 0.7 max 0.8 out filter.dat</div>
<div class="lyx_code_item">outtraj maxmin.crd</div>
</div>
<div class="standard"><a id="magicparlabel-4663"></a>The output trajectory will only contain frames that meet the RMSD requirement, and the <em>filter.dat</em> file can be used to see which frames those were that were output.</div>

<div class="standard"><a id="magicparlabel-4664"></a>A similar command that can be used with data that already exists (e.g. it has been read in with <b><i>readdata</i></b>) is <b><i>datafilter</i></b> (see page <a href="#subsec_cpptraj_datafilter">elsewhere</a>).</div>
<h3 class="subsection"><a id="magicparlabel-4665"></a><span class="subsection_label">10.31</span> fixatomorder</h3>

<div class="lyx_code"><a id="magicparlabel-4666"></a><div class="lyx_code_item">fixatomorder [outprefix &lt;name&gt;]</div>
</div>
<div class="standard"><a id="magicparlabel-4667"></a>Cpptraj (and most 
of Amber) expects that atom indices in molecules to increase 
monotonically. However, occasionally atom indices in molecules can 
become disordered. This command fixes atom ordering so that all atoms in
 molecules are sequential. The <b>outprefix</b> keyword will write out the re-ordered topology with name <b>&lt;name&gt;.&lt;original name&gt;</b>.</div>
<h3 class="subsection"><a id="magicparlabel-4668"></a><span class="subsection_label">10.32</span> fiximagedbonds</h3>

<div class="lyx_code"><a id="magicparlabel-4669"></a><div class="lyx_code_item">fiximagedbonds [&lt;mask&gt;]</div>

<dl class="description"><a id="magicparlabel-4670"></a><dt class="description_label">&lt;mask&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Mask expression of atoms to check.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-4671"></a>Fix bonds that have
 been split across periodic boundary conditions by imaging. It may be 
desirable to reimage the coordinates after this with <em><b>autoimage</b></em>.</div>
<h3 class="subsection"><a id="magicparlabel-4672"></a><span class="subsection_label">10.33</span> gist (Grid Inhomogeneous Solvation Theory)</h3>

<div class="lyx_code"><a id="magicparlabel-4673"></a><div class="lyx_code_item">gist<a id="magicparlabel-4677"></a>
 [doorder] [doeij] [skipE] [refdens &lt;rdval&gt;] [temp &lt;tval&gt;]</div>
<div class="lyx_code_item">     [noimage] [gridcntr &lt;xval&gt; &lt;yval&gt; &lt;zval&gt;]</div>
<div class="lyx_code_item">     [griddim &lt;xval&gt; &lt;yval&gt; &lt;zval&gt;] [gridspacn &lt;spaceval&gt;]</div>
<div class="lyx_code_item">     [prefix &lt;filename prefix&gt;] [ext &lt;grid extension&gt;] [out &lt;output&gt;]</div>
<div class="lyx_code_item">     [info &lt;info&gt;]</div>

<dl class="description"><a id="magicparlabel-4682"></a><dt class="description_label">[doorder]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Calculate the water order parameter [<a href="#LyXCite-Chatterjee"><span class="bib-numericallabel">6</span></a>] for each voxel.</span></dd>
<dt class="description_label">[doeij]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Calculate the triangular matrix representing the water-water interactions between pairs of voxels (see below).</span></dd>
<dt class="description_label">[skipE]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Skip all energy calculations (cannot be specified with <b>'doeij'</b>).</span></dd>
<dt class="description_label">[refdens rdval&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Reference density of bulk water, used in computing<b> g_O</b>,<b> g_H</b>, and the translational entropy. Default is 0.0334 molecules/Å<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup><mrow/>
   <mrow><mn>3</mn>
   </mrow>
  </msup>
 </mrow></math>.</span></dd>
<dt class="description_label">[temp &lt;tval&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Temperature of the input trajectory.</span></dd>
<dt class="description_label">[noimage]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Disable distance imaging in energy calculation.</span></dd>
<dt class="description_label">[gridcntr &lt;xval&gt; &lt;yval&gt; &lt;zval&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Coordinates (Å) of the center of the grid (default 0.0, 0.0, 0.0).</span></dd>
<dt class="description_label">[griddim &lt;xval&gt; &lt;yval&gt; &lt;zval&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Grid dimensions along each coordinate axis (default 40, 40, 40).</span></dd>
<dt class="description_label">[gridspacn &lt;spaceval&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Grid spacing (linear dimension of each voxel) in Angstroms. Values greater than 0.75 Å are not recommended (default 0.5 Å).</span></dd>
<dt class="description_label">[prefix &lt;filename prefix&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output file name prefix (default “gist”).</span></dd>
<dt class="description_label">[ext &lt;grid extension&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output grid file name extension (default “.dx”).</span></dd>
<dt class="description_label">[out &lt;output&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Name of the main GIST output file. If not specified set to '&lt;prefix&gt;-output.dat'.</span></dd>
<dt class="description_label">[info &lt;info&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Name of main GIST info file. If not specified info is written to standard output.</span></dd>
</dl>
<div class="standard"><a id="magicparlabel-4695"></a><span style="font-family:monospace;">DataSet Aspects:</span></div>

<dl class="description"><a id="magicparlabel-4696"></a><dt class="description_label">[gO]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Number density of oxygen centers found in the voxel, in units of the bulk density.</span></dd>
<dt class="description_label">[gH]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Number density of hydrogen centers found in the voxel in units of the reference bulk density.</span></dd>
<dt class="description_label">[Esw]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Mean solute-water interaction energy density.</span></dd>
<dt class="description_label">[Eww]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Mean water-water interaction energy density.</span></dd>
<dt class="description_label">[dTStrans]</dt>
<dd class="description_item"><span style="font-family:monospace;"> First order translational entropy density.</span></dd>
<dt class="description_label">[dTSorient]</dt>
<dd class="description_item"><span style="font-family:monospace;"> First order orientational entropy density .</span></dd>
<dt class="description_label">[neighbor]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Mean number of waters neighboring the water molecules found in this voxel multiplied by the voxel number density.</span></dd>
<dt class="description_label">[dipole]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Magnitude of mean dipole moment (polarization).</span></dd>
<dt class="description_label">[order]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Average Tetrahedral Order Parameter.</span></dd>
<dt class="description_label">[dipolex]</dt>
<dd class="description_item"><span style="font-family:monospace;"> x-component of the mean water dipole moment density</span></dd>
<dt class="description_label">[dipoley]</dt>
<dd class="description_item"><span style="font-family:monospace;"> y-component of the mean water dipole moment density</span></dd>
<dt class="description_label">[dipolez]</dt>
<dd class="description_item"><span style="font-family:monospace;"> z-component of the mean water dipole moment density</span></dd>
<dt class="description_label">[Eij]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Water-water interaction matrix.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-4709"></a>Grid Inhomogeneous Solvation Theory [<a href="#LyXCite-Lazaridis"><span class="bib-numericallabel">19</span></a>, <a href="#LyXCite-Nguyen_gist"><span class="bib-numericallabel">22</span></a>]
 (GIST) is a method for analyzing the structure and thermodynamics of 
solvent in the vicinity of a solute molecule. The current implementation
 works for only water, but the method can be generalized to other 
solvents whose molecules are rigid like water, such as chloroform or 
dimethylsulfoxide (DMSO). GIST post-processes explicit solvent 
simulation data to create a three-dimensional mapping of water density 
and thermodynamic properties within a region of interest, which is 
defined by a user-specified 3D rectangular grid. The small grid boxes 
are referred to as voxels, and each voxel is associated with solvent 
properties. (See Fig. <a href="#gist_1_1">10.33</a>.) The GIST implementation incorporated into AmberTools <em>cpptraj</em>
 also calculates a number of other local water properties, as listed 
below. GIST works for the nonpolarizable water models currently 
supported by AMBER.</div>

<div class="standard"><a id="magicparlabel-4710"></a>In order to carry 
out a GIST calculation, you must have a trajectory file generated with 
explicit water, as well as the corresponding topology file. To generate 
the most readily interpretable results, it is recommended that the 
solute (e.g., a protein) be restrained into essentially one 
conformation. GIST will then provide information about the structure and
 thermodynamics of the solvent for that conformation. For a 
room-temperature simulation of a solvent-exposed binding site, and a 
grid-spacing of 0.5 Å, it is recommended that the simulation be at least
 10-20 ns in duration, and it is also a good idea to check for 
convergence of the GIST properties you are interested in by loading and 
then processing successively more frames of your trajectory file. 
Because GIST assumes that the solute of interest comprises all molecules
 in the simulation that are not waters, it is a good idea to remove all 
counterions and cosolutes with cpptraj's strip command before running 
GIST. A sample series of cpptraj commands for running GIST is provided 
below.</div>


<div class="float-figure"><div class="plain_layout"><a id="magicparlabel-4715"></a><img style="width:70%;" src="CPPTRAJ_files/0_mnt_raid0_droe_Local_work_Cpptraj_cpptraj_doc_gist.png" alt="image: 0_mnt_raid0_droe_Local_work_Cpptraj_cpptraj_doc_gist.png" />
 <span class="float-caption-Standard float-caption float-caption-standard">Figure 1:  Diagram, in 2D, of GIST's gridded water properties in a binding site.</span></div>

<div class="plain_layout"><a id="magicparlabel-4724"></a><a id="gist_1_1"></a>
</div>
</div>


<div class="standard"><a id="magicparlabel-4725"></a>Although it is not mandatory to supply values of <b>gridcntr</b>, <b>griddim</b> and <b>gridspcn</b>, these parameters should be carefully chosen, because they determine the region to be analyzed (<b>gridcntr</b> and <b>griddim</b>) and the spatial resolution and convergence properties of the results (<b>gridspcn</b>).
 In particular, although smaller grid spacings will give finer spatial 
resolution, longer simulation times will be needed to converge the 
properties in the smaller voxels that result. A larger grid spacing will
 allow earlier convergence, but will smooth the spatial distributions 
and hence can reduce accuracy. </div>

<div class="standard"><a id="magicparlabel-4726"></a>The reference density of water (<b>rdval</b>)
 is taken by default to be the experimental number density of pure water
 at 300 K and 1 atm. However, different water models may yield slightly 
different bulk densities under these conditions, and the density also 
depends on T and P. If you know that the bulk density of the water model
 you are using, at the T and P of your simulation, deviates 
significantly from 0.0334 water molecules/Å<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup><mrow/>
   <mrow><mn>3</mn>
   </mrow>
  </msup>
 </mrow></math>, it would be advisable to supply the actual value with the <b>refdens</b> keyword, instead of allowing GIST to supply the default value.</div>
<h4 class="subsubsection_"><a id="magicparlabel-4727"></a>GIST Output </h4>
<div class="standard"><a id="magicparlabel-4728"></a>GIST generates a 
main output file and a collection of grid data files that by default are
 in Data Explorer format (.dx); this can be changed via the <b>ext</b> keyword. These grid files enable visualization of the various gridded quantities, such as with the program VMD [<a href="#LyXCite-humprey"><span class="bib-numericallabel">16</span></a>]. If the <b>doeij</b>
 keyword is provided, GIST also writes out a matrix of water-water 
interactions between pairs of voxels. In addition, run details are 
written to stdout, which can be redirected into a log file. </div>

<div class="standard"><a id="magicparlabel-4729"></a>Note that a number 
of quantities are written out as both densities and normalized 
quantities. For example, the output file includes both the solute-water 
energy density and the normalized (per water) solute-water energy. In 
all cases, the normalized quantity at voxel <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>i</mi>
 </mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>X</mi>
   </mrow>
   <mrow>
    <mrow><mi>i</mi><mo>,</mo><mi>n</mi><mi>o</mi><mi>r</mi><mi>m</mi>
    </mrow>
   </mrow>
  </msub>
 </mrow></math> is related to the corresponding density, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>X</mi>
   </mrow>
   <mrow>
    <mrow><mi>i</mi><mo>,</mo><mi>d</mi><mi>e</mi><mi>n</mi><mi>s</mi>
    </mrow>
   </mrow>
  </msub>
 </mrow></math>, by the relationship <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>X</mi>
    </mrow>
    <mrow>
     <mrow><mi>i</mi><mo>,</mo><mi>n</mi><mi>o</mi><mi>r</mi><mi>m</mi>
     </mrow>
    </mrow>
   </msub><mo>=</mo>
   <msub>
    <mrow><mi> ρ </mi>
    </mrow>
    <mrow><mi>i</mi>
    </mrow>
   </msub>
   <msub>
    <mrow><mi>X</mi>
    </mrow>
    <mrow>
     <mrow><mi>i</mi><mo>,</mo><mi>d</mi><mi>e</mi><mi>n</mi><mi>s</mi>
     </mrow>
    </mrow>
   </msub>
  </mrow>
 </mrow></math>, where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi> ρ </mi>
   </mrow>
   <mrow><mi>i</mi>
   </mrow>
  </msub>
 </mrow></math> is the number density of water in the voxel. The 
normalized quantity provides information regarding the nature of the 
water found in the voxel. The density has the property that, if the grid
 extended over the entire simulation volume, the total system quantity 
would be given by <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>X</mi>
    </mrow>
    <mrow>
     <mrow><mi>t</mi><mi>o</mi><mi>t</mi>
     </mrow>
    </mrow>
   </msub><mo>=</mo>
   <msub>
    <mrow><mi>V</mi>
    </mrow>
    <mrow>
     <mrow><mi>v</mi><mi>o</mi><mi>x</mi><mi>e</mi><mi>l</mi>
     </mrow>
    </mrow>
   </msub>
   <msub>
    <mrow><mo> ∑ </mo>
    </mrow>
    <mrow><mi>i</mi>
    </mrow>
   </msub>
   <msub>
    <mrow><mi>X</mi>
    </mrow>
    <mrow>
     <mrow><mi>i</mi><mo>,</mo><mi>d</mi><mi>e</mi><mi>n</mi><mi>s</mi>
     </mrow>
    </mrow>
   </msub>
  </mrow>
 </mrow></math>, where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>V</mi>
   </mrow>
   <mrow>
    <mrow><mi>v</mi><mi>o</mi><mi>x</mi><mi>e</mi><mi>l</mi>
    </mrow>
   </mrow>
  </msub>
 </mrow></math> is the volume of one grid voxel. </div>

<div class="standard"><a id="magicparlabel-4730"></a>The main output 
file takes the form of a space-delimited-variable file, where each row 
corresponds to one voxel of the grid. This file can easily be opened 
with and manipulated with spreadsheet programs like Excel and 
LibreOffice Calc. The columns are as follows. </div>

<ul class="itemize"><a id="magicparlabel-4731"></a><li class="itemize_item"><b>index</b> - A unique, sequential integer assigned to each voxel</li>
<li class="itemize_item"><b>xcoord</b> - x coordinate of the center of the voxel (Å)</li>
<li class="itemize_item"><b>ycoord</b> - y coordinate of the center of the voxel (Å)</li>
<li class="itemize_item"><b>zcoord</b> - z coordinate of the center of the voxel (Å)</li>
<li class="itemize_item"><b>population </b>- Number of water molecule, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>n</mi>
   </mrow>
   <mrow><mi>i</mi>
   </mrow>
  </msub>
 </mrow></math>, found in the voxel over the entire simulation. A water 
molecule is deemed to populate a voxel if its oxygen coordinates are 
inside the voxel. The expectation value of this quantity increases in 
proportion to the length of the simulation.</li>
<li class="itemize_item"><b>g_O</b> - Number density of oxygen centers found in the voxel, in units of the bulk density (rdval). Thus, the expectation value of <b>g_O</b> for a neat water system is unity.</li>
<li class="itemize_item"><b>g_H</b> - Number density of hydrogen centers found in the voxel in units of the reference bulk density (2<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo> × </mo>
 </mrow></math>rdval). Thus, the expectation value of <b>g_H</b> for a neat water system would be unity.</li>
<li class="itemize_item"><b>dTStrans-dens</b> - First order translational entropy density (kcal/mole/Å<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup><mrow/>
   <mrow><mn>3</mn>
   </mrow>
  </msup>
 </mrow></math>), referenced to the translational entropy of bulk water, based on the value rdval.</li>
<li class="itemize_item"><b>dTStrans-norm</b> - First order 
translational entropy per water molecule (kcal/mole/molecule), 
referenced to the translational entropy of bulk water, based on the 
value rdval. The quantity<b> dTStrans-norm</b> equals <b>dTStrans-dens</b> divided by the number density of the voxel.</li>
<li class="itemize_item"><b>dTSorient-dens</b> - First order orientational entropy density (kcal/mole/Å<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup><mrow/>
   <mrow><mn>3</mn>
   </mrow>
  </msup>
 </mrow></math>), referenced to bulk solvent (see below).</li>
<li class="itemize_item"><b>dTSorient-norm</b> - First order 
orientational entropy per water molecule (kcal/mole/water), referenced 
to bulk solvent (see below). This quantity equals<b> dTSorient-dens</b> divided by the number density of the voxel.</li>
<li class="itemize_item"><b>Esw-dens</b> - Mean solute-water interaction energy density (kcal/mole/Å<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup><mrow/>
   <mrow><mn>3</mn>
   </mrow>
  </msup>
 </mrow></math>). This is the interaction of the solvent in a given 
voxel with the entire solute. Both Lennard-Jones and electrostatic 
interactions are computed without any cutoff, within the minimum image 
convention but without Ewald summation. This quantity is referenced to 
bulk, in the trivial sense that the solute-solvent interaction energy is
 zero in bulk.</li>
<li class="itemize_item"><b>Esw-norm</b> - Mean solute-water interaction energy per water molecule. This equals<b> Esw-dens</b> divided by the number density of the voxel (kcal/mole/molecule).</li>
<li class="itemize_item"><b>Eww-dens</b> - Mean water-water interaction 
energy density, scaled by ½ to prevent double-counting, and not 
referenced to the corresponding bulk value of this quantity (see below).
 This quantity is one half of the mean interaction energy of the water 
in a given voxel with all other waters in the system, both on and off 
the GIST grid, divided by the volume of the voxel (kcal/mole/Å<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup><mrow/>
   <mrow><mn>3</mn>
   </mrow>
  </msup>
 </mrow></math>). Again, both Lennard-Jones and electrostatic 
interactions are computed without any cutoff, within the minimum image 
convention.</li>
<li class="itemize_item"><b>Eww-norm</b> - Mean water-water interaction 
energy, normalized to the mean number of water molecules in the voxel 
(kcal/mole/water). See prior column definition for details.</li>
<li class="itemize_item"><b>Dipole_x-dens</b> - x-component of the mean water dipole moment density (Debye/Å<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup><mrow/>
   <mrow><mn>3</mn>
   </mrow>
  </msup>
 </mrow></math>).</li>
<li class="itemize_item"><b>Dipole_y-dens</b> - y-component of the mean water dipole moment density (Debye/Å<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup><mrow/>
   <mrow><mn>3</mn>
   </mrow>
  </msup>
 </mrow></math>).</li>
<li class="itemize_item"><b>Dipole_z-dens</b> - z-component of the mean water dipole moment density (Debye/Å<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup><mrow/>
   <mrow><mn>3</mn>
   </mrow>
  </msup>
 </mrow></math>).</li>
<li class="itemize_item"><b>Dipole-dens</b> - Magnitude of mean dipole moment (polarization) (Debye/Å<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup><mrow/>
   <mrow><mn>3</mn>
   </mrow>
  </msup>
 </mrow></math>).</li>
<li class="itemize_item"><b>Neighbor-dens</b> - Mean number of waters 
neighboring the water molecules found in this voxel multiplied by the 
voxel number density. Two waters are considered neighbors if their 
oxygens are within 3.5 angstroms of each other. For any given frame, the
 contribution to the average is set to zero if no water is found in the 
voxel (units of number/Å<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup><mrow/>
   <mrow><mn>3</mn>
   </mrow>
  </msup>
 </mrow></math>).</li>
<li class="itemize_item"><b>Neighbor-norm</b> - Mean number of neighboring water molecules, per water molecule found in the voxel (units of number per water).</li>
<li class="itemize_item"><b>Order-norm</b> - Average Tetrahedral Order Parameter [<a href="#LyXCite-Chatterjee"><span class="bib-numericallabel">6</span></a>], <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>q</mi>
   </mrow>
   <mrow>
    <mrow><mi>t</mi><mi>e</mi><mi>t</mi>
    </mrow>
   </mrow>
  </msub>
 </mrow></math>, for water molecules found in the voxel, normalized by the number of waters in the voxel. The order parameter for water <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>i</mi>
 </mrow></math> in a given frame is given by: <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>q</mi>
    </mrow>
    <mrow>
     <mrow><mi>t</mi><mi>e</mi><mi>t</mi>
     </mrow>
    </mrow>
   </msub><mo form="prefix" fence="true" stretchy="true" symmetric="true">(</mo>
<mi>i</mi>
<mo form="postfix" fence="true" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>1</mn><mo>-</mo>
   <mfrac>
    <mrow><mn>3</mn>
    </mrow>
    <mrow><mn>8</mn>
    </mrow>
   </mfrac>
   <msubsup>
    <mrow><mo> ∑ </mo>
    </mrow>
    <mrow>
     <mrow><mi>j</mi><mo>=</mo><mn>1</mn>
     </mrow>
    </mrow>
    <mrow><mn>3</mn>
    </mrow>
   </msubsup>
   <msubsup>
    <mrow><mo> ∑ </mo>
    </mrow>
    <mrow>
     <mrow><mi>k</mi><mo>=</mo><mi>j</mi><mo>+</mo><mn>1</mn>
     </mrow>
    </mrow>
    <mrow><mn>4</mn>
    </mrow>
   </msubsup><mo>(</mo><mi>c</mi><mi>o</mi><mi>s</mi>
   <msub>
    <mrow><mi> φ </mi>
    </mrow>
    <mrow>
     <mrow><mi>i</mi><mi>j</mi><mi>k</mi>
     </mrow>
    </mrow>
   </msub><mo>+</mo>
   <mfrac>
    <mrow><mn>1</mn>
    </mrow>
    <mrow><mn>3</mn>
    </mrow>
   </mfrac>
   <msup>
    <mrow><mo>)</mo>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msup>
  </mrow>
 </mrow></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>j</mi>
 </mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>k</mi>
 </mrow></math> index the 4 closest water neighbors to water <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>i</mi>
 </mrow></math>, and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi> φ </mi>
   </mrow>
   <mrow>
    <mrow><mi>i</mi><mi>j</mi><mi>k</mi>
    </mrow>
   </mrow>
  </msub>
 </mrow></math> is the angle formed by water <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>i</mi>
 </mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>j</mi>
 </mrow></math>, and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>k</mi>
 </mrow></math>. If the doorder keyword is not provided or is set to 
FALSE, then this calculation will not be done, and the entries in this 
column will be set to zero.</li>
</ul>
<div class="standard"><a id="magicparlabel-4753"></a>Grid files are 
provided for all computed quantities listed above, except that the 
normalized quantities are not included. The filenames are as follows: 
gist-gO.dx, gist-gH.dx, gist-dTStrans-dens.dx, gist-dTSorient-dens.dx, 
gist-Esw-dens.dx, gist-Eww-dens.dx, gist-dipolex-dens.dx, 
gist-dipoley-dens.dx, gist-dipolez-dens.dx, gist-dipole-dens.dx, 
gist-neighbor-dens.dx, gist-neighbor-norm.dx, gist-order-norm.dx. If the
 <b>doorder</b> keyword is not provided, then the data in 
gist-order-norm.dx will all be zeroes. Note that the file of voxel water
 densities, gist-gO.dx, can be used as input to the program Placevent [<a href="#LyXCite-Sindhikara"><span class="bib-numericallabel">32</span></a>], in order to define spherical hydration sites based on the density distribution.</div>

<div class="standard"><a id="magicparlabel-4754"></a>Similar grid files 
with other computed quantities can be generated by reading the gist.out 
file into a spreadsheet program, processing the numbers to generate a 
new column of voxel data of interest, and writing this column to an 
ascii text file. Then the Perl script write_dx_file.pl, which should be 
available on the GIST tutorial web-site, may be used to read in the 
column of data and create the corresponding dx file. The input format, 
and an example, are as follows: </div>

<div class="lyx_code"><a id="magicparlabel-4755"></a><div class="lyx_code_item">./write_dx_file.pl [filename] [x-dimension y-dimension z-dimension]</div>
<div class="lyx_code_item">[x-origin y-origin z-origin] [grid spacing]</div>
<div class="lyx_code_item">./write_dx_file.pl file.dat 40 40 40 13.0 13.0 13.0 0.75</div>
</div>
<div class="standard"><a id="magicparlabel-4758"></a>If the doeij 
keyword is provided, GIST also writes a large file, Eww_ij.dat, 
containing the mean water-water interaction energies between pairs of 
voxels, scaled by ½. (See below.) This file has three columns. The first
 two columns are voxel indexes, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>i</mi>
 </mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>j</mi>
 </mrow></math>, where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>j</mi><mo>&gt;</mo><mi>i</mi>
  </mrow>
 </mrow></math>, so that no pair appears more than once, and the third column is the mean interaction energy (kcal/mole) of water in voxels <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>i</mi>
 </mrow></math> and<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>j</mi>
 </mrow></math>, scaled by ½. If the occupancy of either voxel is 0, 
such as for voxels covered by solute atoms, then the interaction energy 
is zero. In order to save space, such interactions are omitted from the 
file. </div>

<div class="standard"><a id="magicparlabel-4759"></a><b>Sample cpptraj input file to run GIST </b></div>

<div class="standard"><a id="magicparlabel-4760"></a>The following input
 file, gist.in, causes cpptraj to read a parameter file named 
topology.top; read in the first 5000 frames of the trajectory file named
 trajectoryfile.mdcrd; strip out all Na and Cl ions; and carry out a 
GIST run which computes order parameters, uses a 41x41x45 grid centered 
at (25.0, 31.0, 30.0) with a spacing of 0.5 Å, uses the default bulk 
water density of 0.0334 molecules/Å<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup><mrow/>
   <mrow><mn>3</mn>
   </mrow>
  </msup>
 </mrow></math>, and generates the main output file gist.out. </div>

<div class="lyx_code"><a id="magicparlabel-4761"></a><div class="lyx_code_item">parm topology.top</div>
<div class="lyx_code_item">trajin trajectoryfile.mdcrd 1 5000</div>
<div class="lyx_code_item">strip @Na</div>
<div class="lyx_code_item">strip @Cl</div>
<div class="lyx_code_item">gist doorder doeij gridcntr 25.0 31.0 30.0 griddim 41 41 45 </div>
<div class="lyx_code_item">    gridspacn 0.50 out gist.out</div>
<div class="lyx_code_item">go</div>
</div>
<div class="standard"><a id="magicparlabel-4768"></a>To execute this run in the background, use </div>

<div class="lyx_code"><a id="magicparlabel-4769"></a><div class="lyx_code_item">cpptraj&lt;gist.in&gt;gist.log&amp; or cpptraj –i gist.in&gt;gist.log&amp; </div>
</div>
<div class="standard"><a id="magicparlabel-4770"></a><b>Referencing GIST results to unperturbed (bulk) water</b> </div>

<div class="standard"><a id="magicparlabel-4771"></a>Inhomogeneous fluid
 solvation theory, which is the basis of GIST, is designed to provide 
information on how water structure and thermodynamics around a solute 
molecule, such as a protein, are changed relative to the structure and 
thermodynamics of unperturbed (bulk) water. Accordingly, the quantities 
reported by GIST are most informative when the results are referenced to
 the corresponding bulk water properties. For the orientational entropy,
 the reference value is the same regardless of water model or 
conditions, because the first order orientational distribution of water 
in the bulk is always uniform. Therefore, the GIST results for 
orientational entropies are already referenced to bulk. However, cpptraj
 reports unreferenced values for those GIST quantities whose reference 
values depend upon the water model and the simulation conditions; i.e., 
the energies. The translational entropy as well as the number densities 
will be referenced to bulk using the input referenced density or the 
default density value of 0.0334. The table below provides useful 
reference values for these quantities, computed for various water models
 at P=1atm, T=300K, using GIST in order to ensure a consistent minimum 
image treatment of periodic boundary conditions. </div>




<div class="float-table"><div class="plain_layout" style="text-align: center;"><a id="magicparlabel-4776"></a><table><tbody><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4810"></a>Water Model</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4813"></a> Mean Energy (Eww-norm) (kcal/mol/water) </div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4816"></a>Number Density (Å<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup><mrow/>
   <mrow>
    <mrow><mo>-</mo><mn>3</mn>
    </mrow>
   </mrow>
  </msup>
 </mrow></math>)</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4819"></a>TIP3P</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4822"></a>-9.533</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4825"></a>0.0329</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4828"></a>TIP4PEW</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4831"></a>-11.036</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4834"></a>0.0332</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4837"></a>TIP4P</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4840"></a>-9.856</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4843"></a>0.0332</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4846"></a>TIP5P</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4849"></a>-9.596</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4852"></a>0.0329</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4855"></a>Tip3PFW</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4858"></a>-11.369</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4861"></a>0.0334</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4864"></a>SPCE</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4867"></a>-11.123</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4870"></a>0.0333</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4873"></a>SPCFW</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4876"></a>-11.873</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-4879"></a>0.0329</div>
</td>
</tr></tbody>
</table>
</div>

<div class="plain_layout"><a id="magicparlabel-4880"></a><span class="float-caption-Standard float-caption float-caption-standard">Table 3:  <a id="tab_cpptraj_gist_1"></a>
Water model energy and density.</span></div>
</div>


<div class="standard"><a id="magicparlabel-4885"></a>Users running 
calculations under significantly different conditions, or with different
 water models, should consider generating their own reference quantities
 by applying GIST to a simulation of pure water under their conditions 
of interest. The quantities of interest can then be obtained in their 
most precise available form by averaging over voxels, for the pure water
 simulation. If the quantity of interest is <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>Q</mi>
 </mrow></math>, then its average reference value is <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>Q</mi>
    </mrow>
    <mrow>
     <mrow><mi>r</mi><mi>e</mi><mi>f</mi><mi>e</mi><mi>r</mi><mi>e</mi><mi>n</mi><mi>c</mi><mi>e</mi>
     </mrow>
    </mrow>
   </msub><mo>=</mo>
   <mfrac>
    <mrow>
     <mrow><mo> ∑ </mo>
      <msub>
       <mrow><mi>n</mi>
       </mrow>
       <mrow><mi>i</mi>
       </mrow>
      </msub>
      <msub>
       <mrow><mi>Q</mi>
       </mrow>
       <mrow><mi>i</mi>
       </mrow>
      </msub>
     </mrow>
    </mrow>
    <mrow>
     <mrow><mo> ∑ </mo>
      <msub>
       <mrow><mi>n</mi>
       </mrow>
       <mrow><mi>i</mi>
       </mrow>
      </msub>
     </mrow>
    </mrow>
   </mfrac>
  </mrow>
 </mrow></math>, where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>Q</mi>
   </mrow>
   <mrow><mi>i</mi>
   </mrow>
  </msub>
 </mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>n</mi>
   </mrow>
   <mrow><mi>i</mi>
   </mrow>
  </msub>
 </mrow></math> are, respectively, GIST's reported values of the quantity and the population in voxel <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>i</mi>
 </mrow></math>. The densities, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi> ρ </mi>
   </mrow>
   <mrow><mi>i</mi>
   </mrow>
  </msub>
 </mrow></math>, are referenced to the corresponding bulk densities, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup>
   <mrow><mi> ρ </mi>
   </mrow>
   <mrow><mi>o</mi>
   </mrow>
  </msup>
 </mrow></math>, as <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>g</mi>
    </mrow>
    <mrow><mi>i</mi>
    </mrow>
   </msub><mo>=</mo>
   <msub>
    <mrow><mi> ρ </mi>
    </mrow>
    <mrow><mi>i</mi>
    </mrow>
   </msub><mo>/</mo>
   <msup>
    <mrow><mi> ρ </mi>
    </mrow>
    <mrow><mi>o</mi>
    </mrow>
   </msup>
  </mrow>
 </mrow></math>, while the energy and entropy terms are referenced by subtracting their bulk values.</div>

<div class="standard"><a id="magicparlabel-4886"></a><b>Interpreting GIST results</b> </div>

<div class="standard"><a id="magicparlabel-4887"></a>GIST provides 
access to the first order entropies and the first- and second-order 
energies of inhomogeneous fluid solvation theory. Non-zero higher-order 
entropies exist but are not yet computationally accessible. However, for
 a pairwise additive force-field, such as those listed in the Table 
above, the energy is fully described at the second order provided by 
GIST. </div>

<div class="standard"><a id="magicparlabel-4888"></a>GIST is a research 
tool, and its applications (to, for example, protein-ligand binding and 
protein function) are still being explored. The following general 
comments may be helpful to users studying GIST results. </div>

<div class="standard"><a id="magicparlabel-4889"></a>1. The water in 
voxels near a solute (e.g., a protein) almost always has unfavorable 
water-water interaction energies, relative to bulk, simply because the 
solute displaces water, resulting in fewer proximal water-water 
interactions. </div>

<div class="standard"><a id="magicparlabel-4890"></a>2. The unfavorable water-water energies mentioned in [<a href="#LyXCite-Lazaridis"><span class="bib-numericallabel">19</span></a>]
 may be balanced by favorable water-solute interactions. If they are 
not, as may occur especially for voxels in small, hydrophobic pockets, 
then the net energy of the water in the voxel may be unfavorable 
relative to bulk, in which case a ligand which displaces water from the 
voxel into bulk may get a boost in affinity. </div>

<div class="standard"><a id="magicparlabel-4891"></a>3. Because the 
first order orientational distribution of bulk water is uniform, and a 
nonuniform distribution always has lower entropy than a uniform one, the
 solute can only lower the orientational entropy of water, relative to 
bulk. Thus, this term always opposes solvation, and displacing oriented 
water into the bulk is always favorable from the standpoint of 
orientational entropy. </div>

<div class="standard"><a id="magicparlabel-4892"></a>4. Localized water,
 which corresponds to voxels with high water density, has a low first 
order translational entropy, and the translational entropy around a 
solute is lower than that in bulk, as a nonuniform translational 
distribution takes the place of the uniform translational distribution 
of bulk water. </div>

<div class="standard"><a id="magicparlabel-4893"></a>5. The displacement
 of highly oriented (low orientational entropy) and localized (low 
translational entropy) water into bulk leads to a favorable increase in 
these entropy terms. </div>

<div class="standard"><a id="magicparlabel-4894"></a>6. However, highly 
oriented and localized water is often the consequence of strongly 
favorable polar interactions, such as hydrogen-bonding, between water 
and the solute. As a consequence, the net favorability of displacing 
such water is frequently a balance between favorable entropic 
consequences and unfavorable energetic consequences. </div>

<div class="standard"><a id="magicparlabel-4895"></a>7. The water-water 
energy associated with a given voxel accounts for the interactions of 
the waters in this voxel with all other waters in the system, including 
waters in other voxels. This quantity is multiplied by ½, so that, in a 
pure-water system where the GIST grid covers the entire simulation box, 
the sum over all voxels equals the correct mean water-water interaction 
energy. Note that Reference [<a href="#LyXCite-Nguyen_gist"><span class="bib-numericallabel">22</span></a>] does not include this factor of ½. </div>

<div class="standard"><a id="magicparlabel-4896"></a>8. For a typical 
GIST application, in which the grid occupies only part of the simulation
 box, the energy bookkeeping can become complicated, as discussed in 
Section II.B.3 (page 044101-6) of Reference [<a href="#LyXCite-Nguyen_gist"><span class="bib-numericallabel">22</span></a>]. That section also explains how one can compute the water-water energy associated with a region <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>R</mi>
 </mrow></math> defined by a set of voxels, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msubsup>
   <mrow><mi>E</mi>
   </mrow>
   <mrow>
    <mrow><mi>W</mi><mi>W</mi>
    </mrow>
   </mrow>
   <mrow><mi>R</mi>
   </mrow>
  </msubsup>
 </mrow></math>. The regional water-water energy, on a normalized (per water) basis, is given by <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msubsup>
    <mrow><mi>E</mi>
    </mrow>
    <mrow>
     <mrow><mi>W</mi><mi>W</mi>
     </mrow>
    </mrow>
    <mrow><mi>R</mi>
    </mrow>
   </msubsup><mo>=</mo><mn>2</mn><mo form="prefix" fence="true" stretchy="true" symmetric="true">(</mo>

   <mrow>
    <msub>
     <mrow><mo> ∑ </mo>
     </mrow>
     <mrow>
      <mrow><mi>i</mi><mo> ∈ </mo><mi>R</mi>
      </mrow>
     </mrow>
    </msub>
    <msub>
     <mrow><mi>E</mi>
     </mrow>
     <mrow>
      <mrow><mi>i</mi><mo>,</mo><mi>W</mi><mi>W</mi>
      </mrow>
     </mrow>
    </msub><mo>-</mo>
    <msub>
     <mrow><mo> ∑ </mo>
     </mrow>
     <mrow>
      <mrow><mi>i</mi><mo> ∈ </mo><mi>R</mi>
      </mrow>
     </mrow>
    </msub>
    <msub>
     <mrow><mo> ∑ </mo>
     </mrow>
     <mrow>
      <mrow><mi>j</mi><mo> ∈ </mo><mi>R</mi><mo>,</mo><mi>j</mi><mo>&gt;</mo><mi>i</mi>
      </mrow>
     </mrow>
    </msub>
    <msub>
     <mrow><mi>E</mi>
     </mrow>
     <mrow>
      <mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mi>W</mi><mi>W</mi>
      </mrow>
     </mrow>
    </msub>
   </mrow>
<mo form="postfix" fence="true" stretchy="true" symmetric="true">)</mo>

  </mrow>
 </mrow></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>i</mi><mo> ∈ </mo><mi>R</mi>
  </mrow>
 </mrow></math> means that voxel <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>i</mi>
 </mrow></math> is in region <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>R</mi>
 </mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>E</mi>
   </mrow>
   <mrow>
    <mrow><mi>i</mi><mo>,</mo><mi>W</mi><mi>W</mi>
    </mrow>
   </mrow>
  </msub>
 </mrow></math> is the value of Eww-norm for voxel <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>i</mi>
 </mrow></math>, and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>E</mi>
   </mrow>
   <mrow>
    <mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mi>W</mi><mi>W</mi>
    </mrow>
   </mrow>
  </msub>
 </mrow></math> is the value of the water-water interaction energy between voxels <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>i</mi>
 </mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>j</mi>
 </mrow></math>, taken from the file Eww_ij.dat. The extra factor of 2 
in the present formula, relative to that in the paper, results from 
application of an extra factor of ½ to the reported water-water 
interaction energies here. </div>
<h3 class="subsection"><a id="magicparlabel-4897"></a><span class="subsection_label">10.34</span> grid<a id="subsec_cpptraj_grid"></a>
</h3>

<div class="lyx_code"><a id="magicparlabel-4898"></a><div class="lyx_code_item">grid &lt;filename&gt;</div>
<div class="lyx_code_item"> 	{ data &lt;dsname&gt; | boxref &lt;ref name/tag&gt; &lt;nx&gt; &lt;ny&gt; &lt;nz&gt; |</div>
<div class="lyx_code_item"> 	  &lt;nx&gt; &lt;dx&gt; &lt;ny&gt; &lt;dy&gt; &lt;nz&gt; &lt;dz&gt; [gridcenter &lt;cx&gt; &lt;cy&gt; &lt;cz&gt;] }</div>
<div class="lyx_code_item"> 	[box|origin|center &lt;mask&gt;] [negative] [name &lt;gridname&gt;]</div>
<div class="lyx_code_item"> 	&lt;mask&gt; [normframe | normdensity [density &lt;density&gt;]]</div>
<div class="lyx_code_item">	 [pdb &lt;pdbout&gt; [max &lt;fraction&gt;]]</div>
<div class="lyx_code_item"> 	[[smoothdensity &lt;value&gt;] [invert]] [madura &lt;madura&gt;]
<br />

</div>

<dl class="description"><a id="magicparlabel-4905"></a><dt class="description_label">&lt;filename&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> File to write out grid to. Use “.grid” or “.xplor” extension for XPLOR format, “.dx” for OpenDX format.</span></dd>
</dl>
<div class="standard"><a id="magicparlabel-4906"></a><span style="font-family:monospace;">Options for setting up grid:</span></div>

<dl class="description"><a id="magicparlabel-4907"></a><dt class="description_label">data &lt;dsname&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use 
previously calculated/loaded grid data set named &lt;dsname&gt;. When 
using this option there is no need to specify grid bins/spacing/center.</span></dd>
<dt class="description_label">boxref &lt;ref name/tag&gt; &lt;nx&gt; &lt;ny&gt; &lt;nz&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Set 
up grid using box information from a previously loaded reference 
structure. Currently the only way to set up non-orthogonal grids.</span></dd>
<dt class="description_label">&lt;nx&gt; &lt;dx&gt; &lt;ny&gt; &lt;dy&gt; &lt;nz&gt; &lt;dz&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Number of grid bins and spacing in the X/Y/Z directions.</span></dd>
<dt class="description_label">[gridcenter &lt;cx&gt; &lt;cy&gt; &lt;cz&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Location of grid center, default is origin (0.0, 0.0, 0.0).</span></dd>
</dl>
<div class="standard"><a id="magicparlabel-4911"></a><span style="font-family:monospace;">Options for offset during grid binning (must center grid at origin):</span></div>

<dl class="description"><a id="magicparlabel-4912"></a><dt class="description_label">[box]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Offset each point by location of box center prior to gridding. Cannot be used with 'gridcenter'.</span></dd>
<dt class="description_label">[origin]</dt>
<dd class="description_item"><span style="font-family:monospace;"> No offset (default)</span></dd>
<dt class="description_label">[center &lt;mask&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Offset each point by center of atoms in &lt;mask&gt; prior to gridding. Cannot be used with 'gridcenter'.</span></dd>
</dl>
<div class="standard"><a id="magicparlabel-4915"></a><span style="font-family:monospace;">Other options:</span></div>

<dl class="description"><a id="magicparlabel-4916"></a><dt class="description_label">[negative]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Grid negative density instead of positive density.</span></dd>
<dt class="description_label">[name &lt;gridname&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Grid data set name.</span></dd>
<dt class="description_label">&lt;mask&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Mask of atoms to grid.</span></dd>
<dt class="description_label">[normframe]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Normalize grid bins by the number of frames.</span></dd>
<dt class="description_label">[normdensity [density &lt;density&gt;]]</dt>
<dd class="description_item"><span style="font-family:monospace;"> 
Normalize grid bins by density: GridBin = GridBin / (Nframes * BinVolume
 * density). Default particle density (molecules/Ang^3) for water based 
on 1.0 g/mL.</span></dd>
<dt class="description_label">[pdb &lt;pdbout&gt; [max &lt;fraction&gt;]]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write a pseudo-PDB of grid points that have density greater than &lt;fraction&gt; (default 0.80) of the grid max value.</span></dd>
</dl>
<div class="standard"><a id="magicparlabel-4922"></a><span style="font-family:monospace;">Less common options:</span></div>

<dl class="description"><a id="magicparlabel-4923"></a><dt class="description_label">[smoothdensity &lt;smooth&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Used 
to smooth density. The smoothing takes the form of GridBin = 0 if 
GridBin &lt; smooth, otherwise GridBin = GridBin - (GridBin * 
exp[-(GridBin - smooth)^2 / (0.2 * smooth^2)]).</span></dd>
<dt class="description_label">[invert]</dt>
<dd class="description_item"><span style="font-family:monospace;"> (Only used if smoothdensity also used) Do inverse smoothing (i.e. if GridBin &gt; smooth).</span></dd>
<dt class="description_label">[madura &lt;madura&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Grid values lower than &lt;madura&gt; become flipped in sign, exposes low density.</span></dd>
</dl>
<div class="standard"><a id="magicparlabel-4926"></a><span style="font-family:monospace;">Data Sets Created:</span></div>

<dl class="description"><a id="magicparlabel-4927"></a><dt class="description_label">&lt;dsname&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Grid data set.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-4928"></a>Create a grid representing the histogram of atoms in <i>mask1</i> on the 3D grid that is "<i>nx</i> * <i>x_spacing</i> by <i>ny</i> * <i>y_spacing</i> by <i>nz</i> * <i>z_spacing</i> angstroms (cubed). By default the grid is centered at the origin unless <b>gridcenter</b> is specified. Grid points can be offset by either the box center (using <b>box</b>) or the center of specified atoms (using <b>center &lt;mask&gt;</b>); if either of these options are used the grid must be centered at the origin. Note that the <b><i>bounds</i></b> command (<a href="#subsec_cpptraj_bounds">elsewhere</a>) can be very useful for determining grid dimensions.</div>

<div class="standard"><a id="magicparlabel-4929"></a>Note that when 
calculating grid densities for things like solvent/ions, the solute of 
interest (about which the atomic densities are binned) should be rms 
fit, centered and imaged prior to the <b><i><span style="font-family:sans-serif;">grid</span></i></b><!-- Output Error: Tried to close pending tag `i' when other tags were pending. Last pending tag is `<span style='font-family:sans-serif;'>'. Tag discarded. -->
 call in order to provide any meaningful representation of the density. If the optional keyword <b><span style="font-family:monospace;">negative</span></b> is also specified, then these density will be stored as negative numbers. Output can be in the XPLOR or OpenDX data formats.</div>
<h4 class="subsubsection_"><a id="magicparlabel-4930"></a>Examples</h4>
<div class="standard"><a id="magicparlabel-4931"></a>Grid water density around a solute.</div>

<div class="lyx_code"><a id="magicparlabel-4932"></a><div class="lyx_code_item">trajin tz2.truncoct.nc</div>
<div class="lyx_code_item">autoimage origin</div>
<div class="lyx_code_item">rms first :1-13</div>
<div class="lyx_code_item"># Create average of solute to view with grid.</div>
<div class="lyx_code_item">average avg.mol2 :1-13 </div>
<div class="lyx_code_item">grid out.dx 20 0.5 20 0.5 20 0.5 :WAT@O </div>
</div>
<div class="standard"><a id="magicparlabel-4938"></a>Generate grid from bounds command.</div>

<div class="lyx_code"><a id="magicparlabel-4939"></a><div class="lyx_code_item">trajin tz2.ortho.nc </div>
<div class="lyx_code_item">autoimage </div>
<div class="lyx_code_item">rms first :1-13&amp;!@H= mass</div>
<div class="lyx_code_item">bounds :1-13 dx .5 name MyGrid out bounds.dat </div>
<div class="lyx_code_item">average bounds.mol2 :1-13</div>
<div class="lyx_code_item"># Save coordinates for second pass.</div>
<div class="lyx_code_item">createcrd MyCoords</div>
<div class="lyx_code_item">run</div>
<div class="lyx_code_item"># Grid using grid data set from bounds command.</div>
<div class="lyx_code_item">crdaction MyCoords grid bounds.xplor data MyGrid :WAT@O</div>
</div>
<div class="standard"><a id="magicparlabel-4949"></a>Create non-orthogonal grid:</div>

<div class="lyx_code"><a id="magicparlabel-4950"></a><div class="lyx_code_item">trajin tz2.truncoct.nc</div>
<div class="lyx_code_item">reference ../tz2.truncoct.nc [REF]</div>
<div class="lyx_code_item">autoimage triclinic</div>
<div class="lyx_code_item">grid nonortho.dx boxref [REF] 50 50 50 :WAT@O pdb nonortho.pdb</div>
</div>
<h3 class="subsection"><a id="magicparlabel-4954"></a><span class="subsection_label">10.35</span> hbond<a id="subsec_cpptraj_hbond"></a>
</h3>

<div class="lyx_code"><a id="magicparlabel-4955"></a><div class="lyx_code_item">hbond<a id="magicparlabel-4959"></a>
 [&lt;dsname&gt;] [out &lt;filename&gt;] [&lt;mask&gt;] [angle &lt;acut&gt;] [dist &lt;dcut&gt;]</div>
<div class="lyx_code_item">      [donormask &lt;dmask&gt; [donorhmask &lt;dhmask&gt;]] [acceptormask &lt;amask&gt;]</div>
<div class="lyx_code_item">      [avgout &lt;filename&gt;] [printatomnum] [nointramol] [image]</div>
<div class="lyx_code_item">      [solventdonor &lt;sdmask&gt;] [solventacceptor &lt;samask&gt;]</div>
<div class="lyx_code_item">      [solvout &lt;filename&gt;] [bridgeout &lt;filename&gt;] [bridgebyatom]</div>
<div class="lyx_code_item">      [series [uuseries &lt;filename&gt;] [uvseries &lt;filename&gt;]]
<br />

</div>

<dl class="description"><a id="magicparlabel-4965"></a><dt class="description_label">[&lt;dsname&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Data set name.</span></dd>
<dt class="description_label">[out &lt;filename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write
 # of solute-solute hydrogen bonds (aspect [UU]) vs time to this file. 
If searching for solute-solvent hydrogen bonds, write # of 
solute-solvent hydrogen bonds (aspect [UV]) and # of bridging solvent 
molecules (aspect [Bridge]), as well as the residue # of the bridging 
solvent and the solute residues being bridged with format '&lt;solvent 
resnum&gt;(&lt;solute res1&gt;+&lt;solute res2&gt;+...+),...' (aspect 
[ID]).</span></dd>
<dt class="description_label">[&lt;mask&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Atoms to search for solute hydrogen bond donors/acceptors.</span></dd>
<dt class="description_label">[angle &lt;acut&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Angle cutoff for hydrogen bonds (default 135°). Can be disabled by specifying -1.</span></dd>
<dt class="description_label">[dist &lt;dcut&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Distance cutoff for hydrogen bonds (acceptor to donor heavy atom, default 3.0 Å).</span></dd>
<dt class="description_label">[donormask &lt;dmask&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use 
atoms in &lt;dmask&gt; as solute donor heavy atoms. If 'donorhmask' not 
specified only atoms bonded to hydrogen will be considered donors.</span></dd>
<dt class="description_label">[donorhmask &lt;dhmask&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use 
atoms in &lt;dmask&gt; as solute donor hydrogen atoms. Should only be 
specified if 'donormask' is. Should be a 1 to 1 correspondence between 
donormask and donorhmask.</span></dd>
<dt class="description_label">[acceptormask &lt;amask&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use atoms in &lt;amask&gt; as solute acceptor atoms.</span></dd>
<dt class="description_label">[avgout &lt;filename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write solute-solute hydrogen bond averages to &lt;filename&gt;.</span></dd>
<dt class="description_label">[printatomnum]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Add atom numbers to the output, in addtion to residue name, residue number and atom name.</span></dd>
<dt class="description_label">[nointramol]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Ignore intramolecular hydrogen bonds.</span></dd>
<dt class="description_label">[image]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Turn on imaging of distances/angles.</span></dd>
<dt class="description_label">[solventdonor &lt;sdmask&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use atoms in &lt;sdmask&gt; as solvent donors. Can specify ions as well.</span></dd>
<dt class="description_label">[solventacceptor &lt;samask&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use atoms in &lt;samask&gt; as solvent acceptors. Can specify ions as well.</span></dd>
<dt class="description_label">[solvout &lt;filename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write
 solute-solvent hydrogen bond averages to &lt;filename&gt;. If not 
specified and 'avgout' is, solute-solvent hydrogen bonds averages will 
be written to that file.</span></dd>
<dt class="description_label">[bridgeout &lt;filename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write
 information on detected solvent bridges to &lt;filename&gt;. If not 
specified, will be written to same place as 'solvout'.</span></dd>
<dt class="description_label">[bridgebyatom]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Report bridging results by atom instead of by residue.</span></dd>
<dt class="description_label">[series]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Save 
hydrogen bond formed (1.0) or not formed (0.0) per frame for any 
detected hydrogen bond. Solute-solute hydrogen bonds are saved with 
aspect [solutehb], solute-solvent hydrogen bonds are saved with aspect 
[solventhb].
<br />

</span>

<dl class="description"><a id="magicparlabel-4983"></a><dt class="description_label">[uuseries &lt;filename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> File to write solute-solute hbond time series data to.</span></dd>
<dt class="description_label">[uvseries &lt;filename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> File to write solute-solvent hbond time series data to.</span></dd>
</dl>
</dd></dl>
<div class="standard"><a id="magicparlabel-4985"></a><span style="font-family:monospace;">Data Sets Created:</span></div>

<dl class="description"><a id="magicparlabel-4986"></a><dt class="description_label">&lt;dsname&gt;[UU]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Number of solute-solute hydrogen bonds.</span></dd>
<dt class="description_label">&lt;dsname&gt;[UV]</dt>
<dd class="description_item"><span style="font-family:monospace;"> (only for <b>solventdonor</b>/<b>solventacceptor</b>) Number of solute-solvent hydrogen bonds.</span></dd>
<dt class="description_label">&lt;dsname&gt;[Bridge]</dt>
<dd class="description_item"><span style="font-family:monospace;"> (only for <b>solventdonor</b>/<b>solventacceptor</b>) Number of bridging solvent molecules.</span></dd>
<dt class="description_label">&lt;dsname&gt;[ID]</dt>
<dd class="description_item"><span style="font-family:monospace;"> (only for <b>solventdonor</b>/<b>solventacceptor</b>) String identifying bridging solvent residues and the solute residues they bridge.</span></dd>
<dt class="description_label">&lt;dsname&gt;[solutehb]</dt>
<dd class="description_item"><span style="font-family:monospace;"> (<b>series</b> only) Time series for solute-solute hydrogen bonds; 1 for present, 0 for not present.</span></dd>
<dt class="description_label">&lt;dsname&gt;[solventhb]</dt>
<dd class="description_item"><span style="font-family:monospace;"> (<b>series</b> only) Time series for solute-solvent hydrogen bonds; 1 for present, 0 for not present.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-4992"></a><i>Note that <b>series</b> data sets are not generated until hydrogen bonds are actually determined (i.e. <b>run</b> is called).</i></div>

<div class="standard"><a id="magicparlabel-4993"></a>Determine hydrogen 
bonds in each coordinate frame using simple geometric criteria. A 
hydrogen bond is defined as being between an acceptor heavy atom A, a 
donor hydrogen atom H, and a donor heavy atom D. If the A to D distance 
is less than the distance cutoff and the A-H-D angle is greater than the
 angle cutoff a hydrogen bond is considered formed. Imaging of 
distances/angles is not performed by default, but can be turned on using
 the <b>image</b> keyword.</div>

<div class="standard"><a id="magicparlabel-4994"></a>Potential hydrogen bond donor/acceptor atoms are searched for as follows:</div>

<ol class="enumerate"><a id="magicparlabel-4995"></a><li class="enumerate_item">If just <b>&lt;mask&gt;</b> is specified donors and acceptors will be automatically determined from <b>&lt;mask&gt;</b>.</li>
<li class="enumerate_item">If <b>donormask</b> is specified donors will be determined from <b>&lt;dmask&gt;</b> (only atoms bonded to hydrogen will be considered valid). Optionally, <b>donorhmask</b> can be used in conjunction with <b>donormask</b> to explicitly specify the hydrogen atoms bonded to donor atoms. Acceptors will be automatically determined from <b>&lt;mask&gt;</b>.</li>
<li class="enumerate_item">If <b>acceptormask</b> is specified acceptors will be determined from <b>&lt;amask&gt;</b>. Donors will be automatically determined from <b>&lt;mask&gt;</b>.</li>
<li class="enumerate_item">If both <b>acceptormask</b> and <b>donormask</b> are specified only <b>&lt;amask&gt;</b> and <b>&lt;dmask&gt;</b> will be used; no searching will occur in <b>&lt;mask&gt;</b>.</li>
</ol>
<div class="standard"><a id="magicparlabel-4999"></a>Automatic 
determination of hydrogen bond donors/acceptors uses the simplistic 
criterion that “hydrogen bonds are FON”, i.e., hydrogens bonded to F, O,
 and N atoms are considered donors, and F, O, and N atoms are considered
 acceptors. Intra-molecular hydrogen bonds can be ignored using the <b>nointramol</b> keyword.</div>

<div class="standard"><a id="magicparlabel-5000"></a>The number of hydrogen bonds present at each frame will be determined and written to the file specified by <b>out</b>. If the <b>series</b>
 keyword is specified the time series for each hydrogen bond (1 for 
present, 0 for not present) will also be saved for subsequent analysis 
(e.g. with <b><i>lifetime</i></b>, see <a href="#subsec_cpptraj_lifetime">elsewhere</a>);
 solute-solute hydrogen bonds will be saved to '&lt;dataset 
name&gt;[solutehb]' and solute-solvent hydrogen bonds will be saved to 
'&lt;dataset name&gt;[solventhb]'. The data set legends are set with the
 residues and atoms involved in the hydrogen bonds. In the case of 
solute to non-specific solvent hydrogen bonds, a V is used in place of 
solvent.</div>

<div class="standard"><a id="magicparlabel-5001"></a>If <b>avgout</b> is
 specified the average of each solute-solute hydrogen bond (sorted by 
population) formed over the course of the trajectory is printed with the
 format:</div>

<div class="lyx_code"><a id="magicparlabel-5002"></a><div class="lyx_code_item">Acceptor   DonorH   Donor   Frames   Frac   AvgDist   AvgAng</div>
</div>
<div class="standard"><a id="magicparlabel-5003"></a>where <i>Acceptor</i>, <i>DonorH</i>, and <i>Donor</i> are the residue and atom name of the atoms involved in the hydrogen bond, <i>Frames</i> is the number of frames the bond is present, <i>Frac</i> is the fraction of frames the bond is present, <i>AvgDist</i> is the average distance of the bond when present, and <i>AvgAng</i> is the average angle of the bond when present. The <b>printatomnum</b> keyword can be used to print atom numbers as well.</div>

<div class="standard"><a id="magicparlabel-5004"></a>Solute to non-specific solvent hydrogen bonds can be tracked by using the <b>solventdonor</b> and/or <b>solventacceptor</b>
 keywords. The number of solute-solvent hydrogen bonds and number of 
“bridging” solvent molecules (i.e. solvent that is hydrogen bonded to 
two or more different solute residues at the same time) will also be 
written to the file specified by <b>out</b>. These keywords can also be used to track non-specific interactions with ions. If <b>avgout</b> or <b>solvavg</b> is specified the average of each solute solvent hydrogen bond will be printed with the format:</div>

<div class="lyx_code"><a id="magicparlabel-5005"></a><div class="lyx_code_item">Acceptor   DonorH   Donor   Count   Frac   AvgDist   AvgAng</div>
</div>
<div class="standard"><a id="magicparlabel-5006"></a>where <i>Acceptor</i>, <i>DonorH</i>, and <i>Donor</i> are either the residue and atom name of the solute atoms or “SolventAcc”/”SolventH”/”SolventDnr” representing solvent, <i>Count</i>
 is the total number of interactions between solute and solvent (note 
this can be greater than the total number of frames since for any given 
frame more than one solvent molecule can hydrogen bond to the same place
 on solute and vice versa), <i>AvgDist</i> is the average distance of the bond when present, and <i>AvgAng</i> is the average angle of the bond when present. If <b>avgout</b> or <b>bridgeout</b>
 is specified information on residues that were bridged by a solvent 
molecule over the course of the trajectory will be written to 
&lt;bfilename&gt; with format:</div>

<div class="lyx_code"><a id="magicparlabel-5007"></a><div class="lyx_code_item">Bridge Res &lt;N0:RES0&gt; &lt;N1:RES1&gt; ... , &lt;X&gt; frames.</div>
</div>
<div class="standard"><a id="magicparlabel-5008"></a>where 
'&lt;N0:RES0&gt; ...' is a list of residues that were bridged (residue #
 followed by residue name) and &lt;X&gt; is the number of frames the 
residues were bridged.</div>
<h4 class="subsubsection_"><a id="magicparlabel-5009"></a>hbond Examples</h4>
<div class="standard"><a id="magicparlabel-5010"></a>To search for all 
hydrogen bonds within residues 1-22, writing the number of hydrogen 
bonds per frame to “nhb.dat” and information on each hydrogen bond found
 to “avghb.dat”:</div>

<div class="lyx_code"><a id="magicparlabel-5011"></a><div class="lyx_code_item">hbond :1-22 out nhb.dat avgout avghb.dat</div>
</div>
<div class="standard"><a id="magicparlabel-5012"></a>To search for all hydrogen bonds formed between donors in residue 1 and acceptors in residue 2:</div>

<div class="lyx_code"><a id="magicparlabel-5013"></a><div class="lyx_code_item">hbond donormask :1 acceptormask :2 out nhb.dat avgout avghb.dat</div>
</div>
<div class="standard"><a id="magicparlabel-5014"></a>To search for all intermolecular hydrogen bonds only and solute-solvent hydrogen bonds, saving time series data to HB:</div>

<div class="lyx_code"><a id="magicparlabel-5015"></a><div class="lyx_code_item">hbond HB out nhb.dat avgout solute_avg.dat \</div>
<div class="lyx_code_item">  solventacceptor :WAT@O solventdonor :WAT \</div>
<div class="lyx_code_item">  solvout solvent_avg.dat bridgeout bridge.dat \</div>
<div class="lyx_code_item">  series uuseries uuhbonds.agr uvseries uvhbonds.agr</div>
</div>
<div class="standard"><a id="magicparlabel-5019"></a>To search for non-specific hydrogen bonds between solute and ions named Na+:</div>

<div class="lyx_code"><a id="magicparlabel-5020"></a><div class="lyx_code_item">hbond HB-Ion out nhb.agr avgout ion_avg.dat \</div>
<div class="lyx_code_item">  solventacceptor :Na+ solventdonor :Na+</div>
</div>
<h3 class="subsection"><a id="magicparlabel-5022"></a><span class="subsection_label">10.36</span> image</h3>

<div class="lyx_code"><a id="magicparlabel-5023"></a><div class="lyx_code_item">image<a id="magicparlabel-5027"></a>
 [origin] [center] [triclinic | familiar [com &lt;commask&gt;]] [&lt;mask&gt;]</div>
<div class="lyx_code_item">      [ bymol | byres | byatom ] [xoffset &lt;x&gt;] [yoffset &lt;y&gt;] [zoffset &lt;z&gt;]
<br />

</div>

<dl class="description"><a id="magicparlabel-5029"></a><dt class="description_label">[origin]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Image to coordinate origin (0.0, 0.0, 0.0); default is to image to box center.</span></dd>
<dt class="description_label">[center]</dt>
<dd class="description_item"><span style="font-family:monospace;"> For bymol/byres, image by center of mass; default is to image by first atom position.</span></dd>
<dt class="description_label">[triclinic]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Force imaging with triclinic code. This is the default for non-orthorhombic cells.</span></dd>
<dt class="description_label">[familiar [com &lt;commask&gt;]]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Image
 to truncated octahedron shape. If 'com &lt;commask&gt;' is given, image
 with respect to the center of mass of atoms in &lt;commask&gt;.</span></dd>
<dt class="description_label">[&lt;mask&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Image atoms/residues/molecules in mask.</span></dd>
<dt class="description_label">[bymol]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Image by molecule (default).</span></dd>
<dt class="description_label">[byres]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Image by residue.</span></dd>
<dt class="description_label">[byatom]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Image by atom.</span></dd>
<dt class="description_label">[xoffset &lt;x&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Shift atoms by a factor of &lt;x&gt; in the X-direction.</span></dd>
<dt class="description_label">[yoffset &lt;y&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Shift atoms by a factor of &lt;y&gt; in the Y-direction.</span></dd>
<dt class="description_label">[zoffset &lt;z&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Shift atoms by a factor of &lt;z&gt; in the Z-direction.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-5040"></a>Note this command is intended for advanced use; for most cases the <b><i>autoimage</i></b> command should be sufficient.</div>

<div class="standard"><a id="magicparlabel-5041"></a>For periodic 
systems only, image molecules/residues/atoms that are outside of the box
 back into the box. Currently both orthorhombic and non-orthorhombic 
boxes are supported. A typical use of <b><i>image</i></b> is to move molecules back into the box after performing <b><i>center</i></b>.
 For example, the following commands move all atoms so that the center 
of residue 1 is at the center of the box, then image so that all 
molecules that are outside the box after centering are wrapped back 
inside:</div>

<div class="lyx_code"><a id="magicparlabel-5042"></a><div class="lyx_code_item">center :1</div>
<div class="lyx_code_item">image</div>
</div>
<div class="standard"><a id="magicparlabel-5044"></a>The xoffset etc. 
keywords can be used to shift the entire unit cell in a certain 
direction by the given factor, which can be useful for visualizing 
trajectories with periodic boundary conditions. For example, to generate
 a trajectory that is offset by 1.0 box length in the X direction, one 
could use:</div>

<div class="lyx_code"><a id="magicparlabel-5045"></a><div class="lyx_code_item">image xoffset 1.0</div>
<div class="lyx_code_item">trajout traj.offsetx1.nc</div>
</div>
<h3 class="subsection"><a id="magicparlabel-5047"></a><span class="subsection_label">10.37</span> jcoupling</h3>

<div class="lyx_code"><a id="magicparlabel-5048"></a><div class="lyx_code_item">jcoupling<a id="magicparlabel-5052"></a>
 &lt;mask&gt; [outfile &lt;filename&gt;] [kfile &lt;param file&gt;] [out &lt;filename&gt;]</div>
<div class="lyx_code_item">          [name &lt;dsname&gt;]
<br />

</div>

<dl class="description"><a id="magicparlabel-5054"></a><dt class="description_label">&lt;mask&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Atom mask in which to search for dihedrals within.</span></dd>
<dt class="description_label">[outfile &lt;filename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> File to write j-coupling values to with fixed format.</span></dd>
<dt class="description_label">[kfile &lt;param file&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> File containing Karplus parameters (default is $AMBERHOME/dat/Karplus.txt).</span></dd>
<dt class="description_label">[out &lt;filename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> File to write data set output to.</span></dd>
<dt class="description_label">[name &lt;dsname&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Data set name.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-5059"></a><i>Note data sets are not generated until <b>run</b> is called.</i></div>

<div class="standard"><a id="magicparlabel-5060"></a>Calculate J-coupling values for all dihedrals found within <b>&lt;mask&gt;</b>
 (all atoms if no mask given). In order to use this function, Karplus 
parameters for all dihedrals which will be calculated must be loaded. By
 default <i>cpptraj</i> will use the data found in $AMBERHOME/dat/Karplus.txt; if this is not found <i>cpptraj</i> will look for the file specified by the $KARPLUS environment variable. </div>

<div class="standard"><a id="magicparlabel-5061"></a>In the Karplus parameter file each parameter set consists of two lines for each dihedral with the format:</div>

<div class="lyx_code"><a id="magicparlabel-5062"></a><div class="lyx_code_item">[&lt;Type&gt;]&lt;Name1&gt;&lt;Name2&gt;&lt;Name3&gt;&lt;Name4&gt;&lt;A&gt;&lt;B&gt;&lt;C&gt;[&lt;D&gt;]</div>
<div class="lyx_code_item">&lt;Resname1&gt;[&lt;Resname2&gt;...]</div>
</div>
<div class="standard"><a id="magicparlabel-5064"></a>The first line 
defines the parameter set for a dihedral. &lt;Type&gt; is optional; if 
not given the form for calculating the J-coupling will be as described 
by Chou et al.[<a href="#LyXCite-Chou03"><span class="bib-numericallabel">7</span></a>]; if 'C' the form will be as described by Perez et al.[<a href="#LyXCite-Perez01"><span class="bib-numericallabel">24</span></a>].
 The &lt;NameX&gt; parameters define the four atoms involved in the 
dihedral. Each &lt;NameX&gt; parameter is 5 characters wide, starting 
with a plus '+', minus '-' or space ' ' character indicating the atom 
belongs to the next, previous, or current residue. The remaining 4 
characters are the atom name. The parameters &lt;A&gt;, &lt;B&gt;, 
&lt;C&gt;, and &lt;D&gt; are floating point values 6 characters wide 
describing the Karplus parameters. For the 'C' form A, B, and C 
correspond to C0, C1, and C2; D is unused and should not be specified. 
The second line is a list of residue names (4 characters each) to which 
the dihedral applies. For example:</div>

<div class="lyx_code"><a id="magicparlabel-5065"></a><div class="lyx_code_item">C HA   CA   CB   HB    5.40 -1.37  3.61</div>
<div class="lyx_code_item">ILE VAL </div>
</div>
<div class="standard"><a id="magicparlabel-5067"></a>Describes a 
dihedral between atoms HA-CA-CB-HB using the Perez et al. form with 
constants C0=5.40, C1=-1.37, C2=3.61 applied to ILE and VAL residues.</div>

<div class="standard"><a id="magicparlabel-5068"></a>Output can be in both a fixed format (<b>outfile &lt;filename&gt;</b>) and using cpptraj data set/data file formatting (<b>out &lt;filename&gt;</b>). The fixed format has each dihedral that is defined from <b>&lt;mask1&gt;</b> printed along with its calculated J-coupling value for each frame, e.g.:</div>

<div class="lyx_code"><a id="magicparlabel-5069"></a><div class="lyx_code_item">#Frame 1 </div>
<div class="lyx_code_item">1 SER HA CA CB HB2 45.334742 4.024759 </div>
<div class="lyx_code_item">1 SER HA CA CB HB3 -69.437134 1.829510</div>
<div class="lyx_code_item">...</div>
</div>
<div class="standard"><a id="magicparlabel-5073"></a>First the frame 
number is printed, then for each dihedral: Residue number, residue name,
 atom names 1-4 in the dihedral, the value of the dihedral, the 
J-coupling value.</div>

<div class="standard"><a id="magicparlabel-5074"></a>In <i><span style="font-family:monospace;">cpptraj</span></i> format, only the J-coupling value is written.</div>
<h3 class="subsection"><a id="magicparlabel-5075"></a><span class="subsection_label">10.38</span> lessplit</h3>

<div class="lyx_code"><a id="magicparlabel-5076"></a><div class="lyx_code_item">lessplit [out &lt;filename prefix&gt;] [average &lt;avg filename&gt;] &lt;trajout args&gt;
<br />

</div>

<dl class="description"><a id="magicparlabel-5077"></a><dt class="description_label">[out &lt;filename prefix&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write split LES trajectories to &lt;filename prefix&gt;.X, where X is an integer.</span></dd>
<dt class="description_label">[average &lt;avg filename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write trajectory of averaged LES regions to &lt;avg filename&gt;.</span></dd>
<dt class="description_label">&lt;trajout args&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Arguments for output trajectories.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-5080"></a>Split and/or average LES trajectory. At least one of <b>'out'</b> or <b>'average'</b> must be specified. If both are specified they share &lt;trajout args&gt;.</div>
<h3 class="subsection"><a id="magicparlabel-5081"></a><span class="subsection_label">10.39</span> lie</h3>

<div class="lyx_code"><a id="magicparlabel-5082"></a><div class="lyx_code_item">lie<a id="magicparlabel-5086"></a>
 [&lt;name&gt;] &lt;Ligand mask&gt; [&lt;Surroundings mask&gt;] [out &lt;filename&gt;]
<br />

    [noelec] [novdw] [cutvdw &lt;cutoff&gt;] [cutelec &lt;cutoff&gt;] [diel &lt;dielc&gt;]
<br />

</div>
<div class="standard"><a id="magicparlabel-5087"></a><span style="font-family:monospace;">DataSet Aspects:</span></div>

<dl class="description"><a id="magicparlabel-5088"></a><dt class="description_label">[EELEC]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Electrostatic energy (kcal/mol).</span></dd>
<dt class="description_label">[EVDW]</dt>
<dd class="description_item"><span style="font-family:monospace;"> van der Waals energy (kcal/mol).</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-5090"></a>For each frame, 
calculate the non-bonded interactions between all atoms in &lt;Ligand 
mask&gt; with all atoms in &lt;Surroundings mask&gt;. Electrostatic and 
van der Waals interactions will be calculated for all atom pairs. A 
separate electrostatic and van der Waals cutoff can be applied, the 
default is 12.0 Angstroms for both. &lt;dielc&gt; is an optional 
dielectric constant. Either the electrostatic or van der Waals 
calculations can be suppressed via the keywords noelec and novdw, 
respectively.</div>

<div class="standard"><a id="magicparlabel-5091"></a>The electrostatic 
interactions are calculated according to a simple shifting function 
shown below. The data file will contain two data sets—one for 
electrostatic interactions and one for van der Waals interactions. 
Periodic topologies and trajectories are required (i.e., explicit 
solvent is necessary). The minimum image convention is followed.</div>

<div class="standard"><a id="magicparlabel-5092"></a><math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>E</mi>
    </mrow>
    <mrow>
     <mrow><mi>e</mi><mi>l</mi><mi>e</mi><mi>c</mi>
     </mrow>
    </mrow>
   </msub><mo>=</mo><mi>k</mi>
   <mfrac>
    <mrow>
     <mrow>
      <msub>
       <mrow><mi>q</mi>
       </mrow>
       <mrow><mi>i</mi>
       </mrow>
      </msub>
      <msub>
       <mrow><mi>q</mi>
       </mrow>
       <mrow><mi>j</mi>
       </mrow>
      </msub>
     </mrow>
    </mrow>
    <mrow>
     <msub>
      <mrow><mi>r</mi>
      </mrow>
      <mrow>
       <mrow><mi>i</mi><mi>j</mi>
       </mrow>
      </mrow>
     </msub>
    </mrow>
   </mfrac>
   <msup>
    <mrow><mo form="prefix" fence="true" stretchy="true" symmetric="true">(</mo>

     <mrow><mn>1</mn><mo>-</mo>
      <mfrac>
       <mrow>
        <msubsup>
         <mrow><mi>r</mi>
         </mrow>
         <mrow>
          <mrow><mi>i</mi><mi>j</mi>
          </mrow>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
        </msubsup>
       </mrow>
       <mrow>
        <msubsup>
         <mrow><mi>r</mi>
         </mrow>
         <mrow>
          <mrow><mi>c</mi><mi>u</mi><mi>t</mi>
          </mrow>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
        </msubsup>
       </mrow>
      </mfrac>
     </mrow>
<mo form="postfix" fence="true" stretchy="true" symmetric="true">)</mo>

    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msup>
  </mrow>
 </mrow></math></div>
<h3 class="subsection"><a id="magicparlabel-5093"></a><span class="subsection_label">10.40</span> lipidorder</h3>

<div class="lyx_code"><a id="magicparlabel-5094"></a><div class="lyx_code_item">order out &lt;filename&gt; [x|y|z] [scd] [unsat &lt;mask&gt;] </div>
<div class="lyx_code_item">      [taildist &lt;filename&gt; [delta &lt;resolution&gt;] tailstart &lt;mask&gt;</div>
<div class="lyx_code_item">       tailend &lt;mask&gt;] &lt;mask0&gt; ... &lt;maskN&gt; 
<br />

</div>

<dl class="description"><a id="magicparlabel-5097"></a><dt class="description_label">out</dt>
<dd class="description_item"><span style="font-family:monospace;"> 
Output file for order parameters: Sx, Sy, Sz (each succeeded by the 
standard deviation), and two estimates for the deuterium-order parameter
 |SCD| = 0.5Sz and |SCD| = -(2Sx + Sy)/3. If scd is set then the order 
parameter directly computed from the C-H vectors is output. </span></dd>
<dt class="description_label">x|y|z</dt>
<dd class="description_item"><span style="font-family:monospace;"> Reference axis. (z) </span></dd>
<dt class="description_label">unsat</dt>
<dd class="description_item"><span style="font-family:monospace;"> Mask 
for unsaturated bonds. Sz is calculated for vector Cn-Cn+1. This is only
 relevant if scd (below) is not set, i.e. order parameters are 
calculated from carbon position only. </span></dd>
<dt class="description_label">scd</dt>
<dd class="description_item"><span style="font-family:monospace;"> 
Calculate the deuterium-order parameter |SCD| directly from the C-H 
vectors (masks must contain C-H-H triplets, see below). Otherwise the 
order parameter is estimated from carbon positions only (masks must 
contain only relevant carbons). (false) </span></dd>
<dt class="description_label">taildist</dt>
<dd class="description_item"><span style="font-family:monospace;"> Optional output file for end-to-end distances. </span></dd>
<dt class="description_label">delta</dt>
<dd class="description_item"><span style="font-family:monospace;"> Optional resolution for taildist. (0.1) </span></dd>
<dt class="description_label">tailstart</dt>
<dd class="description_item"><span style="font-family:monospace;"> Mask for the start of the tail. Must be given if taildist. </span></dd>
<dt class="description_label">tailend</dt>
<dd class="description_item"><span style="font-family:monospace;"> Mask for the end of the tail. Must be given if taildist. </span></dd>
<dt class="description_label">mask0</dt>
<dd class="description_item"><span style="font-family:monospace;"> ... maskN Masks for each group in the lipid chain.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-5106"></a>The order parameters <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>S</mi>
   </mrow>
   <mrow><mi>x</mi>
   </mrow>
  </msub>
 </mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>S</mi>
   </mrow>
   <mrow><mi>y</mi>
   </mrow>
  </msub>
 </mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>S</mi>
   </mrow>
   <mrow><mi>z</mi>
   </mrow>
  </msub>
 </mrow></math> and |SCD| are calculated. Carbons must be given in bonding order. If <b>scd</b>
 the masks must be made up of C-H-H triples, hence hydrogens to double 
bonds must be enumerated twice while methyl groups require an additional
 mask which will also create two entries in the output.</div>

<div class="standard"><a id="magicparlabel-5107"></a><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>S</mi>
   </mrow>
   <mrow><mi>z</mi>
   </mrow>
  </msub>
 </mrow></math>is the vector joining carbons <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>C</mi>
   </mrow>
   <mrow>
    <mrow><mi>n</mi><mo>-</mo><mn>1</mn>
    </mrow>
   </mrow>
  </msub>
 </mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>C</mi>
   </mrow>
   <mrow>
    <mrow><mi>n</mi><mo>+</mo><mn>1</mn>
    </mrow>
   </mrow>
  </msub>
 </mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>S</mi>
   </mrow>
   <mrow><mi>x</mi>
   </mrow>
  </msub>
 </mrow></math> the vector normal to the <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>C</mi>
    </mrow>
    <mrow>
     <mrow><mi>n</mi><mo>-</mo><mn>1</mn>
     </mrow>
    </mrow>
   </msub><mo>-</mo>
   <msub>
    <mrow><mi>C</mi>
    </mrow>
    <mrow><mi>n</mi>
    </mrow>
   </msub>
  </mrow>
 </mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>C</mi>
    </mrow>
    <mrow><mi>n</mi>
    </mrow>
   </msub><mo>-</mo>
   <msub>
    <mrow><mi>C</mi>
    </mrow>
    <mrow>
     <mrow><mi>n</mi><mo>+</mo><mn>1</mn>
     </mrow>
    </mrow>
   </msub>
  </mrow>
 </mrow></math> plane and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>S</mi>
   </mrow>
   <mrow><mi>y</mi>
   </mrow>
  </msub>
 </mrow></math> is the third axis in the molecular coordinate system. The order parameter is then calculated from <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>S</mi><mi>c</mi><mo>=</mo><mn>0.5</mn><mo>&lt;</mo><mn>3</mn><mo> cos </mo><mo form="prefix" fence="true" stretchy="true" symmetric="true">(</mo>

   <mrow><mn>2</mn><mi> θ </mi>
   </mrow>
<mo form="postfix" fence="true" stretchy="true" symmetric="true">)</mo>
<mo>&gt;</mo><mo>-</mo><mn>1</mn>
  </mrow>
 </mrow></math>, where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi> θ </mi>
 </mrow></math> is the angle to the chosen reference axis. See example input file.</div>

<div class="standard"><a id="magicparlabel-5108"></a>Example input (all atom names according to CHARMM27 force field for POPC). </div>

<div class="standard"><a id="magicparlabel-5109"></a>sn1 chain: order parameters <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>S</mi>
   </mrow>
   <mrow><mi>x</mi>
   </mrow>
  </msub>
 </mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>S</mi>
   </mrow>
   <mrow><mi>y</mi>
   </mrow>
  </msub>
 </mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>S</mi>
   </mrow>
   <mrow><mi>z</mi>
   </mrow>
  </msub>
 </mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mo>|</mo><mi>S</mi><mi>C</mi><mi>D</mi><mo>|</mo><mo>=</mo><mn>0.5</mn><mo> × </mo>
   <msub>
    <mrow><mi>S</mi>
    </mrow>
    <mrow><mi>z</mi>
    </mrow>
   </msub>
  </mrow>
 </mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mo>|</mo><mi>S</mi><mi>C</mi><mi>D</mi><mo>|</mo><mo>=</mo><mo>-</mo><mo form="prefix" fence="true" stretchy="true" symmetric="true">(</mo>

   <mrow><mn>2</mn>
    <msub>
     <mrow><mi>S</mi>
     </mrow>
     <mrow><mi>x</mi>
     </mrow>
    </msub><mo>+</mo>
    <msub>
     <mrow><mi>S</mi>
     </mrow>
     <mrow><mi>y</mi>
     </mrow>
    </msub>
   </mrow>
<mo form="postfix" fence="true" stretchy="true" symmetric="true">)</mo>
<mo>/</mo><mn>3</mn>
  </mrow>
 </mrow></math></div>

<div class="lyx_code"><a id="magicparlabel-5110"></a><div class="lyx_code_item">lipidorder out sn1.dat z taildist e2e_sn1.dat delta 0.1 \</div>
<div class="lyx_code_item">           tailstart ":POPC@C32" tailend ":POPC@C316" \</div>
<div class="lyx_code_item">           ":POPC@C32" ":POPC@C33" ":POPC@C34" ":POPC@C35" \</div>
<div class="lyx_code_item">           ":POPC@C36" ":POPC@C37" ":POPC@C38" ":POPC@C39" \</div>
<div class="lyx_code_item">           ":POPC@C310" ":POPC@C311" ":POPC@C312" ":POPC@C313" \</div>
<div class="lyx_code_item">           ":POPC@C314" ":POPC@C315" ":POPC@C316"</div>
</div>
<div class="standard"><a id="magicparlabel-5116"></a>See also <span style="font-family:monospace;">$AMBERHOME/AmberTools/test/cpptraj/Test_LipidOrder</span>.</div>
<h3 class="subsection"><a id="magicparlabel-5117"></a><span class="subsection_label">10.41</span> lipidscd</h3>

<div class="lyx_code"><a id="magicparlabel-5118"></a><div class="lyx_code_item">lipidscd [&lt;name&gt;] [&lt;mask&gt;] [{x|y|z}] [out &lt;file&gt;] [p2]</div>

<dl class="description"><a id="magicparlabel-5119"></a><dt class="description_label">&lt;name&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output data set name.</span></dd>
<dt class="description_label">&lt;mask&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Atom mask specifying where to search for lipids.</span></dd>
<dt class="description_label">x|y|z</dt>
<dd class="description_item"><span style="font-family:monospace;"> Axis to calculate order parameters with respect to (default z).</span></dd>
<dt class="description_label">out &lt;file&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> File to write order parameters to.</span></dd>
<dt class="description_label">p2</dt>
<dd class="description_item"><span style="font-family:monospace;"> If specified, report raw &lt;P2&gt; values.</span></dd>
</dl>
<div class="standard"><a id="magicparlabel-5124"></a><span style="font-family:monospace;">DataSets Generated:</span></div>

<dl class="description"><a id="magicparlabel-5125"></a><dt class="description_label">&lt;name&gt;[H1]:&lt;idx&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Hold lipid order parameters for each C-H1. Each lipid type will have a different &lt;idx&gt; starting from 0.</span></dd>
<dt class="description_label">&lt;name&gt;[H2]:&lt;idx&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Hold lipid order parameters for each C-H2. If no H2, the C-H1 value will be used.</span></dd>
<dt class="description_label">&lt;name&gt;[H3]:&lt;idx&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Hold lipid order parameters for each C-H3. If no H3, the C-H2/C-H1 value will be used.</span></dd>
<dt class="description_label">&lt;name&gt;[SDHX]:&lt;idx&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Hold standard deviation of lipid order parameters for each C-HX.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-5129"></a>Calculate lipid 
order parameters SCD (|&lt;P2&gt;|) for lipid chains in mask   
&lt;mask&gt;. Lipid chains are identified by carboxyl groups, i.e.   
O-(C=O)-C1-...-CN, where C1 is the first carbon in the acyl chain   and 
CN is the last. Order parameters will be determined for each   hydrogen 
bonded to each carbon. If 'p2' is specified the raw &lt;P2&gt;   values 
will be reported.</div>
<h3 class="subsection"><a id="magicparlabel-5130"></a><span class="subsection_label">10.42</span> makestructure</h3>

<div class="lyx_code"><a id="magicparlabel-5131"></a><div class="lyx_code_item">makestructure &lt;List of Args&gt;</div>
</div>
<div class="standard"><a id="magicparlabel-5132"></a>Apply dihedrals to 
specified residues using arguments found in &lt;List of Args&gt;, where 
an argument is 1 or more of the following arg types: </div>
<h4 class="subsubsection_"><a id="magicparlabel-5133"></a>&lt;sstype keyword&gt;:&lt;res range&gt;</h4>
<div class="standard"><a id="magicparlabel-5134"></a>Apply secondary 
structure type (via phi/psi backbone angles) to residues in given range.
 If the secondary structure type is a turn, the residue range must 
correspond to a multiple of 2 residues.</div>



<div class="standard" style="text-align: center;"><a id="magicparlabel-5135"></a><table><tbody><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-5187"></a><b>Keyword</b></div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-5190"></a><b>phi, psi (deg.)</b></div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-5193"></a><b># residues</b></div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-5196"></a>alpha</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-5199"></a>-57.8, -47.0</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-5202"></a>1</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-5205"></a>left</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-5208"></a>-57.8, 47.0</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-5211"></a>1</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-5214"></a>pp2</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-5217"></a>-75.0, 145.0</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-5220"></a>1</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-5223"></a>hairpin</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-5226"></a>-100.0, 130.0</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-5229"></a>1</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-5232"></a>extended</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-5235"></a>-150.0, 155.0</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-5238"></a>1</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-5241"></a>typeI</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-5244"></a>-60.0, -30.0 | -90.0, 0.0</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-5247"></a>2</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-5250"></a>typeII</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-5253"></a>-60.0, 120.0 | 80.0, 0.0</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-5256"></a>2</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-5259"></a>typeVIII</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-5262"></a>-60.0, -30.0 | -120.0, 120.0</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-5265"></a>2</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-5268"></a>typeI'</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-5271"></a>60.0, 30.0 | 90.0, 0.0</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-5274"></a>2</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-5277"></a>typeII</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-5280"></a>60.0, -120.0 | -80.0, 0.0</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-5283"></a>2</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-5286"></a>typeVIa1</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-5289"></a>-60.0, 120.0 | -90.0, 0.0</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-5292"></a>2</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-5295"></a>typeVIa2</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-5298"></a>-120.0, 120.0 | -60.0, 0.0</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-5301"></a>2</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-5304"></a>typeVIb</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-5307"></a>-135.0, 135.0 | -75.0, 160.0</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-5310"></a>2</div>
</td>
</tr></tbody>
</table>
</div>
<h4 class="subsubsection_"><a id="magicparlabel-5311"></a>&lt;custom ss&gt;:&lt;res range&gt;[:&lt;phi&gt;:&lt;psi&gt;]</h4>
<div class="standard"><a id="magicparlabel-5312"></a>If &lt;phi&gt; and 
&lt;psi&gt; are given, define a custom secondary structure conformation 
named &lt;custom_ss&gt; and apply to residues in range. If 
&lt;custom_ss&gt; has been previously defined then apply it to residues 
in range.</div>
<h4 class="subsubsection_"><a id="magicparlabel-5313"></a>&lt;custom turn&gt;:&lt;res range&gt;[:&lt;phi1&gt;:&lt;psi1&gt;:&lt;phi2&gt;:&lt;psi2&gt;]</h4>
<div class="standard"><a id="magicparlabel-5314"></a>If &lt;phi1&gt;, 
&lt;psi1&gt;, &lt;phi2&gt;, and &lt;psi2&gt; are given, defined a custom
 turn conformation named &lt;custom_turn&gt; and apply to residues in 
range (range must correspond to a multiple of 2 residues). If 
&lt;custom_turn&gt; has been previously defined then apply it to 
residues in range.</div>
<h4 class="subsubsection_"><a id="magicparlabel-5315"></a>&lt;custom dih&gt;:&lt;res range&gt;[:&lt;dih type&gt;:&lt;angle&gt;]</h4>

<div class="lyx_code"><a id="magicparlabel-5316"></a><div class="lyx_code_item">&lt;dih type&gt; = phi psi chip omega alpha beta gamma delta epsilon zeta nu1 nu2 chin </div>
</div>
<div class="standard"><a id="magicparlabel-5317"></a>If &lt;dih type&gt;
 and &lt;angle&gt; are given, apply &lt;angle&gt; to selected dihedrals 
of type in range. If &lt;custom dih&gt; has been previously defined then
 apply it to residues in range.</div>
<h4 class="subsubsection_"><a id="magicparlabel-5318"></a>&lt;custom dih&gt;:&lt;res range&gt;[:&lt;at0&gt;:&lt;at1&gt;:&lt;at2&gt;:&lt;at3&gt;:&lt;angle&gt;[:&lt;offset&gt;]]</h4>
<div class="standard"><a id="magicparlabel-5319"></a>Apply &lt;angle&gt;
 to dihedral defined by atoms &lt;at1&gt;, &lt;at2&gt;, &lt;at3&gt;, and
 &lt;at4&gt;, or use previously defined &lt;custom_dih&gt;.</div>



<div class="standard"><a id="magicparlabel-5320"></a><table><tbody><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-5341"></a>&lt;offset&gt;</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-5344"></a>Description</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-5347"></a>-2</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-5350"></a>&lt;at0&gt; and &lt;at1&gt; in previous residue.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-5353"></a>-1</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-5356"></a>&lt;at0&gt; in previous residue.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-5359"></a>0</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-5362"></a>All atoms in single residue.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-5365"></a>1</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-5368"></a>&lt;at3&gt; in next residue.</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-5371"></a>2</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-5374"></a>&lt;at2&gt; and &lt;at3&gt; in next residue.</div>
</td>
</tr></tbody>
</table>
</div>
<h4 class="subsubsection_"><a id="magicparlabel-5375"></a>ref:&lt;range&gt;:&lt;refname&gt;[:&lt;ref range&gt;]</h4>
<div class="standard"><a id="magicparlabel-5376"></a>Apply dihedrals 
from residues &lt;ref_range&gt; in previously loaded reference structure
 &lt;refname&gt; to dihedrals in &lt;range&gt;.</div>
<h4 class="subsubsection_"><a id="magicparlabel-5377"></a>Examples</h4>
<div class="standard"><a id="magicparlabel-5378"></a>Assign polyproline II structure to residues 1 through 13:</div>

<div class="lyx_code"><a id="magicparlabel-5379"></a><div class="lyx_code_item">makestructure pp2:1-13</div>
</div>
<div class="standard"><a id="magicparlabel-5380"></a>Make residues 1 and
 12 'extended', residues 6 and 7 a type I' turn, and two custom 
assignments, one (custom1) for residues 2-5, the other (custom2) for 
residues 8-11:</div>

<div class="lyx_code"><a id="magicparlabel-5381"></a><div class="lyx_code_item">makestructure extended:1,12 \</div>
<div class="lyx_code_item">              custom1:2-5:-80.0:130.0:-130.0:140.0 \</div>
<div class="lyx_code_item">              typeI':6-7 \</div>
<div class="lyx_code_item">              custom2:8-11:-140.0:170.0:-100.0:140.0</div>
</div>
<div class="standard"><a id="magicparlabel-5385"></a>Assign residue 5 phi 90 degrees, residues 6 and 7 phi=-70 and psi=60 degrees:</div>

<div class="lyx_code"><a id="magicparlabel-5386"></a><div class="lyx_code_item">makestructure customdih:5:phi:90 custom:6,7:-70:60</div>
</div>
<div class="standard"><a id="magicparlabel-5387"></a>Create a new dihedral named chi1 and assign it a value of 35 degrees in residue 8:</div>

<div class="lyx_code"><a id="magicparlabel-5388"></a><div class="lyx_code_item">makestructure chi1:8:N:CA:CB:CG:35</div>
</div>
<div class="standard"><a id="magicparlabel-5389"></a>Assign 'extended' structure to residues 1 and 12, a custom turn to residues 2-5 and 8-11, and a typeI' turn to residues 6-7:</div>

<div class="lyx_code"><a id="magicparlabel-5390"></a><div class="lyx_code_item">makestructure extended:1,12 \</div>
<div class="lyx_code_item">              custom1:2-5:-80.0:130.0:-130.0:140.0 \</div>
<div class="lyx_code_item">              typeI’:6-7 \</div>
<div class="lyx_code_item">              custom1:8-11</div>
</div>
<div class="standard"><a id="magicparlabel-5394"></a>Assign secondary structure from reference structure:</div>

<div class="lyx_code"><a id="magicparlabel-5395"></a><div class="lyx_code_item">parm ../tz2.parm7</div>
<div class="lyx_code_item">reference ../tz2.rst7</div>
<div class="lyx_code_item">trajin pp2.rst7.save</div>
<div class="lyx_code_item">makestructure "ref:1-13:tz2.rst7" rmsd reference</div>
<div class="lyx_code_item">trajout fromref.pdb multi </div>
</div>
<h3 class="subsection"><a id="magicparlabel-5400"></a><span class="subsection_label">10.43</span> mask</h3>

<div class="lyx_code"><a id="magicparlabel-5401"></a><div class="lyx_code_item">mask<a id="magicparlabel-5405"></a>
 &lt;mask&gt; [maskout &lt;filename&gt;] [maskpdb &lt;pdbname&gt;] [maskmol2 &lt;mol2name&gt;]
<br />

</div>

<dl class="description"><a id="magicparlabel-5406"></a><dt class="description_label">&lt;mask&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Atom mask to process.</span></dd>
<dt class="description_label">[maskout &lt;filename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write information on atoms in &lt;mask&gt; to &lt;filename&gt;.</span></dd>
<dt class="description_label">[maskpdb &lt;name&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write PDB of atoms in &lt;mask&gt; to &lt;name&gt;.X.</span></dd>
<dt class="description_label">[maskmol2 &lt;name&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write Mol2 of atoms in &lt;mask&gt; to &lt;name&gt;.X.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-5410"></a>For each frame determine all atoms that correspond to <b>&lt;mask&gt;</b>. This is most useful when using distance-based masks, since the atoms in the mask are updated for every frame read in. If <b>maskout</b> is specified information on all atoms in &lt;mask&gt; will be written to &lt;filename&gt; with format:</div>

<div class="lyx_code"><a id="magicparlabel-5411"></a><div class="lyx_code_item">#Frame AtomNum Atom ResNum Res MolNum</div>
</div>
<div class="standard"><a id="magicparlabel-5412"></a>where <span style="font-family:monospace;">#Frame</span> is the frame number, <span style="font-family:monospace;">AtomNum</span> is the number of the selected atom, <span style="font-family:monospace;">Atom</span> is the name of the selected atom, <span style="font-family:monospace;">ResNum</span> is the residue number of the selected atom, <span style="font-family:monospace;">Res</span> is the residue name, and <span style="font-family:monospace;">MolNum</span> is the molecule number of the selected atom.</div>

<div class="standard"><a id="magicparlabel-5413"></a>If <b>maskpdb</b> or <b>maskmol2</b> are specified a PDB/Mol2 file corresponding to &lt;mask&gt; will be written out every frame with name “<i>&lt;name&gt;.frame#</i>”.</div>

<div class="standard"><a id="magicparlabel-5414"></a>For example, to 
write out all atoms within 3.0 Angstroms of residue 195 that are part of
 residues named WAT to “Res195WAT.dat”, as well as write out 
corresponding PDB files:</div>

<div class="lyx_code"><a id="magicparlabel-5415"></a><div class="lyx_code_item">mask “(:195&lt;:3.0)&amp;:WAT” maskout Res195WAT.dat maskpdb Res195WAT.pdb</div>
</div>
<h3 class="subsection"><a id="magicparlabel-5416"></a><span class="subsection_label">10.44</span> matrix</h3>

<div class="lyx_code"><a id="magicparlabel-5417"></a><div class="lyx_code_item">matrix [out &lt;filename&gt;] [start &lt;#&gt;] [stop|end &lt;#&gt;] [offset &lt;#&gt;]</div>
<div class="lyx_code_item">       [name &lt;name&gt;] [ byatom | byres [mass] | bymask [mass] ]</div>
<div class="lyx_code_item">       [ ired [order &lt;#&gt;] ]</div>
<div class="lyx_code_item">       [ {distcovar | idea} &lt;mask1&gt; ]</div>
<div class="lyx_code_item">       [ {dist | correl | covar | mwcovar} &lt;mask1&gt; [&lt;mask2&gt;] ]</div>
<div class="lyx_code_item">       [ dihcovar dihedrals &lt;dataset arg&gt; ]
<br />

</div>

<dl class="description"><a id="magicparlabel-5423"></a><dt class="description_label">[out &lt;filename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> If specified, write matrix to &lt;filename&gt;.</span></dd>
<dt class="description_label">[start &lt;#&gt;] [stop|end &lt;#&gt;] [offset &lt;#&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Start, stop, and offset frames to use (as a subset of all frames read in).</span></dd>
<dt class="description_label">[name &lt;name&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Name of the matrix dataset (for referral in subsequent analysis).</span></dd>
<dt class="description_label">byatom</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write results by atom (default). This is the sole option for covar, mwcovar, and ired.</span></dd>
<dt class="description_label">byres</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write results by calculating an average for each residue (mass weighted if <b>mass</b> is specified).</span></dd>
<dt class="description_label">bymask</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write
 average over &lt;mask1&gt;, and if &lt;mask2&gt; is specified 
&lt;mask1&gt; x &lt;mask2&gt; and &lt;mask2&gt; as well (mass weighted 
if <b>mass</b> is specified).</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-5429"></a>Calculate matrix of the specified type from input coordinate frames:</div>

<dl class="description"><a id="magicparlabel-5430"></a><dt class="description_label">dist &lt;mask1&gt; [&lt;mask2&gt;]</dt>
<dd class="description_item"> Distance matrix (default).</dd>
<dt class="description_label">correl &lt;mask1&gt; [&lt;mask2&gt;]</dt>
<dd class="description_item"> Correlation matrix (aka dynamic cross correlation[<a href="#LyXCite-Hunenberger1995"><span class="bib-numericallabel">17</span></a>]).</dd>
<dt class="description_label">covar &lt;mask1&gt; [&lt;mask2&gt;]</dt>
<dd class="description_item"> Coordinate covariance matrix. </dd>
<dt class="description_label">mwcovar &lt;mask1&gt; [&lt;mask2&gt;]</dt>
<dd class="description_item"> Mass-weighted coordinate covariance matrix.</dd>
<dt class="description_label">distcovar &lt;mask1&gt;</dt>
<dd class="description_item"> Distance covariance matrix.</dd>
<dt class="description_label">idea &lt;mask1&gt;</dt>
<dd class="description_item"> Isotropically Distributed Ensemble Analysis matrix.[<a href="#LyXCite-Prompers02"><span class="bib-numericallabel">25</span></a>]</dd>
<dt class="description_label">ired [order &lt;#&gt;]</dt>
<dd class="description_item"> Isotropic Reorientational Eigenmode Dynamics matrix[<a href="#LyXCite-Prompers02a"><span class="bib-numericallabel">26</span></a>] with Legendre polynomials of specified order (default 1). IRED vectors must have been specified previously with '<em><b>vector</b></em> <b>ired</b>' (see <a href="#subsec_cpptraj_vector">10.81</a>).</dd>
<dt class="description_label">dihcovar dihedrals &lt;dataset arg&gt;</dt>
<dd class="description_item"> Dihedral covariance matrix. Dihedral data sets must have been previously defined with e.g. <em><b>dihedral</b></em> or <em><b>multidihedral</b></em> commands or read in externally with <em><b>readdata</b></em> and marked as dihedrals.</dd>
</dl>
<div class="standard"><a id="magicparlabel-5438"></a>Matrix dimensions will be of the order of N x M for <b>dist</b>, <b>correl</b>, <b>idea</b>, and <b>ired</b>, 2N x 2N for <b>dihcovar</b>, 3N x 3M for <b>covar</b> and <b>mwcovar</b>, and N(N-1) x N(N-1) / 4 for <b>distcovar</b> (with N being the number of data sets in the case of <b>ired</b> and <b>dihcovar</b> and the number of atoms in <em><b><i>&lt;mask1&gt;</i></b></em><!-- Output Error: Tried to close pending tag `b' when other tags were pending. Last pending tag is `<i>'. Tag discarded. -->
 otherwise, and M being the number of atoms in <b>&lt;mask2&gt;</b> if specified or <em><b><i>&lt;mask1&gt;</i></b></em><!-- Output Error: Tried to close pending tag `b' when other tags were pending. Last pending tag is `<i>'. Tag discarded. -->
 otherwise). No mask is required for <b>ired</b>; the matrix will be made up of previously defined IRED vectors (see the <b><i>vector</i></b> command <a href="#subsec_cpptraj_vector">elsewhere</a>).
 Similarly no mask is required for dihcovar; dihedral data sets must 
have been previously defined. Only one mask can be used with <b>distcovar</b> and <b>idea</b>
 matrices (i.e. they can be symmetric only), otherwise one or two masks 
can be used (for symmetric and full matrices respectively). If two masks
 are specified the number of atoms covered by <i>mask1</i> must be greater than or equal to the number of atoms covered by <i>mask2,</i> and on output <b>&lt;mask1&gt;</b><i> </i>corresponds to columns while <b>&lt;mask2&gt;</b> corresponds to rows.</div>

<div class="standard"><a id="magicparlabel-5439"></a>As a simple example, a distance matrix of all CA atoms is generated and output to distmat.dat.</div>

<div class="lyx_code"><a id="magicparlabel-5440"></a><div class="lyx_code_item">matrix dist @CA out distmat.dat</div>
</div>
<h3 class="subsection"><a id="magicparlabel-5441"></a><span class="subsection_label">10.45</span> mindist</h3>
<div class="standard"><a id="magicparlabel-5442"></a>This functionality is now part of the <em><b>nativecontacts</b></em> command; see <a href="#subsec_cpptraj_nativecontacts">10.51</a>.</div>
<h3 class="subsection"><a id="magicparlabel-5443"></a><span class="subsection_label">10.46</span> minimage</h3>

<div class="lyx_code"><a id="magicparlabel-5444"></a><div class="lyx_code_item">minimage [&lt;name&gt;] &lt;mask1&gt; &lt;mask2&gt; [out &lt;filename&gt;] [geom] [maskcenter]
<br />

</div>

<dl class="description"><a id="magicparlabel-5445"></a><dt class="description_label">&lt;name&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Data set name.</span></dd>
<dt class="description_label">&lt;mask1&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> First atom mask.</span></dd>
<dt class="description_label">&lt;mask2&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Second atom mask.</span></dd>
<dt class="description_label">out &lt;filename&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> File to write to.</span></dd>
<dt class="description_label">geom</dt>
<dd class="description_item"><span style="font-family:monospace;"> (<b>maskcenter</b> only) If specified, use geometric center instead of center of mass.</span></dd>
<dt class="description_label">maskcenter</dt>
<dd class="description_item"><span style="font-family:monospace;"> Calculate distance from center of masks instead of between each atom.</span></dd>
</dl>
<div class="standard"><a id="magicparlabel-5451"></a><span style="font-family:monospace;">Data Sets Created:</span></div>

<dl class="description"><a id="magicparlabel-5452"></a><dt class="description_label">&lt;name&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Minimum distance to an image in Ang.</span></dd>
<dt class="description_label">&lt;name&gt;[A1]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Atom number in mask 1 involved in minimum distance.</span></dd>
<dt class="description_label">&lt;name&gt;[A2]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Atom number in mask 2 involved in minimum distance.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-5455"></a>Calculate the 
shortest distance to an image, i.e. the distance to a neighboring unit 
cell, as well as the numbers of the atoms involved in the distance. By 
default the distance between each atom in &lt;mask1&gt; and 
&lt;mask2&gt; is considered; if <b>maskcenter</b> is specified the center of the masks is used.</div>
<h3 class="subsection"><a id="magicparlabel-5456"></a><span class="subsection_label">10.47</span> molsurf</h3>

<div class="lyx_code"><a id="magicparlabel-5457"></a><div class="lyx_code_item">molsurf<a id="magicparlabel-5461"></a>
 [&lt;name&gt;] [&lt;mask&gt;] [out filename] [probe &lt;probe_rad&gt;]</div>
<div class="lyx_code_item">    	[radii {gb | parse | vdw}] [offset &lt;rad_offset&gt;]
<br />

</div>

<dl class="description"><a id="magicparlabel-5463"></a><dt class="description_label">[&lt;name&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Name of surface area data set.</span></dd>
<dt class="description_label">[&lt;mask&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Atoms to calculate surface area of.</span></dd>
<dt class="description_label">[out &lt;filename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> File to write values to.</span></dd>
<dt class="description_label">[probe &lt;probe_rad&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Probe radius (default 1.4 Angstrom).</span></dd>
<dt class="description_label">[offset &lt;rad_offset&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Add &lt;rad_offset&gt; to each atom radius (default 0.0).</span></dd>
<dt class="description_label">[radii {gb|parse|vdw}]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Specify radii to use:
<br />

</span>

<dl class="description"><a id="magicparlabel-5469"></a><dt class="description_label">gb</dt>
<dd class="description_item"><span style="font-family:monospace;"> GB radii (default).</span></dd>
<dt class="description_label">parse</dt>
<dd class="description_item"><span style="font-family:monospace;"> PARSE radii.</span></dd>
<dt class="description_label">vdw</dt>
<dd class="description_item"><span style="font-family:monospace;"> van der Waals radii.</span></dd>
</dl>
</dd></dl>
</div>
<div class="standard"><a id="magicparlabel-5472"></a>Calculate the Connolly surface area[<a href="#LyXCite-Connolly83"><span class="bib-numericallabel">8</span></a>]
 of atoms in &lt;mask&gt; (default all atoms if no mask specified) using
 routines from molsurf (originally developed by Paul Beroza) using the 
probe radius specified by <b>probe</b> (1.4 Å if not specified). Note 
that if GB/VDW radii are not present in the topology file (e.g. for PDB 
files), then PARSE radii can be used. Also note that this routine only 
calculate absolute surface areas, i.e. it cannot be used to get the 
contribution of a subset of atoms to overall surface area; if such 
functionality is needed try the <em><b>surf</b></em> command (<a href="#subsec_cpptraj_surf">10.75</a>).</div>
<h3 class="subsection"><a id="magicparlabel-5473"></a><span class="subsection_label">10.48</span> multidihedral</h3>

<div class="lyx_code"><a id="magicparlabel-5474"></a><div class="lyx_code_item">multidihedral [&lt;name&gt;] &lt;dihedral types&gt; [resrange &lt;range&gt;] [out &lt;filename&gt;] [range360]</div>
<div class="lyx_code_item">              [dihtype &lt;name&gt;:&lt;a0&gt;:&lt;a1&gt;:&lt;a2&gt;:&lt;a3&gt;[:&lt;offset&gt;] ...]</div>
<div class="lyx_code_item">                  Offset -2=&lt;at0&gt;&lt;at1&gt; in previous res, -1=&lt;at0&gt; in previous res,</div>
<div class="lyx_code_item">                          0=All &lt;atX&gt; in single res,</div>
<div class="lyx_code_item">                          1=&lt;at3&gt; in next res, 2=&lt;at2&gt;&lt;at3&gt; in next res.</div>
<div class="lyx_code_item">              &lt;dihedral types&gt; =  phi psi chip omega alpha beta gamma delta </div>
<div class="lyx_code_item">                                  epsilon zeta nu1 nu2 chin
<br />

</div>

<dl class="description"><a id="magicparlabel-5481"></a><dt class="description_label">[&lt;name&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output data set name.</span></dd>
<dt class="description_label">&lt;dihedral types&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Dihedral types to look for. Note that chip is 'protein chi', chin is 'nucleic chi'.</span></dd>
<dt class="description_label">[resrange &lt;range&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Residue range to look for dihedrals in.</span></dd>
<dt class="description_label">[out &lt;filename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output file name.</span></dd>
<dt class="description_label">[range360]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Wrap torsion values from 0.0 to 360.0 (default is -180.0 to 180.0).</span></dd>
<dt class="description_label">[dihtype &lt;name&gt;:&lt;a0&gt;:&lt;a1&gt;:&lt;a2&gt;:&lt;a3&gt;[:&lt;offset&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Search for a custom dihedral type called &lt;name&gt; using atom names &lt;a0&gt;, &lt;a1&gt;, &lt;a2&gt;, and &lt;a3&gt;.
<br />

</span>
<div class="standard"><a id="magicparlabel-5487"></a><span style="font-family:monospace;">Offset:
 -2=&lt;a0&gt;&lt;a1&gt; in previous res, -1=&lt;a0&gt; in previous res,
 0=All &lt;aX&gt; in single res, 1=&lt;a3&gt; in next res, 
2=&lt;a2&gt;&lt;a3&gt; in next res.</span></div>
</dd></dl>
<div class="standard"><a id="magicparlabel-5488"></a><span style="font-family:monospace;">DataSet Aspects:</span></div>

<dl class="description"><a id="magicparlabel-5489"></a><dt class="description_label">[&lt;dihedral type&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Aspect corresponds to the dihedral type name (e.g. [phi], [psi], etc).</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-5490"></a><i>Note data sets are not generated until <b>run</b> is called.</i></div>

<div class="standard"><a id="magicparlabel-5491"></a>Calculate specified
 dihedral angle types for residues in given range. By default, dihedral 
angles are identified based on standard Amber atom names. The resulting 
data sets will have aspect equal to [&lt;dihedral type&gt;] and index 
equal to residue #. To differentiate the chi angle, chip is used for 
proteins and chin for nucleic acids. For example, to calculate all 
phi/psi dihedrals for residues 6 to 9:</div>

<div class="lyx_code"><a id="magicparlabel-5492"></a><div class="lyx_code_item">multidihedral phi psi resrange 6-9 out PhiPsi_6-9.dat</div>
</div>
<div class="standard"><a id="magicparlabel-5493"></a>Dihedrals other than those defined in <b>&lt;dihedral types&gt;</b> can be searched for using <b>dihtype</b>.
 For example to create a custom dihedral type called chi1 using atoms N,
 CA, CB, and CG (all in the same residue), then search for and calculate
 the dihedral in all residues:</div>

<div class="lyx_code"><a id="magicparlabel-5494"></a><div class="lyx_code_item">multidihedral dihtype chi1:N:CA:CB:CG out custom.dat</div>
</div>
<h3 class="subsection"><a id="magicparlabel-5495"></a><span class="subsection_label">10.49</span> multivector</h3>

<div class="lyx_code"><a id="magicparlabel-5496"></a><div class="lyx_code_item">multivector [&lt;name&gt;] [resrange &lt;range&gt;] name1 &lt;name1&gt; name2 &lt;name2&gt; [out &lt;filename&gt;]</div>
<div class="lyx_code_item">            [ired]
<br />

</div>

<dl class="description"><a id="magicparlabel-5498"></a><dt class="description_label">[&lt;name&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Data set name.</span></dd>
<dt class="description_label">[resrange &lt;range&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Range of residues to look for vectors in.</span></dd>
<dt class="description_label">name1 &lt;name1&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Name of first atom in each residue.</span></dd>
<dt class="description_label">name2 &lt;name2&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Name of second atom in each residue.</span></dd>
<dt class="description_label">[out &lt;filename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> File to write results to.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-5503"></a>Search for and 
calculate atomic vectors between atoms named &lt;name1&gt; and 
&lt;name2&gt; in residues specified by the given &lt;range&gt;; each one
 is equivalent to the command '<b><span style="font-family:monospace;">vector</span></b><span style="font-family:monospace;"> &lt;name1&gt; &lt;name2&gt;</span>'.
 For example, to calculate all vectors between atoms named 'N' and atoms
 named 'H' in residues 5-20, storing the results in data sets named NH 
and writing to NH.dat:</div>

<div class="lyx_code"><a id="magicparlabel-5504"></a><div class="lyx_code_item">multivector NH name1 N name2 H ired out NH.dat resrange 5-20</div>
</div>
<h3 class="subsection"><a id="magicparlabel-5505"></a><span class="subsection_label">10.50</span> nastruct</h3>

<div class="lyx_code"><a id="magicparlabel-5506"></a><div class="lyx_code_item">nastruct<a id="magicparlabel-5510"></a>
 [&lt;dataset name&gt;] [resrange &lt;range&gt;] [naout &lt;suffix&gt;]</div>
<div class="lyx_code_item">     	[noheader] [resmap &lt;ResName&gt;:{A,C,G,T,U} ...] [calcnohb]</div>
<div class="lyx_code_item">         [baseref &lt;file&gt;] ...</div>
<div class="lyx_code_item">     	[hbcut &lt;hbcut&gt;] [origincut &lt;origincut&gt;] [altona | cremer]</div>
<div class="lyx_code_item">     	[zcut &lt;zcut&gt;] [zanglecut &lt;zanglecut&gt;] [groovecalc {simple | 3dna}]</div>
<div class="lyx_code_item">     	[{ first | reference | ref &lt;name&gt; | refindex &lt;#&gt; | allframes | guessbp}]
<br />

</div>
<div class="lyx_code_item">         [bptype {anti | para} ...]</div>

<dl class="description"><a id="magicparlabel-5517"></a><dt class="description_label">[&lt;dataset name&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output data set name.</span></dd>
<dt class="description_label">[resrange &lt;range&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Residue range to search for nucleic acids in (default all).</span></dd>
<dt class="description_label">[naout &lt;suffix&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> File 
name suffix for output files; BP.&lt;suffix&gt; for base pair 
parameters, BPstep.&lt;suffix&gt; for base pair step parameters, and 
Helix.&lt;suffix&gt; for base pair step helical parameters.</span></dd>
<dt class="description_label">[noheader]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Do not print header to <b>naout</b> file.</span></dd>
<dt class="description_label">[resmap &lt;ResName&gt;:{A,C,G,T,U}]</dt>
<dd class="description_item"><span style="font-family:monospace;"> 
Attempt to treat residues named &lt;ResName&gt; as if it were A, C, G, 
T, or U; useful for residues with modifications or non-standard residue 
names. This will only work if enough reference atoms are present in 
&lt;ResName&gt;.</span></dd>
<dt class="description_label">[calcnohb]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Calculate parameters between bases in base pairs even if no hydrogen bonds present between them.</span></dd>
<dt class="description_label">[baseref &lt;file&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> 
Specify a custom nucleic acid base reference. One file per custom 
residue; multiple 'baseref' keywords may be present. See below for 
details.</span></dd>
<dt class="description_label">[hbcut &lt;hbcut&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Distance cutoff (in Angstroms) for determining hydrogen bonds between bases (default 3.5).</span></dd>
<dt class="description_label">[origincut &lt;origincut&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> 
Distance cutoff (in Angstroms) between base pair axis origins for 
determining which bases are eligible for base-pairing (default 2.5).</span></dd>
<dt class="description_label">[altona]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use method of Altona &amp; Sundaralingam to calculate sugar pucker (default, see <b><i>pucker</i></b> command).</span></dd>
<dt class="description_label">[cremer]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use method of Cremer and Pople to calculate sugar pucker (see <b><i>pucker</i></b> command).</span></dd>
<dt class="description_label">[zcut]</dt>
<dd class="description_item"><span style="font-family:monospace;"> 
Distance cutoff (in Angstroms) between base reference axes along the Z 
axis (i.e. stagger) for determining base pairing (default 2).</span></dd>
<dt class="description_label">[zanglecut]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Angle cutoff (in degrees) between base reference Z axes for determining base pairing (default 65).</span></dd>
<dt class="description_label">[groovecalc]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Groove width calculation method:
<br />

</span>

<dl class="description"><a id="magicparlabel-5531"></a><dt class="description_label">simple</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use P-P distance for major groove, O4-O4 distance for minor groove. Output to 'BP.&lt;suffix&gt;'.</span></dd>
<dt class="description_label">3dna</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use groove width calculation of El Hassan and Calladine[<a href="#LyXCite-Hassan1998"><span class="bib-numericallabel">14</span></a>]. Output to 'BPstep.&lt;suffix&gt;'.</span></dd>
</dl>
</dd><dt class="description_label">[first]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use first frame to determine base pairing (default).</span></dd>
<dt class="description_label">[reference | refindex &lt;#&gt; | ref &lt;name&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Reference structure to use to determine base pairing.</span></dd>
<dt class="description_label">[allframes]</dt>
<dd class="description_item"><span style="font-family:monospace;"> If specified determine base pairing each frame.</span></dd>
<dt class="description_label">[guessbp [bptype{anti|para}]]</dt>
<dd class="description_item"><span style="font-family:monospace;"> If 
specified base pairing will be determined based on selected NA strands. 
It is assumed that consecutive strands will be base-paired and that they
 are arranged 5' to 3'. The specific type of base pairing between 
strands can be specified with one or more 'bptype' arguments.</span></dd>
</dl>
<div class="standard"><a id="magicparlabel-5537"></a><span style="font-family:monospace;">DataSets Created:</span></div>

<dl class="description"><a id="magicparlabel-5538"></a><dt class="description_label">&lt;name&gt;[pucker]:X</dt>
<dd class="description_item"><span style="font-family:monospace;"> Base X (residue number) sugar pucker.</span></dd>
</dl>
<div class="standard"><a id="magicparlabel-5539"></a><span style="font-family:monospace;">Base pairs:</span></div>

<dl class="description"><a id="magicparlabel-5540"></a><dt class="description_label">&lt;name&gt;[shear]:X</dt>
<dd class="description_item"><span style="font-family:monospace;"> Base pair X (starting from 1) shear.</span></dd>
<dt class="description_label">&lt;name&gt;[stretch]:X</dt>
<dd class="description_item"><span style="font-family:monospace;"> Base pair stretch.</span></dd>
<dt class="description_label">&lt;name&gt;[stagger]:X</dt>
<dd class="description_item"><span style="font-family:monospace;"> Base pair stagger.</span></dd>
<dt class="description_label">&lt;name&gt;[buckle]:X</dt>
<dd class="description_item"><span style="font-family:monospace;"> Base pair buckle.</span></dd>
<dt class="description_label">&lt;name&gt;[prop]:X</dt>
<dd class="description_item"><span style="font-family:monospace;"> Base pair propeller.</span></dd>
<dt class="description_label">&lt;name&gt;[open]:X</dt>
<dd class="description_item"><span style="font-family:monospace;"> Base pair opening.</span></dd>
<dt class="description_label">&lt;name&gt;[hb]:X</dt>
<dd class="description_item"><span style="font-family:monospace;"> Number of WC hydrogen bonds between bases in base pair.</span></dd>
<dt class="description_label">&lt;name&gt;[bp]:X</dt>
<dd class="description_item"><span style="font-family:monospace;"> Contain 1 if bases are base paired, 0 otherwise.</span></dd>
<dt class="description_label">&lt;name&gt;[major]:X</dt>
<dd class="description_item"><span style="font-family:monospace;"> (If groovecalc simple) Major groove width calculated between P atoms of each base.</span></dd>
<dt class="description_label">&lt;name&gt;[minor]:X</dt>
<dd class="description_item"><span style="font-family:monospace;"> (If groovecalc simple) Minor groove width calculated between O4 atoms of each base.</span></dd>
</dl>
<div class="standard"><a id="magicparlabel-5550"></a><span style="font-family:monospace;">Base pair steps:</span></div>

<dl class="description"><a id="magicparlabel-5551"></a><dt class="description_label">&lt;name&gt;[shift]:X</dt>
<dd class="description_item"><span style="font-family:monospace;"> Base pair step X (starting from 1) shift.</span></dd>
<dt class="description_label">&lt;name&gt;[slide]:X</dt>
<dd class="description_item"><span style="font-family:monospace;"> Base pair step slide.</span></dd>
<dt class="description_label">&lt;name&gt;[rise]:X</dt>
<dd class="description_item"><span style="font-family:monospace;"> Base pair step rise.</span></dd>
<dt class="description_label">&lt;name&gt;[title]:X</dt>
<dd class="description_item"><span style="font-family:monospace;"> Base pair step tilt.</span></dd>
<dt class="description_label">&lt;name&gt;[roll]:X</dt>
<dd class="description_item"><span style="font-family:monospace;"> Base pair step roll.</span></dd>
<dt class="description_label">&lt;name&gt;[twist]:X</dt>
<dd class="description_item"><span style="font-family:monospace;"> Base pair step twist.</span></dd>
<dt class="description_label">&lt;name&gt;[zp]:X</dt>
<dd class="description_item"><span style="font-family:monospace;"> Base pair step Zp value.</span></dd>
<dt class="description_label">&lt;name&gt;[major]:X</dt>
<dd class="description_item"><span style="font-family:monospace;"> (If groovecalc 3dna) Major groove width, El Hassan and Calladine.</span></dd>
<dt class="description_label">&lt;name&gt;[minor]:X</dt>
<dd class="description_item"><span style="font-family:monospace;"> (If groovecalc 3dna) Minor groove width, El Hassan and Calladine.</span></dd>
</dl>
<div class="standard"><a id="magicparlabel-5560"></a><span style="font-family:monospace;">Helical steps:</span></div>

<dl class="description"><a id="magicparlabel-5561"></a><dt class="description_label">&lt;name&gt;[xdisp]:X</dt>
<dd class="description_item"><span style="font-family:monospace;"> Helical step X (starting from 1) X displacement.</span></dd>
<dt class="description_label">&lt;name&gt;[ydisp]:X</dt>
<dd class="description_item"><span style="font-family:monospace;"> Helical Y displacement.</span></dd>
<dt class="description_label">&lt;name&gt;[hrise]:X</dt>
<dd class="description_item"><span style="font-family:monospace;"> Helical rise.</span></dd>
<dt class="description_label">&lt;name&gt;[incl]:X</dt>
<dd class="description_item"><span style="font-family:monospace;"> Helical inclination.</span></dd>
<dt class="description_label">&lt;name&gt;[tip]:X</dt>
<dd class="description_item"><span style="font-family:monospace;"> Helical tip.</span></dd>
<dt class="description_label">&lt;name&gt;[htwist]:X</dt>
<dd class="description_item"><span style="font-family:monospace;"> Helical twist.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-5567"></a><i>Note that data sets are not created until base pairing is determined.</i></div>

<div class="standard"><a id="magicparlabel-5568"></a>Calculate basic nucleic acid (NA) structure parameters for all residues in the range specified by <b>resrange</b>
 (or all NA residues if no range specified). Residue names are 
recognized with the following priority: standard Amber residue names DA,
 DG, DC, DT, RA, RG, RC, and RU; 3 letter residue names ADE, GUA, CYT, 
THY, and URA; and finally 1 letter residue names A, G, C, T, and U. 
Non-standard/modified NA bases can be recognized by using the <b>resmap</b> keyword. For example, to make <i>cpptraj</i> recognize all 8-oxoguanine residues named '8OG' as a guanine-based residue:</div>

<div class="lyx_code"><a id="magicparlabel-5569"></a><div class="lyx_code_item">nastruct naout nastruct.dat resrange 274-305 resmap 8OG:G</div>
</div>
<div class="standard"><a id="magicparlabel-5570"></a>The <b>resmap</b> keyword can be specified multiple times, but only one mapping per unique residue name is allowed. Note that <b>resmap</b> may fail if the residue is missing heavy atoms normally present in the specified base type.</div>

<div class="standard"><a id="magicparlabel-5571"></a>Base pairs are determined either once from the first frame or from a reference structure, or can be determined each frame if <b>allframes</b>
 is specified. Base pairing is determined first by base reference axis 
origin distance, then by stagger, then by angle between base Z axes, 
then finally by hydrogen bonding (at least one hydrogen bond must be 
present). Base pair parameters will only be written for determined base 
pairs. Both Watson-Crick and other types of base pairing can be 
detected. Note that although all possible hydrogen bonds are searched 
for, only WC hydrogen bonds are reported in the BP.&lt;suffix&gt; file.</div>

<div class="standard"><a id="magicparlabel-5572"></a>The procedure used to calculate NA structural parameters is the same as 3DNA[<a href="#LyXCite-Lu2003"><span class="bib-numericallabel">20</span></a>], with algorithms adapted from Babcok et al.[<a href="#LyXCite-Babcock94"><span class="bib-numericallabel">2</span></a>] and reference frame coordinates from Olson et al.[<a href="#LyXCite-Olson2001"><span class="bib-numericallabel">23</span></a>]. Given the same base pairs are determined, <i>cpptraj</i> nastruct gives the exact same numbers as 3DNA. </div>

<div class="standard"><a id="magicparlabel-5573"></a>Calculated NA structure parameters are written to three separate files, the suffix of which is specified by <b>naout</b>.
 Base pair parameters (shear, stretch, stagger, buckle, propeller twist,
 opening, # WC hydrogen bonds, base pairing, and simple groove widths) 
are written to BP.&lt;suffix&gt;, along with the number of WC hydrogen 
bonds detected. Base pair step parameters (shift, slide, rise, tilt, 
roll, twist, Zp, and El Hassan and Calladine groove widths) are written 
to BPstep.&lt;suffix&gt;, and helical parameters (X-displacement, 
Y-displacement, rise, inclination, tip, and twist) are written to 
Helix.&lt;suffix&gt;. If <b>noheader</b> is specified a header will not 
be written to the output files. Note that although base puckering is 
calculated, it is not written to an output file by default. You can 
output pucker to a file via the create or write/writedata commands after
 the data has been generated, e.g.:</div>

<div class="lyx_code"><a id="magicparlabel-5574"></a><div class="lyx_code_item">nastruct NA naout nastruct.dat resrange 1-3,28-30</div>
<div class="lyx_code_item">run</div>
<div class="lyx_code_item">writedata NApucker.dat NA[pucker]</div>
</div>
<h4 class="subsubsection_"><a id="magicparlabel-5577"></a>Custom Nucleic Acid Base References</h4>
<div class="standard"><a id="magicparlabel-5578"></a>Users can now specify <b>baseref &lt;file&gt;</b>
 to load a custom nucleic acid base reference. The base reference files 
are white-space delimited, begin with the line NASTRUCT REFERENCE, and 
have the following format:</div>

<div class="lyx_code"><a id="magicparlabel-5579"></a><div class="lyx_code_item">NASTRUCT REFERENCE</div>
<div class="lyx_code_item">&lt;base character&gt; &lt;res name 0&gt; [&lt;res name 1&gt; ...]</div>
<div class="lyx_code_item">&lt;atom name&gt; &lt;X&gt; &lt;Y&gt; &lt;Z&gt; &lt;HB type&gt; &lt;RMS fit&gt;</div>
<div class="lyx_code_item">...</div>
</div>
<div class="standard"><a id="magicparlabel-5583"></a>There is a line for each reference atom. Lines beginning with '#' are ignored as comments.</div>

<dl class="description"><a id="magicparlabel-5584"></a><dt class="description_label">&lt;base character&gt;</dt>
<dd class="description_item"> Used to identify the underlying base type:
 A G C T or U. If none of these, it will be considered an unknown 
residue (which just means WC hydrogen bonding will not be identified).</dd>
<dt class="description_label">&lt;res name X&gt;</dt>
<dd class="description_item"> Specifies what residue names this 
reference corresponds to. There must be at least one residue name. There
 can be any number of these specified.</dd>
<dt class="description_label">&lt;atom name&gt;</dt>
<dd class="description_item"> A reference atom name.</dd>
<dt class="description_label">&lt;X&gt; &lt;Y&gt; &lt;Z&gt;</dt>
<dd class="description_item"> The X Y and Z coordinates of the reference atom.</dd>
<dt class="description_label">&lt;HB type&gt;</dt>
<dd class="description_item"> Denotes if and how the atom participates 
in hydrogen bonding. Can be 'd'onor, 'a'cceptor, or 'n'one (or the 
numbers 1, 2, 0 respectively). Only the first character of the word 
actually matters.</dd>
<dt class="description_label">&lt;RMS fit&gt;</dt>
<dd class="description_item"> Denotes whether the atom is involved in RMS-fitting.</dd>
</dl>
<div class="standard"><a id="magicparlabel-5590"></a>Here is an example for GUA:</div>

<div class="lyx_code"><a id="magicparlabel-5591"></a><div class="lyx_code_item">NASTRUCT REFERENCE</div>
<div class="lyx_code_item">G G G5 G3</div>
<div class="lyx_code_item"># Modified into format readable by cpptraj nastruct</div>
<div class="lyx_code_item">C1' -2.477   5.399   0.000 0      0</div>
<div class="lyx_code_item">N9  -1.289   4.551   0.000 0      1</div>
<div class="lyx_code_item">C8   0.023   4.962   0.000 0      1</div>
<div class="lyx_code_item">N7   0.870   3.969   0.000 accept 1</div>
<div class="lyx_code_item">C5   0.071   2.833   0.000 0      1</div>
<div class="lyx_code_item">C6   0.424   1.460   0.000 0      1</div>
<div class="lyx_code_item">O6   1.554   0.955   0.000 accept 0</div>
<div class="lyx_code_item">N1  -0.700   0.641   0.000 donor  1</div>
<div class="lyx_code_item">C2  -1.999   1.087   0.000 0      1</div>
<div class="lyx_code_item">N2  -2.949   0.139  -0.001 donor  0</div>
<div class="lyx_code_item">N3  -2.342   2.364   0.001 accept 1</div>
<div class="lyx_code_item">C4  -1.265   3.177   0.000 0      1</div>
</div>
<h3 class="subsection"><a id="magicparlabel-5606"></a><span class="subsection_label">10.51</span> nativecontacts<a id="subsec_cpptraj_nativecontacts"></a>
</h3>

<div class="lyx_code"><a id="magicparlabel-5607"></a><div class="lyx_code_item">nativecontacts [&lt;mask1&gt; [&lt;mask2&gt;]] [writecontacts &lt;outfile&gt;] [resout &lt;resfile&gt;]</div>
<div class="lyx_code_item">               [noimage] [distance &lt;cut&gt;] [out &lt;filename&gt;] [includesolvent]</div>
<div class="lyx_code_item">               [ first | reference | ref &lt;name&gt; | refindex &lt;#&gt; ]</div>
<div class="lyx_code_item">               [resoffset &lt;n&gt;] [contactpdb &lt;file&gt;] [pdbcut &lt;cut&gt;] [mindist] [maxdist]</div>
<div class="lyx_code_item">               [name &lt;dsname&gt;] [byresidue] [map [mapout &lt;mapfile&gt;]] [series [seriesout &lt;file&gt;]]
<br />

</div>
<div class="lyx_code_item">               [savenonnative [seriesnnout &lt;file&gt;] [nncontactpdb &lt;file&gt;]]</div>
<div class="lyx_code_item">               [resseries { present | sum } [resseriesout &lt;file&gt;]]</div>

<dl class="description"><a id="magicparlabel-5614"></a><dt class="description_label">&lt;mask1&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> First mask to calculate contacts for.</span></dd>
<dt class="description_label">[&lt;mask2&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> (Optional) Second mask to calculate contacts for.</span></dd>
<dt class="description_label">[writecontacts &lt;outfile&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write information on native contacts to <b>&lt;outfile&gt;</b> (STDOUT if not specified).</span></dd>
<dt class="description_label">[resout &lt;resfile&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> File to write contact residue pairs to.</span></dd>
<dt class="description_label">[noimage]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Do not image distances.</span></dd>
<dt class="description_label">[distance &lt;cut&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Distance cutoff for determining native contacts in Angstroms (default 7.0 Ang).</span></dd>
<dt class="description_label">[out &lt;filename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> File to write number of native contacts and non-native contacts.</span></dd>
<dt class="description_label">[includesolvent]</dt>
<dd class="description_item"><span style="font-family:monospace;"> By default solvent molecules are ignored; this will explicitly include solvent molecules.</span></dd>
<dt class="description_label">[first | reference | ref &lt;name&gt; | refindex &lt;#&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Reference structure to use for determining native contacts.</span></dd>
<dt class="description_label">[resoffset &lt;n&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> (<b>byresidue</b> only) Ignore contacts between residues spaced less than &lt;n&gt; residues apart in sequence.</span></dd>
<dt class="description_label">[contactpdb &lt;file&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write PDB with B-factor column containing relative contact strength for native contacts (strongest is 100.0).</span></dd>
<dt class="description_label">[pdbcut &lt;cut&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> If writing <b>contactpdb</b>, only write contacts with relative contact strength greater than <b>&lt;cut&gt;</b>.</span></dd>
<dt class="description_label">[mindist]</dt>
<dd class="description_item"><span style="font-family:monospace;"> If specified, determine the minimum distance between any atoms in the mask(s).</span></dd>
<dt class="description_label">[maxdist]</dt>
<dd class="description_item"><span style="font-family:monospace;"> If specified, determine the maximum distance between any atoms in the mask(s).</span></dd>
<dt class="description_label">[name &lt;dsname&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Data set name.</span></dd>
<dt class="description_label">[byresidue]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write out the contact map by residue instead of by atom.</span></dd>
<dt class="description_label">[map]</dt>
<dd class="description_item"><span style="font-family:monospace;"> 
Calculate matrices of native contacts ([nativemap]) and non-native 
contacts ([nonnatmap]). These matrices are normalized by the total 
number of frames, so that a value of 1.0 means “contact always present”.
 If <b>byresidue</b> specified, the values for each individual atom pair are summed over the residues they belong to (this means for <b>byresidue</b> values greater than 1.0 are possible).</span></dd>
<dt class="description_label">[mapout &lt;mapfile&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write native/non-native matrices to 'native.&lt;mapfile&gt;' and 'nonnative.&lt;mapfile&gt;' respectively.</span></dd>
<dt class="description_label">[series]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Calculate native contact time series data, 1 for contact present and 0 otherwise.</span></dd>
<dt class="description_label">[seriesout &lt;file&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write native contact time series data to file.</span></dd>
<dt class="description_label">[savenonnative]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Save non-native contacts; <b>series</b> must also be specified.</span>

<dl class="description"><a id="magicparlabel-5635"></a><dt class="description_label">[seriesnnout &lt;file&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write non-native contact time series data to file.</span></dd>
<dt class="description_label">[nncontactpdb &lt;file&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write PDB with B-factor column containing relative contact strength for non-native contacts (strongest is 100.0).</span></dd>
</dl>
</dd><dt class="description_label">[resseries {present | sum}</dt>
<dd class="description_item"><span style="font-family:monospace;"> Create contacts time series by residue; <b>series</b> must also be specified.</span>

<dl class="description"><a id="magicparlabel-5638"></a><dt class="description_label">present</dt>
<dd class="description_item"><span style="font-family:monospace;"> Record a 1 if <em>any</em> contact is present and 0 if no contact is present for the residue pair.</span></dd>
<dt class="description_label">sum</dt>
<dd class="description_item"><span style="font-family:monospace;"> The sum of all individual contacts is recorded for the residue pair.</span></dd>
<dt class="description_label">[resseriesout &lt;file&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write residue time series data to &lt;file&gt;.</span></dd>
</dl>
</dd></dl>
<div class="standard"><a id="magicparlabel-5641"></a><span style="font-family:monospace;">Data Sets Created:</span></div>

<dl class="description"><a id="magicparlabel-5642"></a><dt class="description_label">&lt;dsname&gt;[native]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Number of native contacts.</span></dd>
<dt class="description_label">&lt;dsname&gt;[nonnative]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Number of non-native contacts.</span></dd>
<dt class="description_label">&lt;dsname&gt;[mindist]</dt>
<dd class="description_item"><span style="font-family:monospace;"> (mindist only) Minimum observed distance each frame.</span></dd>
<dt class="description_label">&lt;dsname&gt;[maxdist]</dt>
<dd class="description_item"><span style="font-family:monospace;"> (maxdist only) Maximum observed distance each frame.</span></dd>
<dt class="description_label">&lt;dsname&gt;[nativemap]</dt>
<dd class="description_item"><span style="font-family:monospace;"> (map only) Native contacts matrix (2D).</span></dd>
<dt class="description_label">&lt;dsname&gt;[nonnatmap]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Non-native contacts matrix (2D).</span></dd>
<dt class="description_label">&lt;dsname&gt;[NC]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Native contacts time series.</span></dd>
<dt class="description_label">&lt;dsname&gt;[NN]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Non-native contacts time series.</span></dd>
<dt class="description_label">&lt;dsname&gt;[NCRES]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Residue native contacts time series.</span></dd>
<dt class="description_label">&lt;dsname&gt;[NNRES]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Residue non-native contacts time series.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-5652"></a>Define and track “native” contacts as determined by a simple distance cut-off, i.e. any atoms which are closer than <b>&lt;cut&gt;</b>
 in the specified reference frame (the first frame if no reference 
specified) are considered a native contact. If one mask is provided, 
contacts are looked for within <b>&lt;mask1&gt;</b>; if two masks are provided, only contacts between atoms in <b>&lt;mask1&gt;</b> and atoms in <b>&lt;mask2&gt;</b>
 are looked for (useful for determining intermolecular contacts). By 
default only native contacts are tracked. This can be changed by 
specifying the <b>savenonnative</b> keyword. The time series for contacts can be saved using the <b>series</b> keyword; these can be further consolidated by residue using the <b>resseries</b>
 keyword. When using &lt;resseries&gt; the data set index is calculated 
as (r2 * nres) + r1 so that indices can be matched between 
native/non-native contact pairs. Non-native residue contact legends have
 an nn_ prefix.</div>

<div class="standard"><a id="magicparlabel-5653"></a>Native contacts that are found are written to the file specified by writecontacts (or STDOUT) with format:</div>

<div class="lyx_code"><a id="magicparlabel-5654"></a><div class="lyx_code_item"># Contact Nframes Frac. Avg Stdev </div>
</div>
<div class="standard"><a id="magicparlabel-5655"></a>Where <span style="font-family:monospace;">Contact</span> takes the form ':&lt;residue1 num&gt;@&lt;atom name&gt;_:&lt;residue2 num&gt;@&lt;atom name&gt;, <span style="font-family:monospace;">Nframes</span> is the number of frames the contact is present, <span style="font-family:monospace;">Frac.</span> is the total fraction of frames the contact is present, <span style="font-family:monospace;">Avg</span> is the average distance of the contact when present, and <span style="font-family:monospace;">Stdev</span> is the standard deviation of the contact distance when present. If <b>resout</b> is specified the total fraction of contacts is printed for all residue pairs having native contacts with format:</div>

<div class="lyx_code"><a id="magicparlabel-5656"></a><div class="lyx_code_item">#Res1 #Res2 TotalFrac Contacts </div>
</div>
<div class="standard"><a id="magicparlabel-5657"></a>Where <span style="font-family:monospace;">#Res1</span> is the first residue number, <span style="font-family:monospace;">#Res2</span> is the second residue number, <span style="font-family:monospace;">TotalFrac</span> is the total fraction of contacts for the residue pair, and <span style="font-family:monospace;">Contacts</span> is the total number of native contacts involved with the residue pair. Since <span style="font-family:monospace;">TotalFrac</span>
 is calculated for each pair as the sum of each contact involving that 
pair divided by the total number of frames, it is possible to have <span style="font-family:monospace;">TotalFrac</span> values greater than 1 if the residue pair includes more than 1 native contact.</div>

<div class="standard"><a id="magicparlabel-5658"></a>During trajectory 
processing, non-native contacts (i.e. any pair satisfying the distance 
cut-off which is not already a native contact) are also searched for. 
The time series for native contacts can be saved as well, with 1 for 
contact present and 0 otherwise (similar to the <em><b>hbond</b></em> command). This data can be subsequently analyzed using e.g.<a href="#subsec_cpptraj_lifetime">11.18</a>.</div>

<div class="standard"><a id="magicparlabel-5659"></a>Contact maps (matrices) are generated for native and non-native contacts. If <b>byresidue</b> is specified, contact maps are summed over residues, and contacts between residues spaced <b>&lt;resoffset&gt;</b> residues apart in sequence are ignored.</div>

<div class="standard"><a id="magicparlabel-5660"></a>If <b>contactpdb</b>
 is specified a PDB is generated containing relative contact strengths 
in the B-factor column. The relative contact strength is normalized so 
that a value of 100 means that atom participated in the most contacts 
with other atoms.</div>

<div class="standard"><a id="magicparlabel-5661"></a>Example command 
looking for contacts between residues 210 to 260 and residue named NDP, 
using reference structure 'FtuFabI.WT.pdb' to define native contacts:</div>

<div class="lyx_code"><a id="magicparlabel-5662"></a><div class="lyx_code_item">parm FtuFabI.parm7</div>
<div class="lyx_code_item">trajin FtuFabI.nc</div>
<div class="lyx_code_item">reference FtuFabI.WT.pdb</div>
<div class="lyx_code_item">nativecontacts name NC1 :210-260&amp;!@H= :NDP&amp;!@H= \</div>
<div class="lyx_code_item">    byresidue out nc.all.res.dat mindist maxdist \</div>
<div class="lyx_code_item">    distance 3.0 reference map mapout resmap.gnu \</div>
<div class="lyx_code_item">    contactpdb Loop-NDP.pdb \</div>
<div class="lyx_code_item">    series seriesout native.dat</div>
</div>
<h3 class="subsection"><a id="magicparlabel-5670"></a><span class="subsection_label">10.52</span> outtraj<a id="subsec_cpptraj_outtraj"></a>
</h3>

<div class="lyx_code"><a id="magicparlabel-5671"></a><div class="lyx_code_item">outtraj<a id="magicparlabel-5675"></a>
 &lt;filename&gt; [ trajout args ]</div>
<div class="lyx_code_item">        [maxmin &lt;dataset&gt; min &lt;min&gt; max &lt;max&gt;] ...
<br />

</div>

<dl class="description"><a id="magicparlabel-5677"></a><dt class="description_label">&lt;filename&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output trajectory file name.</span></dd>
<dt class="description_label">[trajout args]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output trajectory arguments (see <a href="#subsec_cpptraj_trajout">9.5</a>).</span></dd>
<dt class="description_label">[maxmin &lt;dataset&gt; min &lt;min&gt; max &lt;max&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Only 
write frames to &lt;filename&gt; if values in &lt;dataset&gt; for those 
frames are between &lt;min&gt; and &lt;max&gt;. Can be specified for one
 or more data sets.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-5680"></a>The outtraj command is similar in function to <em><b>trajout</b></em>,
 and takes all of the same arguments. However, instead of writing a 
trajectory frame after all actions are complete outtraj writes the 
trajectory frame at its position in the Action queue. For example, given
 the input:</div>

<div class="lyx_code"><a id="magicparlabel-5681"></a><div class="lyx_code_item">trajin mdcrd.crd</div>
<div class="lyx_code_item">trajout output.crd</div>
<div class="lyx_code_item">outtraj BeforeRmsd.crd</div>
<div class="lyx_code_item">rms R1 first :1-20@CA out rmsd.dat</div>
<div class="lyx_code_item">outtraj AfterRmsd.crd</div>
</div>
<div class="standard"><a id="magicparlabel-5686"></a>three trajectories 
will be written: output.crd, BeforeRmsd.crd, and AfterRmsd.crd. The 
output.crd and AfterRmsd.crd trajectories will be identical, but the 
BeforeRmsd.crd trajectory will contain the coordinates of mdcrd.crd 
before they are RMS-fit.</div>

<div class="standard"><a id="magicparlabel-5687"></a>The maxmin keyword 
can be used to restrict output using one more more data sets. For 
example, to only write frames for which the RMSD value is between 0.7 
and 0.8:</div>

<div class="lyx_code"><a id="magicparlabel-5688"></a><div class="lyx_code_item">trajin tz2.truncoct.nc</div>
<div class="lyx_code_item">rms R1 first :2-11</div>
<div class="lyx_code_item">outtraj maxmin.crd maxmin R1 min 0.7 max 0.8</div>
</div>
<h3 class="subsection"><a id="magicparlabel-5691"></a><span class="subsection_label">10.53</span> pairdist</h3>

<div class="lyx_code"><a id="magicparlabel-5692"></a><div class="lyx_code_item">pairdist out &lt;filename&gt; mask &lt;mask&gt; [delta &lt;resolution&gt;]</div>
</div>
<div class="standard"><a id="magicparlabel-5693"></a>Calculate pair distribution function. In the following, defaults are given in parentheses. The <b>out</b> keyword specifies output file for histogram: distance, P(r), s(P(r)). The <b>mask</b> option specifies atoms for which distances should be computed. The <b>delta</b> option specifies resolution. (0.1 Å)</div>
<h3 class="subsection"><a id="magicparlabel-5694"></a><span class="subsection_label">10.54</span> pairwise</h3>

<div class="lyx_code"><a id="magicparlabel-5695"></a><div class="lyx_code_item">pairwise [&lt;name&gt;] [&lt;mask&gt;] [out &lt;filename&gt;] [cuteelec &lt;ecut&gt;] [cutevdw &lt;vcut&gt;] 	</div>
<div class="lyx_code_item">         [ reference | ref &lt;name&gt; | refindex &lt;#&gt; ] [cutout &lt;cut mol2 prefix&gt;]</div>
<div class="lyx_code_item">     	[vmapout &lt;vdw map&gt;] [emapout &lt;elec map&gt;] [avgout &lt;avg file&gt;]</div>
<div class="lyx_code_item">     	[eout &lt;eout file&gt;] [pdbout &lt;pdb file&gt;] [scalepdbe] [printmode {only|or|and|}]
<br />

</div>

<dl class="description"><a id="magicparlabel-5699"></a><dt class="description_label">[&lt;name&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Data set name; van der Waals energy will get aspect [EVDW] and electrostatic energy will get aspect [EELEC].</span></dd>
<dt class="description_label">[&lt;mask&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Atoms to calculate energy for.</span></dd>
<dt class="description_label">[out &lt;filename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> File to write total EELEC and EVDW to.</span></dd>
<dt class="description_label">[eout &lt;eout file&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> File to write individual EELEC and EVDW interactions to.</span></dd>
<dt class="description_label">[reference | ref &lt;name&gt; | refindex &lt;#&gt; ]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Specify a reference to compare frames to (i.e. calculate Eref - Eframe).</span></dd>
<dt class="description_label">[cuteelec &lt;cut&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Only report interaction EELEC (or delta EELEC) if absolute value is greater than &lt;ecut&gt; (default 1.0 kcal/mol).</span></dd>
<dt class="description_label">[cutevdw &lt;cutv&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Only report interaction EVDW (or delta EVDW) if absolute value is greater than &lt;vcut&gt; (default 1.0 kcal/mol).</span></dd>
<dt class="description_label">[cutout &lt;cut mol2 prefix&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write out mol2 containing only atom pairs which satisfy &lt;ecut&gt; and &lt;vcut&gt;.</span></dd>
<dt class="description_label">[vmapout &lt;vdw map&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write out interaction EVDW (or delta EVDW) matrix to file &lt;vdw map&gt;.</span></dd>
<dt class="description_label">[emapout &lt;elec map&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write out interaction EELEC (or delta EELEC) matrix to file &lt;elec map&gt;.</span></dd>
<dt class="description_label">[avgout &lt;avg file&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Print average interaction EVDW|EELEC (or average delta EVDW|EELC) to &lt;avg file&gt;.</span></dd>
<dt class="description_label">[pdbout &lt;pdb file&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write PDB with EVDW|EELEC in occupancy|B-factor columns to &lt;pdb file&gt;.</span></dd>
<dt class="description_label">[scalepdbe]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Scale energies written to PDB from 0 to 100.</span></dd>
<dt class="description_label">[printmode {only|or|and}]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Control when/how average energies are written</span></dd>
</dl>
<div class="standard"><a id="magicparlabel-5713"></a><span style="font-family:monospace;">Data Sets Created:</span></div>

<dl class="description"><a id="magicparlabel-5714"></a><dt class="description_label">&lt;name&gt;[EELEC]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Electrostatic energy in (kcal/mol).</span></dd>
<dt class="description_label">&lt;name&gt;[EVDW]</dt>
<dd class="description_item"><span style="font-family:monospace;"> van der Waals energy in (kcal/mol).</span></dd>
<dt class="description_label">&lt;name&gt;[VMAP]</dt>
<dd class="description_item"><span style="font-family:monospace;"> van der Waals energy matrix.</span></dd>
<dt class="description_label">&lt;name&gt;[EMAP]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Electrostatic energy matrix.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-5718"></a>This action has two related functions: 1) Calculate pairwise (i.e. non-bonded) energy (in kcal/mol) for atoms in <b>&lt;mask&gt;</b>, or 2) Compare pairwise energy of frames to a reference frame. This calculation does use an exclusion list but is not periodic.</div>

<div class="standard"><a id="magicparlabel-5719"></a>When comparing to a reference frame, the <b>eout</b> file will contain the differences for each individual interaction (i.e. Eref - Eframe), otherwise the <b>eout</b> file will contain the absolute value of each individual interaction. The <b>cuteelc</b> and <b>cutevdw</b>
 keywords can be used to restrict printing of individual interactions to
 those for which the absolute value is above a cutoff. The VMAP and EMAP
 matrix elements will contain these values as well (differences for 
reference, absolute value otherwise) averaged over all frames. The <b>avgout</b> file will contain only these values averaged over all frames that satisfy the cutoffs. The <b>printmode</b> keyword controls when the average energies are written: <b>only</b> means only average energy components that satisfy cutoffs will be printed, <b>or</b> means that both energy components will be printed if either satistfy a cutoff, and <b>and</b> means that both energy components will be written only if both satisfy the cutoffs.</div>

<div class="standard"><a id="magicparlabel-5720"></a>The <b>cutout</b> 
keyword can be used to write out MOL2 files each frame named '&lt;cut 
mol2 prefix&gt;.evdw.mol2.X' and '&lt;cut mol2 prefix&gt;.eelec.mol2.X' 
(where X is the frame number) containing only atoms with energies that 
satisfy the cutoffs. Similarly, the <b>pdbout</b> keyword can be used to
 write out a PDB file (with 1 MODEL per frame). The occupancy and 
B-factor columns will contain the total van der Waals and electrostatic 
energy for each atom if cutoffs are satisfied, or 0.0 otherwise.</div>
<h3 class="subsection"><a id="magicparlabel-5721"></a><span class="subsection_label">10.55</span> principal</h3>

<div class="lyx_code"><a id="magicparlabel-5722"></a><div class="lyx_code_item">principal [&lt;mask&gt;] [dorotation] [out &lt;filename&gt;] [name &lt;dsname&gt;]
<br />

</div>

<dl class="description"><a id="magicparlabel-5723"></a><dt class="description_label">[&lt;mask&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Mask of atoms used to determine principal axes (default all).</span></dd>
<dt class="description_label">[dorotation]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Align coordinates along principal axes.</span></dd>
<dt class="description_label">[out &lt;filename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write resulting eigenvalues/eigenvectors to &lt;filename&gt;.</span></dd>
<dt class="description_label">[name &lt;dsname&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Data set name (3x3 matrices).</span></dd>
</dl>
<div class="standard"><a id="magicparlabel-5727"></a><span style="font-family:monospace;">Data Sets Created (<b>name</b> keyword only):</span></div>

<dl class="description"><a id="magicparlabel-5728"></a><dt class="description_label">&lt;dsname&gt;[evec]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Eigenvectors (3x3 matrix, row-major).</span></dd>
<dt class="description_label">&lt;dsname&gt;[eval]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Eigenvalues (vector).</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-5730"></a>Determine principal
 axes of each frame determined by diagonalization of the inertial matrix
 from the coordinates of the specified atoms. At least one of <b>dorotation</b>, <b>out</b>, or <b>name</b>
 must be specified. The resulting eigenvectors are sorted from largest 
eigenvalue to smallest, and the corresponding axes labelled using the <em>cpptraj</em> convention of X &gt; Y &gt; Z (similar to '<em><b>vector</b></em> <b>principal</b>'). If out is specified the eigenvectors and eigenvalues will be written for each frame N with format:</div>

<div class="lyx_code"><a id="magicparlabel-5731"></a><div class="lyx_code_item">&lt;N&gt; EIGENVALUES: &lt;EX&gt; &lt;EY&gt; &lt;EZ&gt;</div>
<div class="lyx_code_item">&lt;N&gt; EIGENVECTOR 0: &lt;Xx&gt; &lt;Xy&gt; &lt;Xz&gt;</div>
<div class="lyx_code_item">&lt;N&gt; EIGENVECTOR 1: &lt;Yx&gt; &lt;Yy&gt; &lt;Yz&gt;</div>
<div class="lyx_code_item">&lt;N&gt; EIGENVECTOR 2: &lt;Zx&gt; &lt;Zy&gt; &lt;Zz&gt;</div>
</div>
<div class="standard"><a id="magicparlabel-5735"></a>NOTE: The eigenvector 3x3 matrix data set could subsequently be used e.g. with the <em><b>rotate</b></em> action.</div>

<div class="standard"><a id="magicparlabel-5736"></a>Example: Align system (residues 1-76) along principle axes:</div>

<div class="lyx_code"><a id="magicparlabel-5737"></a><div class="lyx_code_item">parm myparm.parm7</div>
<div class="lyx_code_item">trajin protein.nc</div>
<div class="lyx_code_item">principal :1-76 dorotation out principal.dat</div>
</div>
<h3 class="subsection"><a id="magicparlabel-5740"></a><span class="subsection_label">10.56</span> projection</h3>

<div class="lyx_code"><a id="magicparlabel-5741"></a><div class="lyx_code_item">projection [&lt;name&gt;] evecs &lt;dataset name&gt; [out &lt;outfile&gt;] [beg &lt;beg&gt;] [end &lt;end&gt;]</div>
<div class="lyx_code_item">           [&lt;mask&gt;] [dihedrals &lt;dataset arg&gt;]</div>
<div class="lyx_code_item">           [start &lt;start&gt;] [stop &lt;stop&gt;] [offset &lt;offset&gt;]
<br />

</div>

<dl class="description"><a id="magicparlabel-5744"></a><dt class="description_label">[&lt;name&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output data set name.</span></dd>
<dt class="description_label">evecs &lt;dataset name&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Data set containing eigenvectors (modes).</span></dd>
<dt class="description_label">[out &lt;outfile&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write projections to &lt;outfile&gt;.</span></dd>
<dt class="description_label">[beg &lt;beg&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> First eigenvector/mode to use (default 1).</span></dd>
<dt class="description_label">[end &lt;end&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Final eigenvector/mode to use (default 2).</span></dd>
<dt class="description_label">[&lt;mask&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> (Not dihedral covariance) Mask of atoms to use in projection; MUST CORRESPOND TO HOW EIGENVECTORS WERE GENERATED.</span></dd>
<dt class="description_label">[dihedrals &lt;dataset arg&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> (Dihedral covariance only) Dihedral data sets to use in projection; MUST CORRESPOND TO HOW EIGENVECTORS WERE GENERATED.</span></dd>
<dt class="description_label">[start &lt;start&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Frame to start calculating projection.</span></dd>
<dt class="description_label">[stop &lt;stop&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Frame to stop calculating projection.</span></dd>
<dt class="description_label">[offset &lt;offset&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Frames to skip between projection calculations.</span></dd>
</dl>
<div class="standard"><a id="magicparlabel-5754"></a><span style="font-family:monospace;">Data Sets Created:</span></div>

<div class="standard"><a id="magicparlabel-5755"></a><span style="font-family:monospace;">DataSet indices correspond to mode #.</span></div>

<dl class="description"><a id="magicparlabel-5756"></a><dt class="description_label">&lt;name&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> (All execpt IDEA) Projection data set.</span></dd>
<dt class="description_label">&lt;name&gt;[X]</dt>
<dd class="description_item"><span style="font-family:monospace;"> X component of mode (IDEA modes only).</span></dd>
<dt class="description_label">&lt;name&gt;[Y]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Y component of mode (IDEA modes only).</span></dd>
<dt class="description_label">&lt;name&gt;[Z]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Z component of mode (IDEA modes only).</span></dd>
<dt class="description_label">&lt;name&gt;[R]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Magnitude of mode (IDEA modes only).</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-5761"></a>Projects snapshots 
onto eigenvectors obtained by diagonalizing covariance or mass-weighted 
covariance matrices. Eigenvectors are taken from previously generated 
(e.g. with <b><i>diagmatrix</i></b>) or previously read-in (e.g. with <b><i>readdata</i></b>) eigenvectors with name &lt;dataset name&gt;. The user has to make sure that the atoms selected by <b>&lt;mask&gt;</b> agree with the ones used to calculate the modes (i.e., if mask = '@CA' was used in the “<b><span style="font-family:sans-serif;">matrix</span></b>” command, mask = '@CA' needs to be set here as well). See <a href="#sec_cpptraj_Matrix_Vector_Analysis_Examples">12</a> for examples using the <em><b>projection</b></em> command.</div>
<h3 class="subsection"><a id="magicparlabel-5762"></a><span class="subsection_label">10.57</span> pucker </h3>

<div class="lyx_code"><a id="magicparlabel-5763"></a><div class="lyx_code_item">pucker<a id="magicparlabel-5767"></a>
 [&lt;name&gt;] &lt;mask1&gt; &lt;mask2&gt; &lt;mask3&gt; &lt;mask4&gt; &lt;mask5&gt; [&lt;mask6&gt;] [geom]</div>
<div class="lyx_code_item">	   [out &lt;filename&gt;] [altona | cremer] [amplitude] [theta]</div>
<div class="lyx_code_item">   	[range360] [offset &lt;offset&gt;]
<br />

</div>

<dl class="description"><a id="magicparlabel-5770"></a><dt class="description_label">&lt;name&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output data set name.</span></dd>
<dt class="description_label">&lt;maskX&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Five (optionally six) atom masks selecting atom(s) to calculate pucker for.</span></dd>
<dt class="description_label">[geom]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use geometric center of atoms in &lt;maskX&gt; (default is center of mass).</span></dd>
<dt class="description_label">[out &lt;filename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output file name.</span></dd>
<dt class="description_label">[altona]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use method of Altona &amp; Sundaralingam (5 masks only).</span></dd>
<dt class="description_label">[cremer]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use method of Cremer and Pople (5 or 6 masks).</span></dd>
<dt class="description_label">[amplitude]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Also calculate amplitude.</span></dd>
<dt class="description_label">[theta]</dt>
<dd class="description_item"><span style="font-family:monospace;"> (6 masks only) Also calculate theta.</span></dd>
<dt class="description_label">[range360]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Wrap pucker values from 0.0 to 360.0 (default is -180.0 to 180.0).</span></dd>
<dt class="description_label">[offset &lt;offset&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Add &lt;offset&gt; to pucker values.</span></dd>
</dl>
<div class="standard"><a id="magicparlabel-5780"></a><span style="font-family:monospace;">Data Sets Created:</span></div>

<dl class="description"><a id="magicparlabel-5781"></a><dt class="description_label">&lt;name&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Pucker in degrees.</span></dd>
<dt class="description_label">&lt;name&gt;[Amp]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Amplitude (if <b>amplitude</b> was specified).</span></dd>
<dt class="description_label">&lt;name&gt;[Theta]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Theta (if <b>theta</b> and 6 masks were specified).</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-5784"></a>Calculate the 
pucker (in degrees) for atoms in &lt;mask1&gt;, &lt;mask2&gt;, 
&lt;mask3&gt;, &lt;mask4&gt;, &lt;mask5&gt; using the method of Altona 
&amp; Sundarlingam[<a href="#LyXCite-Altona1972"><span class="bib-numericallabel">1</span></a>, <a href="#LyXCite-Harvey1986"><span class="bib-numericallabel">13</span></a>] (default, or if <b>altona</b> specified), or the method of Cremer &amp; Pople[<a href="#LyXCite-Cremer1975"><span class="bib-numericallabel">9</span></a>] if <b>cremer</b> is specified. If &lt;mask6&gt; is specified calculate the pucker (and optionally theta if <b>theta</b> specified) according to the method of Cremer &amp; Pople. If the <b>amplitude</b> keyword is given, amplitudes will be calculated in addition to pucker. The results from <b><i>pucker</i></b> can be further analyzed with the <b><i>statistics</i></b> analysis.</div>

<div class="standard"><a id="magicparlabel-5785"></a>By default, pucker values are wrapped to range from -180 to 180 degrees. If the <b>range360</b>
 keyword is specified values will be wrapped to range from 0 to 360 
degrees. Note that the Cremer &amp; Pople convention is offset from 
Altona &amp; Sundarlingam convention (with nucleic acids) by +90.0 
degrees; the <b>offset</b> keyword will add an offset to the final value
 and so can be used to convert between the two. For example, to convert 
from Cremer to Altona specify “<b>offset</b> 90”.</div>

<div class="standard"><a id="magicparlabel-5786"></a>To calculate 
nucleic acid pucker specify C1' first, followed by C2', C3', C4' and 
O4'. For example, to calculate the sugar pucker for nucleic acid 
residues 1 and 2 using the method of Altona &amp; Sundarlingam, with 
final pseudorotation values ranging from 0 to 360:</div>

<div class="lyx_code"><a id="magicparlabel-5787"></a><div class="lyx_code_item">pucker p1 :1@C1' :1@C2' :1@C3' :1@C4' :1@O4' range360 out pucker.dat </div>
<div class="lyx_code_item">pucker p2 :2@C1' :2@C2' :2@C3' :2@C4' :2@O4' range360 out pucker.dat</div>
</div>
<h3 class="subsection"><a id="magicparlabel-5789"></a><span class="subsection_label">10.58</span> radgyr | rog</h3>

<div class="lyx_code"><a id="magicparlabel-5790"></a><div class="lyx_code_item">radgyr<a id="magicparlabel-5794"></a>
 [name&gt;] [&lt;mask&gt;] [out &lt;filename&gt;] [mass] [nomax] [tensor]
<br />

</div>

<dl class="description"><a id="magicparlabel-5795"></a><dt class="description_label">[&lt;name&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Data set name.</span></dd>
<dt class="description_label">[&lt;mask&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Atoms to calculate radius of gyration for; default all atoms.</span></dd>
<dt class="description_label">[out &lt;filename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write data to &lt;filename&gt;.</span></dd>
<dt class="description_label">[mass]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Mass-weight radius of gyration.</span></dd>
<dt class="description_label">[nomax]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Do not calculate maximum radius of gyration.</span></dd>
<dt class="description_label">[tensor]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Calculate radius of gyration tensor, output format 'XX YY ZZ XY XZ YZ'.</span></dd>
</dl>
<div class="standard"><a id="magicparlabel-5801"></a><span style="font-family:monospace;">Data Sets Created:</span></div>

<dl class="description"><a id="magicparlabel-5802"></a><dt class="description_label">&lt;name&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Radius of gyration in Ang.</span></dd>
<dt class="description_label">&lt;name&gt;[Max]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Max radius of gyration in Ang.</span></dd>
<dt class="description_label">&lt;name&gt;[Tensor]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Radius of gyration tensor; format 'XX YY ZZ XY XZ YZ'.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-5805"></a>Calculate the 
radius of gyration of specified atoms. For example, to calculate only 
the mass-weighted radius of gyration (not the maximum) of the 
non-hydrogen atoms of residues 4 to 10 and print the results to 
“RoG.dat”:</div>

<div class="lyx_code"><a id="magicparlabel-5806"></a><div class="lyx_code_item">radgyr :4-10&amp;!(@H=) out RoG.dat mass nomax</div>
</div>
<h3 class="subsection"><a id="magicparlabel-5807"></a><span class="subsection_label">10.59</span> radial | rdf</h3>

<div class="lyx_code"><a id="magicparlabel-5808"></a><div class="lyx_code_item">radial<a id="magicparlabel-5812"></a>
 &lt;outfilename&gt; &lt;spacing&gt; &lt;maximum&gt; &lt;solvent mask1&gt;</div>
<div class="lyx_code_item">       [&lt;solute mask2&gt;] [noimage] [density &lt;density&gt; | volume]</div>
<div class="lyx_code_item">       [center1 | center2 | nointramol] [&lt;name&gt;]</div>
<div class="lyx_code_item">       [intrdf &lt;file&gt;] [rawrdf &lt;file&gt;]
<br />

</div>

<dl class="description"><a id="magicparlabel-5816"></a><dt class="description_label">&lt;outfilename&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> File to write RDF to, required.</span></dd>
<dt class="description_label">&lt;spacing&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Bin spacing, required.</span></dd>
<dt class="description_label">&lt;maximum&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Max bin value, required.</span></dd>
<dt class="description_label">&lt;solvent mask1&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Atoms to calculate RDF for, required.</span></dd>
<dt class="description_label">[&lt;solute mask2&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> (Optional) If specified calculate RDF of all atoms in &lt;solvent mask1&gt; to each atom in &lt;solute mask2&gt;.</span></dd>
<dt class="description_label">[noimage]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Do not image distances.</span></dd>
<dt class="description_label">[density &lt;density&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use density value of &lt;density&gt; for normalization (default 0.033456 molecules Å<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup><mrow/>
   <mrow>
    <mrow><mo>-</mo>
     <mstyle mathvariant="normal"><mn>3</mn>
     </mstyle>
    </mrow>
   </mrow>
  </msup>
 </mrow></math>).</span></dd>
<dt class="description_label">[volume]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Determine density for normalization from average volume of input frames.</span></dd>
<dt class="description_label">[center1]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Calculate RDF from geometric center of atoms in &lt;solvent mask1&gt; to all atoms in &lt;solute mask2&gt;.</span></dd>
<dt class="description_label">[center2]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Calculate RDF from geometric center of atoms in &lt;solute mask2&gt; to all atoms in &lt;solvent mask1&gt;.</span></dd>
<dt class="description_label">[nointramol]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Ignore intra-molecular distances.</span></dd>
<dt class="description_label">[&lt;name&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Name radial dataset.</span></dd>
<dt class="description_label">[intrdf &lt;file&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> 
Calculate integral of RDF bin values (averaged over # of frames but 
otherwise not normalized) and write to &lt;file&gt; (can be same as 
&lt;output_filename&gt;).</span></dd>
<dt class="description_label">[rawrdf &lt;file&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write raw (non-normalized) RDF values to &lt;file&gt;.</span></dd>
</dl>
<div class="standard"><a id="magicparlabel-5830"></a><span style="font-family:monospace;">DataSet Aspects:</span></div>

<dl class="description"><a id="magicparlabel-5831"></a><dt class="description_label">[int]</dt>
<dd class="description_item"><span style="font-family:monospace;"> (<b>intrdf</b> only) Integral of RDF bin values.</span></dd>
<dt class="description_label">[raw]</dt>
<dd class="description_item"><span style="font-family:monospace;"> (<b>rawrdf</b> only) Raw (non-normalized) RDF values.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-5833"></a>Calculate the radial distribution function (RDF, aka pair correlation function) of atoms in <b>&lt;solvent mask1&gt;</b> (note that this mask does not need to be solvent, but this nomenclature is used for clarity). If an optional second mask (<b>&lt;solute mask2&gt;</b>) is given, calculate the RDF of ALL atoms in <b>&lt;solvent mask1&gt;</b> to EACH atom in <b>&lt;solute mask2&gt;</b>. If desired, the geometric center of atoms in <b>&lt;solvent mask1&gt;</b> or <b>&lt;solute mask2&gt;</b> can be used by specifying the <b>center1</b> or <b>center2</b> keywords respectively, or alternatively intra-molecular distances can be ignored by specifying the <b>nointramol</b> keyword. </div>

<div class="standard"><a id="magicparlabel-5834"></a>The RDF is 
calculated from the histogram of the number of particles found as a 
function of distance R, normalized by the expected number of particles 
at that distance. The normalization is calculated from:
<br />

</div>

<div class="standard" style="text-align: center;"><a id="magicparlabel-5835"></a><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>D</mi><mi>e</mi><mi>n</mi><mi>s</mi><mi>i</mi><mi>t</mi><mi>y</mi><mo>*</mo><mo form="prefix" fence="true" stretchy="true" symmetric="true">(</mo>

   <mrow><mo form="prefix" fence="true" stretchy="true" symmetric="true">[</mo>

    <mrow>
     <mfrac>
      <mrow>
       <mrow><mn>4</mn><mi> π </mi>
       </mrow>
      </mrow>
      <mrow><mn>3</mn>
      </mrow>
     </mfrac>
     <msup>
      <mrow><mo form="prefix" fence="true" stretchy="true" symmetric="true">(</mo>

       <mrow><mi>R</mi><mo>+</mo><mi>d</mi><mi>R</mi>
       </mrow>
<mo form="postfix" fence="true" stretchy="true" symmetric="true">)</mo>

      </mrow>
      <mrow><mn>3</mn>
      </mrow>
     </msup>
    </mrow>
<mo form="postfix" fence="true" stretchy="true" symmetric="true">]</mo>
<mo>-</mo><mo form="prefix" fence="true" stretchy="true" symmetric="true">[</mo>

    <mrow>
     <mfrac>
      <mrow>
       <mrow><mn>4</mn><mi> π </mi>
       </mrow>
      </mrow>
      <mrow><mn>3</mn>
      </mrow>
     </mfrac><mi>d</mi>
     <msup>
      <mrow><mi>R</mi>
      </mrow>
      <mrow><mn>3</mn>
      </mrow>
     </msup>
    </mrow>
<mo form="postfix" fence="true" stretchy="true" symmetric="true">]</mo>

   </mrow>
<mo form="postfix" fence="true" stretchy="true" symmetric="true">)</mo>

  </mrow>
 </mrow></math></div>

<div class="standard"><a id="magicparlabel-5836"></a>where dR is equal 
to the bin spacing. Some care is required by the user in order to 
normalize the RDF correctly. The default density value is 0.033456 
molecules Å<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup><mrow/>
   <mrow>
    <mrow><mo>-</mo>
     <mstyle mathvariant="normal"><mn>3</mn>
     </mstyle>
    </mrow>
   </mrow>
  </msup>
 </mrow></math>, which corresponds to a density of water approximately equal to 1.0 g mL<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup><mrow/>
   <mrow>
    <mrow><mo>-</mo>
     <mstyle mathvariant="normal"><mn>1</mn>
     </mstyle>
    </mrow>
   </mrow>
  </msup>
 </mrow></math>. To convert a standard density in g mL<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup><mrow/>
   <mrow>
    <mrow><mo>-</mo>
     <mstyle mathvariant="normal"><mn>1</mn>
     </mstyle>
    </mrow>
   </mrow>
  </msup>
 </mrow></math>, multiply the density by <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mfrac>
   <mrow><mn>0.6022</mn>
   </mrow>
   <mrow>
    <msub>
     <mrow><mi>M</mi>
     </mrow>
     <mrow><mi>r</mi>
     </mrow>
    </msub>
   </mrow>
  </mfrac>
 </mrow></math>, where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>M</mi>
   </mrow>
   <mrow><mi>r</mi>
   </mrow>
  </msub>
 </mrow></math> is the mass of the molecule in atomic mass units. Alternatively, if the <b>volume</b> keyword is specified the density is determined from the average volume of the system over all Frames. </div>

<div class="standard"><a id="magicparlabel-5837"></a>Note that correct 
normalization of the RDF depends on the number of atoms in each mask; if
 multiple topology files are being processed that result in changes in 
the number of atoms in each mask, the normalization will be off.</div>
<h3 class="subsection"><a id="magicparlabel-5838"></a><span class="subsection_label">10.60</span> randomizeions</h3>

<div class="lyx_code"><a id="magicparlabel-5839"></a><div class="lyx_code_item">randomizeions &lt;mask&gt; [around &lt;mask&gt; by &lt;distance&gt;] [overlap &lt;value&gt;]</div>
<div class="lyx_code_item">              [noimage] [seed &lt;value&gt;]</div>
</div>
<div class="standard"><a id="magicparlabel-5841"></a>This can be used to randomly swap the positions of solvent and single atom ions. The “<span style="font-family:monospace;">overlap</span>” specifies the minimum distance between ions, and the “<span style="font-family:monospace;">around</span>”
 keyword can be used to specify a solute (or set of atoms) around which 
the ions can get no closer than the distance specified. The optional 
keywords “<span style="font-family:monospace;">noimage</span>” disable imaging and “<span style="font-family:monospace;">seed</span>” update the random number seed. An example usage is</div>

<div class="lyx_code"><a id="magicparlabel-5842"></a><div class="lyx_code_item">randomizeions @NA around :1-20 by 5.0 overlap 3.0</div>
</div>
<div class="standard"><a id="magicparlabel-5843"></a>The above will swap Na<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup><mrow/>
   <mrow>
    <mstyle mathvariant="normal"><mo>+</mo>
    </mstyle>
   </mrow>
  </msup>
 </mrow></math> ions with water getting no closer than 5.0 Å from residues 1 – 20 and no closer than 3.0 Å from any other Na<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup><mrow/>
   <mrow>
    <mstyle mathvariant="normal"><mo>+</mo>
    </mstyle>
   </mrow>
  </msup>
 </mrow></math> ion.<i> </i></div>
<h3 class="subsection"><a id="magicparlabel-5844"></a><span class="subsection_label">10.61</span> replicatecell</h3>

<div class="lyx_code"><a id="magicparlabel-5845"></a><div class="lyx_code_item">replicatecell [out &lt;traj filename&gt;] [parmout &lt;parm filename&gt;] [name &lt;dsname&gt;]</div>
<div class="lyx_code_item">              { all | dir &lt;XYZ&gt; [dir &lt;XYZ&gt; ...] } [&lt;mask&gt;]
<br />

</div>

<dl class="description"><a id="magicparlabel-5847"></a><dt class="description_label">out &lt;traj filename&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write replicated cell to output trajectory file.</span></dd>
<dt class="description_label">parmout &lt;parm filename&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write replicated cell topology to topology file. This file will not be viable to use for simulations.</span></dd>
<dt class="description_label">name &lt;dsname&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> If specified save replicated cell to COORDS data set.</span></dd>
<dt class="description_label">all</dt>
<dd class="description_item"><span style="font-family:monospace;"> Replicate cell once in all possible directions.</span></dd>
<dt class="description_label">dir &lt;XYZ&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> 
Repicate cell once in specified directions. &lt;XYZ&gt; should consist 
of 3 numbers with no spaces in between them and are restricted to values
 of -1, 1, and 0. May be specified more than once.</span></dd>
<dt class="description_label">&lt;mask&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Mask of atoms to replicate.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-5853"></a>Create a trajectory
 where the unit cell is replicated in 1 or more directions (up to 27). 
The resulting coordinates and topology can be written to a 
trajectory/topology file. They can also be saved as a COORDS data set 
for subsequent processing. Currently replication is only allowed 1 axis 
length in either direction. The <b>all</b> keyword will replicate the cell once in all directions. The <b>dir</b> keyword can be used to restrict replication to specific directions, e.g. '<span style="font-family:monospace;">dir 10-1</span>' would replicate the cell once in the +X, -Z directions.</div>

<div class="standard"><a id="magicparlabel-5854"></a>For example, to replicate a cell in all directions, writing out to NetCDF trajectory cell.nc:</div>

<div class="lyx_code"><a id="magicparlabel-5855"></a><div class="lyx_code_item">parm ../tz2.truncoct.parm7</div>
<div class="lyx_code_item">trajin ../tz2.truncoct.nc</div>
<div class="lyx_code_item">replicatecell out cell.nc parmout cell.parm7 all</div>
</div>
<h3 class="subsection"><a id="magicparlabel-5858"></a><span class="subsection_label">10.62</span> rms | rmsd<a id="subsec_cpptraj_rmsd"></a>
</h3>

<div class="lyx_code"><a id="magicparlabel-5859"></a><div class="lyx_code_item">rmsd<a id="magicparlabel-5863"></a>
 [&lt;name&gt;] &lt;mask&gt; [&lt;refmask&gt;] [out &lt;filename&gt;] [mass]</div>
<div class="lyx_code_item"> 	[nofit | norotate | nomod]</div>
<div class="lyx_code_item"> 	[savematrices [matricesout &lt;file&gt;]]</div>
<div class="lyx_code_item"> 	[savevectors {combined|separate} [vecsout &lt;file&gt;]]</div>
<div class="lyx_code_item"> 	[ first | reference | ref &lt;name&gt; | refindex &lt;#&gt; | previous |</div>
<div class="lyx_code_item"> 	  reftraj &lt;name&gt; [parm &lt;name&gt; | parmindex &lt;#&gt;] ]</div>
<div class="lyx_code_item"> 	[perres perresout &lt;filename&gt; [perresavg &lt;avgfile&gt;]</div>
<div class="lyx_code_item"> 	 [range &lt;resRange&gt;] [refrange &lt;refRange&gt;]</div>
<div class="lyx_code_item"> 	 [perresmask &lt;additional mask&gt;] [perrescenter] [perresinvert]
<br />

</div>

<dl class="description"><a id="magicparlabel-5872"></a><dt class="description_label">[&lt;name&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output data set name.</span></dd>
<dt class="description_label">[&lt;mask&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Mask of atoms to calculate RMSD for; if not specified, calculate for all atoms.</span></dd>
<dt class="description_label">[&lt;refmask&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Reference mask; if not specified, use <b>&lt;mask&gt;</b>.</span></dd>
<dt class="description_label">[out &lt;filename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output data file name.</span></dd>
<dt class="description_label">[mass]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Mass-weight the RMSD calculation.</span></dd>
<dt class="description_label">[nofit]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Do not perform best-fit RMSD.</span></dd>
<dt class="description_label">[norotate]</dt>
<dd class="description_item"><span style="font-family:monospace;"> If calculating best-fit RMSD, translate but do not rotate coordinates.</span></dd>
<dt class="description_label">[nomod]</dt>
<dd class="description_item"><span style="font-family:monospace;"> If calculating best-fit RMSD, do not modify coordinates.</span></dd>
<dt class="description_label">[savematrices]</dt>
<dd class="description_item"><span style="font-family:monospace;"> If specified save rotation matrices to data set with aspect [RM].</span>

<dl class="description"><a id="magicparlabel-5881"></a><dt class="description_label">matricesout &lt;file&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write rotation matrices to specified file.</span></dd>
</dl>
</dd><dt class="description_label">[savevectors {combined|separate}]</dt>
<dd class="description_item"><span style="font-family:monospace;"> If specified save translation vectors: <b>combined</b> means save target-to-origin plus the origin-to-reference translation vectors, <b>separate</b> means save target-to-origin as Vx, Vy, Vz and save origin-to-reference as Ox Oy Oz in the output vector data set.</span>

<dl class="description"><a id="magicparlabel-5883"></a><dt class="description_label">vecsout &lt;file&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output translation vector data set to &lt;file&gt;.</span></dd>
</dl>
</dd></dl>
<div class="standard"><a id="magicparlabel-5884"></a><span style="font-family:monospace;">Reference keywords:</span></div>

<dl class="description"><a id="magicparlabel-5885"></a><dt class="description_label">first</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use the first trajectory frame processed as reference.</span></dd>
<dt class="description_label">reference</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use the first previously read in reference structure (refindex 0).</span></dd>
<dt class="description_label">ref &lt;name&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use previously read in reference structure specified by filename/tag.</span></dd>
<dt class="description_label">refindex &lt;#&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use previously read in reference structure specified by &lt;#&gt; (based on order read in).</span></dd>
<dt class="description_label">previous</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use frame prior to current frame as reference.</span></dd>
<dt class="description_label">reftraj &lt;name&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use 
frames from COORDS set &lt;name&gt; or read in from trajectory file 
&lt;name&gt; as references. Each frame from &lt;name&gt; is used in 
turn, so that frame 1 is compared to frame 1 from &lt;name&gt;, frame 2 
is compared to frame 2 from &lt;name&gt; and so on. If &lt;trajname&gt; 
runs out of frames before processing is complete, the last frame of 
&lt;trajname&gt; continues to be used as the reference.
<br />

</span>

<dl class="description"><a id="magicparlabel-5891"></a><dt class="description_label">parm &lt;parmname&gt; | parmindex &lt;#&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> If <b>reftraj</b> specifies a trajectory file, associate it with specified topology; if not specified the first topology is used.</span></dd>
</dl>
</dd></dl>
<div class="standard"><a id="magicparlabel-5892"></a><span style="font-family:monospace;">Per-residue RMSD keywords:</span></div>

<dl class="description"><a id="magicparlabel-5893"></a><dt class="description_label">perres</dt>
<dd class="description_item"><span style="font-family:monospace;"> Activate per-residue no-fit RMSD calculation.</span></dd>
<dt class="description_label">perresout &lt;perresfile&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write per-residue RMSD to &lt;perresfile&gt;.</span></dd>
<dt class="description_label">perresavg &lt;avgfile&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write average per-residue RMSDs to &lt;avgfile&gt;.</span></dd>
<dt class="description_label">range &lt;res range&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Calculate per-residue RMSDs for residues in &lt;res range&gt; (default all solute residues).</span></dd>
<dt class="description_label">refrange &lt;ref range&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Calculate per-residue RMSDs to reference residues in &lt;ref range&gt; (use &lt;res range&gt; if not specified).</span></dd>
<dt class="description_label">perresmask &lt;additional mask&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> By 
default residues are selected using the mask ':X' where X is residue 
number; this appends &lt;additional mask&gt; to the mask expression.</span></dd>
<dt class="description_label">perrescenter</dt>
<dd class="description_item"><span style="font-family:monospace;"> Translate residues to a common center of mass prior to calculating RMSD.</span></dd>
<dt class="description_label">perresinvert</dt>
<dd class="description_item"><span style="font-family:monospace;"> Make X-axis residue number instead of frame number.</span></dd>
</dl>
<div class="standard"><a id="magicparlabel-5901"></a><span style="font-family:monospace;">Data Sets Created:</span></div>

<dl class="description"><a id="magicparlabel-5902"></a><dt class="description_label">&lt;name&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> RMSD of atoms in mask to reference.</span></dd>
<dt class="description_label">&lt;name&gt;[RM]</dt>
<dd class="description_item"><span style="font-family:monospace;"> (savematrices only) Rotation matrices of target to reference.</span></dd>
<dt class="description_label">&lt;name&gt;[TV]</dt>
<dd class="description_item"><span style="font-family:monospace;"> (savevectors only) Translation vector.</span></dd>
<dt class="description_label">&lt;name&gt;[res]</dt>
<dd class="description_item"><span style="font-family:monospace;"> (<b>perres</b> only) Per-residue RMSDs; index is residue number.</span></dd>
<dt class="description_label">&lt;name&gt;[Avg]</dt>
<dd class="description_item"><span style="font-family:monospace;"> (<b>perres</b> only) Average per-residue RMSD for each residue.</span></dd>
<dt class="description_label">&lt;name&gt;[Stdev]</dt>
<dd class="description_item"><span style="font-family:monospace;"> (<b>perres</b> only) Standard deviation of RMSD for each residue.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-5908"></a><i>Note that <b>perres</b> data sets are not generated until <b>run</b> is called.</i></div>

<div class="standard"><a id="magicparlabel-5909"></a>Calculate the 
coordinate RMSD of input frames to a reference frame (or reference 
trajectory). Both &lt;mask&gt; and &lt;refmask&gt; must specify the same
 number of atoms, otherwise an error will occur. </div>

<div class="standard"><a id="magicparlabel-5910"></a>For example, say 
you have a trajectory and you want to calculate RMSD to two separate 
reference structures. To calculate the best-fit RMSD of the C, CA, and N
 atoms of residues 1 to 20 in each frame to the C, CA, and N atoms of 
residues 3 to 23 in StructX.crd, and then calculate the no-fit RMSD of 
residue 7 to residue 7 in another structure named Struct-begin.rst7, 
writing both results to Grace-format file “rmsd1.agr”:</div>

<div class="lyx_code"><a id="magicparlabel-5911"></a><div class="lyx_code_item">reference StructX.crd [structX]</div>
<div class="lyx_code_item">reference md_begin.rst7 [struct0]</div>
<div class="lyx_code_item">rmsd BB :1-20@C,CA,N ref [structX] :3-23@C,CA,N out rmsd1.agr </div>
<div class="lyx_code_item">rmsd Res7 :7 ref [struct0] out rmsd1.agr nofit</div>
</div>
<h4 class="subsubsection_"><a id="magicparlabel-5915"></a>Per-residue RMSD calculation</h4>
<div class="standard"><a id="magicparlabel-5916"></a>If the <b>perres</b>
 keyword is specified, after the initial RMSD calculation the no-fit 
RMSD of specified residues is also calculated. So for example:</div>

<div class="lyx_code"><a id="magicparlabel-5917"></a><div class="lyx_code_item">rmsd :10-260 reference perres perresout PRMS.dat range 190-211 perresmask &amp;!(@H=)</div>
</div>
<div class="standard"><a id="magicparlabel-5918"></a>will first perform a
 best-fit RMSD calculation to the first specified reference structure 
using residues 10 to 260, then calculate the no-fit RMSD of residues 190
 to 211 (excluding any hydrogen atoms), writing the results to PRMS.dat.
 Two additional recommendations for the 'perres' option: 1) try not 
including backbone atoms by using the 'perresmask' keyword, e.g. 
"perresmask &amp;!@H,N,CA,HA,C,O", and 2) try using the 'perrescenter' 
keyword, which centers each residue prior to the 'nofit' calculation; 
this is useful for isolating changes in residue conformation.</div>
<h3 class="subsection"><a id="magicparlabel-5919"></a><span class="subsection_label">10.63</span> rms2d | 2drms</h3>
<div class="standard"><a id="magicparlabel-5920"></a>Although the <em><b>'rms2d'</b></em> command can still be specified as an action, it is now considered an analysis. See <a href="#subsec_cpptraj_rms2d">11.27</a>.</div>
<h3 class="subsection"><a id="magicparlabel-5921"></a><span class="subsection_label">10.64</span> rmsavgcorr</h3>
<div class="standard"><a id="magicparlabel-5922"></a>Although the <em><b>'rmsavgcorr'</b></em> command can still be specified as an action, it is now considered an analysis. See <a href="#subsec_cpptraj_rmsavgcorr">11.28</a>.</div>
<h3 class="subsection"><a id="magicparlabel-5923"></a><span class="subsection_label">10.65</span> rmsf | atomicfluct</h3>
<div class="standard"><a id="magicparlabel-5924"></a>See <a href="#subsec_cpptraj_atomicfluct">10.4</a>.</div>
<h3 class="subsection"><a id="magicparlabel-5925"></a><span class="subsection_label">10.66</span> rotate</h3>

<div class="lyx_code"><a id="magicparlabel-5926"></a><div class="lyx_code_item">rotate [&lt;mask&gt;] { [x &lt;xdeg&gt;] [y &lt;ydeg&gt;] [z &lt;zdeg&gt;]  |</div>
<div class="lyx_code_item">   	           axis0 &lt;mask0&gt; axis1 &lt;mask1&gt; &lt;deg&gt; |</div>
<div class="lyx_code_item">   	           usedata &lt;set name&gt; [inverse] }
<br />

</div>

<dl class="description"><a id="magicparlabel-5929"></a><dt class="description_label">[&lt;mask&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Rotate atoms in &lt;mask&gt; (default all).</span></dd>
<dt class="description_label">[x &lt;xdeg]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Degrees to rotate around the X axis.</span></dd>
<dt class="description_label">[y &lt;xdeg]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Degrees to rotate around the Y axis.</span></dd>
<dt class="description_label">[z &lt;xdeg]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Degrees to rotate around the Z axis.</span></dd>
<dt class="description_label">axis0 &lt;mask0&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Mask defining the beginning of a user-defined axis.</span></dd>
<dt class="description_label">axis1 &lt;mask1&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Mask defining the end of a user-defined axis.</span></dd>
<dt class="description_label">&lt;deg&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Value in degrees to rotate around user defined axis.</span></dd>
<dt class="description_label">usedata &lt;set name&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> If specified, use 3x3 rotation matrices in specified data set to rotate coordinates.</span></dd>
<dt class="description_label">[inverse]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Perform inverse rotation from input rotation matrices.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-5938"></a>Rotate specified 
atoms around the X, Y, and/or Z axes by the specified amounts, around a 
user-defined axis (specified by &lt;mask0&gt; and &lt;mask1&gt;), or use
 a previously read in or generated data set of 3x3 matrices to perform 
rotations.</div>

<div class="standard"><a id="magicparlabel-5939"></a>For example, to rotate the entire system 90 degrees around the X axis:</div>

<div class="lyx_code"><a id="magicparlabel-5940"></a><div class="lyx_code_item">rotate x 90</div>
</div>
<div class="standard"><a id="magicparlabel-5941"></a>To rotate residue 
270 90 degrees around the axis defined between atoms C1, C2, C3, C4, C5,
 and C6 in residue 270 and atoms C7, C8, C9, C10, C11, and C12 in 
residue 270:</div>

<div class="lyx_code"><a id="magicparlabel-5942"></a><div class="lyx_code_item">rotate :270 axis0 :270@C1,C2,C3,C4,C5,C6 axis1 :270@C7,C8,C9,C10,C11,C12 90.0</div>
</div>
<div class="standard"><a id="magicparlabel-5943"></a>To rotate the system with rotation matrices read in from rmatrices.dat:</div>

<div class="lyx_code"><a id="magicparlabel-5944"></a><div class="lyx_code_item">trajin tz2.norotate.crd</div>
<div class="lyx_code_item">readdata rmatrices.dat name RM mat3x3</div>
<div class="lyx_code_item">rotate usedata RM </div>
</div>
<h3 class="subsection"><a id="magicparlabel-5947"></a><span class="subsection_label">10.67</span> rotdif</h3>
<div class="standard"><a id="magicparlabel-5948"></a>The <em><b>'rotdif'</b></em> command is now an analysis (see <a href="#subsec_cpptraj_rotdif">11.29</a>), and requires that rotation matrices be generated via an <em><b>rmsd</b></em> action. For example:</div>

<div class="lyx_code"><a id="magicparlabel-5949"></a><div class="lyx_code_item">reference avgstruct.pdb</div>
<div class="lyx_code_item">trajin tz2.nc</div>
<div class="lyx_code_item">rms R0 reference @CA,C,N,O savematrices </div>
<div class="lyx_code_item">rotdif rmatrix R0[RM] rseed 1 nvecs 10 dt 0.002 tf 0.190 \</div>
<div class="lyx_code_item">       itmax 500 tol 0.000001 d0 0.03 order 2 rvecout rvecs.dat \</div>
<div class="lyx_code_item">       rmout matrices.dat deffout deffs.dat outfile rotdif.out</div>
</div>
<h3 class="subsection"><a id="magicparlabel-5955"></a><span class="subsection_label">10.68</span> runavg | runningaverage</h3>

<div class="lyx_code"><a id="magicparlabel-5956"></a><div class="lyx_code_item">runavg<a id="magicparlabel-5960"></a>
 [window &lt;window_size&gt;]</div>
</div>
<div class="standard"><a id="magicparlabel-5961"></a><i>Note that for backwards compatibility with ptraj “runningaverage” is also accepted.</i></div>

<div class="standard"><a id="magicparlabel-5962"></a>Replaces the current frame with a running average over a number of frames specified by <b>window</b>
 &lt;window_size&gt; (5 if not specified). This means that in order to 
build up the correct number of frames to calculate the average, the 
first &lt;window_size&gt; minus one frames will not be processed by 
subsequent actions. So for example given the input:</div>

<div class="lyx_code"><a id="magicparlabel-5963"></a><div class="lyx_code_item">runavg window 3</div>
<div class="lyx_code_item">rms first out rmsd.dat</div>
</div>
<div class="standard"><a id="magicparlabel-5965"></a>the rms command 
will not take effect until frame 3 since that is the first time 3 frames
 are available for averaging (1, 2, and 3). The next frame processed 
would be an average of frames 2, 3, and 4, etc.</div>
<h3 class="subsection"><a id="magicparlabel-5966"></a><span class="subsection_label">10.69</span> scale</h3>

<div class="lyx_code"><a id="magicparlabel-5967"></a><div class="lyx_code_item">scale x &lt;sx&gt; y &lt;sy&gt; z &lt;sz&gt; &lt;mask&gt;</div>
</div>
<div class="standard"><a id="magicparlabel-5968"></a>Scale the X|Y|Z coordinates of atoms in &lt;mask&gt; by &lt;sx&gt;|&lt;sy&gt;|&lt;sz&gt;.</div>
<h3 class="subsection"><a id="magicparlabel-5969"></a><span class="subsection_label">10.70</span> secstruct<a id="subsec_cpptraj_secstruct"></a>
</h3>

<div class="lyx_code"><a id="magicparlabel-5970"></a><div class="lyx_code_item">secstruct<a id="magicparlabel-5974"></a>
 [&lt;name&gt;] [out &lt;filename&gt;] [&lt;mask&gt;] [sumout &lt;filename&gt;]</div>
<div class="lyx_code_item">          [assignout &lt;filename&gt;] [totalout &lt;filename&gt; [ptrajformat]</div>
<div class="lyx_code_item">          [namen &lt;N name&gt;] [nameh &lt;H name&gt;] [nameca &lt;CA name&gt;]</div>
<div class="lyx_code_item">          [namec &lt;C name&gt;] [nameo &lt;O name&gt;]
<br />

</div>

<dl class="description"><a id="magicparlabel-5978"></a><dt class="description_label">[&lt;name&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output data set name.</span></dd>
<dt class="description_label">[out &lt;filename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output file name for secondary structure vs time.</span></dd>
<dt class="description_label">[&lt;mask&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Atom mask in which residues should be looked for.</span></dd>
<dt class="description_label">[sumout &lt;sumfilename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write
 average secondary structure values for each residue to 
&lt;sumfilename&gt;; if not specified &lt;filename&gt;.sum is used.</span></dd>
<dt class="description_label">[assignout &lt;filename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write overall secondary structure assignment (based on dominant secondary structure type for each residue) to file.</span></dd>
<dt class="description_label">[ptrajformat]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write secondary structure as a string of characters for each frame, similar to ptraj output.</span></dd>
<dt class="description_label">[namen &lt;N name&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Backbone amide nitrogen atom name (default 'N').</span></dd>
<dt class="description_label">[nameh &lt;H name&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Backbone amide hydrogen atom name (default 'H').</span></dd>
<dt class="description_label">[nameca &lt;CA name&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Backbone alpha carbon atom name (default 'CA').</span></dd>
<dt class="description_label">[namec &lt;C name&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Backbone carbonyl carbon atom name (default 'C').</span></dd>
<dt class="description_label">[nameo &lt;O name&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Backbone carbonyl oxygen atom name (default 'O').</span></dd>
</dl>
<div class="standard"><a id="magicparlabel-5989"></a><span style="font-family:monospace;">Data Sets Created:</span></div>

<dl class="description"><a id="magicparlabel-5990"></a><dt class="description_label">&lt;name&gt;[res]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Residue secondary structure per frame; index corresponds to residue number. If <b>ptrajformat</b> specified these will be characters, otherwise integers (see table below).</span></dd>
<dt class="description_label">&lt;name&gt;[avgss]</dt>
<dd class="description_item"><span style="font-family:monospace;"> 
Average of each type of secondary structure; index corresponds to 
secondary structure type (see table below; no index for “None”).</span></dd>
<dt class="description_label">&lt;name&gt;[None]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Total fraction of residues with no structure vs time.</span></dd>
<dt class="description_label">&lt;name&gt;[Para]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Total fraction of residues with parallel beta structure vs time.</span></dd>
<dt class="description_label">&lt;name&gt;[Anti]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Total fraction of residues with anti-parallel beta structure vs time.</span></dd>
<dt class="description_label">&lt;name&gt;[3-10]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Total fraction of 3-10 helical structure vs time.</span></dd>
<dt class="description_label">&lt;name&gt;[Alpha]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Total fraction of alpha helical structure vs time.</span></dd>
<dt class="description_label">&lt;name&gt;[Pi]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Total fraction of Pi helical structure vs time.</span></dd>
<dt class="description_label">&lt;name&gt;[Turn]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Total fraction of turn structure vs time.</span></dd>
<dt class="description_label">&lt;name&gt;[Bend]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Total fraction of bend structure vs time.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-6000"></a><i>Note that when not using <b>ptrajformat</b>, data sets are not generated until <b>run</b> is called.</i></div>

<div class="standard"><a id="magicparlabel-6001"></a>Calculate secondary structural propensities for residues in <b>&lt;mask&gt;</b> (or all solute residues if no mask given) using the DSSP method of Kabsch and Sander[<a href="#LyXCite-Kabsch83"><span class="bib-numericallabel">18</span></a>],
 which assigns secondary structure types for residues based on backbone 
amide (N-H) and carbonyl (C=O) atom positions. By default <i>cpptraj</i>
 assumes these atoms are named “N”, “H”, “C”, and “O” respectively. If a
 different naming scheme is used (e.g. amide hydrogens are named “HN”) 
the backbone atom names can be customized with the <b>nameX</b> keywords
 (e.g. 'nameH HN'). Note that it is expected that some residues will not
 have all of these atoms (such as proline); in this case <i>cpptraj</i> will print an informational message but the calculation will proceed normally.</div>

<div class="standard"><a id="magicparlabel-6002"></a>Results will be written to filename specified by <b>out</b> with format:</div>

<div class="lyx_code"><a id="magicparlabel-6003"></a><div class="lyx_code_item">&lt;#Frame&gt;    &lt;ResX SS&gt; &lt;ResX+1 SS&gt; ... &lt;ResN SS&gt;</div>
</div>
<div class="standard"><a id="magicparlabel-6004"></a>where 
&lt;#Frame&gt; is the frame number and &lt;ResX SS&gt; is an integer 
representing the calculated secondary structure type for residue X. If 
the keyword <b>ptrajformat</b> is specified, the output format will instead be:</div>

<div class="lyx_code"><a id="magicparlabel-6005"></a><div class="lyx_code_item">&lt;#Frame&gt;    STRING</div>
</div>
<div class="standard"><a id="magicparlabel-6006"></a>where STRING is a 
string of characters (one for each residue) where each character 
represents a different structural type (this format is similar to what <i>ptraj</i> outputs). The various secondary structure types and their corresponding integer/character are listed below:
<br />

</div>



<div class="standard" style="text-align: center;"><a id="magicparlabel-6007"></a><table><tbody><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6054"></a>Character</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6057"></a>Integer</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6060"></a>DSSP Char</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6063"></a>SS type</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6066"></a>0</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6069"></a>0</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6072"></a>' '</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6075"></a>None</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6078"></a>b</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6081"></a>1</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6084"></a>'E'</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6087"></a>Parallel Beta-sheet</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6090"></a>B</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6093"></a>2</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6096"></a>'B'</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6099"></a>Anti-parallel Beta-sheet</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6102"></a>G</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6105"></a>3</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6108"></a>'G'</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6111"></a>3-10 helix</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6114"></a>H</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6117"></a>4</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6120"></a>'H'</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6123"></a>Alpha helix</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6126"></a>I</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6129"></a>5</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6132"></a>'I'</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6135"></a>Pi (3-14) helix</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6138"></a>T</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6141"></a>6</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6144"></a>'T'</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6147"></a>Turn</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6150"></a>S</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6153"></a>7</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6156"></a>'S'</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6159"></a>Bend</div>
</td>
</tr></tbody>
</table>
</div>

<div class="standard"><a id="magicparlabel-6160"></a>Average structural propensities over all frames for each residue will be written to the file specified by <b>sumout</b> (or “<i>&lt;filename&gt;.sum</i>” if <b>sumout</b>
 is not specified). The total structural propensity over all residues 
for each secondary structure type will be written to the file specified 
by <b>totalout</b>. If assignout is specified, the overall secondary 
structure assignment for each residue will be printed in two line chunks
 of 50 residues, with the first line containing the residue number the 
line starts with and one character residue names, and the second line 
containing secondary structure assignment using DSSP-style characters, 
like so:</div>

<div class="lyx_code"><a id="magicparlabel-6161"></a><div class="lyx_code_item">1 KCNTATCATQ RLANFLVHSS NNFGAILSST NVGSNTRn</div>
<div class="lyx_code_item">    SSS   TH HHHTTSBBBB TTTBBBB SS     S </div>
</div>
<div class="standard"><a id="magicparlabel-6163"></a>The output of 
secstruct command is amenable to visualization with gnuplot. To generate
 a 2D map-style plot of secondary structure vs time, with each residue 
on the Y axis simply give the output file a “.gnu” extension. For 
example, to generate a 2D map of secondary structure vs time, with 
different colors representing different secondary structure types for 
residues 1-22:</div>

<div class="lyx_code"><a id="magicparlabel-6164"></a><div class="lyx_code_item">secstruct :1-22 out dssp.gnu</div>
</div>
<div class="standard"><a id="magicparlabel-6165"></a>The resulting file can be visualized with gnuplot:</div>

<div class="lyx_code"><a id="magicparlabel-6166"></a><div class="lyx_code_item">gnuplot dssp.gnu</div>
</div>
<div class="standard"><a id="magicparlabel-6167"></a>Similarly, the <b>sumout</b> file can be nicely visualized using xmgrace (use “.agr” extension).</div>

<div class="lyx_code"><a id="magicparlabel-6168"></a><div class="lyx_code_item">secstruct :1-22 out dssp.gnu sumout dssp.agr</div>
<div class="lyx_code_item">xmgrace dssp.agr</div>
</div>
<h3 class="subsection"><a id="magicparlabel-6170"></a><span class="subsection_label">10.71</span> spam</h3>

<div class="lyx_code"><a id="magicparlabel-6171"></a><div class="lyx_code_item">spam &lt;filename&gt; [solv &lt;solvname&gt;] [reorder] [name &lt;name&gt;]</div>
<div class="lyx_code_item">     [purewater] [cut &lt;cut&gt;] [info &lt;infofile&gt;] [summary &lt;summary&gt;]</div>
<div class="lyx_code_item">     [site_size &lt;size&gt;] [sphere] [out &lt;datafile&gt;]</div>
<div class="lyx_code_item">     [dgbulk &lt;dgbulk&gt;] [dhbulk &lt;dhbulk&gt;] [temperature &lt;T&gt;] </div>

<dl class="description"><a id="magicparlabel-6175"></a><dt class="description_label">&lt;filename&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> File with the peak locations present (XYZ- format) </span></dd>
<dt class="description_label">&lt;solvname&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Name of the solvent residues </span></dd>
<dt class="description_label">&lt;cut&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Non-bonded cutoff for energy evaluation</span></dd>
<dt class="description_label">&lt;dgbulk&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> SPAM free energy of the bulk solvent in kcal/mol; default is -30.3 kcal/mol (SPC/E water).</span></dd>
<dt class="description_label">&lt;dhbulk&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> SPAM enthalpy of the bulk solvent in kcal/mol; default is -22.2 kcal/mol (SPC/E water).</span></dd>
<dt class="description_label">&lt;T&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Temperature at which SPAM calculation was run.</span></dd>
<dt class="description_label">&lt;infofile&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> File with stats about which sites are occupied when.</span></dd>
<dt class="description_label">&lt;size&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Size of the water site around each density peak.</span></dd>
<dt class="description_label">[sphere]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Treat each site like a sphere.</span></dd>
<dt class="description_label">[purewater]</dt>
<dd class="description_item"><span style="font-family:monospace;"> The system is pure water---used to parametrize the bulk values.</span></dd>
<dt class="description_label">[reorder]</dt>
<dd class="description_item"><span style="font-family:monospace;"> The solvent should be re-ordered so the same solvent molecule is always in the same site.</span></dd>
<dt class="description_label">&lt;summary&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> File with the summary of all SPAM results. If not specified, no SPAM energies will be calculated.</span></dd>
<dt class="description_label">&lt;datafile&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Data file with all SPAM energies for each snapshot.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-6188"></a>Perform profiling of bound water molecules via SPAM analysis[<a href="#LyXCite-Cui2013"><span class="bib-numericallabel">10</span></a>].
 Briefly, this method identifies and estimates the free energy profiles 
of bound waters via calculation of the distribution of interaction 
energies between the water and it's environment from explicit solvent MD
 trajectories. The interaction energies are calculated using a force- 
and energy-shifted electrostatic term with a hard cutoff.</div>

<div class="standard"><a id="magicparlabel-6189"></a>Prior to this command, the <em><b>volmap</b></em> command should be run with the <b>peakfile</b> keyword (see <a href="#subsec_cpptraj_volmap">10.83</a>) to generate the peaks file. If not using peaks from the <em><b>volmap</b></em> command, the peaks file should have one line per peak with format:</div>

<div class="lyx_code"><a id="magicparlabel-6190"></a><div class="lyx_code_item">C &lt;X&gt; &lt;Y&gt; &lt;Z&gt; &lt;Density&gt;</div>
</div>
<div class="standard"><a id="magicparlabel-6191"></a>Values of <b>dgbulk</b> and <b>dhbulk</b> for different water models can be calculated from pure water simulations with the <b>purewater</b> keyword.</div>
<h3 class="subsection"><a id="magicparlabel-6192"></a><span class="subsection_label">10.72</span> setvelocity</h3>

<div class="lyx_code"><a id="magicparlabel-6193"></a><div class="lyx_code_item">setvelocity [&lt;mask&gt;] [tempi &lt;temperature&gt; | modify] [ig &lt;random seed&gt;]
<br />

</div>
<div class="lyx_code_item">            [[ntc &lt;#&gt;]] [[dt &lt;time&gt;] [epsilon &lt;eps&gt;]]</div>
<div class="lyx_code_item">        	[zeromomentum]</div>

<dl class="description"><a id="magicparlabel-6196"></a><dt class="description_label">&lt;mask&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Mask of atoms to assign velocities to.</span></dd>
<dt class="description_label">tempi &lt;temperature&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Assign velocities at specified temperature (default 300.0 K).</span></dd>
<dt class="description_label">modify</dt>
<dd class="description_item"><span style="font-family:monospace;"> If specified, do not set, just modify any existing velocities (via 'ntc' or 'zeromomentum').</span></dd>
<dt class="description_label">ig &lt;random seed&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Random seed to use to generate velocity distribution.</span></dd>
<dt class="description_label">ntc &lt;#&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> 
Correct set velocities for SHAKE constraints. Numbers match 
sander/pmemd: 1 = no SHAKE, 2 = SHAKE on hydrogens, 3 = SHAKE on all 
atoms.</span></dd>
<dt class="description_label">dt &lt;time&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Time step for SHAKE correction.</span></dd>
<dt class="description_label">epsilon &lt;eps&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Epsilon for SHAKE correction</span></dd>
<dt class="description_label">zeromomentum</dt>
<dd class="description_item"><span style="font-family:monospace;"> If specified adjust velocities so the total momentum of atoms in &lt;mask&gt; is zero.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-6204"></a>Set velocities in frame for atoms in &lt;mask&gt; using Maxwellian distribution based on given temperature.</div>
<h3 class="subsection"><a id="magicparlabel-6205"></a><span class="subsection_label">10.73</span> stfcdiffusion</h3>

<div class="lyx_code"><a id="magicparlabel-6206"></a><div class="lyx_code_item">stfcdiffusion mask &lt;mask&gt; [out &lt;file&gt;] [time &lt;time per frame&gt;]</div>
<div class="lyx_code_item">              [mask2 &lt;mask&gt;] [lower &lt;distance&gt;] [upper &lt;distance&gt;]</div>
<div class="lyx_code_item">              [nwout &lt;file&gt;]) [avout &lt;file&gt;] [distances] [com]</div>
<div class="lyx_code_item">              [x|y|z|xy|xz|yz|xyz]
<br />

</div>

<dl class="description"><a id="magicparlabel-6210"></a><dt class="description_label">mask</dt>
<dd class="description_item"><span style="font-family:monospace;"> Atoms for which MSDs will be computed.</span></dd>
<dt class="description_label">out</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output file: time vs. MSD. </span></dd>
<dt class="description_label">time</dt>
<dd class="description_item"><span style="font-family:monospace;"> Time step in the trajectory. (1.0 ps) </span></dd>
<dt class="description_label">mask2</dt>
<dd class="description_item"><span style="font-family:monospace;"> Compute MSDs only within the lower and upper limit of mask2. IMPORTANT: may be very slow!!! </span></dd>
<dt class="description_label">lower</dt>
<dd class="description_item"><span style="font-family:monospace;"> Smaller distance from reference point(s). (0.01 Å) </span></dd>
<dt class="description_label">upper</dt>
<dd class="description_item"><span style="font-family:monospace;"> Larger distance from reference point(s). (3.5 Å) </span></dd>
<dt class="description_label">nwout</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output file containing number of water molecules in the chosen region, see mask2. (off) </span></dd>
<dt class="description_label">avout</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output file containing average distances. (off) </span></dd>
<dt class="description_label">x|y|z|xy|xz|yz|xyz</dt>
<dd class="description_item"><span style="font-family:monospace;"> Computation of the mean square displacement in the chosen dimension. (xyz) </span></dd>
<dt class="description_label">distances</dt>
<dd class="description_item"><span style="font-family:monospace;"> Dump un-imaged distances. By default only averages are output. (off) </span></dd>
<dt class="description_label">com</dt>
<dd class="description_item"><span style="font-family:monospace;"> Calculate MSD for centre of mass. (off)</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-6221"></a>Calculate diffusion
 for selected atoms using code based on the 'diffusion' routine 
developed by Hannes Loeffler at STFC (http://www.stfc.ac.uk/CSE).</div>
<h3 class="subsection"><a id="magicparlabel-6222"></a><span class="subsection_label">10.74</span> strip</h3>

<div class="lyx_code"><a id="magicparlabel-6223"></a><div class="lyx_code_item">strip<a id="magicparlabel-6227"></a>
 &lt;mask&gt; [outprefix &lt;name&gt;] [&lt;parmout&gt; file&gt;] [nobox]
<br />

</div>

<dl class="description"><a id="magicparlabel-6228"></a><dt class="description_label">&lt;mask&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Remove atoms specified by mask from the system.</span></dd>
<dt class="description_label">[outprefix &lt;prefix&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write out stripped topology file with name '&lt;prefix&gt;.&lt;Original Topology Name&gt;'.</span></dd>
<dt class="description_label">[parmout &lt;file&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write corresponding topology to file with name &lt;file&gt;.</span></dd>
<dt class="description_label">[nobox]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Remove any box information from the stripped topology.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-6232"></a>Strip all atoms specified by <b>&lt;mask&gt;</b> from the frame and modify the topology to match for any subsequent Actions. The <b>outprefix</b> keyword can be used to write stripped topologies; stripped Amber topologies are fully-functional.</div>

<div class="standard"><a id="magicparlabel-6233"></a>Note that stripping a system renumbers all atoms and residues, so for example after this command:</div>

<div class="lyx_code"><a id="magicparlabel-6234"></a><div class="lyx_code_item">strip :1</div>
</div>
<div class="standard"><a id="magicparlabel-6235"></a>residue 1 will be gone, and the former second residue will now be the first, and so on.</div>

<div class="standard"><a id="magicparlabel-6236"></a>For example, to strip all residues named WAT from each topology/coordinate frame:</div>

<div class="lyx_code"><a id="magicparlabel-6237"></a><div class="lyx_code_item">strip :WAT</div>
</div>
<div class="standard"><a id="magicparlabel-6238"></a>The next example uses a distance-based mask to strip atoms in a single frame. Note that with the exception of the <b><i>mask</i></b>
 command, distance-based masks do not update on a per-frame basis. To 
strip all residues outside of 6.0 from any atom in residues 1 to 14 and 
write out the stripped topology and coordinates, both with no box 
information:</div>

<div class="lyx_code"><a id="magicparlabel-6239"></a><div class="lyx_code_item">parm parm7 </div>
<div class="lyx_code_item">trajin frame_1000.rst.1</div>
<div class="lyx_code_item">reference frame_1000.rst.1</div>
<div class="lyx_code_item">strip !(:1-14&lt;:6.0) outprefix f1.1 nobox</div>
<div class="lyx_code_item">trajout f1.1.x restart nobox</div>
</div>
<h3 class="subsection"><a id="magicparlabel-6244"></a><span class="subsection_label">10.75</span> surf<a id="subsec_cpptraj_surf"></a>
</h3>

<div class="lyx_code"><a id="magicparlabel-6245"></a><div class="lyx_code_item">surf<a id="magicparlabel-6249"></a>
 [&lt;name&gt;] [&lt;mask1&gt;] [out &lt;filename&gt;] [solutemask &lt;mask&gt;]</div>
<div class="lyx_code_item">	[offset &lt;offset&gt;] [nbrcut &lt;cut&gt;]</div>

<dl class="description"><a id="magicparlabel-6251"></a><dt class="description_label">&lt;name&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output data set name.</span></dd>
<dt class="description_label">&lt;mask1&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Atoms to calculate surface area for.</span></dd>
<dt class="description_label">out &lt;filename&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> File to write surface area to.</span></dd>
<dt class="description_label">solutemask &lt;mask&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> If specified, calculate the contribution of &lt;mask1&gt; to &lt;mask&gt;.</span></dd>
<dt class="description_label">offset &lt;offset&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Increment van der Waals radii by &lt;offset&gt;; 1.4 Ang. is the default (as used by Amber).</span></dd>
<dt class="description_label">nbrcut &lt;cut&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Only atoms with van der Waals radii greater than &lt;cut&gt; are considered to have neighbors (2.5 Ang Amber default).</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-6257"></a>Calculate the surface area in Å<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup><mrow/>
   <mrow>
    <mstyle mathvariant="normal"><mn>2</mn>
    </mstyle>
   </mrow>
  </msup>
 </mrow></math> of atoms in &lt;mask&gt; (if no mask specified, all 
atoms not marked as 'solvent' that are part of a molecule &gt; 1 atom in
 size) using the LCPO algorithm of Weiser et al.[<a href="#LyXCite-Weiser99"><span class="bib-numericallabel">34</span></a>]. In order for this to work, the topology needs to have bond information and atom type information. </div>

<div class="standard"><a id="magicparlabel-6258"></a>Note that even if 
&lt;mask&gt; does not include all solute atoms, the neighbor list is 
still calculated for all solute atoms so the surface area calculated 
reflects the contribution of atoms in &lt;mask&gt; to the overall 
surface area, not the surface area of &lt;mask&gt; as an isolated 
system. As a result, it may be possible to obtain a negative surface 
area if only a small fraction of the solute is selected.</div>

<div class="standard"><a id="magicparlabel-6259"></a>For example, to 
calculate the overall surface area of all solute atoms, as well as the 
contribution of residue 1 to the overall surface area, writing both 
results to “surf.dat”:</div>

<div class="lyx_code"><a id="magicparlabel-6260"></a><div class="lyx_code_item">surf out surf.dat</div>
<div class="lyx_code_item">surf :1 out surf.dat</div>
</div>
<h3 class="subsection"><a id="magicparlabel-6262"></a><span class="subsection_label">10.76</span> symmrmsd<a id="subsec_cpptraj_symmrmsd"></a>
</h3>

<div class="lyx_code"><a id="magicparlabel-6263"></a><div class="lyx_code_item">symmrmsd  [&lt;name&gt;] [&lt;mask&gt;] [&lt;refmask&gt;] [out &lt;filename&gt;] [nofit] [mass] [remap]</div>
<div class="lyx_code_item">          [ first | reference | ref &lt;name&gt; | refindex &lt;#&gt; | previous |</div>
<div class="lyx_code_item">            reftraj &lt;name&gt; [parm &lt;parmname&gt; | parmindex &lt;#&gt;] ]
<br />

</div>

<dl class="description"><a id="magicparlabel-6266"></a><dt class="description_label">[&lt;name&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output data set name.</span></dd>
<dt class="description_label">[&lt;mask&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Mask of atoms to calculate RMSD for; if not specified, calculate for all atoms.</span></dd>
<dt class="description_label">[&lt;refmask&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Reference mask; if not specified, use <b>&lt;mask&gt;</b>.</span></dd>
<dt class="description_label">[out &lt;filename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output data file name.</span></dd>
<dt class="description_label">[nofit]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Do not perform best-fit RMSD (not recommended).</span></dd>
<dt class="description_label">[mass]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Mass-weight the RMSD calculation.</span></dd>
<dt class="description_label">[remap]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Re-arrange atoms according to symmetry. See below for more details.</span></dd>
</dl>
<div class="standard"><a id="magicparlabel-6273"></a><span style="font-family:monospace;">Reference keywords:</span></div>

<dl class="description"><a id="magicparlabel-6274"></a><dt class="description_label">first</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use the first trajectory frame processed as reference.</span></dd>
<dt class="description_label">reference</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use the first previously read in reference structure (refindex 0).</span></dd>
<dt class="description_label">ref &lt;name&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use previously read in reference structure specified by filename/tag.</span></dd>
<dt class="description_label">refindex &lt;#&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use previously read in reference structure specified by &lt;#&gt; (based on order read in).</span></dd>
<dt class="description_label">previous</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use frame prior to current frame as reference.</span></dd>
<dt class="description_label">reftraj &lt;name&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use 
frames from COORDS set &lt;name&gt; or read in from trajectory file 
&lt;name&gt; as references. Each frame from &lt;name&gt; is used in 
turn, so that frame 1 is compared to frame 1 from &lt;name&gt;, frame 2 
is compared to frame 2 from &lt;name&gt; and so on. If &lt;trajname&gt; 
runs out of frames before processing is complete, the last frame of 
&lt;trajname&gt; continues to be used as the reference.
<br />

</span>

<dl class="description"><a id="magicparlabel-6280"></a><dt class="description_label">parm &lt;parmname&gt; | parmindex &lt;#&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> If <b>reftraj</b> specifies a file associate trajectory &lt;name&gt; with specified topology; if not specified the first topology is used.</span></dd>
</dl>
</dd></dl>
</div>
<div class="standard"><a id="magicparlabel-6281"></a>Perform 
symmetry-corrected RMSD calculation. This is done by identifying 
potential symmetric atoms in each residue, performing an initial 
best-fit, then determining which configuration of symmetric atoms will 
give the lowest RMSD using atomic distance to reference atoms. </div>

<div class="standard"><a id="magicparlabel-6282"></a><b>Note that when 
re-mapping, all atoms in the residues of interest should be selected to 
prevent cases where selected symmetric atoms are swapped but the atoms 
they are bonded to are not</b>. Also, occasionally larger symmetric 
structures (e.g. 6 membered rings) may become distorted due to only part
 of the residue being corrected for symmetry. This appears to happen 
about 4% of the time but does not overly inflate the RMSD. The <b><i>'check'</i></b> command can be used after <b><i>symmrmsd</i></b> to look for such distortions.</div>

<div class="standard"><a id="magicparlabel-6283"></a>Warning: the 
symmetry correction is generally robust enough to account for symmetries
 in the standard amino and nucleic acid residues, but has not been 
extensively tested on residues with more extended types of symmetry.</div>
<h3 class="subsection"><a id="magicparlabel-6284"></a><span class="subsection_label">10.77</span> temperature</h3>

<div class="lyx_code"><a id="magicparlabel-6285"></a><div class="lyx_code_item">temperature [&lt;name&gt;] {frame | [&lt;mask&gt;] [ntc &lt;#&gt;]} [out &lt;filename&gt;]
<br />

</div>

<dl class="description"><a id="magicparlabel-6286"></a><dt class="description_label">[&lt;name&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Data set name.</span></dd>
<dt class="description_label">frame</dt>
<dd class="description_item"><span style="font-family:monospace;"> Do not calculate temperature; use existing frame temperature.</span></dd>
<dt class="description_label">[&lt;mask&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Atoms to calculate temperature for.</span></dd>
<dt class="description_label">[ntc &lt;#&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Value of SHAKE bond constraint: 1 - none, 2 - bonds to H, 3- all bonds (equivalent to SANDER/PMEMD).</span></dd>
<dt class="description_label">[out &lt;filename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> File to write values to.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-6291"></a>Calculate temperature in frame based on velocity information. If <b>'frame'</b> is specified just use frame temperature (read in from e.g. REMD trajectory). </div>
<h3 class="subsection"><a id="magicparlabel-6292"></a><span class="subsection_label">10.78</span> trans | translate</h3>

<div class="lyx_code"><a id="magicparlabel-6293"></a><div class="lyx_code_item">translate [&lt;mask&gt;] [x &lt;dx&gt;] [y &lt;dy&gt;] [z &lt;dz&gt;]</div>
</div>
<div class="standard"><a id="magicparlabel-6294"></a>Translate atoms in <b>&lt;mask&gt;</b> (all atoms if no mask specified) <b>&lt;dx&gt;</b> Å in the X direction, <b>&lt;dy&gt;</b> Å in the Y direction, and <b>&lt;dz&gt;</b> Å in the Z direction.</div>
<h3 class="subsection"><a id="magicparlabel-6295"></a><span class="subsection_label">10.79</span> unstrip</h3>

<div class="lyx_code"><a id="magicparlabel-6296"></a><div class="lyx_code_item">unstrip<a id="magicparlabel-6300"></a>
</div>
</div>
<div class="standard"><a id="magicparlabel-6301"></a>Requests that the 
original topology and frame be used for all following actions. This has 
the effect of undoing any command that modifies the state (such as 
strip). For example, the following code takes a solvated complex and 
uses a combination of strip, unstrip, and outtraj commands to write out 
separate dry complex, receptor, and ligand files:</div>

<div class="lyx_code"><a id="magicparlabel-6302"></a><div class="lyx_code_item">parm Complex.WAT.pdb</div>
<div class="lyx_code_item">trajin Complex.WAT.pdb</div>
<div class="lyx_code_item"># Remove water, write complex</div>
<div class="lyx_code_item">strip :WAT</div>
<div class="lyx_code_item">outtraj Complex.pdb pdb</div>
<div class="lyx_code_item"># Reset to solvated Complex</div>
<div class="lyx_code_item">unstrip</div>
<div class="lyx_code_item"># Remove water and ligand, write receptor</div>
<div class="lyx_code_item">strip :WAT,LIG</div>
<div class="lyx_code_item">outtraj Receptor.pdb pdb</div>
<div class="lyx_code_item"># Reset to solvated Complex</div>
<div class="lyx_code_item">unstrip</div>
<div class="lyx_code_item"># Remove water and receptor, write ligand</div>
<div class="lyx_code_item">strip :WAT</div>
<div class="lyx_code_item">strip !(:LIG)</div>
<div class="lyx_code_item">outtraj Ligand.pdb pdb</div>
</div>
<h3 class="subsection"><a id="magicparlabel-6318"></a><span class="subsection_label">10.80</span> unwrap</h3>

<div class="lyx_code"><a id="magicparlabel-6319"></a><div class="lyx_code_item">unwrap [center] [{bymol | byres | byatom}]</div>
<div class="lyx_code_item">       [ reference | ref &lt;name&gt; | refindex &lt;#&gt; ] [&lt;mask&gt;]
<br />

</div>

<dl class="description"><a id="magicparlabel-6321"></a><dt class="description_label">[center]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Unwrap by center of mass; otherwise unwrap by first atom position.</span></dd>
<dt class="description_label">bymol</dt>
<dd class="description_item"><span style="font-family:monospace;"> Unwrap by molecule (default).</span></dd>
<dt class="description_label">byres</dt>
<dd class="description_item"><span style="font-family:monospace;"> Unwrap by residue.</span></dd>
<dt class="description_label">byatom</dt>
<dd class="description_item"><span style="font-family:monospace;"> Unwrap by atom.</span></dd>
<dt class="description_label">[ reference | ref &lt;name&gt; | refindex &lt;#&gt; ]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Reference structure to use in unwrapping.</span></dd>
<dt class="description_label">[&lt;mask&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Selection to unwrap.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-6327"></a>Under periodic 
boundary conditions, MD trajectories are not continuous if molecules are
 wrapped(imaged) into the central unit cell. Especially, in sander, with
 <em>iwrap</em>=1, molecular trajectories become discontinuous when a molecule crosses the boundary of the unit cell. This command, <b><span style="font-family:sans-serif;">unwrap</span></b> processes the trajectories to force the <i>mask</i>ed molecules continuous by translating the molecules into the neighboring unit cells. It is the opposite function of <b><span style="font-family:sans-serif;">image</span></b>,
 but this command can also be used to place molecules side by side, for 
example, two strands of a DNA duplex. However, this command fails when 
the <i>mask</i>ed molecules travel more than half of the box size within a single frame.</div>

<div class="standard"><a id="magicparlabel-6328"></a>If the optional argument “<span style="font-family:monospace;">reference</span>”
 is specified, then the first frame is unwrapped according to the 
reference structure. Otherwise, the first frame is not modified.</div>

<div class="standard"><a id="magicparlabel-6329"></a>As an example, 
assume that :1-10 is the first strand of a DNA duplex and :11-20 is the 
other strand of the duplex. Then the following commands could be used to
 create system where the two strands are not separated artificially:</div>

<div class="lyx_code"><a id="magicparlabel-6330"></a><div class="lyx_code_item">unwrap :1-20</div>
<div class="lyx_code_item">center :1-20 mass origin</div>
<div class="lyx_code_item">image origin center familiar</div>
</div>
<h3 class="subsection"><a id="magicparlabel-6333"></a><span class="subsection_label">10.81</span> vector<a id="subsec_cpptraj_vector"></a>
</h3>

<div class="lyx_code"><a id="magicparlabel-6334"></a><div class="lyx_code_item">vector [&lt;name&gt;] &lt;Type&gt; [out &lt;filename&gt; [ptrajoutput]] [&lt;mask1&gt;] [&lt;mask2&gt;]</div>
<div class="lyx_code_item">   	[magnitude] [ired]</div>
<div class="lyx_code_item">       &lt;Type&gt; = { mask | minimage  | dipole | center | corrplane |</div>
<div class="lyx_code_item">                  box  | boxcenter | ucellx | ucelly | ucellz</div>
<div class="lyx_code_item">   	           principal [x|y|z] }
<br />

</div>

<dl class="description"><a id="magicparlabel-6339"></a><dt class="description_label">[&lt;name&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Vector data set name.</span></dd>
<dt class="description_label">&lt;Type&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Vector type; see below.</span></dd>
<dt class="description_label">[out &lt;filename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write vector data to <b>&lt;filename&gt;</b> with format 'Vx Vy Vz Ox Oy Oz' where V denotes vector coordinates and 'O' denotes origin coordinates.</span></dd>
<dt class="description_label">[ptrajoutput]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write vector data in <i>ptraj</i> style (Vx Vy Vz Ox Oy Oz Vx+Ox Vy+Oy Vz+Oz). This prevents additional formatting of <b>&lt;filename&gt;</b> and is not compatible with <b>'magnitude'</b>.</span></dd>
<dt class="description_label">[&lt;mask1&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Atom mask, required for all types except <b>'box'</b>.</span></dd>
<dt class="description_label">[&lt;mask2&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Second atom mask, only required for type <b>'mask'</b>.</span></dd>
<dt class="description_label">[magnitude]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Store the magnitude of the vector with aspect [Mag].</span></dd>
<dt class="description_label">[ired]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Mark this vector for subsequent IRED analysis with commands 'matrix ired' and 'ired'.</span></dd>
</dl>
<div class="standard"><a id="magicparlabel-6347"></a><span style="font-family:monospace;">Data Sets Created:</span></div>

<dl class="description"><a id="magicparlabel-6348"></a><dt class="description_label">&lt;name&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Vector data set.</span></dd>
<dt class="description_label">&lt;name&gt;[Mag]</dt>
<dd class="description_item"><span style="font-family:monospace;"> (<b>magnitude</b> only) Vector magnitude.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-6350"></a>This command will 
keep track of a vector value (and its origin) over the trajectory; the 
data can be referenced for later use based on the <i>name</i> (which must be unique). The types of vectors that can be calculated are:</div>

<dl class="description"><a id="magicparlabel-6351"></a><dt class="description_label">mask</dt>
<dd class="description_item"> (Default) Store vector from center of mass of atoms in <b>&lt;mask1&gt;</b> to atoms in <b>&lt;mask2&gt;</b>.</dd>
<dt class="description_label">minimage</dt>
<dd class="description_item"> Store minimum-imaged vector from center of mass of atoms in <b>&lt;mask1&gt;</b> to atoms in <b>&lt;mask2&gt;</b>.</dd>
<dt class="description_label">dipole</dt>
<dd class="description_item"> Store the dipole and center of mass of the atoms specified in <b>&lt;mask1&gt;</b>.
 The vector is not converted to appropriate units, nor is the value 
well-defined if the atoms in the mask are not overall charge neutral.</dd>
<dt class="description_label">center</dt>
<dd class="description_item"> Store the center of mass of atoms in <b>&lt;mask1&gt;</b>. The reference point is the origin (0.0, 0.0, 0.0).</dd>
<dt class="description_label">corrplane</dt>
<dd class="description_item"> This defines a vector perpendicular to the (least-squares best) plane through the atoms in <b>&lt;mask1&gt;</b>. The reference point is the center of mass of atoms in <b>&lt;mask1&gt;</b>.</dd>
<dt class="description_label">box</dt>
<dd class="description_item"> (No mask needed) Store the box lengths of the trajectory. The reference point is the origin (0.0, 0.0, 0.0). </dd>
<dt class="description_label">boxcenter</dt>
<dd class="description_item"> (No mask needed) Store the center of the box as a vector.</dd>
<dt class="description_label">ucell{x|y|z}:</dt>
<dd class="description_item"> (No mask needed) Store specified unit cell (i.e. box) vector.</dd>
<dt class="description_label">principal [x|y|z]</dt>
<dd class="description_item"> Store one of the principal axis vectors 
determined by diagonalization of the inertial matrix from the 
coordinates of the atoms specified by <b>&lt;mask1&gt;</b>. The eigenvector with the largest eigenvalue is considered “<span style="font-family:monospace;">x</span>” (i.e., the hardest axis to rotate around) and the eigenvector with the smallest eigenvalue is considered “<span style="font-family:monospace;">z</span>”. If none of <span style="font-family:monospace;">x</span> or <span style="font-family:monospace;">y</span> or <span style="font-family:monospace;">z</span> are specified, then the “x” principal axis is stored. The reference point is the center of mass of atoms in <b>&lt;mask1&gt;</b>.</dd>
</dl>
<div class="standard"><a id="magicparlabel-6360"></a>Cpptraj supports 
writing out vector data in a pseudo-trajectory format for easy 
visualization. Once a vector data set has been generated the writedata 
command can be used with the vectraj keyword (see <a href="#sec_Datafile_Commands">5</a>
 for more details) to write a pseudo trajectory consisting of two atoms,
 one for the vector origin and one for the vector from the origin (i.e. 
V+O). For example, to create a MOL2 containing a pseudo-trajectory of 
the minimum-imaged vector from residue 4 to residue 11:</div>

<div class="lyx_code"><a id="magicparlabel-6361"></a><div class="lyx_code_item">trajin tz2.nc</div>
<div class="lyx_code_item">vector v8 minimage out v8.dat :4 :11 </div>
<div class="lyx_code_item">run</div>
<div class="lyx_code_item">writedata v8.mol2 vectraj v8 trajfmt mol2 </div>
</div>
<div class="standard"><a id="magicparlabel-6365"></a>Auto-correlation or cross-correlation functions can be calculated subsequently for vectors using either the <em><b>corr</b></em> analysis command or the <b><i>timecorr</i></b> analysis command (to calculate via spherical harmonic theory).</div>
<h3 class="subsection"><a id="magicparlabel-6366"></a><span class="subsection_label">10.82</span> velocityautocorr</h3>

<div class="lyx_code"><a id="magicparlabel-6367"></a><div class="lyx_code_item">velocityautocorr [&lt;set name&gt;] [&lt;mask&gt;] [usevelocity] [out &lt;filename&gt;] [diffout &lt;file&gt;]</div>
<div class="lyx_code_item">                 [maxlag &lt;frames&gt;] [tstep &lt;timestep&gt;] [direct] [norm]
<br />

</div>

<dl class="description"><a id="magicparlabel-6369"></a><dt class="description_label">[&lt;set name&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Data set name.</span></dd>
<dt class="description_label">[&lt;mask&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Atoms(s) to calculate velocity autocorrelation (VAC) function for.</span></dd>
<dt class="description_label">[usevelocity]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use 
velocity information in frame if present. This will only give sensible 
results if the velocities are recorded close to the order of the 
simulation time step.</span></dd>
<dt class="description_label">[out &lt;filename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write VAC function to &lt;filename&gt;.</span></dd>
<dt class="description_label">[diffout &lt;file&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> File to write diffusion constants to.</span></dd>
<dt class="description_label">[maxlag &lt;frames&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Maximum lag in frames to calculate VAC function for. Default is half the total number of frames.</span></dd>
<dt class="description_label">[tstep &lt;timestep&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Time between frames in ps (default 1.0).</span></dd>
<dt class="description_label">[direct]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Calculate VAC function directly instead of via FFT (will be much slower).</span></dd>
<dt class="description_label">[norm]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Normalize resulting VAC function to 1.0.</span></dd>
</dl>
<div class="standard"><a id="magicparlabel-6378"></a><span style="font-family:monospace;">DataSet Aspects:</span></div>

<dl class="description"><a id="magicparlabel-6379"></a><dt class="description_label">[D]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Diffusion constant calculated from integral over VAC function in 1x10<sup class="script_superscript">-5</sup> cm<sup class="script_superscript">2</sup>/s.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-6388"></a>Calculate the 
velocity autocorrelation (VAC) function averaged over the atoms in 
&lt;mask&gt;. Pseudo-velocities are calculated using coordinates and the
 specified time step. As with all time correlation functions the 
statistical noise will increase if the maximum lag is greater than half 
the total number of frames. In addition to calculating the velocity 
autocorrelation function, the self-diffusion coefficient will be 
reported in the output, calculated from the integral over the VAC 
function.</div>
<h3 class="subsection"><a id="magicparlabel-6389"></a><span class="subsection_label">10.83</span> volmap<a id="subsec_cpptraj_volmap"></a>
</h3>

<div class="lyx_code"><a id="magicparlabel-6390"></a><div class="lyx_code_item">volmap filename dx dy dz &lt;mask&gt; [radscale &lt;factor&gt;]</div>
<div class="lyx_code_item">   	{ data &lt;existing set&gt; |</div>
<div class="lyx_code_item">   	  name &lt;setname&gt; { size &lt;x,y,z&gt; [center &lt;x,y,z&gt;] |</div>
<div class="lyx_code_item">   	                   centermask &lt;mask&gt; [buffer &lt;buffer&gt;] } }</div>
<div class="lyx_code_item">   	[peakcut &lt;cutoff&gt;] [peakfile &lt;xyzfile&gt;]
<br />

</div>

<dl class="description"><a id="magicparlabel-6395"></a><dt class="description_label">filename</dt>
<dd class="description_item"> <span style="font-family:monospace;">The name of the output file with the grid density.</span></dd>
<dt class="description_label">dx, dy, dz</dt>
<dd class="description_item"> <span style="font-family:monospace;">The grid spacing (Angstroms) in the X-, Y-, and Z-dimensions, respectively</span></dd>
<dt class="description_label">&lt;mask&gt;</dt>
<dd class="description_item"> <span style="font-family:monospace;">The atom selection from which to calculate the number density.</span></dd>
<dt class="description_label">radscale &lt;factor&gt;</dt>
<dd class="description_item"> <span style="font-family:monospace;">Factor
 by which to scale radii (by division). To match the atomic radius of 
Oxygen used by the VMD volmap tool, a scaling factor of 1.36 should be 
used. Default 1.0.</span></dd>
<dt class="description_label">data &lt;setname&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Name of existing grid data set to use.</span></dd>
<dt class="description_label">name &lt;setname&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Name of grid set that will be created (<b>size/center</b> or <b>centermask/buffer</b> keywords).</span></dd>
<dt class="description_label">size &lt;x,y,z&gt;</dt>
<dd class="description_item"> <span style="font-family:monospace;">Specify the size of the grid in the X-, Y-, and Z-dimensions. Must be used alongside the center argument.</span></dd>
<dt class="description_label">center &lt;x,y,z&gt;</dt>
<dd class="description_item"> <span style="font-family:monospace;">Specify the grid center explicitly. Note, the size argument must be present in this case. Default is the origin.</span></dd>
<dt class="description_label">centermask &lt;mask&gt;</dt>
<dd class="description_item"> <span style="font-family:monospace;">The 
mask around which the grid should be centered (via geometric center). If
 this is omitted and the center and size are not specified, the default 
&lt;mask&gt; entered (see above) is used in its place.</span></dd>
<dt class="description_label">buffer &lt;buffer&gt;</dt>
<dd class="description_item"> <span style="font-family:monospace;">A 
buffer distance, in Angstroms, by which the edges of the grid should 
clear every atom of the centermask (or default mask if centermask is 
omitted) in every direction. The default value is 3. The buffer is 
ignored if the center and size are specified (see below).</span></dd>
<dt class="description_label">peakcut &lt;cutoff&gt;</dt>
<dd class="description_item"> <span style="font-family:monospace;">The minimum density required to consider a local maximum a 'density peak' in the outputted peak file (default 0.05).</span></dd>
<dt class="description_label">peakfile &lt;xyzfile&gt;</dt>
<dd class="description_item"> <span style="font-family:monospace;">A 
file in XYZ-format that contains a carbon atom centered at the grid 
point of every local density maximum. This file is necessary input to 
the spam action command.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-6407"></a>Grid data as a 
volumetric map, similar to the 'volmap' command in VMD. The density is 
calculated by treating each atom as a 3-dimensional Gaussian function 
whose standard deviation is equal to the van der Waals radius. The 
density calculated is the number density averaged over the entire 
simulation. The grid can be specified in one of three ways:</div>

<ol class="enumerate"><a id="magicparlabel-6408"></a><li class="enumerate_item">An existing grid data set (from e.g. bounds), specified with the <b>data</b> keyword.</li>
<li class="enumerate_item">Via the sizes and center specified by the <b>size</b> and <b>center</b> keywords (comma-separated strings, e.g. '20,20,20').</li>
<li class="enumerate_item">Centered on the atoms in the mask given by <b>centermask</b> with an additional buffer in each direction specified by <b>buffer</b>.</li>
</ol>
<h3 class="subsection"><a id="magicparlabel-6411"></a><span class="subsection_label">10.84</span> volume</h3>

<div class="lyx_code"><a id="magicparlabel-6412"></a><div class="lyx_code_item">volume [&lt;name&gt;] [out &lt;filename&gt;]
<br />

</div>

<dl class="description"><a id="magicparlabel-6413"></a><dt class="description_label">&lt;name&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Data set name.</span></dd>
<dt class="description_label">out &lt;filename&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output file name.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-6415"></a>Calculate unit cell volume.</div>
<h3 class="subsection"><a id="magicparlabel-6416"></a><span class="subsection_label">10.85</span> watershell</h3>

<div class="lyx_code"><a id="magicparlabel-6417"></a><div class="lyx_code_item">watershell &lt;solutemask&gt; [out &lt;filename&gt;] [lower &lt;lower cut&gt;] [upper &lt;upper cut&gt;]</div>
<div class="lyx_code_item">           [noimage] [&lt;solventmask&gt;]
<br />

</div>

<dl class="description"><a id="magicparlabel-6419"></a><dt class="description_label">&lt;solutemask&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Atom mask corresponding to solute of interest (required).</span></dd>
<dt class="description_label">[out &lt;filename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output file name.</span></dd>
<dt class="description_label">[lower &lt;lower cut&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Cutoff for the first water shell (default 3.4 Angstroms).</span></dd>
<dt class="description_label">[upper &lt;upper cut&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Cutoff for the second water shell (default 5.0 Angstroms).</span></dd>
<dt class="description_label">[noimage]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Do not image distances.</span></dd>
<dt class="description_label">[&lt;solventmask&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Optional atom mask corresponding to solvent.</span></dd>
</dl>
<div class="standard"><a id="magicparlabel-6425"></a><span style="font-family:monospace;">DataSet Aspects:</span></div>

<dl class="description"><a id="magicparlabel-6426"></a><dt class="description_label">[lower]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Number of solvent molecules in first solvent shell.</span></dd>
<dt class="description_label">[upper]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Number of solvent molecules in second solvent shell.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-6428"></a>This option will 
count the number of waters within a certain distance of the atoms in the
 &lt;solutemask&gt; in order to represent the first and second solvation
 shells. The optional &lt;solventmask&gt; can be used to consider other 
atoms as the solvent; the default is “:WAT”.</div>

<div class="standard"><a id="magicparlabel-6429"></a>This action is often used prior to the <b><i>closest</i></b>
 command in order to determine how many waters around a solute should be
 retained to maintain the first and/or second water shells.</div>

<div class="standard"><a id="magicparlabel-6430"></a>As of version 17 this command is CUDA-enabled in CUDA versions of CPPTRAJ.</div>
<h2 class="section"><a id="magicparlabel-6431"></a><span class="section_label">11</span> Analysis Commands</h2>
<div class="standard"><a id="magicparlabel-6432"></a>Analyses in <em>cpptraj</em> operate on data sets which have been generated by Actions in a prior Run or read in with a <em><b>readdata</b></em> command (<a href="#subsec_cpptraj_readdata">7.18</a>). Unlike <em>ptraj</em>, Analysis commands in <em>cpptraj</em> do not need to be prefaced with <span style="font-family:monospace;">'analysis'</span>. The exception to this is '<em><b>analyze matrix</b></em>' in order to differentiate it from the <em><b>matrix</b></em> Action command; users are encouraged to use the new command <em><b>diagmatrix</b></em> instead.</div>

<div class="standard"><a id="magicparlabel-6433"></a>Like Actions, when 
an Analysis command is issued it is by default added to the Analysis 
queue and is not executed until after trajectory processing is 
completed; a complete list of data sets available for analysis is shown 
after trajectory processing (prefaced by 'DATASETS') or can be shown 
with the '<em><b>list dataset</b></em>' command. Analyses can also be executed immediately via the <em><b>runanalysis</b></em> command (<a href="#subsec_cpptraj_runanalysis">7.23</a>).</div>

<div class="standard"><a id="magicparlabel-6434"></a>Note that for 
Analysis commands that use COORDS data sets, if no COORDS data set is 
specified then a default one will be automatically created from frames 
read in by <em><b>trajin</b></em> commands.
<br />

</div>




<div class="standard" style="text-align: center;"><a id="magicparlabel-6435"></a><div class="longtable" style="text-align: center;"><table><tbody><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6580"></a><b>Command</b></div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6583"></a><b>Description</b></div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6586"></a><b>Set Type(s)</b></div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6589"></a>autocorr</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6592"></a>Calculate autocorrelation function for multiple data sets.</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6595"></a>N 1D sclar</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6598"></a>avg</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6601"></a>Calculate average, standard deviation, min, and max for (or over) data sets.</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6604"></a>N 1D scalar</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6607"></a>calcstate</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6610"></a>Calculate states based on given data sets and criteria.</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6613"></a>N 1D scalar</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6616"></a>cluster</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6619"></a>Perform cluster analysis.</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6622"></a>COORDS, N 1D scalar</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6625"></a>corr,</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6628"></a>Calculate auto or cross correlation for 1 or 2 data sets.</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6631"></a>1D scalar, vector</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6634"></a> correlationcoe</div>
</td>
<td valign="top" align="center">

</td>
<td valign="top" align="center">

</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6643"></a>cphstats</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6646"></a>Calculate statistics for constant pH data sets.</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6649"></a>pH data sets</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6652"></a>crank, </div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6655"></a>Calculate crankshaft motion between two data sets.</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6658"></a>2 1D scalar</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6661"></a>crankshaft</div>
</td>
<td valign="top" align="center">

</td>
<td valign="top" align="center">

</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6670"></a>crdfluct</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6673"></a>Calculate atomic fluctuations (RMSF) for atoms over time blocks.</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6676"></a>COORDS</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6679"></a>crosscorr</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6682"></a>Calculate a matrix of Pearson product-moment </div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6685"></a>N 1D scalar</div>
</td>
</tr><tr><td valign="top" align="center">

</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6691"></a>coefficients between given data sets.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6697"></a>curvefit</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6700"></a>Perform non-linear curve fitting on given data set.</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6703"></a>1D scalar</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6706"></a>diagmatrix</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6709"></a>Calculate eigenvectors and eigenvalues from given symmetric matrix.</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6712"></a>symmetric matrix</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6715"></a>divergence</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6718"></a>Calculate Kullback-Leibler divergence between two data sets.</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6721"></a>2 1D scalar</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6724"></a>FFT</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6727"></a>Perform a fast Fourier transform on data sets.</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6730"></a>N 1D scalar</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6733"></a>hist, histogram</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6736"></a>Calculate N-dimensional histogram for N given data sets.</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6739"></a>N 1D scalar</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6742"></a>integrate</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6745"></a>Perform integration on each of the given data sets.</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6748"></a>N 1D scalar</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6751"></a>ired</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6754"></a>Perform isotropic reorientational eigenmode dynamics</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6757"></a>N IRED vectors</div>
</td>
</tr><tr><td valign="top" align="center">

</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6763"></a> analysis using given IRED vectors.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6769"></a>kde</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6772"></a>Calculate 1D histogram from given data set using a kernel density estimator.</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6775"></a>1 or 2 1D scalar</div>
</td>
</tr><tr><td valign="top" align="center">

</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6781"></a>Also time-dependent Kullback-Leibler divergence analysis with another set.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6787"></a>lifetime</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6790"></a>Perform lifetime analysis on given data sets.</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6793"></a>N 1D scalar</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6796"></a>lowestcurve</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6799"></a>For each given data set, calculate a curve that traces </div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6802"></a>N 1D scalar</div>
</td>
</tr><tr><td valign="top" align="center">

</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6808"></a>the lowest N points over specified bins.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6814"></a>meltcurve</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6817"></a>Calculate a melting curve from given data sets assuming simple 2 state kinetics.</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6820"></a>N 1D scalar</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6823"></a>modes</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6826"></a>Perform various analyses on eigenmodes (from e.g. <em><b>diagmatrix</b></em>).</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6829"></a>eigenmodes</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6832"></a>multicurve</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6835"></a>Perform non-linear curve fitting for multiple input data sets.</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6838"></a>N 1D scalar</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6841"></a>multihist</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6844"></a>Calculate 1D histograms (optionally with a kernel</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6847"></a>N 1D scalar</div>
</td>
</tr><tr><td valign="top" align="center">

</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6853"></a> density estimator) from multiple input data sets.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6859"></a>phipsi</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6862"></a>Calculate and plot the average phi and psi values from input dihedral data sets.</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6865"></a>N phi/psi dihedrals</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6868"></a>regress</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6871"></a>Perform linear regression on multiple input data sets.</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6874"></a>N 1D scalar</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6877"></a>remlog</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6880"></a>Calculate various statistics from a replica log data set.</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6883"></a>replica log</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6886"></a>rms2d, 2drms</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6889"></a>Calculate 2D RMSD between frames in 1 or 2 COORDS data sets.</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6892"></a>1 or 2 COORDS</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6895"></a>rmsavgcorr</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6898"></a>Calculate RMS average correlation curve for a COORDS data set.</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6901"></a>COORDS</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6904"></a>rotdif</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6907"></a>Calculate rotational diffusion using given rotation matrices (from e.g. <em><b>rms</b></em>).</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6910"></a>rotation matrices</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6913"></a>runningavg</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6916"></a>Calculate running average for given data sets using given window size.</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6919"></a>N 1D scalar</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6922"></a>spline</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6925"></a>Calculate cubic splines for given data sets.</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6928"></a>N 1D scalar</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6931"></a>stat, statistics</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6934"></a>Calculate various statistics for given data sets.</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6937"></a>N 1D scalar</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6940"></a>ti</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6943"></a>Peform Gaussian quadrature integration for given DV/DL data sets.</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6946"></a>N 1D scalar</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6949"></a>timecorr</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6952"></a>Calculate auto/cross-correlation functions for given</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6955"></a>1 or 2 vector</div>
</td>
</tr><tr><td valign="top" align="center">

</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6961"></a> vector(s) using spherical harmonics.</div>
</td>
<td valign="top" align="center">

</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6967"></a>vectormath</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6970"></a>Perform math on given vector data sets.</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6973"></a>2 vector</div>
</td>
</tr><tr><td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6976"></a>wavelet</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6979"></a>Perform wavelet analysis on coordinates from given COORDS set.</div>
</td>
<td valign="top" align="center">
<div class="plain_layout"><a id="magicparlabel-6982"></a>COORDS</div>
</td>
</tr></tbody>
</table>
</div>
</div>
<h3 class="subsection"><a id="magicparlabel-6983"></a><span class="subsection_label">11.1</span> autocorr</h3>

<div class="lyx_code"><a id="magicparlabel-6984"></a><div class="lyx_code_item">autocorr [name &lt;dsetname&gt;] &lt;dsetarg0&gt; [&lt;dsetarg1&gt; ...] [out &lt;filename&gt;]</div>
<div class="lyx_code_item">         [lagmax &lt;lag&gt;] [nocovar] [direct]
<br />

</div>

<dl class="description"><a id="magicparlabel-6986"></a><dt class="description_label">&lt;dsetarg0&gt; [dsetarg1&gt; ...]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Argument(s) specifying datasets to be used.</span></dd>
<dt class="description_label">[name &lt;dsetname&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Store results in dataset(s) named &lt;dsetname&gt;:X.</span></dd>
<dt class="description_label">[out &lt;filename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write results to file named &lt;filename&gt;.</span></dd>
<dt class="description_label">[lagmax]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Maximum lag to calculate for. If not specified all frames are used.</span></dd>
<dt class="description_label">[nocovar]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Do not calculate covariance.</span></dd>
<dt class="description_label">[direct]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Do not use FFTs to calculate correlation; this will be much slower.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-6992"></a><i>This is for integer/double/float datasets only; for vectors see the <b>'timecorr'</b> command.</i></div>

<div class="standard"><a id="magicparlabel-6993"></a>Calculate 
auto-correlation (actually auto-covariance by default) function for 
datasets specified by one or more dataset arguments. The datasets must 
have the same # of data points.</div>
<h3 class="subsection"><a id="magicparlabel-6994"></a><span class="subsection_label">11.2</span> avg</h3>

<div class="lyx_code"><a id="magicparlabel-6995"></a><div class="lyx_code_item">avg &lt;dset0&gt; [&lt;dset1&gt; ...] [torsion] [out &lt;file&gt;] [oversets]</div>
<div class="lyx_code_item">    [name &lt;name&gt;] [nostdout]
<br />

</div>

<dl class="description"><a id="magicparlabel-6997"></a><dt class="description_label">&lt;dsetX&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Data set(s) to calculate the average for.</span></dd>
<dt class="description_label">[torsion]</dt>
<dd class="description_item"><span style="font-family:monospace;"> If the data sets are not already marked periodic (e.g. if read in via 'readdata'), treat them as periodic torsion.</span></dd>
<dt class="description_label">[out &lt;file&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> File to write results to.</span></dd>
<dt class="description_label">[oversets]</dt>
<dd class="description_item"><span style="font-family:monospace;"> If specified, calculate the average over all inpout sets instead of each input set.</span></dd>
<dt class="description_label">[name &lt;name&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output data set name.</span></dd>
<dt class="description_label">[nostdout]</dt>
<dd class="description_item"><span style="font-family:monospace;"> If 'nostdout' specified do not write averages to STDOUT when 'out' not specified.</span></dd>
</dl>
<div class="standard"><a id="magicparlabel-7003"></a><span style="font-family:monospace;">DataSets Created (not <b>oversets</b>):</span></div>

<dl class="description"><a id="magicparlabel-7004"></a><dt class="description_label">&lt;name&gt;[avg]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Average of each set.</span></dd>
<dt class="description_label">&lt;name&gt;[sd]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Standard deviation of each set.</span></dd>
<dt class="description_label">&lt;name&gt;[ymin]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Y minimum of each set.</span></dd>
<dt class="description_label">&lt;name&gt;[ymax]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Y maximum of each set.</span></dd>
<dt class="description_label">&lt;name&gt;[yminidx]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Index of minimum Y value.</span></dd>
<dt class="description_label">&lt;name&gt;[ymaxidx]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Index of maximum Y value.</span></dd>
<dt class="description_label">&lt;name&gt;[names]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Name of each set.</span></dd>
</dl>
<div class="standard"><a id="magicparlabel-7011"></a><span style="font-family:monospace;">DataSets Created (oversets)</span></div>

<dl class="description"><a id="magicparlabel-7012"></a><dt class="description_label">&lt;name&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Average over all input sets for each frame.</span></dd>
<dt class="description_label">&lt;name&gt;[SD]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Standard deviation over all input sets for each frame.</span></dd>
</dl>
<div class="lyx_code_item"></div>
</div>
<div class="standard"><a id="magicparlabel-7015"></a>Calculate the average, standard deviation, min, and max of given 1D data sets. Alternatively, if <b>oversets</b> is specified the average over each set for each point is calculated; this requires all input sets be the same size.</div>

<div class="standard"><a id="magicparlabel-7016"></a>For example, to read in data from a file named perres.peptide.dat and calculate the averages etc for all the input sets:</div>

<div class="lyx_code"><a id="magicparlabel-7017"></a><div class="lyx_code_item">readdata perres.peptide.dat </div>
<div class="lyx_code_item">avg perres.peptide.dat out output.dat name V </div>
</div>
<h3 class="subsection"><a id="magicparlabel-7019"></a><span class="subsection_label">11.3</span> calcstate</h3>

<div class="lyx_code"><a id="magicparlabel-7020"></a><div class="lyx_code_item">calcstate {state &lt;ID&gt;,&lt;dataset&gt;,&lt;min&gt;,&lt;max&gt;} [out &lt;state v time file&gt;] [name &lt;setname&gt;]</div>
<div class="lyx_code_item">          [curveout &lt;curve file&gt;] [stateout &lt;states file&gt;] [transout &lt;transitions file&gt;]
<br />

</div>

<dl class="description"><a id="magicparlabel-7022"></a><dt class="description_label">state &lt;ID&gt;,&lt;dataset&gt;,&lt;min&gt;,&lt;max&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Define a state according to given data set and criteria. Multiple states can be given.
<br />

</span>

<dl class="description"><a id="magicparlabel-7023"></a><dt class="description_label">&lt;ID&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> ID to give each state index (e.g. 1, 2, etc). State indices start at 0. -1 means “undefined state”.</span></dd>
<dt class="description_label">&lt;dataset&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Data set to use.</span></dd>
<dt class="description_label">&lt;min&gt;,&lt;max&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Frames with data set value above &lt;min&gt; and below &lt;max&gt; will be assigned &lt;ID&gt;.</span></dd>
</dl>
</dd><dt class="description_label">[out &lt;state v time file&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> File to write state index vs frame to.</span></dd>
<dt class="description_label">[name &lt;setname&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Data set name.</span></dd>
<dt class="description_label">[curveout &lt;curve file&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> File to write state lifetime and transition curves to.</span></dd>
<dt class="description_label">[stateout &lt;states file&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> File to write state lifetime data to.</span></dd>
<dt class="description_label">[transout &lt;transitions file&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> File to write state transition data to.</span></dd>
</dl>
<div class="standard"><a id="magicparlabel-7031"></a><span style="font-family:monospace;">DataSets Created:</span></div>

<dl class="description"><a id="magicparlabel-7032"></a><dt class="description_label">&lt;setname&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> State index vs frame.</span></dd>
<dt class="description_label">&lt;setname&gt;[sCurve]:X</dt>
<dd class="description_item"><span style="font-family:monospace;"> State curves; lifetime curve for transitions from given state to any other state.</span></dd>
<dt class="description_label">&lt;setname&gt;[tCurve]:X</dt>
<dd class="description_item"><span style="font-family:monospace;"> Transition curves; lifetime curve for transitions from given state to other specific state.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-7035"></a>Data for the 
specified data set(s) that matches the given criteria will be assigned a
 state index. State indices start from 0 and match the order in which <b>state</b> keywords were given. For example, the following input:</div>

<div class="lyx_code"><a id="magicparlabel-7036"></a><div class="lyx_code_item">parm DPDP.parm7</div>
<div class="lyx_code_item">trajin DPDP.nc</div>
<div class="lyx_code_item">distance d1 :19@O :12@N</div>
<div class="lyx_code_item">angle a1 :19@O :12@H :12@N</div>
<div class="lyx_code_item">calcstate state D,d1,3.0,4.0 state A,a1,100,120 out state.dat curveout curve.agr \</div>
<div class="lyx_code_item">                stateout States.dat transout States.dat name d1_a1</div>
<div class="lyx_code_item">run</div>
</div>
<div class="standard"><a id="magicparlabel-7043"></a>Defines two states.
 State index 0 is defined as a state named “D” based on the distance 
from ':19@O' to ':12@N' being between 3 and 4 Angstroms. State index 1 
is defined as a state named “A” based on the angle between ':19@O', 
':12@H', and ':12@N' being between 100 and 120 degrees. The output in 
state.dat might look like:</div>

<div class="lyx_code"><a id="magicparlabel-7044"></a><div class="lyx_code_item">#Frame          d1_a1</div>
<div class="lyx_code_item">       1           -1</div>
<div class="lyx_code_item">       2            0</div>
<div class="lyx_code_item">       3            0</div>
<div class="lyx_code_item">       4            0</div>
<div class="lyx_code_item">       5           -1</div>
<div class="lyx_code_item">       6            1</div>
<div class="lyx_code_item">       7           -1</div>
<div class="lyx_code_item">       8           -1</div>
<div class="lyx_code_item">       9            0</div>
<div class="lyx_code_item">      10           -1</div>
</div>
<div class="standard"><a id="magicparlabel-7055"></a>where the values in column d1_a1 refer to state index: -1 is undefined, 0 is state “D”, and 1 is state “A”.</div>

<div class="standard"><a id="magicparlabel-7056"></a>Lifetime curves (see <a href="#subsec_cpptraj_lifetime">11.18</a>
 for further explanation) are calculated for transitions from each state
 to any other state (aspect [sCurve]) and each state to each other state
 (aspect [tCurve]). In this case there will be 3 sCurves and 4 tCurves:</div>

<div class="lyx_code"><a id="magicparlabel-7057"></a><div class="lyx_code_item">d1_a1[sCurve]:0 "Undefined" (double), size is 10 </div>
<div class="lyx_code_item">d1_a1[sCurve]:1 "D" (double), size is 3 </div>
<div class="lyx_code_item">d1_a1[sCurve]:2 "A" (double), size is 1 </div>
<div class="lyx_code_item">d1_a1[tCurve]:0 "Undefined-&gt;D" (double), size is 10</div>
<div class="lyx_code_item">d1_a1[tCurve]:1 "D-&gt;Undefined" (double), size is 3</div>
<div class="lyx_code_item">d1_a1[tCurve]:2 "Undefined-&gt;A" (double), size is 1</div>
<div class="lyx_code_item">d1_a1[tCurve]:3 "A-&gt;Undefined" (double), size is 1</div>
</div>
<div class="standard"><a id="magicparlabel-7064"></a>Lifetime analysis from each state to any other state is directed to the file specified by <b>stateout</b> and has format:</div>

<div class="lyx_code"><a id="magicparlabel-7065"></a><div class="lyx_code_item">#Index N Average Max State</div>
</div>
<div class="standard"><a id="magicparlabel-7066"></a>Where <span style="font-family:monospace;">#Index</span> is the state index, <span style="font-family:monospace;">N</span> is the number of lifetimes in that state, <span style="font-family:monospace;">Average</span> is the average lifetime while in that state (in frames), <span style="font-family:monospace;">Max</span> is the maximum lifetime while in that state (in frames) and <span style="font-family:monospace;">State</span> is the name of the state.</div>

<div class="standard"><a id="magicparlabel-7067"></a>Finally, lifetime 
analysis of transitions from each state to each other state is directory
 to the file specified by transout and has format:</div>

<div class="lyx_code"><a id="magicparlabel-7068"></a><div class="lyx_code_item">#N Average Max Transition</div>
</div>
<div class="standard"><a id="magicparlabel-7069"></a>Where <span style="font-family:monospace;">#N</span> is the number of transitions, <span style="font-family:monospace;">Average</span> is the average lifetime (in frames) in the first state before transitioning to the second state, <span style="font-family:monospace;">Max</span> is the max lifetime (in frames) before transitioning to the second state, and <span style="font-family:monospace;">Transition</span> is the name of the transition.</div>
<h3 class="subsection"><a id="magicparlabel-7070"></a><span class="subsection_label">11.4</span> <a id="subsec_cpptraj_cluster_analysis"></a>
cluster</h3>

<div class="lyx_code"><a id="magicparlabel-7071"></a><div class="lyx_code_item">cluster<a id="magicparlabel-7075"></a>
 [crdset &lt;crd set&gt; | nocoords]</div>
<div class="lyx_code_item">  Algorithms:</div>
<div class="lyx_code_item">	[hieragglo [epsilon &lt;e&gt;] [clusters &lt;n&gt;] [linkage|averagelinkage|complete]</div>
<div class="lyx_code_item">      [epsilonplot &lt;file&gt;] [includesieved_cdist]]</div>
<div class="lyx_code_item">	[dbscan minpoints &lt;n&gt; epsilon &lt;e&gt; [sievetoframe] [kdist &lt;k&gt; [kfile &lt;prefix&gt;]]]</div>
<div class="lyx_code_item">    [dpeaks epsilon &lt;e&gt; [noise] [dvdfile &lt;density_vs_dist_file&gt;]</div>
<div class="lyx_code_item">	  [choosepoints {manual | auto}]</div>
<div class="lyx_code_item">	  [distancecut &lt;distcut&gt;] [densitycut &lt;densitycut&gt;]</div>
<div class="lyx_code_item">	  [runavg &lt;runavg_file&gt;] [deltafile &lt;file&gt;] [gauss]]</div>
<div class="lyx_code_item">    [kmeans clusters &lt;n&gt; [randompoint [kseed &lt;seed&gt;]] [maxit &lt;iterations&gt;]</div>
<div class="lyx_code_item">    [{readtxt|readinfo} infofile &lt;file&gt;]</div>
<div class="lyx_code_item">  Distance options:</div>
<div class="lyx_code_item">	{[[rms | srmsd] [&lt;mask&gt;] [mass] [nofit]] | [dme [&lt;mask&gt;]] |</div>
<div class="lyx_code_item">      [data &lt;dset0&gt;[,&lt;dset1&gt;,...]]}</div>
<div class="lyx_code_item">	[sieve &lt;#&gt; [random [sieveseed &lt;#&gt;]]] [loadpairdist] [savepairdist] [pairdist &lt;file&gt;]</div>
<div class="lyx_code_item">    [pairwisecache {mem | none}] [includesieveincalc]</div>
<div class="lyx_code_item">  Output options:</div>
<div class="lyx_code_item">	[out &lt;cnumvtime&gt;] [gracecolor] [summary &lt;summaryfile&gt;] [info &lt;infofile&gt;]</div>
<div class="lyx_code_item">	[summarysplit &lt;splitfile&gt;] [splitframe &lt;comma-separated frame list&gt;]</div>
<div class="lyx_code_item">    [clustersvtime &lt;filename&gt; cvtwindow &lt;window size&gt;]</div>
<div class="lyx_code_item">	[cpopvtime &lt;file&gt; [normpop | normframe] [lifetime]]</div>
<div class="lyx_code_item">    [sil &lt;silhouette file prefix&gt;] [assignrefs [refcut &lt;rms&gt;] [refmask &lt;mask&gt;]]</div>
<div class="lyx_code_item">  Coordinate output options:</div>
<div class="lyx_code_item">	[ clusterout &lt;trajfileprefix&gt; [clusterfmt &lt;trajformat&gt;] ]</div>
<div class="lyx_code_item">	[ singlerepout &lt;trajfilename&gt; [singlerepfmt &lt;trajformat&gt;] ]</div>
<div class="lyx_code_item">	[ repout &lt;repprefix&gt; [repfmt &lt;repfmt&gt;] [repframe] ]</div>
<div class="lyx_code_item">    [ avgout &lt;avgprefix&gt; [avgfmt &lt;avgfmt&gt;] ]
<br />

</div>

<dl class="description"><a id="magicparlabel-7102"></a><dt class="description_label">[crdset &lt;crd set&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Name of previously generated COORDS data set. If not specified the default COORDS set will be used unless <b>nocoords</b> has been specified.</span></dd>
<dt class="description_label">[nocoords]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Do not use a COORDS data set; distance metrics that require coordinates and coordiante output will be disabled.</span></dd>
</dl>
<div class="standard"><a id="magicparlabel-7104"></a><span style="font-family:monospace;">Algorithms:</span></div>

<dl class="description"><a id="magicparlabel-7105"></a><dt class="description_label">hieragglo</dt>
<dd class="description_item"><span style="font-family:monospace;"> (Default) Use hierarchical agglomerative (bottom-up) approach.
<br />

</span>

<dl class="description"><a id="magicparlabel-7106"></a><dt class="description_label">[epsilon &lt;e&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Finish clustering when minimum distance between clusters is greater than <b>&lt;e&gt;</b>.</span></dd>
<dt class="description_label">[clusters &lt;n&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Finish clustering when <b>&lt;n&gt;</b> clusters remain.</span></dd>
<dt class="description_label">[linkage]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Single-linkage; use the shortest distance between members of two clusters.</span></dd>
<dt class="description_label">[averagelinkage]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Average-linkage (default); use the average distance between members of two clusters.</span></dd>
<dt class="description_label">[complete]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Complete-linkage; use the maximum distance between members of two clusters.</span></dd>
<dt class="description_label">[epsilonplot &lt;file&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write number of clusters vs epsilon to <b>&lt;file&gt;</b>.</span></dd>
<dt class="description_label">[includesieved_cdist]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Include sieved frames in final cluster distance calculation (<u>may be very slow</u>).</span></dd>
</dl>
</dd><dt class="description_label">dbscan</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use DBSCAN clustering algorithm of Ester et al.[<a href="#LyXCite-Ester96"><span class="bib-numericallabel">11</span></a>]
<br />

</span>

<dl class="description"><a id="magicparlabel-7114"></a><dt class="description_label">minpoints &lt;n&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Minimum number of points required to form a cluster.</span></dd>
<dt class="description_label">epsilon &lt;e&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Distance cutoff between points for forming a cluster.</span></dd>
<dt class="description_label">[sievetoframe]</dt>
<dd class="description_item"><span style="font-family:monospace;"> When restoring sieved frames, compare frame to every frame in a cluster instead of the centroid; slower but more accurate.</span></dd>
<dt class="description_label">[kdist &lt;k&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Generate K-dist plot for help in determining DBSCAN parameters (see below).</span></dd>
<dt class="description_label">[kfile &lt;prefix&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Prefix for K-dist plot file.</span></dd>
</dl>
</dd><dt class="description_label">dpeaks</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use the density peaks algorithm of Rodriguez and Laio[<a href="#LyXCite-Rodriguez2014"><span class="bib-numericallabel">27</span></a>]
<br />

</span>

<dl class="description"><a id="magicparlabel-7120"></a><dt class="description_label">epsilon &lt;e&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Cutoff for determining local density in Angstroms.</span></dd>
<dt class="description_label">[noise]</dt>
<dd class="description_item"><span style="font-family:monospace;"> If specified, treat all points within epsilon of another cluster as noise.</span></dd>
<dt class="description_label">[dvdfile &lt;density_vs_dist_file&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> File 
to write density versus minimum distance to point with next highest 
density. This can be used to determine appropriate cutoffs for distance 
and density in a subsequent step with <b>choosepoints</b> <b>manual</b>.</span></dd>
<dt class="description_label">[choosepoints {manual | auto}]</dt>
<dd class="description_item"><span style="font-family:monospace;"> 
Specify whether clusters will be chosen based on specified 
distance/density cutoffs, or automatically. If not specified only the 
density vs distance file will be written and no clustering will be 
performed. Currently <b>manual</b> is recommended.</span></dd>
<dt class="description_label">[distancecut &lt;distcut&gt;] [densitycut &lt;densitycut&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> If <b>choosepoints</b> <b>manual</b>,
 points with minimum distance greather than or equal to &lt;distcut&gt; 
and density greater than or equal to &lt;densitycut&gt; will be chosen.</span></dd>
<dt class="description_label">[runavg &lt;runavg file&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> If <b>choosepoints</b> <b>automatic</b>, the calculated running average of density versus distance will be written to &lt;runavg file&gt;.</span></dd>
<dt class="description_label">[deltafile &lt;file&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> If <b>choosepoints</b> <b>automatic</b>, distance minus the running average for each point will be written to this file.</span></dd>
<dt class="description_label">[gauss]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Calculate density with Gaussian kernels instead of using discrete density.</span></dd>
</dl>
</dd><dt class="description_label">kmeans</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use K-means clustering algorithm.
<br />

</span>

<dl class="description"><a id="magicparlabel-7129"></a><dt class="description_label">clusters &lt;n&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Finish clustering when number of clusters is <b>&lt;n&gt;</b>.</span></dd>
<dt class="description_label">[randompoint]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Randomize initial set of points used (recommended).</span></dd>
<dt class="description_label">[kseed &lt;seed&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Random number generator seed for <b>randompoint</b>.</span></dd>
<dt class="description_label">[maxit &lt;iteration&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Algorithm will run until frames no longer change clusters of &lt;iteration&gt; iterations are reached (default 100).</span></dd>
</dl>
</dd><dt class="description_label">readtxt|readinfo</dt>
<dd class="description_item"><span style="font-family:monospace;"> No clustering - read in previous cluster results.
<br />

</span>

<dl class="description"><a id="magicparlabel-7134"></a><dt class="description_label">infofile &lt;file&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Cluster info file to read.</span></dd>
</dl>
</dd></dl>
<div class="standard"><a id="magicparlabel-7135"></a><span style="font-family:monospace;">Distance Metric Options:</span></div>

<dl class="description"><a id="magicparlabel-7136"></a><dt class="description_label">[rms | srmsd[&lt;mask&gt;]]</dt>
<dd class="description_item"><span style="font-family:monospace;"> (Default <b>rms</b>) Distance between frames calculated via best-fit coordinate RMSD using atoms in <b>&lt;mask&gt;</b>. If <b>srmsd</b> specified use symmetry-corrected RMSD (see <a href="#subsec_cpptraj_symmrmsd">10.76</a>).
<br />

</span>

<dl class="description"><a id="magicparlabel-7137"></a><dt class="description_label">[mass]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Mass-weight the RMSD.</span></dd>
<dt class="description_label">[nofit]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Do not fit structures onto each other prior to calculating RMSD.</span></dd>
</dl>
</dd><dt class="description_label">dme [&lt;mask&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Distance between frames calculated using distance-RMSD (aka DME, <em><b>distrmsd</b></em>) using atoms in <b>&lt;mask&gt;</b>.</span></dd>
<dt class="description_label">[data &lt;dset0&gt;[,&lt;dset1&gt;,...]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Distance between frames calculated using specified data set(s) (Euclidean distance).</span></dd>
<dt class="description_label">[sieve &lt;#&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Perform clustering only for every <b>&lt;#&gt;</b> frame. After clustering, all other frames will be added to clusters.</span></dd>
<dt class="description_label">[random]</dt>
<dd class="description_item"><span style="font-family:monospace;"> When <b>sieve</b> is specified, select initial frames to cluster randomly.</span></dd>
<dt class="description_label">[sieveseed &lt;#&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Seed for random sieving; if not set the wallclock time will be used.</span></dd>
<dt class="description_label">[pairdist &lt;file&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> File to use for loading/saving pairwise distances.</span></dd>
<dt class="description_label">[loadpairdist]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Load pairwise distances from <b>&lt;file&gt;</b> (CpptrajPairDist if pairdist not specified).</span></dd>
<dt class="description_label">[savepairdist]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Save pairwise distances from <b>&lt;file&gt;</b> (CpptrajPairDist if pairdist not specified). NOTE: If sieving was performed only the calculated distances are saved.</span></dd>
<dt class="description_label">[pairwisecache {mem | disk | none}]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Cache
 pairwise distance data in memory (default), to disk, or disable 
pairwise caching. No caching will save memory but be extremely slow. 
Caching to disk will likely be slow unless writing to a fast storage 
device (e.g. SSD) - data is saved to a file named 
'CpptrajPairwiseCache'.</span></dd>
<dt class="description_label">[includesieveincalc]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Include sieved frames when calculating within-cluster average (<u>may be very slow</u>).</span></dd>
</dl>
<div class="standard"><a id="magicparlabel-7149"></a><span style="font-family:monospace;">Output Options:</span></div>

<dl class="description"><a id="magicparlabel-7150"></a><dt class="description_label">[out &lt;cnumvtime&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write cluster # vs frame to <b>&lt;cnumvtime&gt;</b>. Algorithms that calculate noise (e.g. DBSCAN) will assign noise points a value of -1.</span></dd>
<dt class="description_label">[gracecolor]</dt>
<dd class="description_item"><span style="font-family:monospace;"> 
Instead of cluster # vs frame, write cluster# + 1 (corresponding to 
colors used by XMGRACE) vs frame. Cluster #s larger than 15 are given 
the same color. Algorithms that calculate noise (e.g. DBSCAN) will 
assign noise points a color of 0 (blank).</span></dd>
<dt class="description_label">[summary &lt;summaryfile&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Summarize each cluster with format '#Cluster Frames Frac AvgDist Stdev Centroid AvgCDist':
<br />

</span>

<dl class="description"><a id="magicparlabel-7153"></a><dt class="description_label">#Cluster</dt>
<dd class="description_item"><span style="font-family:monospace;"> Cluster number starting from 0 (0 is most populated).</span></dd>
<dt class="description_label">Frames</dt>
<dd class="description_item"><span style="font-family:monospace;"> # of frames in cluster.</span></dd>
<dt class="description_label">Frac</dt>
<dd class="description_item"><span style="font-family:monospace;"> Size of cluster as fraction of total trajectory.</span></dd>
<dt class="description_label">AvgDist</dt>
<dd class="description_item"><span style="font-family:monospace;"> Average distance between points in the cluster.</span></dd>
<dt class="description_label">Stdev</dt>
<dd class="description_item"><span style="font-family:monospace;"> Standard deviation of points in the cluster.</span></dd>
<dt class="description_label">Centroid</dt>
<dd class="description_item"><span style="font-family:monospace;"> Frame # of structure in cluster that has the lowest cumulative distance to every other point.</span></dd>
<dt class="description_label">AvgCDist</dt>
<dd class="description_item"><span style="font-family:monospace;"> Average distance of this cluster to every other cluster.</span></dd>
</dl>
</dd><dt class="description_label">[info &lt;infofile&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write ptraj-like cluster information to <b>&lt;infofile&gt;</b>. This file has format:
<br />

#Clustering: &lt;X&gt; clusters &lt;N&gt; frames
<br />

#Cluster &lt;I&gt; has average-distance-to-centroid &lt;AVG&gt;
<br />

...
<br />

#DBI: &lt;DBI&gt;
<br />

#pSF: &lt;PSF&gt;
<br />

#Algorithm: &lt;algorithm-specific info&gt;
<br />

&lt;Line for cluster 0&gt;
<br />

...
<br />

#Representative frames: &lt;representative frame list&gt;
<br />

Where &lt;X&gt; is the number of clusters, &lt;N&gt; is the number of 
frames clustered, &lt;I&gt; ranges from 0 to &lt;X&gt;-1, &lt;AVG&gt; is
 the average distance of all frames in that cluster to the centroid, 
&lt;DBI&gt; is the Davies-Bouldin Index, &lt;pSF&gt; is the pseudo-F 
statistic, and &lt;representative frame list&gt; contains the frame # of
 the representative frame (i.e. closest to the centroid) for each 
cluster. Each cluster has a line made up of characters (one for each 
frame) where '.' means 'not in cluster' and 'X' means 'in cluster'.</span></dd>
<dt class="description_label">[summarysplit &lt;splitfile&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> 
Summarize each cluster based on which of its frames fall in portions of 
the trajectory specified by splitframe with format '#Cluster Total Frac 
C# Color NumInX ... FracX ... FirstX':
<br />

</span>

<dl class="description"><a id="magicparlabel-7162"></a><dt class="description_label">#Cluster</dt>
<dd class="description_item"><span style="font-family:monospace;"> Cluster number starting from 0 (0 is most populated).</span></dd>
<dt class="description_label">Total</dt>
<dd class="description_item"><span style="font-family:monospace;"> # of frames in cluster.</span></dd>
<dt class="description_label">Frac</dt>
<dd class="description_item"><span style="font-family:monospace;"> Size of cluster as a fraction of the total trajectory.</span></dd>
<dt class="description_label">C#</dt>
<dd class="description_item"><span style="font-family:monospace;"> Grace color number.</span></dd>
<dt class="description_label">Color</dt>
<dd class="description_item"><span style="font-family:monospace;"> Text description of the color (based on standard XMGRACE coloring).</span></dd>
<dt class="description_label">NumInX</dt>
<dd class="description_item"><span style="font-family:monospace;"> Number of frames in Xth portion of the trajectory.</span></dd>
<dt class="description_label">FracX</dt>
<dd class="description_item"><span style="font-family:monospace;"> Fraction of frames in Xth portion of the trajectory.</span></dd>
<dt class="description_label">FirstX</dt>
<dd class="description_item"><span style="font-family:monospace;"> Frame in the Xth portion of the trajectory where the cluster is first observed.</span></dd>
</dl>
</dd><dt class="description_label">[splitframe &lt;frame&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> For <b>summarysplit</b>, frame or comma-separated list of frames to split the trajectory at, e.g. '100,200,300'.</span></dd>
<dt class="description_label">[bestrep {cumulative|centroid|cumulative_nosieve}]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Method for choosing cluster representative frames.</span>

<dl class="description"><a id="magicparlabel-7172"></a><dt class="description_label">cumulative</dt>
<dd class="description_item"><span style="font-family:monospace;"> Choose by lowest cumulative distance to all other frames in cluster. Default when not sieving.</span></dd>
<dt class="description_label">centroid</dt>
<dd class="description_item"><span style="font-family:monospace;"> Choose by lowest distance to cluster centroid. Default when sieving.</span></dd>
<dt class="description_label">cumulative_nosieve</dt>
<dd class="description_item"><span style="font-family:monospace;"> Choose by lowest cumulative distance to all other frames, ignoring sieved frames.</span></dd>
</dl>
</dd><dt class="description_label">[clustersvtime &lt;filename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write number of unique clusters observed in a given time window to &lt;filename&gt;.</span></dd>
<dt class="description_label">[cvtwindow &lt;windowsize&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Window size for <b>clustersvtime</b> output.</span></dd>
<dt class="description_label">[cpopvtime &lt;file&gt; [normpop | normframe]]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write cluster population vs time to <b>&lt;file&gt;</b>; if <b>normpop</b> specified normalize each cluster to 1.0; if <b>normframe</b> specified normalize cluster populations by number of frames.</span></dd>
<dt class="description_label">[sil &lt;prefix&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write
 average cluster silhouette value for each cluster to 
'&lt;prefix&gt;.cluster.dat' and cluster silhouette value for each 
individual frame to '&lt;prefix&gt;.frame.dat'.</span></dd>
<dt class="description_label">assignrefs</dt>
<dd class="description_item"><span style="font-family:monospace;"> In <b>summary</b>/<b>summarysplit</b>, assign clusters to loaded representative structures if RMSD to that reference is less than specified cutoff.</span>

<dl class="description"><a id="magicparlabel-7180"></a><dt class="description_label">[refcut &lt;rms&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> RMSD cutoff in Angstroms.</span></dd>
<dt class="description_label">[refmask &lt;mask&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Mask to use for RMSD calculation. If not specified the default mask is all heavy atoms.</span></dd>
</dl>
</dd></dl>
<div class="standard"><a id="magicparlabel-7182"></a><span style="font-family:monospace;">Coordinate Output Options:</span></div>

<dl class="description"><a id="magicparlabel-7183"></a><dt class="description_label">clusterout &lt;trajfileprefix&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write frames in each cluster to files named &lt;trajfileprefix&gt;.cX, where X is the cluster number.</span></dd>
<dt class="description_label">clusterfmt &lt;trajformat&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Format keyword for clusterout (default Amber Trajectory).</span></dd>
<dt class="description_label">singlerepout &lt;trajfilename&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write all representative frames to single trajectory named &lt;trajfilename&gt;.</span></dd>
<dt class="description_label">singlerepfmt &lt;trajformat&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Format keyword for singlerepout (default Amber Trajectory).</span></dd>
<dt class="description_label">repout &lt;repprefix&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write
 representative frames to separate files named 
&lt;repprefix&gt;.X.&lt;ext&gt;, where X is the cluster number and 
&lt;ext&gt; is a format-specific filename extension.</span></dd>
<dt class="description_label">repfmt &lt;trajformat&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Format keyword for repout (default Amber Trajectory).</span></dd>
<dt class="description_label">repframe</dt>
<dd class="description_item"><span style="font-family:monospace;"> Include representative frame number in <b>repout</b> filename.</span></dd>
<dt class="description_label">avgout &lt;avgprefix&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write
 average structure for each cluster to separate files named 
&lt;avgprefix&gt;.X.&lt;ext&gt;, where X is the cluster number and 
&lt;ext&gt; is a format-specific filename extension.</span></dd>
<dt class="description_label">avgfmt &lt;trajformat&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Format keyword for avgout.</span></dd>
</dl>
<div class="standard"><a id="magicparlabel-7192"></a><span style="font-family:monospace;">DataSet Aspects:</span></div>

<dl class="description"><a id="magicparlabel-7193"></a><dt class="description_label">[Pop]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Cluster population vs time; index corresponds to cluster number.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-7194"></a><i>Note cluster population vs time data sets are not generated until the analysis has been run.</i></div>

<div class="standard"><a id="magicparlabel-7195"></a>Cluster input 
frames using the specified clustering algorithm and distance metric. In 
order to speed up clustering of large trajectories, the <b>sieve</b> 
keyword can be used. In addition, subsequent clustering calculations can
 be sped up by writing/reading calculated pair distances between each 
frame to/from a file specified by <b>pairdist</b> (or “CpptrajPairDist” if <b>pairdist</b> not specified).</div>

<div class="standard"><a id="magicparlabel-7196"></a>Example: cluster on a specific distance:</div>

<div class="lyx_code"><a id="magicparlabel-7197"></a><div class="lyx_code_item">distance endToEnd :1 :255</div>
<div class="lyx_code_item">cluster data endToEnd clusters 10 epsilon 3.0 summary summary.dat info info.dat</div>
</div>
<div class="standard"><a id="magicparlabel-7199"></a>Example: cluster on
 the CA atoms of residues 2-10 using average-linkage, stopping when 
either 3 clusters are reached or the minimum distance between clusters 
is 4.0, writing the cluster number vs time to “cnumvtime.dat” and a 
summary of each cluster to “avg.summary.dat”:</div>

<div class="lyx_code"><a id="magicparlabel-7200"></a><div class="lyx_code_item">cluster C1 :2-10 clusters 3 epsilon 4.0 out cnumvtime.dat summary avg.summary.dat</div>
</div>
<h4 class="subsubsection_"><a id="magicparlabel-7201"></a>Clustering Metrics</h4>
<div class="standard"><a id="magicparlabel-7202"></a>The Davies-Bouldin Index (DBI) measures sum over all clusters of the within cluster scatter to the between cluster separation; <b>the smaller the DBI, the better</b>.
 The DBI is defined as the average, for all clusters X, of fred, where 
fred(X) = max, across other clusters Y, of (Cx + Cy)/dXY. Here Cx is the
 average distance from points in X to the centroid, similarly Cy, and 
dXY is the distance between cluster centroids. </div>

<div class="standard"><a id="magicparlabel-7203"></a>The pseudo-F 
statistic (pSF) is another measure of clustering goodness. It is 
intended to capture the 'tightness' of clusters, and is in essence a 
ratio of the mean sum of squares between groups to the mean sum of 
squares within group. <b>High values are good</b>. Generally, one 
selects a cluster-count that gives a peak in the pseudo-f statistic. 
Formula: A/B, where A = (T - P)/(G-1), and B = P / (n-G). Here n is the 
number of points, G is the number of clusters, T is the total distance 
from the all-data centroid, and P is the sum (for all clusters) of the 
distances from the cluster centroid. </div>

<div class="standard"><a id="magicparlabel-7204"></a>The cluster 
silhouette is a measure of how well each point fits within a cluster. 
Values of 1 indicate the point is very similar to other points in the 
cluster, i.e. it is well-clustered. Values of -1 indicate the point is 
dissimilar and may fit better in a neighboring cluster. Values of 0 
indicate the point is on a border between two clusters. </div>
<h4 class="subsubsection_"><a id="magicparlabel-7205"></a>Hints for setting DBSCAN parameters with 'kdist'<a id="subsec_cpptraj_dbscan_Hints"></a>
</h4>
<div class="standard"><a id="magicparlabel-7206"></a>It is not always 
obvious what parameters to set for DBSCAN. You can get a rough idea of 
what to set 'mindist' and 'epsilon' to by generating a so-called 
"K-dist" plot with the 'kidst &lt;k&gt;' option. The K-dist plot shows 
for each point (X axis) the Kth farthest distance (Y axis), sorted by 
decreasing distance. You supply the same distance metric and sieve 
parameters you want to use for the actual clustering, but nothing else. 
For example:</div>

<div class="lyx_code"><a id="magicparlabel-7207"></a><div class="lyx_code_item">cluster C0 dbscan kdist 4 rms :1-4@CA sieve 10 loadpairdist pairdist CpptrajPairDist</div>
</div>
<div class="standard"><a id="magicparlabel-7208"></a>The K-dist plot 
will be named &lt;prefix&gt;.&lt;k&gt;.dat, with the default prefix 
being 'Kdist' (in this case the file name would be Kdist.4.dat). The 
K-dist plot usually looks like a curve with an initially steep slope 
that gradually decreases. Around where the initial part of the curve 
starts to flatten out (indicating an increas in density) is around where
 epsilon should be set; minpoints is set to whatever &lt;k&gt; was. It 
has been suggested that the shape of the K-dist curve doesn't change too
 much after Kdist=4, but users are encouraged to experiment.</div>
<h4 class="subsubsection_"><a id="magicparlabel-7209"></a>Using 'dpeaks' clustering</h4>
<div class="standard"><a id="magicparlabel-7210"></a>The 'dpeaks' 
(density peaks) algorithm attempts to find clusters by identifying 
points in high density regions which are far from other points of high 
density[<a href="#LyXCite-Rodriguez2014"><span class="bib-numericallabel">27</span></a>].
 There are two ways these points can be chosen. The first and 
recommended way is manually. In this method, clustering if first run 
with <b>choosepoints</b> not specified to generate a plot containing 
density versus minimum distance to point with next highest density (the 
decision graph). Appropriate cut offs for distance and density can then 
be chosen based on visual inspection; cutoffs should be chosen so that 
they select points that have both a high density and a high distance to 
point with next highest density. Clustering can then be run again with <b>distancecut</b> and <b>densitycut</b> set.</div>

<div class="standard"><a id="magicparlabel-7211"></a>The second way is 
automatically; cpptraj will attempt to identify outliers in the density 
vs distance plot based on distance from the running average. Although 
this only requires a single pass, this method of choosing points is not 
well-tested and currently not recommended.</div>
<h4 class="subsubsection_"><a id="magicparlabel-7212"></a>The CpptrajPairDist file format</h4>
<div class="standard"><a id="magicparlabel-7213"></a>The CpptrajPairDist
 file is binary; the exact format depends on what version of cpptraj 
generated the file (since earlier versions had no concept of 'sieve'). 
The CpptrajPairDist file starts with a 4 byte header containing the 
characters 'C' 'T' 'M' followed by the version number. A quick way to 
figure out the version is to use the linux 'od' command to output the 
first 4 bytes as hexadecimal, e.g.:</div>

<div class="lyx_code"><a id="magicparlabel-7214"></a><div class="lyx_code_item">$ od -t x1 -N 4 CpptrajPairDist 0000000 43 54 4d 02</div>
</div>
<div class="standard"><a id="magicparlabel-7215"></a>So the CpptrajPairDist file version in the above example is 2.</div>

<div class="standard"><a id="magicparlabel-7216"></a>The next few numbers describe the matrix size and depend on the version.</div>

<dl class="description"><a id="magicparlabel-7217"></a><dt class="description_label">Version 0:</dt>
<dd class="description_item"> Two 4-byte integers: # of rows and # of elements. </dd>
<dt class="description_label">Version 1:</dt>
<dd class="description_item"> Two 8-byte unsigned integers (equivalent to size_t on most systems): # of rows and # of elements. </dd>
<dt class="description_label">Version 2:</dt>
<dd class="description_item"> Three 8 byte unsigned integers: original # of rows, actual # of rows, and sieve value.</dd>
</dl>
<div class="standard"><a id="magicparlabel-7220"></a>This is followed by
 the actual matrix data, stored as a single array of floats (4 bytes). 
For versions 1 and 2 the number of elements is explicitly stored. For 
version 2, to calculate the number of matrix elements you need to read:</div>

<div class="lyx_code"><a id="magicparlabel-7221"></a><div class="lyx_code_item">Elements = (actual_rows * (actual_rows - 1)) / 2</div>
</div>
<div class="standard"><a id="magicparlabel-7222"></a>The cluster 
pair-distance matrix is an upper-right triangle matrix without the 
diagonal (in row-major order), so the first element is the distance 
between elements 0 and 1, the second is between elements 0 and 2, etc.</div>

<div class="standard"><a id="magicparlabel-7223"></a>In version 2 files,
 if the sieve value is greater than 1 that means original_rows &gt; 
actual_rows and there is an additional array of characters 
original_nrows long, with 'T' if the row is being ignored (i.e. it was 
sieved out) and 'F' if the row is active (i.e. is active in the actual 
pairwise-distance matrix).</div>

<div class="standard"><a id="magicparlabel-7224"></a>The code that cpptraj uses to read in CpptrajPairDist files is in ClusterMatrix::LoadFile() (ClusterMatrix.cpp).</div>
<h3 class="subsection"><a id="magicparlabel-7225"></a><span class="subsection_label">11.5</span> cphstats</h3>

<div class="lyx_code"><a id="magicparlabel-7226"></a><div class="lyx_code_item">cphstats &lt;pH sets&gt; [name &lt;name&gt;] [statsout &lt;statsfile&gt;] [deprot]</div>
<div class="lyx_code_item">     	[fracplot [fracplotout &lt;file&gt;]]</div>

<dl class="description"><a id="magicparlabel-7228"></a><dt class="description_label">&lt;pH sets&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Previously read in pH data sets.</span></dd>
<dt class="description_label">name &lt;name&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output set name.</span></dd>
<dt class="description_label">statsout &lt;statsfile&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write pH statistics to &lt;statsfile&gt;</span></dd>
<dt class="description_label">deprot</dt>
<dd class="description_item"><span style="font-family:monospace;"> If specified, calculate fraction deprotonated instead of protonated.</span></dd>
<dt class="description_label">fracplot</dt>
<dd class="description_item"><span style="font-family:monospace;"> If specified, calculate fraction protonated/deprotonated vs pH.</span>

<dl class="description"><a id="magicparlabel-7233"></a><dt class="description_label">fracplotout &lt;file&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> File to write fraction plots to.</span></dd>
</dl>
</dd></dl>
<div class="standard"><a id="magicparlabel-7234"></a><span style="font-family:monospace;">Data Sets Generated</span></div>

<dl class="description"><a id="magicparlabel-7235"></a><dt class="description_label">&lt;name&gt;[Frac]:&lt;idx&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Fraction protonated/deprotonated for residue &lt;idx&gt;.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-7236"></a>Calculate statistics for constant pH simulation data previously read in with <em><b>readdata</b></em> (see <a href="#subsec_cpptraj_cphdatafile">5.11</a>). Statistics are calculated for each residue at each input pH. Output format is as follows:</div>

<div class="lyx_code"><a id="magicparlabel-7237"></a><div class="lyx_code_item">Solvent pH is &lt;pH&gt;</div>
<div class="lyx_code_item">&lt;residue name&gt; &lt;residue number&gt; :
 Offset &lt;offset from predicted&gt; Pred &lt;predicted pH&gt; Frac 
Prot &lt;fraction&gt; Transitions &lt;number of transitions&gt;</div>
<div class="lyx_code_item">...</div>
<div class="lyx_code_item"></div>
<div class="lyx_code_item">Average total molecular protonation: &lt;avg&gt;</div>
</div>
<div class="standard"><a id="magicparlabel-7242"></a>A line is printed for each residue. This functionality is similar to the <b>cphstats</b> utility that comes with Amber (see <a href="#sec_cphstats">sec:cphstats</a>).</div>

<div class="standard"><a id="magicparlabel-7243"></a>Note that data from constant pH REMD must be sorted prior to use with <em><b>cphstats</b></em>. See the <em><b>readensembledata</b></em> (<a href="#subsec_cpptraj_readensembledata">7.19</a>) and <em><b>sortensembledata</b></em> (<a href="#subsec_cpptraj_sortensembledata">7.26</a>) commands for more details.</div>

<div class="standard"><a id="magicparlabel-7244"></a>For example, to read in constant pH data from constant pH REMD, sort and analyze:</div>

<div class="lyx_code"><a id="magicparlabel-7245"></a><div class="lyx_code_item">readensembledata ExplicitRemd/cpout.001 cpin ExplicitRemd/cpin name PH</div>
<div class="lyx_code_item">sortensembledata PH</div>
<div class="lyx_code_item">runanalysis cphstats PH[*] statsout stats.dat fracplot fracplotout frac.agr deprot</div>
</div>
<h3 class="subsection"><a id="magicparlabel-7248"></a><span class="subsection_label">11.6</span> corr | correlationcoe</h3>

<div class="lyx_code"><a id="magicparlabel-7249"></a><div class="lyx_code_item">corr<a id="magicparlabel-7253"></a>
 out &lt;outfilename&gt; &lt;dataset1&gt; [&lt;dataset2&gt;]</div>
<div class="lyx_code_item">     [lagmax &lt;lag&gt;] [nocovar] [direct]
<br />

</div>

<dl class="description"><a id="magicparlabel-7255"></a><dt class="description_label">out &lt;outfilename&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write results to file named &lt;outfilename&gt;. The datasets must have the same # of data points.</span></dd>
<dt class="description_label">&lt;dataset1&gt; [&lt;dataset2&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Data 
set(s) to calculate correlation for. If one dataset or the same dataset 
is given twice, the auto-correlation will be calculated, otherwise 
cross-correlation.</span></dd>
<dt class="description_label">[lagmax]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Maximum lag to calculate for. If not specified all frames are used.</span></dd>
<dt class="description_label">[nocovar]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Do not calculate covariance.</span></dd>
<dt class="description_label">[direct]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Do not use FFTs to calculate correlation; this will be much slower.</span></dd>
</dl>
<div class="standard"><a id="magicparlabel-7260"></a><span style="font-family:monospace;">DataSet Aspects:</span></div>

<dl class="description"><a id="magicparlabel-7261"></a><dt class="description_label">[&lt;dataset1&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> (Auto-correlation) The aspect will be the name of each of the input data set.</span></dd>
<dt class="description_label">[&lt;dataset1&gt;-&lt;dataset2&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> (Cross-correlation) The aspect will be the names of each of the input data sets joined by a dash ('-').</span></dd>
</dl>
<div class="standard"><a id="magicparlabel-7263"></a><span style="font-family:monospace;">DataSet Aspects:</span></div>

<dl class="description"><a id="magicparlabel-7264"></a><dt class="description_label">[coeff]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Correlation coefficient.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-7265"></a>Calculate the 
auto-correlation function for data set named &lt;dataset1&gt; or the 
cross-correlation function for data sets named &lt;dataset1&gt; and 
&lt;dataset2&gt; up to &lt;lagmax&gt; frames (all if <b>lagmax</b> not specified), writing the result to file specified by <b>out</b>. The two datasets must have the same # of datapoints. </div>
<h3 class="subsection"><a id="magicparlabel-7266"></a><span class="subsection_label">11.7</span> crank | crankshaft</h3>

<div class="lyx_code"><a id="magicparlabel-7267"></a><div class="lyx_code_item">crank {angle | distance} &lt;dsetname1&gt; &lt;dsetname2&gt; info &lt;string&gt;</div>
<div class="lyx_code_item">      [out &lt;filename&gt;] [results &lt;resultsfile&gt;]
<br />

</div>

<dl class="description"><a id="magicparlabel-7269"></a><dt class="description_label">angle</dt>
<dd class="description_item"><span style="font-family:monospace;"> Analyze angle data sets.</span></dd>
<dt class="description_label">distance</dt>
<dd class="description_item"><span style="font-family:monospace;"> Analyze distance data sets.</span></dd>
<dt class="description_label">&lt;dsetname1&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Data set to analyze.</span></dd>
<dt class="description_label">&lt;dsetname2&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Data set to analyze.</span></dd>
<dt class="description_label">info &lt;string&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Title the analysis &lt;string&gt;.</span></dd>
<dt class="description_label">[out &lt;filename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write frame-vs-bin to &lt;filename&gt;.</span></dd>
<dt class="description_label">[results &lt;resultsfile&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write results to &lt;resultsfile&gt;.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-7276"></a>Calculate crankshaft motion between two data sets.</div>
<h3 class="subsection"><a id="magicparlabel-7277"></a><span class="subsection_label">11.8</span> crdfluct</h3>

<div class="lyx_code"><a id="magicparlabel-7278"></a><div class="lyx_code_item">[crdset &lt;crd set&gt;] [&lt;mask&gt;] [out &lt;filename&gt;] [window &lt;size&gt;] [bfactor]</div>
</div>
<div class="standard"><a id="magicparlabel-7279"></a>Calculate atomic positional fluctuations for atoms in <b>&lt;mask&gt;</b> over windows of size <b>&lt;size&gt;</b>. If <b>bfactor</b> is specified, the fluctuations are weighted by <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mfrac>
    <mrow><mn>8</mn>
    </mrow>
    <mrow><mn>3</mn>
    </mrow>
   </mfrac>
   <msup>
    <mrow><mi> π </mi>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msup>
  </mrow>
 </mrow></math>(similar but not necessarily equivalent to crystallographic B-factor calculation). Units are Å, or Å<sup class="script_superscript">2</sup>x<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mfrac>
    <mrow><mn>8</mn>
    </mrow>
    <mrow><mn>3</mn>
    </mrow>
   </mfrac>
   <msup>
    <mrow><mi> π </mi>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msup>
  </mrow>
 </mrow></math> if <b>bfactor</b> specified.</div>
<h3 class="subsection"><a id="magicparlabel-7284"></a><span class="subsection_label">11.9</span> crosscorr</h3>

<div class="lyx_code"><a id="magicparlabel-7285"></a><div class="lyx_code_item">crosscorr [name &lt;dsetname&gt;] &lt;dsetarg0&gt; [&lt;dsetarg1&gt; ...] [out &lt;filename&gt;]
<br />

</div>

<dl class="description"><a id="magicparlabel-7286"></a><dt class="description_label">[name &lt;dsetname&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> The resulting upper-triangle matrix is stored with name &lt;dsetname&gt;.</span></dd>
<dt class="description_label">&lt;dsetarg0&gt; [&lt;dsetarg1&gt; ...]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Argument(s) specifying datasets to be used.</span></dd>
<dt class="description_label">[out &lt;filename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write results to file named &lt;filename&gt;.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-7289"></a>Calculate the Pearson product-moment correlation coefficients between all specified datasets.</div>
<h3 class="subsection"><a id="magicparlabel-7290"></a><span class="subsection_label">11.10</span> curvefit<a id="subsec_cpptraj_curvefit"></a>
</h3>

<div class="lyx_code"><a id="magicparlabel-7291"></a><div class="lyx_code_item">curvefit &lt;dset&gt; { &lt;equation&gt;  |</div>
<div class="lyx_code_item">                  name &lt;dsname&gt; { gauss | nexp &lt;m&gt; [form {mexp|mexpk|mexpk_penalty} } }</div>
<div class="lyx_code_item">         [AX=&lt;value&gt; ...] [out &lt;outfile&gt;] [resultsout &lt;results&gt;]</div>
<div class="lyx_code_item">         [maxit &lt;max iterations&gt;] [tol &lt;tolerance&gt;]</div>
<div class="lyx_code_item">         [outxbins &lt;NX&gt; outxmin &lt;xmin&gt; outxmax &lt;xmax&gt;]
<br />

</div>

<dl class="description"><a id="magicparlabel-7296"></a><dt class="description_label">&lt;dset&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Data set to fit.</span></dd>
<dt class="description_label">&lt;equation&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Equation to fit of form &lt;Variable&gt; = &lt;Equation&gt;. See <a href="#subsec_cpptraj_Data_Set_Math">4.2</a> for more details on equations <em>cpptraj</em> understands.</span></dd>
<dt class="description_label">name &lt;dsname&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Final data set name (required if using <b>nexp</b> or <b>gauss</b>).</span></dd>
<dt class="description_label">gauss</dt>
<dd class="description_item"><span style="font-family:monospace;"> Fit to Gaussian of form A0 * exp( -((X - A1)^2) / (2 * A2^2) )</span></dd>
<dt class="description_label">nexp &lt;m&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Fit to specified number of exponentials.
<br />

</span>

<dl class="description"><a id="magicparlabel-7301"></a><dt class="description_label">form &lt;type&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Fit to specified exponential form:
<br />

</span>

<dl class="description"><a id="magicparlabel-7302"></a><dt class="description_label">mexp</dt>
<dd class="description_item"><span style="font-family:monospace;"> Multi-exponential, SUM(m)[ An * exp(An+1 * X)]</span></dd>
<dt class="description_label">mexpk</dt>
<dd class="description_item"><span style="font-family:monospace;"> Multi-exponential plus constant, A0 + SUM(m)[An * exp(An+1 * X)]</span></dd>
<dt class="description_label">mexpk_penalty</dt>
<dd class="description_item"><span style="font-family:monospace;"> Same as mexpk except sum of prefactors constrained to 1.0 and exponential constants constrained to &lt; 0.0.</span></dd>
</dl>
</dd></dl>
</dd><dt class="description_label">AX=&lt;value&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Value of any constants in specified equation with X starting from 0 (can specify more than one).</span></dd>
<dt class="description_label">out &lt;outfile&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write resulting fit curve to &lt;outfile&gt;.</span></dd>
<dt class="description_label">resultsout &lt;results&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write details of the fit to &lt;results&gt; (default STDOUT).</span></dd>
<dt class="description_label">maxit &lt;max iterations&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Number of iterations to run curve fitting algorithm (default 50).</span></dd>
<dt class="description_label">tol &lt;tolerance&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Curve-fitting tolerance (default 1E-4).</span></dd>
<dt class="description_label">outxbins &lt;NX&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Number of points to use when generating final curve (default same number of points as input data set).</span></dd>
<dt class="description_label">outxmin &lt;xmin&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Minimum X value to use for final curve (default same number of points as input data set).</span></dd>
<dt class="description_label">outxmax &lt;xmax&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Maximum X value to use for final curve (default same number of points as input data set).</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-7313"></a>Perform non-linear 
curve fitting for the specified data set using the Levenberg-Marquardt 
algorithm. Any equation form that cpptraj understands (see <a href="#subsec_cpptraj_Data_Set_Math">4.2</a>)
 can be used, or several preset forms can be used. Similar to Grace 
(http://plasma-gate.weizmann.ac.il/Grace/), an equation can contain 
constants for curve fitting termed AX (with X being a numerical digit, 
one for each constant), and is assigned to a variable which then becomes
 a data set. For example, to fit a curve to data from a file named 
Data.dat to a data set named 'FitY':</div>

<div class="lyx_code"><a id="magicparlabel-7314"></a><div class="lyx_code_item">readdata Data.dat</div>
<div class="lyx_code_item">runanalysis curvefit Data.dat \</div>
<div class="lyx_code_item">  "FitY = (A0 * exp(X * A1)) + (A2 * exp(X * A3))" \</div>
<div class="lyx_code_item">  A0=1 A1=-1 A2=1 A3=-1 \</div>
<div class="lyx_code_item">  out curve.dat tol 0.0001 maxit 50</div>
</div>
<div class="standard"><a id="magicparlabel-7319"></a>To perform the same fit but to a multi-exponential curve with two exponentials:</div>

<div class="lyx_code"><a id="magicparlabel-7320"></a><div class="lyx_code_item">readdata Data.dat</div>
<div class="lyx_code_item">runanalysis curvefit Data.dat nexp 2 name FitY \</div>
<div class="lyx_code_item">  A0=1 A1=-1 A2=1 A3=-1 \</div>
<div class="lyx_code_item">  out curve1.dat tol 0.0001 maxit 50</div>
</div>
<h3 class="subsection"><a id="magicparlabel-7324"></a><span class="subsection_label">11.11</span> diagmatrix<a id="subsec_diagmatrix___analyze"></a>
</h3>

<div class="lyx_code"><a id="magicparlabel-7325"></a><div class="lyx_code_item">diagmatrix &lt;name&gt; [out &lt;filename&gt;] [thermo [outthermo &lt;filename&gt;]]</div>
<div class="lyx_code_item">           [vecs &lt;#&gt;] [name &lt;modesname&gt;] [reduce] </div>
<div class="lyx_code_item">           [nmwiz [nmwizvecs &lt;#&gt;] [nmwizfile &lt;filename&gt;]]
<br />

</div>

<dl class="description"><a id="magicparlabel-7328"></a><dt class="description_label">&lt;name&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Name of symmetric matrix to diagonalize.</span></dd>
<dt class="description_label">[out &lt;filename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write results to &lt;filename&gt;.</span></dd>
<dt class="description_label">[thermo [outthermo &lt;filename&gt;]]</dt>
<dd class="description_item"><span style="font-family:monospace;"> 
Mass-weighted covariance (mwcovar) matrix only. Calculate entropy, heat 
capacity, and internal energy from the structure of a molecule (average 
coordinates, see above) and its vibrational frequencies using standard 
statistical mechanical formulas for an ideal gas. Results are written to
 &lt;filename&gt; if specified, otherwise results are written to STDOUT.
 <b>Note that this converts the units of the calculated eigenvalues to frequencies (cm<sup class="script_superscript">-1</sup>)</b>.</span></dd>
<dt class="description_label">[vecs &lt;#&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Number of eigenvectors to calculate. Default is 0, which is only allowed when 'thermo' is specified.</span></dd>
<dt class="description_label">[name &lt;modesname&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Store resulting modes data set with name &lt;modesname&gt;.</span></dd>
<dt class="description_label">[reduce]</dt>
<dd class="description_item"><span style="font-family:monospace;"> 
Covariance (covar/mwcovar/distcovar) matrices only. For coordinate 
covariance (covar/mwcovar) matrices, each eigenvector element is reduced
 via Ei = Eix^2 + Eiy^2 + Eiz^2. For distance covariance (distcovar) the
 eigenvectors are reduced by taking the sum of the squares of each row. 
See Abseher &amp; Nilges, JMB 1998, 279, 911-920 for further details. 
They may be used to compare results from PCA in distance space with 
those from PCA in cartesian-coordinate space.</span></dd>
<dt class="description_label">[nmwiz]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Generate output in <em>.nmd</em> format file for viewing with NMWiz[<a href="#LyXCite-Bakan11"><span class="bib-numericallabel">3</span></a>]. See http://prody.csb.pitt.edu/tutorials/nmwiz_tutorial/ for further details.
<br />

</span>

<dl class="description"><a id="magicparlabel-7339"></a><dt class="description_label">[nmwizvecs &lt;#&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Number of vectors to write out for nmwiz output, starting with the lowest frequency mode (default 20).</span></dd>
<dt class="description_label">[nmwizfile &lt;filename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Name of nmwiz file to write to (default 'out.nmd').</span></dd>
<dt class="description_label">[nmwizmask &lt;mask&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Mask of atoms corresponding to eigenvectors - should be the same one used to generate the matrix.</span></dd>
</dl>
</dd></dl>
</div>
<div class="standard"><a id="magicparlabel-7342"></a>Calculate 
eigenvectors and eigenvalues for the specified symmetric matrix. This is
 followed by Principal Component Analysis (in cartesian coordinate space
 in the case of a covariance matrix or in distance space in the case of a
 distance-covariance matrix), or Quasiharmonic Analysis (in the case of a
 mass-weighted covariance matrix). Diagonalization of distance, 
correlation, idea, and ired matrices are also possible. Eigenvalues are 
given in cm<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup><mrow/>
   <mrow>
    <mrow><mo>-</mo><mn>1</mn>
    </mrow>
   </mrow>
  </msup>
 </mrow></math> in the case of a mass-weighted covariance matrix and in 
the units of the matrix elements in all other cases. In the case of a 
mass-weighted covariance matrix, the eigenvectors are mass-weighted.</div>

<div class="standard"><a id="magicparlabel-7343"></a>For quasi-harmonic 
analysis the input must be a mass-weighted covariance matrix. 
Thermodynamic quantities are calculated based on statistical mechanical 
formulae that assume the input system is oscillating in a single energy 
well: see Statistical Thermodynamics by D. A. McQuarrie, particularly 
chapters 4, 5, and 6 for more details.[<a href="#LyXCite-McQuarrie1973"><span class="bib-numericallabel">21</span></a>] For an in-depth discussion of the accuracy of thermodynamic parameters obtained via quasi-harmonic analysis see Chang et al..[<a href="#LyXCite-Chang2005"><span class="bib-numericallabel">5</span></a>]</div>

<div class="standard"><a id="magicparlabel-7344"></a>Note that the 
maximum number of non-zero eigenvalues obtainable depends on the number 
of frames used to generate the input matrix; the number of frames should
 be equal to or greater than the number of columns in the matrix in 
order to obtain all eigenmodes.</div>

<div class="standard"><a id="magicparlabel-7345"></a>Results may include
 average coordinates (in the case of covar, mwcovar, correl), average 
distances (in the case of distcovar), main diagonal elements (in the 
case of idea and ired), eigenvalues, and eigenvectors.</div>

<div class="standard"><a id="magicparlabel-7346"></a>For example, in the
 following a mass-weighted covariance matrix of all atoms is generated 
and stored internally with the name mwcvmat; the matrix itself is 
written to mwcvmat.dat. Subsequently, the first 20 eigenmodes of the 
matrix are calculated and written to evecs.dat, and quasiharmonic 
analysis is performed at 300.0 K, with the results written to 
thermo.dat.</div>

<div class="lyx_code"><a id="magicparlabel-7347"></a><div class="lyx_code_item">matrix mwcovar name mwcvmat out mwcvmat.dat</div>
<div class="lyx_code_item">diagmatrix mwcvmat out evecs.dat vecs 20 \</div>
<div class="lyx_code_item">           thermo outthermo thermo.dat temp 300.0</div>
</div>
<h4 class="subsubsection_"><a id="magicparlabel-7350"></a>Output Format</h4>
<div class="standard"><a id="magicparlabel-7351"></a>The “modes” or “evecs” output file is a text file with the following format:</div>

<div class="lyx_code"><a id="magicparlabel-7352"></a><div class="lyx_code_item"> [Reduced] Eigenvector file: &lt;Type&gt; nmodes &lt;#&gt; width &lt;width&gt;</div>
<div class="lyx_code_item">  &lt;# Avg Coords&gt; &lt;Eigenvector Size&gt;</div>
<div class="lyx_code_item">&lt;Average Coordinates&gt;</div>
</div>
<div class="standard"><a id="magicparlabel-7355"></a>Where &lt;Type&gt; 
is a string identifying what kind of matrix the eigenvectors/eigenvalues
 were determined from, nmodes is how many eigenvectors are in the file, 
and &lt;Average Coordinates&gt; are in lines 7 columns wide, with each 
element having width specified by &lt;width&gt;. Then for each 
eigenvector:</div>

<div class="lyx_code"><a id="magicparlabel-7356"></a><div class="lyx_code_item"> ****</div>
<div class="lyx_code_item">&lt;Eigenvector#&gt; &lt;Eigenvalue&gt;</div>
<div class="lyx_code_item">&lt;Eigenvector Coordinates&gt;</div>
<div class="lyx_code_item">...</div>
</div>
<div class="standard"><a id="magicparlabel-7360"></a>Where &lt;Eigenvector Coordinates&gt; are in lines 7 columns wide, with each element having width specified by &lt;width&gt;.</div>
<h3 class="subsection"><a id="magicparlabel-7361"></a><span class="subsection_label">11.12</span> divergence</h3>

<div class="lyx_code"><a id="magicparlabel-7362"></a><div class="lyx_code_item">divergence ds1 &lt;ds1&gt; ds2 &lt;ds2&gt;</div>
</div>
<div class="standard"><a id="magicparlabel-7363"></a>Calculate Kullback-Leibler divergence between specified data sets.</div>
<h3 class="subsection"><a id="magicparlabel-7364"></a><span class="subsection_label">11.13</span> fft</h3>

<div class="lyx_code"><a id="magicparlabel-7365"></a><div class="lyx_code_item">fft &lt;dset0&gt; [&lt;dset1&gt; ...] [out &lt;outfile&gt;] [name &lt;outsetname&gt;] [dt &lt;samp_int&gt;]
<br />

</div>

<dl class="description"><a id="magicparlabel-7366"></a><dt class="description_label">&lt;dset0&gt; [&lt;dset1 ...]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Argument(s) specifying datasets to be used.</span></dd>
<dt class="description_label">[out &lt;outfile&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write results to file named &lt;outfile&gt;.</span></dd>
<dt class="description_label">[name &lt;outsetname&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> The resulting transform will be stored with name &lt;outsetname&gt;.</span></dd>
<dt class="description_label">[dt &lt;samp_int&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Set the sampling interval (default is 1.0).</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-7370"></a>Perform fast Fourier transform (FFT) on specified data set(s). If more than 1 data set, they must all have the same size.</div>
<h3 class="subsection"><a id="magicparlabel-7371"></a><span class="subsection_label">11.14</span> hist | histogram</h3>

<div class="lyx_code"><a id="magicparlabel-7372"></a><div class="lyx_code_item">hist<a id="magicparlabel-7376"></a>
 &lt;dataset_name&gt;[,&lt;min&gt;,&lt;max&gt;,&lt;step&gt;,&lt;bins&gt;] ...</div>
<div class="lyx_code_item">	[free &lt;temperature&gt;] [norm | normint] [gnu] [circular] out &lt;filename&gt;</div>
<div class="lyx_code_item">	[amd &lt;amdboost_data&gt;] [name &lt;outputset name&gt;]</div>
<div class="lyx_code_item">    [traj3d &lt;file&gt; [trajfmt &lt;format&gt;] [parmout &lt;file&gt;]]</div>
<div class="lyx_code_item">	[min &lt;min&gt;] [max &lt;max&gt;] [step &lt;step&gt;] [bins &lt;bins&gt;] [nativeout]
<br />

</div>

<dl class="description"><a id="magicparlabel-7381"></a><dt class="description_label">&lt;dataset_name&gt;[,&lt;min&gt;,&lt;max&gt;,&lt;step&gt;,&lt;bins&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> 
Dataset(s) to be histogrammed. Optionally, the min, max, step, and/or 
number of bins can be specified for this dimension after the dataset 
name separated by commas. It is only necessary to specify the step or 
number of bins, an asterisk '*' indicates the value should be calculated
 from available data. </span></dd>
<dt class="description_label">[free &lt;temperature&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> If specified, estimate free energy from bin populations using <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>G</mi>
    </mrow>
    <mrow><mi>i</mi>
    </mrow>
   </msub><mo>=</mo><mo>-</mo>
   <msub>
    <mrow><mi>k</mi>
    </mrow>
    <mrow><mi>B</mi>
    </mrow>
   </msub><mi>T</mi><mo> ln </mo><mo form="prefix" fence="true" stretchy="true" symmetric="true">(</mo>

   <mfrac>
    <mrow>
     <msub>
      <mrow><mi>N</mi>
      </mrow>
      <mrow><mi>i</mi>
      </mrow>
     </msub>
    </mrow>
    <mrow>
     <msub>
      <mrow><mi>N</mi>
      </mrow>
      <mrow>
       <mrow><mi>M</mi><mi>a</mi><mi>x</mi>
       </mrow>
      </mrow>
     </msub>
    </mrow>
   </mfrac>
<mo form="postfix" fence="true" stretchy="true" symmetric="true">)</mo>

  </mrow>
 </mrow></math>, where K<sub class="script_subscript">B</sub> is Boltzmann's constant, T is the temperature specified by &lt;temperature&gt;, N<sub class="script_subscript">i</sub> is the population of bin i and N<sub class="script_subscript">Max</sub>
 is the population of the most populated bin. Bins with no population 
are given an artificial barrier equivalent to a population of 0.5.</span></dd>
<dt class="description_label">[norm]</dt>
<dd class="description_item"><span style="font-family:monospace;"> If specified, normalize bin populations so the sum over all bins equals 1.0.</span></dd>
<dt class="description_label">[normint]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Normalize bin populations so the integral over them is 1.0.</span></dd>
<dt class="description_label">[gnu]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Internal output only; data will be gnuplot-readable, i.e. a space will be printed after the highest order coordinate cycles.</span></dd>
<dt class="description_label">[circular]</dt>
<dd class="description_item"><span style="font-family:monospace;"> 
Internal output only; data will wrap, i.e. an extra bin will be printed 
before min and after max in each direction. Useful for e.g. dihedral 
angles.</span></dd>
<dt class="description_label">out &lt;filename&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write results to file named &lt;filename&gt;.</span></dd>
<dt class="description_label">[amd &lt;amdboost_data&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Reweight bins using AMD boost energies in data set &lt;amdboost_data&gt; (in KT).</span></dd>
<dt class="description_label">[name &lt;outputset name&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output histogram data set name.</span></dd>
<dt class="description_label">[traj3d &lt;file&gt; [trajfmt &lt;format&gt;]]</dt>
<dd class="description_item"><span style="font-family:monospace;"> (3D histograms only) Write a pseudo-trajectory of the 3 data sets (1 atom) to &lt;file&gt; with format &lt;format&gt;.</span></dd>
<dt class="description_label">[parmout &lt;file&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> (3D histograms only) Write a topology corresponding to the pseudo-trajectory to &lt;file&gt;.</span></dd>
<dt class="description_label">[min &lt;min&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Default minimum to bin if not specified.</span></dd>
<dt class="description_label">[max &lt;max&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Default max to use if not specified.</span></dd>
<dt class="description_label">[step &lt;step&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Default step size to use if not specified.</span></dd>
<dt class="description_label">[bins &lt;bins&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Default bin size to use if not specified.</span></dd>
<dt class="description_label">[nativeout]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Do not use cpptraj data file framework; only necessary for writing out histograms with &gt; 3 dimensions.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-7409"></a>Create an 
N-dimensional histrogram, where N is the number of datasets specified. 
For 1-dimensional histograms the xmgrace '.agr' file format is 
recommended; for 2-dimensional hisograms the gnuplot '.gnu' file format 
is recommended; for all other dimensions plot formatting is disabled and
 the routine uses its own internal output format; this is also enabled 
if <b>gnu</b> or <b>circular</b> is specified.</div>

<div class="standard"><a id="magicparlabel-7410"></a>For example, to create a two dimensional histogram of two datasets 'phi' and 'psi':</div>

<div class="lyx_code"><a id="magicparlabel-7411"></a><div class="lyx_code_item">dihedral phi :2@C :3@N :3@CA :3@C</div>
<div class="lyx_code_item">dihedral psi :3@N :3@CA :3@C :4@N</div>
<div class="lyx_code_item">hist phi,-180,180,*,72 psi,-180,180,*,72 out hist.gnu</div>
</div>
<div class="standard"><a id="magicparlabel-7414"></a>In this case the 
number of bins (72) has been specified for each dimension and '*' has 
been given for the step size, indicating it should be calculated based 
on min/max/bins. The following 'hist' command is equivalent:</div>

<div class="lyx_code"><a id="magicparlabel-7415"></a><div class="lyx_code_item">hist phi psi min -180 max 180 bins 72 out hist.gnu</div>
</div>
<h3 class="subsection"><a id="magicparlabel-7416"></a><span class="subsection_label">11.15</span> integrate</h3>

<div class="lyx_code"><a id="magicparlabel-7417"></a><div class="lyx_code_item">integrate &lt;dset0&gt; [&lt;dset1&gt; ...] [out &lt;outfile&gt;] [name &lt;outsetname&gt;]</div>
</div>
<div class="standard"><a id="magicparlabel-7418"></a>Integrate specified data set(s) using trapezoid integration.</div>
<h3 class="subsection"><a id="magicparlabel-7419"></a><span class="subsection_label">11.16</span> ired</h3>

<div class="lyx_code"><a id="magicparlabel-7420"></a><div class="lyx_code_item">ired [relax freq &lt;MHz&gt; [NHdist &lt;distnh&gt;]] [order &lt;order&gt;]</div>
<div class="lyx_code_item"> 	tstep &lt;tstep&gt; tcorr &lt;tcorr&gt; out &lt;filename&gt; [norm] [drct]</div>
<div class="lyx_code_item"> 	modes &lt;modesname&gt; [name &lt;output sets name&gt;] [ds2matrix &lt;file&gt;]
<br />

</div>

<dl class="description"><a id="magicparlabel-7423"></a><dt class="description_label">[relax freq &lt;MHz&gt; [NHdist &lt;distnh&gt;]]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Should only be used when ired vectors represent N-H bonds; calculate correlation times </span><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi> τ </mi>
   </mrow>
   <mrow><mi>m</mi>
   </mrow>
  </msub>
 </mrow></math><span style="font-family:monospace;"> for each eigenmode 
and relaxation rates and NOEs for each N-H vector. 'freq &lt;MHz&gt;' 
(required) is the Lamor frequency of the measurement. 'NHdist 
&lt;distnh&gt;' specifies the length of the NH bond in Angstroms 
(default is 1.02).</span></dd>
<dt class="description_label">order &lt;order&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Order of the Legendre polynomials to use when calculating spherical harmonics (default 2).</span></dd>
<dt class="description_label">tstep &lt;tstep&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Time between snapshots in ps (default 1.0).</span></dd>
<dt class="description_label">tcorr &lt;tcorr&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Maximum time to calculate correlation functions for in ps (default 10000.0).</span></dd>
<dt class="description_label">out &lt;filename&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Name of file to write output to.</span></dd>
<dt class="description_label">[norm]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Normalize all correlation functions, i.e., <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>C</mi>
    </mrow>
    <mrow><mi>l</mi>
    </mrow>
   </msub><mo form="prefix" fence="true" stretchy="true" symmetric="true">(</mo>

   <mrow><mi>t</mi><mo>=</mo><mn>0</mn>
   </mrow>
<mo form="postfix" fence="true" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
   <msub>
    <mrow><mi>P</mi>
    </mrow>
    <mrow><mi>l</mi>
    </mrow>
   </msub><mo form="prefix" fence="true" stretchy="true" symmetric="true">(</mo>

   <mrow><mi>t</mi><mo>=</mo><mn>0</mn>
   </mrow>
<mo form="postfix" fence="true" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>1.0</mn>
  </mrow>
 </mrow></math>.</span></dd>
<dt class="description_label">[drct]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use the direct method to calculate correlations instead of FFT; this will be much slower.</span></dd>
<dt class="description_label">modes &lt;modesname&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Name of previously calculated eigenmodes corresponding to IRED vectors.</span></dd>
<dt class="description_label">[name &lt;name&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output data set name.</span></dd>
<dt class="description_label">[ds2matrix &lt;file&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> If specified, write full delta*S^2 matrix (# IRED vector rows by # eigenmodes columns) to &lt;file&gt;.</span></dd>
</dl>
<div class="standard"><a id="magicparlabel-7433"></a><span style="font-family:monospace;">DataSets Created:</span></div>

<dl class="description"><a id="magicparlabel-7434"></a><dt class="description_label">&lt;name&gt;[S2]</dt>
<dd class="description_item"><span style="font-family:monospace;"> S2 order parameters for each vector.</span></dd>
<dt class="description_label">&lt;name&gt;[Plateau]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Plateau values for each vector.</span></dd>
<dt class="description_label">&lt;name&gt;[TauM]</dt>
<dd class="description_item"><span style="font-family:monospace;"> TauM values for each vector.</span></dd>
<dt class="description_label">&lt;name&gt;[dS2]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Full delta*S^2 matrix.</span></dd>
<dt class="description_label">&lt;name&gt;[T1]</dt>
<dd class="description_item"><span style="font-family:monospace;"> T1 relaxation values for each vector.</span></dd>
<dt class="description_label">&lt;name&gt;[T2]</dt>
<dd class="description_item"><span style="font-family:monospace;"> T2 relaxation values for each vector.</span></dd>
<dt class="description_label">&lt;name&gt;[NOE]</dt>
<dd class="description_item"><span style="font-family:monospace;"> NOEs for each vector.</span></dd>
<dt class="description_label">&lt;name&gt;[Cm(t)]:X</dt>
<dd class="description_item"><span style="font-family:monospace;"> Cm(t) function for vector X.</span></dd>
<dt class="description_label">&lt;name&gt;[Cj(t)]:X</dt>
<dd class="description_item"><span style="font-family:monospace;"> Cj(t) function for vector X.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-7443"></a>Peform IRED[<a href="#LyXCite-Prompers02a"><span class="bib-numericallabel">26</span></a>]
 analysis on previously defined IRED vectors (see vector ired) using 
eigenmodes calculated from those vectors with a previous 'diagmatrix' 
command. The number of defined IRED vectors should match the number of 
eigenmodes calculated. Autocorrelation functions for each mode and the 
corresponding correlation time <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi> τ </mi>
   </mrow>
   <mrow><mi>m</mi>
   </mrow>
  </msub>
 </mrow></math> will be written to <i>filename.cmt</i>. Autocorrelation functions for each vector will be written to <i>filename.cjt</i>.
 Relaxation rates and NOEs for each N-H vector will be written to 
&lt;filename&gt; or added to the the end of the standard output. For the
 calculation of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi> τ </mi>
   </mrow>
   <mrow><mi>m</mi>
   </mrow>
  </msub>
 </mrow></math> the normalized correlation functions and only the first 
third of the analyzed time steps will be used. For further information 
on the convergence of correlation functions see [Schneider, Brünger, 
Nilges, <i>J. Mol. Biol.</i> <b>285</b>, 727 (1999)].</div>
<h4 class="subsubsection_"><a id="magicparlabel-7444"></a>Example of IRED in Cpptraj</h4>
<div class="standard"><a id="magicparlabel-7445"></a>In <i>cpptraj</i>, IRED analysis[<a href="#LyXCite-Prompers02a"><span class="bib-numericallabel">26</span></a>] can now be performed in one pass (as opposed to the two passes previously required in <i>ptraj</i>).
 First, IRED vectors are defined (in this case for N-H bonds) and an 
IRED matrix is calculated and analyzed. The IRED vectors are then 
projected onto the calculated IRED eigenvectors in the <b><i>ired</i></b> analysis command to calculate the time correlation functions. If the parameter <i>order</i> is specified, order parameters based on IRED are calculated. By specifying the <i>relax</i>
 parameter, relaxation rates and NOEs can be obtained for each N-H 
vector. Note that the order of the IRED matrix should be the same as the
 one specified for IRED analysis.</div>

<div class="lyx_code"><a id="magicparlabel-7446"></a><div class="lyx_code_item"># Define N-H IRED vectors</div>
<div class="lyx_code_item">vector v0 @5 ired @6</div>
<div class="lyx_code_item">vector v1 @7 ired @8</div>
<div class="lyx_code_item">...</div>
<div class="lyx_code_item">vector v5 @15 ired @16</div>
<div class="lyx_code_item">vector v6 @17 ired @18`</div>
<div class="lyx_code_item"># Define IRED matrix using all previous IRED vectors</div>
<div class="lyx_code_item">matrix ired name matired order 2</div>
<div class="lyx_code_item"># Diagonalize IRED matrix</div>
<div class="lyx_code_item">diagmatrix matired vecs 6 out ired.vec name ired.vec</div>
<div class="lyx_code_item"># Perform IRED analysis</div>
<div class="lyx_code_item">ired relax NHdist 1.02 freq 500.0 tstep 1.0 tcorr 100.0 out v0.out noefile noe order 2</div>
</div>
<h3 class="subsection"><a id="magicparlabel-7458"></a><span class="subsection_label">11.17</span> kde</h3>

<div class="lyx_code"><a id="magicparlabel-7459"></a><div class="lyx_code_item">kde &lt;dataset&gt; [bandwidth &lt;bw&gt;] [out &lt;file&gt;] [name &lt;dsname&gt;]</div>
<div class="lyx_code_item">    [min &lt;min&gt;] [max &lt;max] [step &lt;step&gt;] [bins &lt;bins&gt;] [free]</div>
<div class="lyx_code_item">    [kldiv &lt;dsname2&gt; [klout &lt;outfile&gt;]] [amd &lt;amdboost_data&gt;]
<br />

</div>

<dl class="description"><a id="magicparlabel-7462"></a><dt class="description_label">[bandwidth &lt;bw&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Bandwidth to use for KDE; if not specified bandwidth will be estimated using the normal distribution approximation.</span></dd>
<dt class="description_label">[out &lt;file&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output file name.</span></dd>
<dt class="description_label">[name &lt;dsname&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output data set name.</span></dd>
<dt class="description_label">[min &lt;min&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Minimum bin.</span></dd>
<dt class="description_label">[max &lt;max&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Maximum bin.</span></dd>
<dt class="description_label">[step &lt;step&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Bin step.</span></dd>
<dt class="description_label">[bins &lt;bins&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Number of bins.</span></dd>
<dt class="description_label">[free]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Calculate free energy from bin population.</span></dd>
<dt class="description_label">[kldiv &lt;dsname2&gt; [klout &lt;outfile&gt;]]</dt>
<dd class="description_item"><span style="font-family:monospace;"> 
Calculate Kullback-Leibler divergence over time of &lt;dataset&gt; 
distribution to &lt;dsname2&gt; distribution. Output to &lt;outfile&gt; 
if <b>klout</b> specified.</span></dd>
<dt class="description_label">[amd &lt;amdboost_data&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Reweight histogram using AMD boost data from data set &lt;amdboost_data&gt; (in KT).</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-7472"></a>Histogram 1D data set using a Gaussian kernel density estimator.</div>
<h3 class="subsection"><a id="magicparlabel-7473"></a><span class="subsection_label">11.18</span> lifetime<a id="subsec_cpptraj_lifetime"></a>
</h3>

<div class="lyx_code"><a id="magicparlabel-7474"></a><div class="lyx_code_item">lifetime [out &lt;filename&gt;] &lt;dsetarg0&gt; [ &lt;dsetarg1&gt; ... ]</div>
<div class="lyx_code_item">     	[window &lt;windowsize&gt; [name &lt;setname&gt;]] [averageonly]</div>
<div class="lyx_code_item">     	[cumulative] [delta] [cut &lt;cutoff&gt;] [greater | less] [rawcurve]</div>
<div class="lyx_code_item">         [fuzz &lt;fuzzcut&gt;] [nosort]
<br />

</div>

<dl class="description"><a id="magicparlabel-7478"></a><dt class="description_label">[out &lt;filename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write
 results to file named &lt;filename&gt;, and lifetime curves to 
'crv.&lt;filename&gt;'. If performing windowed lifetime analysis, 
&lt;filename&gt; contains the fraction present over time windows, and 2 
additional files are written: 'max.&lt;filename&gt;', containing max 
lifetime over windows, and 'avg.&lt;filename&gt;', containing average 
lifetime over windows.</span></dd>
<dt class="description_label">&lt;dsetarg0&gt; [&lt;dsetarg1&gt; ...]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Argument(s) specifying datasets to be used.</span></dd>
<dt class="description_label">[window &lt;windowsize&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Size 
of window (in frames) over which to calculate lifetimes/averages. If not
 specified lifetime/average will be calculated over all frames.</span></dd>
<dt class="description_label">[name &lt;setname&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Store results in data sets with name &lt;setname&gt;.</span></dd>
<dt class="description_label">[averageonly]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Just calculate averages (no lifetime analysis).</span></dd>
<dt class="description_label">[cumulative]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Calculate cumulative lifetimes/averages over windows.</span></dd>
<dt class="description_label">[delta]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Calculate difference from previous window average.</span></dd>
<dt class="description_label">[cut &lt;cutoff&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Cutoff to use when determining if data is 'present' (default 0.5).</span></dd>
<dt class="description_label">[greater]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Data is considered present when above the cutoff (default).</span></dd>
<dt class="description_label">[less]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Data is considered present when below the cutoff.</span></dd>
<dt class="description_label">[rawcurve]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Do not normalize lifetime curves to 1.0.</span></dd>
<dt class="description_label">[fuzz &lt;fuzzcut&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Ignore changes in lifetime state that are less than &lt;fuzzcut&gt; frames.</span></dd>
<dt class="description_label">[nosort]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Do not sort data sets by name.</span></dd>
</dl>
<div class="standard"><a id="magicparlabel-7491"></a><span style="font-family:monospace;">Data Sets Created:</span></div>

<dl class="description"><a id="magicparlabel-7492"></a><dt class="description_label">&lt;setname&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Number of lifetimes for each set, or if <b>window</b> specified fraction present over time windows.</span></dd>
<dt class="description_label">&lt;setname&gt;[max]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Maximum lifetime for each set, or if <b>window</b> specified maximum lifetime over time windows.</span></dd>
<dt class="description_label">&lt;setname&gt;[avg]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Average lifetime for each set, or if <b>window</b> specified average lifetime over time windows.</span></dd>
<dt class="description_label">&lt;setname&gt;[curve]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Lifetime curves.</span></dd>
</dl>
<div class="standard"><a id="magicparlabel-7496"></a><span style="font-family:monospace;">The following are created only if <b>window</b> not specified:</span></div>

<dl class="description"><a id="magicparlabel-7497"></a><dt class="description_label">&lt;setname&gt;[frames]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Total number of frames lifetime present for each set.</span></dd>
<dt class="description_label">&lt;setname&gt;[name]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Name of each set.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-7499"></a>Perform lifetime 
analysis for specified data sets. Lifetime data can either be determined
 for the entire set, or for time windows of specified size within the 
set if <b>window</b> specified.</div>

<div class="standard"><a id="magicparlabel-7500"></a>A “lifetime” is 
defined as the length of time something remains 'present'; data is 
considered present when above or below a certain cutoff (the default is 
greater than 0.5, useful for analysis of <b><i>hbond</i></b> time series data). For example, in the case of a hydrogen bond <b>'series'</b>
 data set, if a hydrogen bond is present during a frame the value is 1, 
otherwise it is 0. Given the hbond time series data set {1 1 1 0 1 0 0 0
 1 1}, the overall fraction present is 0.6. However, there are 3 
lifetimes of lengths 3, 1, and 2 ({1 1 1}, {1}, and {1 1}). The maximum 
lifetime is 3 and the average lifetime is 2.0, i.e. (3 + 1 + 2) / 3 
lifetimes = 2.0. One can also construct a “lifetime curve”, which is 
constructed as the sum of all individual lifetimes. By default these 
curves are normalized to 1.0, but the raw curve can be obtained using 
the <b>rawcurve</b> keyword. For the example data set here the raw lifetime curve would be 3 frames long:</div>

<div class="lyx_code"><a id="magicparlabel-7501"></a><div class="lyx_code_item">       1 1 1</div>
<div class="lyx_code_item">       1</div>
<div class="lyx_code_item">       1 1</div>
<div class="lyx_code_item">Curve: 3 2 1</div>
</div>
<div class="standard"><a id="magicparlabel-7505"></a>By default data sets are sorted by name unless <b>nosort</b> is specified. The lifetime command can calculate lifetimes over specific time windows by using the <b>window</b>
 keyword. This can be particularly useful if one wants to get a sense 
for how lifetimes are changing over the course of very long time series 
data. In addition, averages can be calculated instead of lifetimes by 
specifying <b>averageonly</b>. Cumulative averages over windows can be obtained using the <b>cumulative</b> keyword, or the change from the average value in the previous window can be obtained using the <b>delta</b> keyword.</div>

<div class="standard"><a id="magicparlabel-7506"></a>The <b>fuzz</b> 
keyword can be used to try and smooth the input data by ignoring changes
 in state that occur for fewer frames than &lt;fuzzcut&gt;. For example,
 in the above example hbond time series data set there is a one frame 
change in state between the first and second lifetimes which could be 
interpreted as a transient breaking of the hydrogen bond. Using a 
&lt;fuzzcut&gt; value of 1, this one frame change in state would be 
ignored, and the data set would effectively appear to lifetime as {1 1 1
 1 1 0 0 0 1 1}. The state change between the second and third lifetimes
 is longer than &lt;fuzzcut&gt; (3 frames) and so it would remain.</div>

<div class="standard"><a id="magicparlabel-7507"></a>If <b>window</b> is
 not specified, two files are output: &lt;filename&gt; and 
crv.&lt;filename&gt;. The file &lt;filename&gt; contains overall 
lifetime stats for each set with format:</div>

<div class="lyx_code"><a id="magicparlabel-7508"></a><div class="lyx_code_item">#Set &lt;setname&gt; &lt;setname&gt;[max] &lt;setname&gt;[avg] &lt;setname&gt;[frames] &lt;setname&gt;[name]</div>
</div>
<div class="standard"><a id="magicparlabel-7509"></a>where <span style="font-family:monospace;">&lt;setname&gt;</span> denotes the total number of lifetimes, <span style="font-family:monospace;">&lt;setname&gt;[max]</span> denotes the maximum lifetime, <span style="font-family:monospace;">&lt;setname&gt;[avg] </span>denotes the average lifetime, <span style="font-family:monospace;">&lt;setname&gt;[frames]</span> denotes the total number of frames present in all lifetimes, and <span style="font-family:monospace;">&lt;setname&gt;[name] </span>is the data set name. The file crv.&lt;filename&gt; contains the lifetime curves for each set.</div>

<div class="standard"><a id="magicparlabel-7510"></a>If <b>window</b> is
 specified, four files are output: &lt;filename&gt;, 
max.&lt;filename&gt;, avg.&lt;filename&gt;, and crv.&lt;filename&gt;. 
&lt;filename&gt; contains the fraction “present” over each time window 
for each set, max.&lt;filename&gt; contains the maximum lifetime in each
 time window for each set, avg.&lt;filename&gt; contains the average 
lifetime over each window for each set, and crv.&lt;filename&gt; 
contains the overall lifetime curves for each set. For window output, 
Gnuplot format is recommended.</div>
<h4 class="subsubsection_"><a id="magicparlabel-7511"></a>Example: hbond lifetime analysis</h4>

<div class="lyx_code"><a id="magicparlabel-7512"></a><div class="lyx_code_item">parm DPDP.parm7</div>
<div class="lyx_code_item">trajin DPDP.nc</div>
<div class="lyx_code_item">hbond HB out hbond.dat @N,H,C,O series uuseries solutehb.agr \</div>
<div class="lyx_code_item">  avgout hbavg.dat printatomnum</div>
<div class="lyx_code_item"># 'run' is used here to process the trajectory and generate hbond data</div>
<div class="lyx_code_item">run</div>
<div class="lyx_code_item"># Perform lifetime analysis</div>
<div class="lyx_code_item">runanalysis lifetime HB[solutehb] out lifehb.dat</div>
</div>
<div class="standard"><a id="magicparlabel-7520"></a>Calculate ion lifetimes from hbond over windows of size 100 frames:</div>

<div class="lyx_code"><a id="magicparlabel-7521"></a><div class="lyx_code_item">hbond ION out ion.dat solventdonor :WAT solventacceptor :WAT@O series</div>
<div class="lyx_code_item">run</div>
<div class="lyx_code_item">lifetime HB[solventhb] out ion.lifetime.100.gnu window 100</div>
</div>
<h3 class="subsection"><a id="magicparlabel-7524"></a><span class="subsection_label">11.19</span> lowestcurve</h3>

<div class="lyx_code"><a id="magicparlabel-7525"></a><div class="lyx_code_item">lowestcurve points &lt;# lowest&gt; [step &lt;stepsize&gt;] &lt;dset0&gt; [&lt;dset1&gt; ...]</div>
<div class="lyx_code_item">                   [out &lt;file&gt;] [name &lt;setname&gt;]
<br />

</div>

<dl class="description"><a id="magicparlabel-7527"></a><dt class="description_label">&lt;# lowest&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Number of lowest points in each bin to average over.</span></dd>
<dt class="description_label">[step &lt;stepsize&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Bin step size</span></dd>
<dt class="description_label">&lt;dset0&gt; [&lt;dset1&gt; ...]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Data set(s) to use.</span></dd>
<dt class="description_label">[out &lt;file&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> File to write lowest curve to.</span></dd>
<dt class="description_label">[name &lt;setname&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output lowest curve set name.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-7532"></a>Calculate a curve 
of the average of the # lowest points in bins of stepsize. Essentially 
each input data set is binned over bins of stepsize, then the lowest 
&lt;#&gt; points are averaged over for each bin.</div>
<h3 class="subsection"><a id="magicparlabel-7533"></a><span class="subsection_label">11.20</span> meltcurve</h3>

<div class="lyx_code"><a id="magicparlabel-7534"></a><div class="lyx_code_item">meltcurve &lt;dset0&gt; [&lt;dset1&gt; ...] [out &lt;outfile&gt;] [name &lt;outsetname&gt;] cut &lt;cut&gt;</div>
</div>
<div class="standard"><a id="magicparlabel-7535"></a>Calculate melting 
curve from input data sets (i.e. fraction 'folded' for each data set) 
assuming a simple 2-state transition model, using data below 
&lt;cut&gt;as 'folded' and data above &lt;cut&gt; as 'unfolded'.</div>
<h3 class="subsection"><a id="magicparlabel-7536"></a><span class="subsection_label">11.21</span> modes</h3>

<div class="lyx_code"><a id="magicparlabel-7537"></a><div class="lyx_code_item">modes {fluct|displ|corr|eigenval|trajout|rmsip} name &lt;modesname&gt; [name2 &lt;modesname&gt;]</div>
<div class="lyx_code_item">  	[beg &lt;beg&gt;] [end &lt;end&gt;] [bose] [factor &lt;factor&gt;] [calcall]</div>
<div class="lyx_code_item">  	[out &lt;outfile&gt;] [setname &lt;name&gt;]</div>
<div class="lyx_code_item">    Options for 'trajout': (Generate pseudo-trajectory)</div>
<div class="lyx_code_item">  	[trajout &lt;name&gt; parm &lt;name&gt; | parmindex &lt;#&gt;</div>
<div class="lyx_code_item">  	  [trajoutfmt &lt;format&gt;] [trajoutmask &lt;mask&gt;]</div>
<div class="lyx_code_item">	    [pcmin &lt;pcmin&gt;] [pcmax &lt;pcmax&gt;] [tmode &lt;mode&gt;]]</div>
<div class="lyx_code_item">    Options for 'corr': (Calculate dipole correlation)</div>
<div class="lyx_code_item">  	{ maskp &lt;mask1&gt; &lt;mask2&gt; [...] | mask1 &lt;mask&gt; mask2 &lt;mask&gt; }</div>
<div class="lyx_code_item">  	parm &lt;name&gt; | parmindex &lt;#&gt;
<br />

</div>
<div class="standard"><a id="magicparlabel-7547"></a><span style="font-family:monospace;">Types of Calculations:</span></div>

<dl class="description"><a id="magicparlabel-7548"></a><dt class="description_label">fluct</dt>
<dd class="description_item"><span style="font-family:monospace;"> RMS fluctuations (X, Y, Z, and total) for each atom across specified normal modes.</span></dd>
<dt class="description_label">displ</dt>
<dd class="description_item"><span style="font-family:monospace;"> Displacement of cartesian coordinates in the X, Y and Z directions for each atom across specified normal modes.</span></dd>
<dt class="description_label">corr</dt>
<dd class="description_item"><span style="font-family:monospace;"> Dipole-dipole correlation functions. Must also specify <b>maskp</b> (see below).</span></dd>
<dt class="description_label">eigenval</dt>
<dd class="description_item"><span style="font-family:monospace;"> Calculate eigenvalue fractions.</span></dd>
<dt class="description_label">trajout</dt>
<dd class="description_item"><span style="font-family:monospace;"> Create a pseudo-trajectory along the given mode from the average structure.</span></dd>
<dt class="description_label">rmsip</dt>
<dd class="description_item"><span style="font-family:monospace;"> Calculate the root-mean-square inner product between modes specified by <b>name</b> and <b>name2</b>.</span></dd>
</dl>
<div class="standard"><a id="magicparlabel-7554"></a><span style="font-family:monospace;">Options:</span></div>

<dl class="description"><a id="magicparlabel-7555"></a><dt class="description_label">name &lt;modesname&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Previously read-in or generated Modes data set name.</span></dd>
<dt class="description_label">[beg &lt;beg&gt;] [end &lt;end&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> If modes taken from datafile, beginning and end modes to read. Default for <i>beg</i> is 7 (which skips the first 6 zero-frequency modes in the case of a normal mode analysis); for <i>end</i> it is 50.</span></dd>
<dt class="description_label">[bose]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use quantum (Bose) statistics in populating the modes.</span></dd>
<dt class="description_label">[factor &lt;factor&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> multiplicative constant on the amplitude of displacement/pseudo-trajectory, default 1.0.</span></dd>
<dt class="description_label">[calcall]</dt>
<dd class="description_item"><span style="font-family:monospace;"> If specified use all eigenvectors; otherwise eigenvectors associated with zero or negative eigenvalues will be skipped.</span></dd>
<dt class="description_label">[out &lt;outfile&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> File to write data results to. If not given results are written to STDOUT.</span></dd>
<dt class="description_label">[setname &lt;name&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output data set name.</span></dd>
</dl>
<div class="standard"><a id="magicparlabel-7562"></a><span style="font-family:monospace;">Options for 'trajout':</span></div>

<dl class="description"><a id="magicparlabel-7563"></a><dt class="description_label">&lt;name&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output trajectory file name.</span></dd>
<dt class="description_label">[parm &lt;parmfile/tag&gt;|parmindex &lt;#&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Topology file to use (default first Topology loaded).</span></dd>
<dt class="description_label">[trajoutfmt &lt;format&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output trajectory format.</span></dd>
<dt class="description_label">[trajoutmask &lt;mask&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Mask of atoms that correspond to how modes were originally generated.</span></dd>
<dt class="description_label">[pcmin &lt;pcmin&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Lowest principal component projection value to use for output trajectory.</span></dd>
<dt class="description_label">[pcmax &lt;pcmax&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Highest principal component projection value to use for output trajectory.</span></dd>
<dt class="description_label">[tmode &lt;mode&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Mode to generate pseudo-trajectory for.</span></dd>
</dl>
<div class="standard"><a id="magicparlabel-7570"></a><span style="font-family:monospace;">Options for 'corr':</span></div>

<dl class="description"><a id="magicparlabel-7571"></a><dt class="description_label">[maskp &lt;mask1&gt; &lt;mask2&gt; [...]]</dt>
<dd class="description_item"><span style="font-family:monospace;"> If <b>corr</b>, pairs of atom masks (<i>mask1</i>, <i>mask2</i>;
 each pair preceded by “maskp” and each mask defining only a single 
atom) have to be given that specify the atoms for which the correlation 
functions are desired.</span></dd>
<dt class="description_label">mask1 &lt;mask&gt; mask2 &lt;mask&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Instead of <b>maskp</b>, specify two masks; atoms from the first mask will be paired up with atoms from the second mask.</span></dd>
</dl>
<div class="standard"><a id="magicparlabel-7573"></a><span style="font-family:monospace;">DataSets Created (fluct)</span></div>

<dl class="description"><a id="magicparlabel-7574"></a><dt class="description_label">&lt;name&gt;[rmsX]</dt>
<dd class="description_item"><span style="font-family:monospace;"> RMS fluctuations in the X direction.</span></dd>
<dt class="description_label">&lt;name&gt;[rmsY]</dt>
<dd class="description_item"><span style="font-family:monospace;"> RMS fluctuations in the Y direction.</span></dd>
<dt class="description_label">&lt;name&gt;[rmsZ]</dt>
<dd class="description_item"><span style="font-family:monospace;"> RMS fluctuations in the Z direction.</span></dd>
<dt class="description_label">&lt;name&gt;[rms]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Total RMS fluctuations.</span></dd>
</dl>
<div class="standard"><a id="magicparlabel-7578"></a><span style="font-family:monospace;">DataSets Created (displ)</span></div>

<dl class="description"><a id="magicparlabel-7579"></a><dt class="description_label">&lt;name&gt;[displX]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Displacement in X direction.</span></dd>
<dt class="description_label">&lt;name&gt;[displY]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Displacement in Y direction.</span></dd>
<dt class="description_label">&lt;name&gt;[displZ]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Displacement in Z direction.</span></dd>
</dl>
<div class="standard"><a id="magicparlabel-7582"></a><span style="font-family:monospace;">DataSets Created (eigenval)</span></div>

<dl class="description"><a id="magicparlabel-7583"></a><dt class="description_label">&lt;name&gt;[Frac]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Fraction eigenvalue contributes to overall motion.</span></dd>
<dt class="description_label">&lt;name&gt;[Cumulative]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Cumulative fraction.</span></dd>
<dt class="description_label">&lt;name&gt;[Eigenval]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Value of eigenvlue.</span></dd>
</dl>
<div class="standard"><a id="magicparlabel-7586"></a><span style="font-family:monospace;">DataSets Created (rmsip)</span></div>

<dl class="description"><a id="magicparlabel-7587"></a><dt class="description_label">&lt;name&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Result of RMSIP calculation.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-7588"></a>Analyze previously 
calculated eigenmodes obtained from principal component analyses (of 
covariance matrices) or quasiharmonic analyses (diagmatrix analysis 
command). Modes are taken from a previously generated data set (i.e. 
from <b><i>diagmatrix</i></b>) or read in from a data file with <b><i>readdata</i></b>. By default, classical (Boltzmann) statistics are used in populating the modes. A possible series of commands would be “<b><span style="font-family:sans-serif;">matrix</span></b><span style="font-family:monospace;"> covar</span> <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi> | </mi>
 </mrow></math> <span style="font-family:monospace;">mwcovar</span> ...” to generate the matrix, “<b><span style="font-family:monospace;">diagmatrix</span></b> ...” to calculate the modes, and, finally, “<b><span style="font-family:monospace;">modes</span></b> ...”. </div>

<div class="standard"><a id="magicparlabel-7589"></a>For example, to 
calculate the RMS fluctuations or displacements of the first 3 
eigenmodes caluclated from a mass-weighted covariance matrix:</div>

<div class="lyx_code"><a id="magicparlabel-7590"></a><div class="lyx_code_item">matrix mwcovar name mwcvmat out mwcvmat.dat</div>
<div class="lyx_code_item">diagmatrix mwcvmat name evecs vecs 5</div>
<div class="lyx_code_item">modes fluct out rmsfluct.dat name evecs beg 1 end 3</div>
<div class="lyx_code_item">modes displ out resdispl.dat name evecs beg 1 end 3</div>
</div>
<div class="standard"><a id="magicparlabel-7594"></a>Additionally, 
dipole-dipole correlation functions for modes obtained from principle 
component analysis or quasiharmonic analysis can be computed.</div>

<div class="lyx_code"><a id="magicparlabel-7595"></a><div class="lyx_code_item">modes corr out cffromvec.dat name evecs beg 1 end 3 \</div>
<div class="lyx_code_item">      maskp @1 @2 maskp @3 @4 maskp @5 @6</div>
</div>
<div class="standard"><a id="magicparlabel-7597"></a>or</div>

<div class="lyx_code"><a id="magicparlabel-7598"></a><div class="lyx_code_item">mode corr out cffromvec.dat name evecs beg 1 end 3 mask1 @1,3,5 mask2 @2,4,6</div>
</div>
<div class="standard"><a id="magicparlabel-7599"></a>If <b>eigenval</b> is specified, the fraction contribution of each eigenvector to the total motion is calculated and output with format:</div>

<div class="lyx_code"><a id="magicparlabel-7600"></a><div class="lyx_code_item">#Mode Frac. Cumulative Eigenval </div>
</div>
<div class="standard"><a id="magicparlabel-7601"></a>where <span style="font-family:monospace;">#Mode</span> is the eigenvector number, <span style="font-family:monospace;">Frac.</span> is the eigenvalue over the sum of all eigenvalues, <span style="font-family:monospace;">Cumulative</span> is the cumulative sum of <span style="font-family:monospace;">Frac.</span>, and <span style="font-family:monospace;">Eigenval</span>
 is the eigenvalue itself. Note that in order to get an idea for how 
much each eigenvector contributes to all motion, this is best used when 
all possible eigenvectors have been determined for a system.</div>

<div class="standard"><a id="magicparlabel-7602"></a>In order to visualize eigenvectors, pseudo-trajectories along eigenvectors can be created using average coordinates with the <b>trajout</b>
 keyword. For example, to write a pseudo-trajectory of the first 
principal component from principal component value of -100 to 100 for a 
previously calculated Modes data set corresponding to heavy atoms (no 
hydrogens) for residues 1 to 36:</div>

<div class="lyx_code"><a id="magicparlabel-7603"></a><div class="lyx_code_item">parm ../GAAC.nowat.parm7</div>
<div class="lyx_code_item">readdata evecs.dat</div>
<div class="lyx_code_item">runanalysis modes name evecs.dat trajout test.nc trajoutfmt netcdf \</div>
<div class="lyx_code_item">            trajoutmask :1-36&amp;!@H= pcmin -100 pcmax 100 tmode 1</div>
</div>
<h3 class="subsection"><a id="magicparlabel-7607"></a><span class="subsection_label">11.22</span> multicurve</h3>

<div class="lyx_code"><a id="magicparlabel-7608"></a><div class="lyx_code_item">multicurve set &lt;dset&gt; [set &lt;dset&gt; ...] </div>
<div class="lyx_code_item">           &lt;dset&gt; { &lt;equation&gt; |</div>
<div class="lyx_code_item">                    name &lt;dsname&gt; nexp &lt;m&gt; [form {mexp|mexpk|mexpk_penalty} }</div>
<div class="lyx_code_item">           [AX=&lt;value&gt; ...] [out &lt;outfile&gt;] [resultsout &lt;results&gt;]</div>
<div class="lyx_code_item">           [maxit &lt;max iterations&gt;] [tol &lt;tolerance&gt;]</div>
<div class="lyx_code_item">           [outxbins &lt;NX&gt; outxmin &lt;xmin&gt; outxmax &lt;xmax&gt;]
<br />

</div>

<dl class="description"><a id="magicparlabel-7614"></a><dt class="description_label">set &lt;dset&gt; [set &lt;dset&gt; ...]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Data set(s) to fit.</span></dd>
<dt class="description_label">&lt;equation&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Equation to fit of form &lt;Variable&gt; = &lt;Equation&gt;. See <a href="#subsec_cpptraj_Data_Set_Math">4.2</a> for more details on equations <em>cpptraj</em> understands.</span></dd>
<dt class="description_label">name &lt;dsname&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Name of output data sets (required if using <b>nexp</b>).</span></dd>
<dt class="description_label">nexp &lt;m&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Fit to specified number of exponentials.</span></dd>
<dt class="description_label">form &lt;type&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Fit to specified exponential form:
<br />

</span>

<dl class="description"><a id="magicparlabel-7619"></a><dt class="description_label">mexp</dt>
<dd class="description_item"><span style="font-family:monospace;"> Multi-exponential, SUM(m)[ An * exp(An+1 * X)]</span></dd>
<dt class="description_label">mexpk</dt>
<dd class="description_item"><span style="font-family:monospace;"> Multi-exponential plus constant, A0 + SUM(m)[An * exp(An+1 * X)]</span></dd>
<dt class="description_label">mexpk_penalty</dt>
<dd class="description_item"><span style="font-family:monospace;"> Same as mexpk except sum of prefactors constrained to 1.0 and exponential constants constrained to &lt; 0.0.</span></dd>
</dl>
</dd><dt class="description_label">AX=&lt;value&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Value of any constants in specified equation with X starting from 0 (can specify more than one).</span></dd>
<dt class="description_label">out &lt;outfile&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write resulting fit curve to &lt;outfile&gt;.</span></dd>
<dt class="description_label">resultsout &lt;results&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write details of the fit to &lt;results&gt; (default STDOUT).</span></dd>
<dt class="description_label">maxit &lt;max iterations&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Number of iterations to run curve fitting algotrithm (default 50).</span></dd>
<dt class="description_label">tol &lt;tolerance&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Curve-fitting tolerance (default 1E-4).</span></dd>
<dt class="description_label">outxbins &lt;NX&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Number of points to use when generating final curve (default same number of points as input data set).</span></dd>
<dt class="description_label">outxmin &lt;xmin&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Minimum X value to use for final curve (default same number of points as input data set).</span></dd>
<dt class="description_label">outxmax &lt;xmax&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Maximum X value to use for final curve (default same number of points as input data set).</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-7630"></a>Fit each input data set &lt;dset&gt; to &lt;equation&gt;. See the <em><b>curvefit</b></em> command <a href="#subsec_cpptraj_curvefit">elsewhere</a> for more details.</div>
<h3 class="subsection"><a id="magicparlabel-7631"></a><span class="subsection_label">11.23</span> multihist</h3>

<div class="lyx_code"><a id="magicparlabel-7632"></a><div class="lyx_code_item">multihist [out &lt;filename&gt;] [name &lt;dsname&gt;] [norm | normint] [kde]</div>
<div class="lyx_code_item">          [min &lt;min&gt;] [max &lt;max&gt;] [step &lt;step&gt;] [bins &lt;bins&gt;] [free &lt;T&gt;]</div>
<div class="lyx_code_item">          &lt;dsetarg0&gt; [ &lt;dsetarg1&gt; ... ]
<br />

</div>

<dl class="description"><a id="magicparlabel-7635"></a><dt class="description_label">out &lt;filename&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output file.</span></dd>
<dt class="description_label">name &lt;dsname&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Name for resulting histogram data sets.</span></dd>
<dt class="description_label">norm</dt>
<dd class="description_item"><span style="font-family:monospace;"> (Only used if not kde) Normalize so that max bin is 1.0.</span></dd>
<dt class="description_label">normint</dt>
<dd class="description_item"><span style="font-family:monospace;"> (Default for kde) Normalize integral over histogram to 1.0.</span></dd>
<dt class="description_label">kde</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use kernel density estimator to construct histogram.</span></dd>
<dt class="description_label">min &lt;min&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Histogram minimum (default data set minimum).</span></dd>
<dt class="description_label">max &lt;max&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Histogram maximum (default data set maximum).</span></dd>
<dt class="description_label">step &lt;step&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Histogram step.</span></dd>
<dt class="description_label">bins &lt;bins&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Number of histogram bins.</span></dd>
<dt class="description_label">free &lt;T&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Calculate free energy from bin populations as G = -R * &lt;T&gt; * ln( Ni / Nmax ).</span></dd>
<dt class="description_label">&lt;dsetargX&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Data set argument - may specify more than one.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-7646"></a>Histogram each data set separately in 1D. Must specify at least <b>bins</b> or <b>step</b>.</div>
<h3 class="subsection"><a id="magicparlabel-7647"></a><span class="subsection_label">11.24</span> phipsi</h3>

<div class="lyx_code"><a id="magicparlabel-7648"></a><div class="lyx_code_item">phipsi &lt;dsarg0&gt; [&lt;dsarg1&gt; ...] resrange &lt;range&gt; [out &lt;file&gt;]
<br />

</div>

<dl class="description"><a id="magicparlabel-7649"></a><dt class="description_label">&lt;dsargX&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Argument selecting data sets. Can specify more than 1.</span></dd>
<dt class="description_label">resrange &lt;range&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Residue range to use (actually uses data set index).</span></dd>
<dt class="description_label">[out &lt;file&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output file.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-7652"></a>Calculate the average and standard deviation of [phi] and [psi] data set pairs, write to &lt;file&gt; with format:</div>

<div class="lyx_code"><a id="magicparlabel-7653"></a><div class="lyx_code_item">#Phi Psi SD(Phi) SD(Psi) Legend</div>
</div>
<div class="standard"><a id="magicparlabel-7654"></a>Where Phi is the 
average value of phi, Psi is the average value of psi, SD(Phi) is the 
standard deviation of phi, SD(psi) is the standard deviation of psi, and
 Legend contains text describing the phi and psi data sets used in the 
calculation. Periodicity is taken into account during averaging. The 
data sets must have been internally labeled as type 'phi'/'psi' and must
 have a data set index set (actions like dihedral and multidihedral do 
this automatically). For example:</div>

<div class="lyx_code"><a id="magicparlabel-7655"></a><div class="lyx_code_item">parm ../DPDP.parm7</div>
<div class="lyx_code_item">trajin ../DPDP.nc</div>
<div class="lyx_code_item">multidihedral DPDP phi psi</div>
<div class="lyx_code_item">run</div>
<div class="lyx_code_item">phipsi DPDP[phi] DPDP[psi] out phipsi.dat resrange 1-22</div>
</div>
<h3 class="subsection"><a id="magicparlabel-7660"></a><span class="subsection_label">11.25</span> regress</h3>

<div class="lyx_code"><a id="magicparlabel-7661"></a><div class="lyx_code_item">regress &lt;dset0&gt; [&lt;dset1&gt; ...] [name &lt;name&gt;] [nx &lt;nxvals&gt;]</div>
<div class="lyx_code_item">    	[out &lt;filename&gt;] [statsout &lt;filename&gt;]
<br />

</div>

<dl class="description"><a id="magicparlabel-7663"></a><dt class="description_label">dsetX</dt>
<dd class="description_item"><span style="font-family:monospace;"> Data set(s) to perform linear regression for.</span></dd>
<dt class="description_label">name &lt;name&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Data set name for resulting linear fits.</span></dd>
<dt class="description_label">nx &lt;nxvals&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Number of X values to use in output data set(s) (ranging from input set min to max X). If not specified, input X values used.</span></dd>
<dt class="description_label">out &lt;filename&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> File to write fit lines to.</span></dd>
<dt class="description_label">statsout &lt;filename&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> File to write fit statistics to.</span></dd>
</dl>
<div class="standard"><a id="magicparlabel-7668"></a><span style="font-family:monospace;">DataSets Generated:</span></div>

<dl class="description"><a id="magicparlabel-7669"></a><dt class="description_label">&lt;name&gt;:&lt;idx&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output fit line(s) (indexed by input set order if more than one input set).</span></dd>
<dt class="description_label">&lt;name&gt;[slope]:&lt;idx&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output fit line slope(s).</span></dd>
<dt class="description_label">&lt;name&gt;[intercept]:&lt;idx&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output fit line intercept(s).</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-7672"></a>Perform linear regression on the specified data set(s). The fit line is calculated using either the input X values or <b>&lt;nxvals&gt;</b> values ranging from the input set minimum to maximum X. Statistics for the fit(s) are saved to the file specified by <b>statsout</b> or reported to STDOUT. </div>

<div class="standard"><a id="magicparlabel-7673"></a>For example, to fit data read in from a file and then create a set using the fit parameters:</div>

<div class="lyx_code"><a id="magicparlabel-7674"></a><div class="lyx_code_item">readdata esurf_vs_rmsd.dat.txt index 1 name XY</div>
<div class="lyx_code_item">runanalysis regress XY name FitXY statsout statsout.dat</div>
<div class="lyx_code_item">createset "Y = FitXY[slope] * X + FitXY[intercept]" xstep .2 nx 100</div>
<div class="lyx_code_item">writedata Y.dat Y</div>
</div>
<h3 class="subsection"><a id="magicparlabel-7678"></a><span class="subsection_label">11.26</span> remlog<a id="subsec_cpptraj_remlog"></a>
</h3>

<div class="lyx_code"><a id="magicparlabel-7679"></a><div class="lyx_code_item">remlog {&lt;remlog dataset&gt; | &lt;remlog filename&gt;} [out &lt;filename&gt;] [crdidx | repidx]</div>
<div class="lyx_code_item">   	[stats [statsout &lt;file&gt;] [printtrips] [reptime &lt;file&gt;]] [lifetime &lt;file&gt;]</div>
<div class="lyx_code_item">   	[reptimeslope &lt;n&gt; reptimeslopeout &lt;file&gt;] [acceptout &lt;file&gt;] [name &lt;setname&gt;]
<br />

</div>
<div class="lyx_code_item">       [edata [edataout &lt;file&gt;]]</div>

<dl class="description"><a id="magicparlabel-7683"></a><dt class="description_label">&lt;remlog dataset&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Previously read-in REM log data.</span></dd>
<dt class="description_label">&lt;remlog filename&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> REM log file name to read in.</span></dd>
<dt class="description_label">[out &lt;filename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write replica/coordinate index versus time to &lt;filename&gt;.
<br />

</span>

<dl class="description"><a id="magicparlabel-7686"></a><dt class="description_label">crdidx</dt>
<dd class="description_item"><span style="font-family:monospace;"> Print coordinate index vs exchange; output sets contain replica indices. </span></dd>
<dt class="description_label">repidx</dt>
<dd class="description_item"><span style="font-family:monospace;"> Print replica index vs exchange; output sets contain coordinate indices. </span></dd>
</dl>
</dd><dt class="description_label">stats [statsout &lt;file&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Calculate round-trip statistics and optionally write to &lt;file&gt;.</span></dd>
<dt class="description_label">printtrips</dt>
<dd class="description_item"><span style="font-family:monospace;"> Print details of each individual round trip.</span></dd>
<dt class="description_label">[reptime &lt;file&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write time spent at each replica to &lt;file&gt;.</span></dd>
<dt class="description_label">[lifetime &lt;file&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Print lifetime data at each replica to &lt;file&gt;.</span></dd>
<dt class="description_label">[reptimeslope &lt;n&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Calculate the slope of time spent at each replica every &lt;n&gt; exchanges.</span></dd>
<dt class="description_label">[reptimeslopeout &lt;file&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> File to write <b>reptimeslope</b> output to.</span></dd>
<dt class="description_label">[acceptout &lt;file&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write overall exchange acceptances to &lt;file&gt;.</span></dd>
<dt class="description_label">[name &lt;setname&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output data set name.</span></dd>
<dt class="description_label">[edata [edataout &lt;file&gt;]]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Extract energy data from replica log, optionally write to file.</span></dd>
</dl>
<div class="standard"><a id="magicparlabel-7697"></a><span style="font-family:monospace;">DataSets created:</span></div>

<dl class="description"><a id="magicparlabel-7698"></a><dt class="description_label">&lt;setname&gt;:&lt;idx&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Replica/coordinate index vs exchange.</span></dd>
<dt class="description_label">&lt;setname&gt;[E]:&lt;idx&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> If 'edata' specified, energy data from replica log.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-7700"></a>Analyze previously read in (via <em><b>readdata</b></em>)
 M-REMD/T-REMD/H-REMD replica log data. Statistics calculated include 
round-trip time, which is the time needed for a coordinate set to travel
 from the lowest replica to the highest and back, and the number of 
exchanges each coordinate spent at each replica. For example, to read in
 REM log data from an Amber M-REMD run and analyze it:</div>

<div class="lyx_code"><a id="magicparlabel-7701"></a><div class="lyx_code_item">readdata rem.log.1.save rem.log.2.save dimfile remd.dim as remlog nosearch </div>
<div class="lyx_code_item">remlog rem.log.1.save stats reptime mremdreptime.dat </div>
</div>
<div class="standard"><a id="magicparlabel-7703"></a>For an example of <em><b>remlog</b></em> analysis applied to actual REMD data, see Roe et al.[<a href="#LyXCite-Roe2014"><span class="bib-numericallabel">29</span></a>].</div>
<h3 class="subsection"><a id="magicparlabel-7704"></a><span class="subsection_label">11.27</span> rms2d<a id="subsec_cpptraj_rms2d"></a>
 | 2drms</h3>

<div class="lyx_code"><a id="magicparlabel-7705"></a><div class="lyx_code_item">rms2d<a id="magicparlabel-7709"></a>
 [crdset &lt;crd set&gt;] [&lt;name&gt;] [&lt;mask&gt;] [out &lt;filename&gt;]</div>
<div class="lyx_code_item">      [dme | nofit | srmsd] [mass]</div>
<div class="lyx_code_item">      [reftraj &lt;traj&gt; [parm &lt;parmname&gt; | parmindex &lt;parm#&gt;] [&lt;refmask&gt;]]</div>
<div class="lyx_code_item">      [corr &lt;corrfilename&gt;]
<br />

</div>

<dl class="description"><a id="magicparlabel-7713"></a><dt class="description_label">[crdset &lt;crd set&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Name of previously generated COORDS DataSet. If not specified the default COORDS set will be used.</span></dd>
<dt class="description_label">[&lt;mask&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Mask of atoms to calculate 2D-RMSD for. Default is all atoms.</span></dd>
<dt class="description_label">[out &lt;filename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write results to &lt;filename&gt;.</span></dd>
<dt class="description_label">[dme]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Calculate distance RMSD instead of coordinate RMSD; this is substantially slower.</span></dd>
<dt class="description_label">[nofit]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Calculate RMSD without fitting.</span></dd>
<dt class="description_label">[srmsd]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Calculate symmetry-corrected RMSD (see <a href="#subsec_cpptraj_symmrmsd">10.76</a>).</span></dd>
<dt class="description_label">[mass]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Mass-weight RMSD.</span></dd>
<dt class="description_label">[reftraj &lt;traj&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Calculate 2D RMSD to frames in trajectory &lt;traj&gt; instead (can also be another COORDS set).</span></dd>
<dt class="description_label">[parm &lt;parmname&gt; | parmindex &lt;#&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Topology to use for &lt;traj&gt;; only useful in conjunction with <b>reftraj</b>.</span></dd>
<dt class="description_label">[&lt;refmask&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Mask of atoms in reference; only useful in conjunction with <b>reftraj</b>.</span></dd>
<dt class="description_label">[corr &lt;corrfilename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Calculate pseudo-auto-correlation <i>C</i> for 2D-RMSD as <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>C</mi><mo form="prefix" fence="true" stretchy="true" symmetric="true">(</mo>
<mi>i</mi>
<mo form="postfix" fence="true" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
   <mfrac>
    <mrow>
     <mrow>
      <msubsup>
       <mrow><mo> ∑ </mo>
       </mrow>
       <mrow>
        <mrow><mi>j</mi><mo>=</mo><mn>0</mn>
        </mrow>
       </mrow>
       <mrow>
        <mrow><mi>j</mi><mo>&lt;</mo><mi>N</mi><mo>-</mo><mi>i</mi>
        </mrow>
       </mrow>
      </msubsup><mo> exp </mo><mo form="prefix" fence="true" stretchy="true" symmetric="true">(</mo>

      <mrow><mo>-</mo><mi>R</mi><mi>M</mi><mi>S</mi><mi>D</mi><mo form="prefix" fence="true" stretchy="true" symmetric="true">(</mo>

       <mrow><mi>j</mi><mo>,</mo><mi>j</mi><mo>+</mo><mi>i</mi>
       </mrow>
<mo form="postfix" fence="true" stretchy="true" symmetric="true">)</mo>

      </mrow>
<mo form="postfix" fence="true" stretchy="true" symmetric="true">)</mo>

     </mrow>
    </mrow>
    <mrow>
     <mrow><mi>N</mi><mo>-</mo><mi>i</mi>
     </mrow>
    </mrow>
   </mfrac>
  </mrow>
 </mrow></math>, where <i>i</i> is the lag, <i>j</i> is the frame #, and <i>N</i>
 is the total number of frames. An exponential is used to weight the 
RMSD since 0.0 RMSD is equivalent to correlation of 1.0. This can only 
be done if <b>reftraj</b> is not used.</span></dd>
</dl>
<div class="standard"><a id="magicparlabel-7724"></a><span style="font-family:monospace;">DataSet Aspects:</span></div>

<dl class="description"><a id="magicparlabel-7725"></a><dt class="description_label">[Corr]</dt>
<dd class="description_item"><span style="font-family:monospace;"> (<b>corr</b> only) Pseudo-auto-correlation.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-7726"></a><i>Note: For backwards compatibility with ptraj the command '2drms' will also work.</i></div>

<div class="standard"><a id="magicparlabel-7727"></a>Calculate the 
best-fit RMSD of each frame in &lt;crd set&gt; (the default COORDS set 
if none specified) to each other frame. This creates an upper-triangle 
matrix named &lt;name&gt; (or a full matrix if <b>reftraj</b> 
specified). The output of the rms2d command can be best-viewed using 
gnuplot; a gnuplot-formatted file can be produced by giving 
&lt;filename&gt; a '.gnu' extension. For example, to calculate the RMSD 
of non-hydrogen atoms of each frame in trajectory “test.nc” to each 
other frame, writing to a gnuplot-viewable file “test.2drms.gnu”:</div>

<div class="lyx_code"><a id="magicparlabel-7728"></a><div class="lyx_code_item">trajin test.nc</div>
<div class="lyx_code_item">rms2d !(@H=) out test.2drms.gnu</div>
</div>
<div class="standard"><a id="magicparlabel-7730"></a>To calculate the 
RMSD of atoms named CA of each frame in trajectory “test.nc” to each 
frame in “ref.nc” (assuming test.nc and ref.nc are using the default 
topology file):</div>

<div class="lyx_code"><a id="magicparlabel-7731"></a><div class="lyx_code_item">trajin test.nc</div>
<div class="lyx_code_item">rms2d @CA out test.2drms.gnu reftraj ref.nc</div>
</div>
<h3 class="subsection"><a id="magicparlabel-7733"></a><span class="subsection_label">11.28</span> rmsavgcorr<a id="subsec_cpptraj_rmsavgcorr"></a>
</h3>

<div class="lyx_code"><a id="magicparlabel-7734"></a><div class="lyx_code_item">rmsavgcorr<a id="magicparlabel-7738"></a>
 [crdset &lt;crd set&gt;] [&lt;name&gt;] [&lt;mask&gt;] [out &lt;filename&gt;] [mass]</div>
<div class="lyx_code_item">       	[stop &lt;maxwindow&gt;] [offset &lt;offset&gt;]</div>
<div class="lyx_code_item">       	{reference &lt;ref file&gt; parm &lt;parmfile&gt; | first}
<br />

</div>

<dl class="description"><a id="magicparlabel-7741"></a><dt class="description_label">[crdset &lt;crd set&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> COORDS data set to use (if not specified the default COORDS set will be used).</span></dd>
<dt class="description_label">[&lt;name&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output data set name.</span></dd>
<dt class="description_label">[&lt;mask&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Atoms to calculate RMS average correlation for.</span></dd>
<dt class="description_label">[out &lt;filename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output filename.</span></dd>
<dt class="description_label">[mass]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Mass weight the RMSD calculation.</span></dd>
<dt class="description_label">[stop &lt;maxwindow&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Only calculate RMS average correlation up to &lt;maxwindow&gt;.</span></dd>
<dt class="description_label">[offset &lt;offset&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Skip every &lt;offset&gt; windows in calculation.</span></dd>
<dt class="description_label">[first]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use first averaged frame as reference for each window (default).</span></dd>
<dt class="description_label">[reference &lt;ref file&gt; [parm &lt;parmfile&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use reference file (with specified parm) as reference for each window.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-7750"></a>The RMS average correlation[<a href="#LyXCite-Roe13"><span class="bib-numericallabel">28</span></a>]
 (RAC) is calculated as the average RMSD of running-averaged coordinates
 over increasing window sizes (or lag). Output has format:</div>

<div class="lyx_code"><a id="magicparlabel-7751"></a><div class="lyx_code_item">&lt;WindowSize&gt; &lt;RAC&gt;</div>
</div>
<div class="standard"><a id="magicparlabel-7752"></a>The first entry has
 a window size of 1, and so is just the average RMSD of all frames to 
the specified reference structure. The second entry has a window size of
 two, so it is the average RMSD of all frames averaged over two adjacent
 windows to the specified reference, and so on. The RAC will be 
calculated up to the number of frames minus 1 or the value specified by <b>stop</b>,
 whichever is lower. The offset can be used to speed up the calculation 
by skipping window sizes. To calculate mass-weighted RMSD specify <b>mass</b>.
 Note that to reduce memory costs it can be useful to strip all 
coordinates not involved in the RMS fit from the system prior to 
specifying 'rmsavgcorr'. For example, to calculate the correlation of 
C-alpha RMSD of residues 2 to 12:</div>

<div class="lyx_code"><a id="magicparlabel-7753"></a><div class="lyx_code_item">strip !(:2-12@CA)</div>
<div class="lyx_code_item">rmsavgcorr out rmscorr.dat</div>
</div>
<div class="standard"><a id="magicparlabel-7755"></a>The curve generated
 by RAC decays towards zero due to the way RAC is defined. By the time 
the "lag" is N-1 (where N is the total number of frames) you have only 
two averaged coordinates: call them Avg1 (averaged over 1 though N-1 
frames) and Avg2 (averaged over 2 through N frames). Barring any 
extraordinary circumstances the RMSD between Avg1 and Avg2 will almost 
certainly be quite low. </div>

<div class="standard"><a id="magicparlabel-7756"></a>The RAC is a way to
 probe the time scales of interesting events. Any deviation from a 
smoothly decaying curve is an indication that there are some significant
 structural differences occurring over that time interval. RAC curves 
can be particularly useful when comparing independent simulations of the
 same system.</div>

<div class="standard"><a id="magicparlabel-7757"></a>One thing to keep 
in mind that since the underlying metric is RMSD, it can be sensitive to
 the reference frame you choose. It may be useful to try looking at both
 RAC from the first frame, as well as an averaged reference frame. For 
an example of use see Galindo-Murillo et al.[<a href="#LyXCite-Galindo2015"><span class="bib-numericallabel">12</span></a>], in particular Figure 2.</div>
<h3 class="subsection"><a id="magicparlabel-7758"></a><span class="subsection_label">11.29</span> rotdif<a id="subsec_cpptraj_rotdif"></a>
</h3>

<div class="lyx_code"><a id="magicparlabel-7759"></a><div class="lyx_code_item">rotdif [outfile &lt;outfilename&gt;] [usefft]</div>
<div class="lyx_code_item">  Options for generating random vectors:</div>
<div class="lyx_code_item">	[nvecs &lt;nvecs&gt;] [rvecin &lt;randvecIn&gt;] [rseed &lt;random seed&gt;]</div>
<div class="lyx_code_item">	[rvecout &lt;randvecOut&gt;] [rmatrix &lt;set name&gt; [rmout &lt;rmOut&gt;]]</div>
<div class="lyx_code_item">  Options for calculating vector time correlation functions:</div>
<div class="lyx_code_item">	[order &lt;olegendre&gt;] [ncorr &lt;ncorr&gt;] [corrout &lt;corrOut&gt;]</div>
<div class="lyx_code_item">  *** The options below only apply if 'usefft' IS NOT specified. ***</div>
<div class="lyx_code_item">  Options for calculating local effective D, small anisotropy:</div>
<div class="lyx_code_item">	[deffout &lt;deffOut&gt;] [itmax &lt;itmax&gt;] [tol &lt;tolerance&gt;] [d0 &lt;d0&gt;]</div>
<div class="lyx_code_item">	[nmesh &lt;NmeshPoints&gt;] dt &lt;tfac&gt; [ti &lt;ti&gt;] tf &lt;tf&gt;</div>
<div class="lyx_code_item">  Options for calculating D with full anisotropy:</div>
<div class="lyx_code_item">	[amoeba_tol &lt;tolerance&gt;] [amoeba_itmax &lt;iterations&gt;]</div>
<div class="lyx_code_item">	[amoeba_nsearch &lt;n&gt;] [scalesimplex &lt;scale&gt;] [gridsearch]</div>
<div class="lyx_code_item">  *** The options below only apply if 'usefft' IS specified. ***</div>
<div class="lyx_code_item">  Options for curve-fitting:</div>
<div class="lyx_code_item">	[fit_tol &lt;tolerance&gt;] [fit_itmax &lt;max # iterations&gt;]  
<br />

</div>

<dl class="description"><a id="magicparlabel-7775"></a><dt class="description_label">outfile &lt;outfilename&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> File to write all output from rotdif command to.</span></dd>
</dl>
<div class="lyx_code_item"><em>Options for generating random vectors:
<span style="font-family:monospace;"><br />

</span></em></div>

<dl class="description"><a id="magicparlabel-7777"></a><dt class="description_label">nvecs &lt;nvecs&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Number of random vectors to generate (default 1000).</span></dd>
<dt class="description_label">rvecin &lt;randvecIn&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> File to read random vectors from (format is 1 per line, 4 columns, &lt;#&gt; &lt;VX&gt; &lt;VY&gt; &lt;VZ&gt;).</span></dd>
<dt class="description_label">rseed &lt;random seed&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Seed for random number generator (default 80531). Specify -1 to use wallclock time.</span></dd>
<dt class="description_label">rvecout &lt;randvecOut&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> File to write random vectors to (format is 1 per line, 4 columns, &lt;#&gt; &lt;VX&gt; &lt;VY&gt; &lt;VZ&gt;).</span></dd>
<dt class="description_label">rmatrix &lt;set name&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Data set to read rotation matrices from. Rotation matrices will be used to rotate random vectors.</span></dd>
<dt class="description_label">rmout &lt;rmOut&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write rotation matrices to file, 1 per line, frame # followed by matrix in row-major order.</span></dd>
</dl>
<div class="lyx_code_item"><em>Options for calculating vector time correlation functions:
<span style="font-family:monospace;"><br />

</span></em></div>

<dl class="description"><a id="magicparlabel-7784"></a><dt class="description_label">order &lt;olegendre&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> The order of Legendre polynomials to use when calculating vector time correlation functions (default 2).</span></dd>
<dt class="description_label">ncorr &lt;ncorr&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Maximum length of time correlation functions in frames. If this is not specified it will be set to (<b>tf</b> - <b>ti</b>) / <b>dt</b> (recommended).</span></dd>
<dt class="description_label">corrout &lt;corrOut&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> If specified write vector time correlation functions to &lt;corrOut&gt;.X with format: &lt;Time&gt; &lt;Px&gt;</span></dd>
</dl>
<div class="lyx_code_item"><em>Options for calculating local effective D, small anisotropy:
<span style="font-family:monospace;"><br />

</span></em></div>

<dl class="description"><a id="magicparlabel-7788"></a><dt class="description_label">deffout &lt;deffOut&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> File to write out local effective diffusion constants determined in the limit of small anisotropy.</span></dd>
<dt class="description_label">itmax &lt;itmax&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> 
Maximum number of iterations to determine each local effective diffusion
 constant (small anisotropy) assuming fit to single exponential form 
(default 500).</span></dd>
<dt class="description_label">tol &lt;tolerance&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> 
Tolerance for determining local effective diffusion constant (small 
anisotropy) assuming fit to single exponential form (default 1E-6).</span></dd>
<dt class="description_label">d0 &lt;d0&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Initial guess for small anisotropy diffusion constant in radians^2/ns (default 0.03).</span></dd>
<dt class="description_label">nmesh &lt;NmeshPoints&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Number of points per frame to use when creating cubic-splined-smoothed forms of vector time correlation curves (default 2).</span></dd>
<dt class="description_label">dt &lt;tfac&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Time interval between frames (used in integrating vector time correlation curves) in ns.</span></dd>
<dt class="description_label">ti &lt;ti&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Initial time value in ns for integrating the time correlation functions (default 0.0).</span></dd>
<dt class="description_label">tf &lt;tf&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Final
 time value in ns for integrating the time correlation functions. It is 
recommended this be less than the maximum simulation time since the 
tails of time correlation functions tend to be noisy.</span></dd>
</dl>
<div class="lyx_code_item"><em>Options for calculating D with full anisotropy:
<span style="font-family:monospace;"><br />

</span></em></div>

<dl class="description"><a id="magicparlabel-7797"></a><dt class="description_label">amoeba_tol &lt;tolerance&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Tolerance for downhill-simplex minimizer (default 1E-7).</span></dd>
<dt class="description_label">amoeba_itmax &lt;iterations&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Number of iterations to run downhill-simplex minimizer (default 10000).</span></dd>
<dt class="description_label">amoeba_nsearch &lt;n&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Number of searches to perform with downhill-simplex minimizer (default 1).</span></dd>
<dt class="description_label">scalesimplex &lt;scale&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Factor to use when scaling simplexes (default 0.5).</span></dd>
<dt class="description_label">gridsearch</dt>
<dd class="description_item"><span style="font-family:monospace;"> If 
specified, perform a brute-force grid search to attempt to find a better
 solution for diffusion tensor with full anisotropy (may be expensive).</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-7802"></a>Evaluate rotational
 diffusion properties of a molecule over a trajectory according to an 
expanded version of the procedure laid out by Wong &amp; Case[<a href="#LyXCite-wong2008"><span class="bib-numericallabel">35</span></a>].
 Briefly, random vectors (representing the orientation of the molecule) 
are rotated according to rotation matrices obtained from an RMS fit to a
 reference structure (typically an averaged structure). For each random 
vector the time correlation function of the rotated vector is calculated
 using Legendre polynomials of the specified order. The integral over 
this time correlation function (which may be smoothed using cubic 
splines to improve the integration) is then used to find the effective 
diffusion constant (D) in the limit of small anisotropy. Then, using 
each calculated D, the diffusion tensor is determined with full 
anisotropy. Finally, a downhill simplex minimizer is used to optimize D 
with full anisotropy; (this last step is not described in the original 
paper).</div>

<div class="standard"><a id="magicparlabel-7803"></a>Rotation matrices are generated via an RMS fit to a reference structure (see <a href="#subsec_cpptraj_rmsd">10.62</a>). It is recommended that the RMS fit be done to an average structure (see <a href="#subsec_cpptraj_average">10.7</a>).
 These rotation matrices are used to rotate each random vector M times 
(where M is the total number of frames), which creates a time series for
 each random vector. The time correlation functions are calculated for 
each random vector time series using Legendre polynomials of the 
specified order (default 2). The maximum length of the correlation 
function (or lag) can be specified by <b>ncorr</b> (in frames). If <b>ncorr</b> is not specified it will be set internally based on the specified values of <b>ti</b>, <b>tf</b>, and <b>dt</b>; this is recommended. Note that if <b>ncorr</b>
 is specified it should be set to a number less than the total number of
 frames since noise in time correlation functions increases as <b>ncorr</b> approaches the # of frames. The integration over the correlation function is from <b>ti </b>(in whatever units are used of <b>dt</b>, generally ns; 0.0 ns if not specified) to <b>tf</b> (same units as <b>ti</b>), with the time between frames specified by <b>dt</b>; the final time should be less than the total simulation time (see example below).</div>

<div class="standard"><a id="magicparlabel-7804"></a>The relative size of the mesh used with cubic spline interpolation for integration is controlled by <b>nmesh</b> (size of the mesh is <b>ncorr</b> points * <b>nmesh</b>); <b>nmesh</b>
 = 1 means no interpolation, default is 2. The iterative solver for 
effective value of the diffusion constant from the correlation functions
 is controlled by <b>itmax</b>, <b>tol</b>, and <b>d0</b>, where <b>itmax</b> specifies the number of iterations to perform (default 500), <b>tol</b> specifies the tolerance (default 1E-6), and <b>d0</b>
 specifies the initial guess for the diffusion constant in radians^2 / 
ns (default 0.03). Effective diffusion constants for each random vector 
can be written out to a file specified by <b>deffout</b>. Results are printed to the file specified by <b>outfile</b>.
 Details on the Q and D tensors are given, as well as observed and 
calculated tau for each random vector. First, results are printed for 
analysis in the limit of small anisotropy. Next, results are printed for
 analysis with full anisotropy. The results of the full anisotropic 
calculation are first given using results from the small anisotropic 
analysis as an initial guess, followed by the final results after 
minimization using the downhill simplex (amoeba) minimizer.</div>
<h4 class="subsubsection_"><a id="magicparlabel-7805"></a>Example</h4>
<div class="standard"><a id="magicparlabel-7806"></a>There are two important things to keep in mind when using rotdif analysis:</div>

<ol class="enumerate"><a id="magicparlabel-7807"></a><li class="enumerate_item">When
 calculating any kind of diffusive property it is best to simulate in 
the microcanonical (NVE) ensemble with a shorter time step and increased
 SHAKE tolerance; thermostats and barostats will effect diffusion 
calculations.</li>
<li class="enumerate_item">Time correlation functions become noisier as 
the length of the function approaches the maximum. Therefore in general 
one should choose parameters for the time correlation function that are 
much shorter than the total simulation length. </li>
</ol>
<div class="standard"><a id="magicparlabel-7809"></a>For example, given a
 trajectory 'mdcrd.nc' containing 10000 frames with a total simulation 
time of 200 ns (so the time between frames is 0.02 ns), to calculate 
rotational diffusion using 100 vectors using rotation matrices generated
 via an RMS fit to 'avgstruct.pdb', computing and integrating the time 
correlation function for each vector from 0 to 5 ns (1/40th of the 
simulation), and writing out the effective diffusion constants and 
results to 'deffs.dat' and 'rotdif.out' respectively:</div>

<div class="lyx_code"><a id="magicparlabel-7810"></a><div class="lyx_code_item">reference avgstruct.pdb [avg]</div>
<div class="lyx_code_item">rms R0 @CA,C,N,O ref [avg] savematrices</div>
<div class="lyx_code_item">trajin mdcrd.nc</div>
<div class="lyx_code_item">rotdif nvecs 100 rmatrix R0[RM] \</div>
<div class="lyx_code_item">       ti 0.0 tf 5.0 dt 0.02 deffout deffs.dat \</div>
<div class="lyx_code_item">       outfile rotdif.out</div>
</div>
<h3 class="subsection"><a id="magicparlabel-7816"></a><span class="subsection_label">11.30</span> runningavg</h3>

<div class="lyx_code"><a id="magicparlabel-7817"></a><div class="lyx_code_item">runningavg &lt;dset1&gt; [&lt;dset2&gt; ...] [name &lt;dsetname&gt;] [out &lt;filename&gt;]</div>
<div class="lyx_code_item">                   [ [cumulative] | [window &lt;window&gt;] ]
<br />

</div>

<dl class="description"><a id="magicparlabel-7819"></a><dt class="description_label">&lt;dset1&gt; [&lt;dset2&gt; ...]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Data set(s) to calculate running average for.</span></dd>
<dt class="description_label">[name &lt;dsetname&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output running average data set name.</span></dd>
<dt class="description_label">[out &lt;filename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> File to write results to.</span></dd>
<dt class="description_label">[cumulative]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Calculate cumulative running average instead.</span></dd>
<dt class="description_label">[window &lt;window&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Size in frames of window over which to calculate running average.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-7824"></a>Calculate running average over windows of given size for data in selected data set(s).</div>
<h3 class="subsection"><a id="magicparlabel-7825"></a><span class="subsection_label">11.31</span> spline</h3>

<div class="lyx_code"><a id="magicparlabel-7826"></a><div class="lyx_code_item">spline &lt;dset0&gt; [&lt;dset1&gt; ...] [out &lt;outfile&gt;] [meshsize &lt;n&gt; | meshfactor &lt;x&gt;]</div>
<div class="lyx_code_item">[meshmin &lt;mmin&gt;] [meshmax &lt;mmax&gt;]
<br />

</div>

<dl class="description"><a id="magicparlabel-7828"></a><dt class="description_label">&lt;dsetX&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Data set(s) to perform splining on.</span></dd>
<dt class="description_label">[out &lt;outfile&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write splined data to &lt;outfile&gt;.</span></dd>
<dt class="description_label">[meshsize&lt;n&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Size of the mesh to use for splining.</span></dd>
<dt class="description_label">[meshfactor &lt;x&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> If meshsize is not given, use a mesh of data set size * &lt;x&gt;.</span></dd>
<dt class="description_label">[meshmin &lt;mmin&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Mesh X minimum value.</span></dd>
<dt class="description_label">[meshmax &lt;mmax&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Mesh X maximum value.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-7834"></a>Cubic spline the given data sets.</div>
<h3 class="subsection"><a id="magicparlabel-7835"></a><span class="subsection_label">11.32</span> statistics | stat<a id="subsec_cpptraj_statistics"></a>
</h3>

<div class="lyx_code"><a id="magicparlabel-7836"></a><div class="lyx_code_item">stat {&lt;name&gt; | ALL} [shift &lt;value&gt;] [out &lt;filename&gt;] [noeout &lt;filename&gt;]</div>
<div class="lyx_code_item">	 [ignorenv] [name &lt;noe setname&gt;]
<br />

</div>

<dl class="description"><a id="magicparlabel-7838"></a><dt class="description_label">&lt;name&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Name of data set to analyze.</span></dd>
<dt class="description_label">ALL</dt>
<dd class="description_item"><span style="font-family:monospace;"> analyze all data sets.</span></dd>
<dt class="description_label">shift &lt;value&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Subtract &lt;value&gt; from all elements in each data set.</span></dd>
<dt class="description_label">[out &lt;filename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write analysis results to &lt;filename&gt; (STDOUT if not specified).</span></dd>
<dt class="description_label">[noeout &lt;filename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> (Type 'noe' only) Write summary of NOE results to &lt;filename&gt;.</span></dd>
<dt class="description_label">[ignorenv]</dt>
<dd class="description_item"><span style="font-family:monospace;"> (Type 'noe' only) Ignore negative NOE violations (i.e. shorter-than-expected distances).</span></dd>
<dt class="description_label">[name &lt;noe setname&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> (Type 'noe' only) Name for output NOE data sets.</span></dd>
</dl>
<div class="standard"><a id="magicparlabel-7845"></a><span style="font-family:monospace;">DataSet Aspects for type 'noe' output:</span></div>

<dl class="description"><a id="magicparlabel-7846"></a><dt class="description_label">[R6]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Averaged <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mn>1</mn><mo>/</mo>
   <msup>
    <mrow><mi>r</mi>
    </mrow>
    <mrow><mn>6</mn>
    </mrow>
   </msup>
  </mrow>
 </mrow></math>distance for each set.</span></dd>
<dt class="description_label">[NViolations]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Number of violations based on given bounds for each set.</span></dd>
<dt class="description_label">[AvgViolation]</dt>
<dd class="description_item"><span style="font-family:monospace;"> <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mn>1</mn><mo>/</mo>
   <msup>
    <mrow><mi>r</mi>
    </mrow>
    <mrow><mn>6</mn>
    </mrow>
   </msup>
  </mrow>
 </mrow></math> averaged distance minus expected distance for each set.</span></dd>
<dt class="description_label">[NOEnames]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Name of each set.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-7850"></a>Analyze angles, 
dihedrals, distances, and/or puckers and calculate various properties. 
More specific analyses can be obtained by labelling 
distances/dihedrals/puckers (from e.g. the <b><i>distance</i></b>, <b><i>dihedral</i></b>, <b><i>pucker</i></b> commands or with the <b><i>dataset</i></b> command) with the 'type &lt;label&gt;' keyword:</div>

<dl class="description"><a id="magicparlabel-7851"></a><dt class="description_label">dihedral type labels:</dt>
<dd class="description_item"> alpha, beta, gamma, delta, epsilon, zeta, chi, c2p h1p, phi, psi, omega, pchi</dd>
<dt class="description_label">distance type labels:</dt>
<dd class="description_item"> noe</dd>
<dt class="description_label">pucker type labels:</dt>
<dd class="description_item"> pucker</dd>
</dl>
<div class="standard"><a id="magicparlabel-7854"></a>For each input data
 set, the average, standard deviation, initial and final values will be 
reported. The cyclic nature of dihedral/pucker data sets is taken into 
consideration when averaging.</div>
<h4 class="subsubsection"><a id="magicparlabel-7855"></a><span class="subsubsection_label">11.32.1</span> Torsion Analysis</h4>
<div class="standard"><a id="magicparlabel-7856"></a>A table will be 
written in ASCII format showing the distribution of torsion values for 
each data set. More specific information may be printed based on the set
 type. Values in the output marked SNB are from those defined by 
Schneider, Neidle, and Berman.[<a href="#LyXCite-Schneider1997"><span class="bib-numericallabel">30</span></a>] For more information on nucleic acid torsion as pertains to RNA see further work by Schneider et al..[<a href="#LyXCite-Schneider2004"><span class="bib-numericallabel">31</span></a>] </div>

<div class="standard"><a id="magicparlabel-7857"></a>For example, to perform in-depth analysis on some nucleic acid dihedral angles:</div>

<div class="lyx_code"><a id="magicparlabel-7858"></a><div class="lyx_code_item">dihedral g0 out dihedrals.dat :1@O5' :1@C5' :1@C4' :1@C3' type gamma </div>
<div class="lyx_code_item">dihedral d0 out dihedrals.dat :1@C5' :1@C4' :1@C3' :1@O3' type delta </div>
<div class="lyx_code_item">dihedral c0 out dihedrals.dat :1@O4' :1@C1' :1@N9 :1@C4 type chi</div>
<div class="lyx_code_item">analyze statistics all out stat.dat</div>
</div>
<h4 class="subsubsection"><a id="magicparlabel-7862"></a><span class="subsubsection_label">11.32.2</span> Distance Analysis</h4>
<div class="standard"><a id="magicparlabel-7863"></a>A table will be 
written in ASCII format showing the distribution of distance values &lt;
 6.5. If a distance is labled as 'type noe' a compact time series will 
be printed in ASCII format showing the NOE as strong, medium, or weak. 
In addition the &lt;r^-6&gt;^(-1/6) averaged value will be reported, as 
well as the number of upper/lower bound violations. If <b>'noeout'</b> is specified, a summary of these results will be written with format:</div>

<div class="lyx_code"><a id="magicparlabel-7864"></a><div class="lyx_code_item">&lt;#NOE&gt; &lt;R6&gt; &lt;Nviolation&gt; &lt;AvgViolation&gt; &lt;Name&gt;</div>
</div>
<div class="standard"><a id="magicparlabel-7865"></a>Where &lt;#NOE&gt; 
is an index, &lt;R6&gt; is the &lt;r^-6&gt;^(-1/6) averaged distance, 
&lt;Nviolation&gt; is the total number of bounds violations, 
&lt;AvgViolation&gt; is the average difference from expected distance <i>Rexp</i> when the distance is violated (note that if not explicitly set, <i>Rexp</i>
 is set to the upper bound when the lower bound is 0.0, or the average 
of upper and lower bounds otherwise), and &lt;Name&gt; is the data set 
legend.</div>

<div class="standard"><a id="magicparlabel-7866"></a>For example, the following input could be used to check certain distances for NOE violations:</div>

<div class="lyx_code"><a id="magicparlabel-7867"></a><div class="lyx_code_item">distance :3@HB= :10@HG= type noe noe_medium </div>
<div class="lyx_code_item">distance :3@HE= :10@HG= type noe noe_strong </div>
<div class="lyx_code_item">distance :3@HA :12@HA type noe noe_medium </div>
<div class="lyx_code_item">distance :3@HD= :12@HG= type noe noe_medium </div>
<div class="lyx_code_item">distance :3@HE= :12@HA type noe noe_strong </div>
<div class="lyx_code_item">analyze statistics all out dpdp.noe.dat noeout noe_graph.dat name Res3_NOE</div>
</div>
<h4 class="subsubsection"><a id="magicparlabel-7873"></a><span class="subsubsection_label">11.32.3</span> Pucker Analysis</h4>
<div class="standard"><a id="magicparlabel-7874"></a>A table will be written in ASCII format showing the distribution of pucker phases for each data set.</div>
<h3 class="subsection"><a id="magicparlabel-7875"></a><span class="subsection_label">11.33</span> ti</h3>

<div class="lyx_code"><a id="magicparlabel-7876"></a><div class="lyx_code_item">ti &lt;dset0&gt; [&lt;dset1&gt; ...] {nq &lt;n quad pts&gt; | xvals &lt;x values&gt;}</div>
<div class="lyx_code_item">	[name &lt;set name&gt;] [out &lt;file&gt;] [curveout &lt;ti curve file&gt;]</div>
<div class="lyx_code_item">	[nskip &lt;#s to skip&gt;]</div>
<div class="lyx_code_item">	[avgincrement &lt;#&gt; [avgmax &lt;#&gt;] [avgskip &lt;#&gt;]]</div>
<div class="lyx_code_item">	[bs_samples &lt;samples&gt; [bs_points &lt;points&gt;] [bs_seed &lt;#&gt;]</div>
<div class="lyx_code_item">	 [bs_fac &lt;factor&gt;]]</div>

<dl class="description"><a id="magicparlabel-7882"></a><dt class="description_label">&lt;dset0&gt; [&lt;dset1&gt; ...]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Data set arguments specifying input DV/DL values.</span></dd>
<dt class="description_label">nq &lt;n quad pts&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Number of points for Gaussian quadrature integration. Expect one data set per point.</span></dd>
<dt class="description_label">xvals &lt;x values&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Comma-separated list of X values for integration. Expect one data set per value.</span></dd>
<dt class="description_label">name &lt;set name&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output data set name.</span></dd>
<dt class="description_label">out &lt;file&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> File to write results of integration to.</span></dd>
<dt class="description_label">curveout &lt;ti curve file&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> File to write TI curves to.</span></dd>
<dt class="description_label">nskip &lt;#s to skip&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Comma separated list of number of points to skip. For each number given, the TI integration will be repeated.</span></dd>
<dt class="description_label">avgincrement &lt;#&gt; [avgmax &lt;#&gt;] [avgskip &lt;#&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> 
Starting from point 'avgskip' (default 0), repeat the TI integration 
calculation in increments of &lt;#&gt; up to 'avgmax' (default all 
points), so 'avgincrement 10' will do points 0-10, 0-20, etc.</span></dd>
<dt class="description_label">bs_samples &lt;samples&gt; [bs_points &lt;points&gt;] [bs_seed&lt;#&gt;] [bs_fac &lt;factor&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> 
Estimate error via bootstrap analysis, repeating the TI integration 
&lt;samples&gt; times using &lt;points&gt; points or &lt;factor&gt; 
times the total number of points. Randomize with given seed.</span></dd>
</dl>
<div class="standard"><a id="magicparlabel-7891"></a><span style="font-family:monospace;">DataSet Aspects:</span></div>

<dl class="description"><a id="magicparlabel-7892"></a><dt class="description_label">[TIcurve]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Raw 
TI curve. If 'nskip' index is number of points skipped. If 
bootstrapping, index is sample index. If 'avgincrement' the index is the
 number of points.</span></dd>
<dt class="description_label">[SD]</dt>
<dd class="description_item"><span style="font-family:monospace;"> For bootstrap analysis, standard deviation of average free energy over samples.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-7894"></a>Calculate free 
energy using DV/DL energies from thermodynamic integration. The results 
of integration of the DV/DL curve will be written to <b>&lt;file&gt;</b>, while the curves themselves will be written to <b>&lt;ti curve file&gt;</b>. Use <b>nq</b> to specify number of Gaussian quadrature points; otherwise the lambda values should be specified by <b>xvals</b>, where <b>&lt;x values&gt;</b> is a comma-separated list.</div>

<div class="standard"><a id="magicparlabel-7895"></a>For example, to 
perform Gaussian quadrature integration using data sets named 'TIdata', 
repeating the calculation for various number of skipped data points:</div>

<div class="lyx_code"><a id="magicparlabel-7896"></a><div class="lyx_code_item">ti TIdata nq 9 name Curve out skip.agr curveout curve.agr nskip 0,5,10,15,20,30,40,50</div>
</div>
<h3 class="subsection"><a id="magicparlabel-7897"></a><span class="subsection_label">11.34</span> timecorr</h3>

<div class="lyx_code"><a id="magicparlabel-7898"></a><div class="lyx_code_item">timecorr vec1 &lt;vecname1&gt; [vec2 &lt;vecname2&gt;] out &lt;filename&gt;</div>
<div class="lyx_code_item">           [order &lt;order&gt;] [tstep &lt;tstep&gt;] [tcorr &lt;tcorr&gt;]</div>
<div class="lyx_code_item">           [dplr] [norm] [drct] [dplrout &lt;dplrfile&gt;] [ptrajformat]
<br />

</div>

<dl class="description"><a id="magicparlabel-7901"></a><dt class="description_label">vec1 &lt;vecname1&gt; [vec2 &lt;vecname2&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> 
Vector(s) on which to operate. By default the auto-correlation function 
will be calculated if one vector is specified, and the cross-correlation
 function will be calculated if two vectors are specified.</span></dd>
<dt class="description_label">out &lt;filename&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Name of file to write output to.</span></dd>
<dt class="description_label">[order &lt;order&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Order of Legendre polynomials to use; default 2.</span></dd>
<dt class="description_label">[tstep &lt;tstep&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Time between snapshots (default 1.0).</span></dd>
<dt class="description_label">[tcorr &lt;tcorr&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Maximum time to calculate correlation functions for (default 10000.0).</span></dd>
<dt class="description_label">[dplr]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output correlation functions <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>C</mi>
    </mrow>
    <mrow><mi>l</mi>
    </mrow>
   </msub><mo> ≡ </mo><mo>&lt;</mo>
   <msub>
    <mrow><mi>P</mi>
    </mrow>
    <mrow><mi>l</mi>
    </mrow>
   </msub><mo>/</mo><mo>(</mo><mi>r</mi><mo>(</mo><mn>0</mn>
   <msup>
    <mrow><mo>)</mo>
    </mrow>
    <mrow><mn>3</mn>
    </mrow>
   </msup><mi>r</mi><mo form="prefix" fence="true" stretchy="true" symmetric="true">(</mo>

   <mrow><mi> τ </mi>
    <msup>
     <mrow><mo>)</mo>
     </mrow>
     <mrow><mn>3</mn>
     </mrow>
    </msup>
   </mrow>
<mo form="postfix" fence="true" stretchy="true" symmetric="true">)</mo>
<mo>&gt;</mo>
  </mrow>
 </mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mo>&lt;</mo><mn>1</mn><mo>/</mo><mo>(</mo><mi>r</mi><mo>(</mo><mn>0</mn>
   <msup>
    <mrow><mo>)</mo>
    </mrow>
    <mrow><mn>3</mn>
    </mrow>
   </msup><mi>r</mi><mo form="prefix" fence="true" stretchy="true" symmetric="true">(</mo>

   <mrow><mi> τ </mi>
    <msup>
     <mrow><mo>)</mo>
     </mrow>
     <mrow><mn>3</mn>
     </mrow>
    </msup>
   </mrow>
<mo form="postfix" fence="true" stretchy="true" symmetric="true">)</mo>
<mo>&gt;</mo>
  </mrow>
 </mrow></math> in addition to the <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>P</mi>
   </mrow>
   <mrow><mi>l</mi>
   </mrow>
  </msub>
 </mrow></math> correlation function.</span></dd>
<dt class="description_label">[norm]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Normalize all correlation functions, i.e., <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>C</mi>
    </mrow>
    <mrow><mi>l</mi>
    </mrow>
   </msub><mo form="prefix" fence="true" stretchy="true" symmetric="true">(</mo>

   <mrow><mi>t</mi><mo>=</mo><mn>0</mn>
   </mrow>
<mo form="postfix" fence="true" stretchy="true" symmetric="true">)</mo>
<mo>=</mo>
   <msub>
    <mrow><mi>P</mi>
    </mrow>
    <mrow><mi>l</mi>
    </mrow>
   </msub><mo form="prefix" fence="true" stretchy="true" symmetric="true">(</mo>

   <mrow><mi>t</mi><mo>=</mo><mn>0</mn>
   </mrow>
<mo form="postfix" fence="true" stretchy="true" symmetric="true">)</mo>
<mo>=</mo><mn>1.0</mn>
  </mrow>
 </mrow></math>.</span></dd>
<dt class="description_label">[drct]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Use the direct method to calculate correlations instead of FFT; this will be much slower.</span></dd>
<dt class="description_label">[dplrout]</dt>
<dd class="description_item"><span style="font-family:monospace;"> (<b>dplr</b> only) Write extra information for each vector related to <b>dplr</b> option to &lt;dplrfile&gt;.</span></dd>
<dt class="description_label">[ptrajformat]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write output in ptraj style (prevents use of data formatting options).</span></dd>
</dl>
<div class="standard"><a id="magicparlabel-7911"></a><span style="font-family:monospace;">DataSet Aspects:</span></div>

<dl class="description"><a id="magicparlabel-7912"></a><dt class="description_label">[P]</dt>
<dd class="description_item"><span style="font-family:monospace;"> P&lt;order&gt; correlation function.</span></dd>
<dt class="description_label">[C]</dt>
<dd class="description_item"><span style="font-family:monospace;"> C&lt;order&gt; correlation function (<b>dplr</b> only).</span></dd>
<dt class="description_label">[R3R3]</dt>
<dd class="description_item"><span style="font-family:monospace;"> &lt;1/(r(0)<sup class="script_superscript">3</sup>r(t)<sup class="script_superscript">3</sup>&gt; correlation function (<b>dplr</b> only).</span></dd>
<dt class="description_label">[R]</dt>
<dd class="description_item"><span style="font-family:monospace;"> (_TC_DIPOLAR_) Average magnitude (&lt;R&gt;).</span></dd>
<dt class="description_label">[RRIG]</dt>
<dd class="description_item"><span style="font-family:monospace;"> (_TC_DIPOLAR_) Sqrt( &lt;R^2&gt; ).</span></dd>
<dt class="description_label">[R3]</dt>
<dd class="description_item"><span style="font-family:monospace;"> (_TC_DIPOLAR_) &lt;1/R^3&gt;.</span></dd>
<dt class="description_label">[R6]</dt>
<dd class="description_item"><span style="font-family:monospace;"> (_TC_DIPOLAR_) &lt;1/R^6&gt;.</span></dd>
<dt class="description_label">[Name]</dt>
<dd class="description_item"><span style="font-family:monospace;"> (_TC_DIPOLAR_) Vector name.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-7928"></a>Calculate time 
auto/cross-correlation functions for vectors using spherical harmonics 
theory. NOTE: To calculate direct correlation functions for vectors just
 use the <em><b>corr</b></em> analysis command. The <b>norm</b> keyword will normalize the resulting correlation functions. Note that if <b>dplr</b> is specified, a new global data set named _TC_DIPOLAR_ will be created, containing extra data for each vector analyzed with a '<b><i>timecorr</i></b> <b>dplr</b>' command.</div>
<h4 class="subsubsection_"><a id="magicparlabel-7929"></a>Examples</h4>
<div class="standard"><a id="magicparlabel-7930"></a>Vectors between 
atoms 5 and 6 as well as 7 and 8 are calculated below, for which auto 
and cross time correlation functions are obtained.</div>

<div class="lyx_code"><a id="magicparlabel-7931"></a><div class="lyx_code_item">vector v0 @5 @6</div>
<div class="lyx_code_item">vector v1 @7 @8</div>
<div class="lyx_code_item">timecorr vec1 v0 tstep 1.0 tcorr 100.0 out v0.out order 2</div>
<div class="lyx_code_item">timecorr vec1 v1 tstep 1.0 tcorr 100.0 out v1.out order 2</div>
<div class="lyx_code_item">timecorr vec1 v0 vec2 v1 tstep 1.0 tcorr 100.0 out v0_v1.out order 2</div>
</div>
<div class="standard"><a id="magicparlabel-7936"></a>Similarly, a vector perpendicular to the plane through atoms 18, 19, and 20 is obtained and further analyzed.</div>

<div class="lyx_code"><a id="magicparlabel-7937"></a><div class="lyx_code_item">vector v2 @18,@19,@20 corrplane</div>
<div class="lyx_code_item">timecorr vec1 v3 tstep 1.0 tcorr 100.0 out v2.out order 2</div>
</div>
<h3 class="subsection"><a id="magicparlabel-7939"></a><span class="subsection_label">11.35</span> vectormath</h3>

<div class="lyx_code"><a id="magicparlabel-7940"></a><div class="lyx_code_item">vectormath vec1 &lt;vecname1&gt; vec2 &lt;vecname2&gt; [out &lt;filename&gt;] [norm] [name &lt;setname&gt;]</div>
<div class="lyx_code_item">           [ dotproduct | dotangle | crossproduct ]
<br />

</div>

<dl class="description"><a id="magicparlabel-7942"></a><dt class="description_label">vec1 &lt;vecname1&gt; vec2 &lt;vecname2&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Vector(s) on which to operate.</span></dd>
<dt class="description_label">[out &lt;filename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Name of file to write output to.</span></dd>
<dt class="description_label">[dotproduct]</dt>
<dd class="description_item"><span style="font-family:monospace;"> (Default) Calculate the dot-product of the two vectors.</span></dd>
<dt class="description_label">[dotangle]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Calculate angle from dot-product between the two vectors; vectors will be normalized.</span></dd>
<dt class="description_label">[crossproduct]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Calculate cross-product of the two vectors.</span></dd>
<dt class="description_label">[norm]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Normalize the vectors; this will affect any subsequent calculations with the vectors. This is turned on automatically if <b>dotangle</b> specified.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-7948"></a>Calculate dot product, angle from dot product (degrees), or cross product for specified vectors. Note that <b>norm</b> normalizes the vectors themselves; the vectors will remain normalized for subsequent calculations or output. Either <b>vec1</b> or <b>vec2</b> can be of size 1; in that case each vector in the set with N frames operates on the single vector. For example, if <b>vec1</b> is size N and <b>vec2</b> is size 1, then each frame of vec1 is operated on the single vector from vec2.</div>

<div class="standard"><a id="magicparlabel-7949"></a>For example, to get the angles between two previously calculated vectors v1 and v2:</div>

<div class="lyx_code"><a id="magicparlabel-7950"></a><div class="lyx_code_item">vectormath vec1 v1 vec2 v2 dotangle out dotproduct.dat name acos(|V1|*|V2|)</div>
</div>
<h3 class="subsection"><a id="magicparlabel-7951"></a><span class="subsection_label">11.36</span> wavelet</h3>

<div class="lyx_code"><a id="magicparlabel-7952"></a><div class="lyx_code_item">wavelet [crdset &lt;set name&gt;] nb &lt;n scaling vals&gt; [s0 &lt;s0&gt;] [ds &lt;ds&gt;]</div>
<div class="lyx_code_item">        [correction &lt;correction&gt;] [chival &lt;chival&gt;] [type &lt;wavelet&gt;]</div>
<div class="lyx_code_item">        [out &lt;filename&gt;] [name &lt;setname&gt;]
<br />

</div>
<div class="lyx_code_item">        [cluster [minpoints &lt;#&gt;] [epsilon &lt;value&gt;] [clusterout &lt;file&gt;]</div>
<div class="lyx_code_item">           [clustermapout &lt;file&gt;] [cmapdetail] [kdist] [cprefix &lt;PDB prefix&gt;]</div>
<div class="lyx_code_item">           [overlay &lt;trajfile&gt;] [overlayparm &lt;parmfile&gt;]]</div>

<dl class="description"><a id="magicparlabel-7958"></a><dt class="description_label">[crdset &lt;set name&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> COORDS data set to use </span></dd>
<dt class="description_label">nb &lt;n scaling vals&gt;</dt>
<dd class="description_item"><span style="font-family:monospace;"> Number of scales. The smaller the number the better resolution, but slower to plot. </span></dd>
<dt class="description_label">[s0 &lt;s0&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> The smallest scale of the wavelet function (default 2dt where dt is time between snapshots in ps ) </span></dd>
<dt class="description_label">[ds &lt;ds&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> 
Spacing between discrete scales. (Default is 0.25. Smaller value of ds 
gives finer resolution. The largest values that give adequate sampling 
in scale for Morlet and Paul are 0.5 and 1.5, respectively)</span></dd>
<dt class="description_label">[correction &lt;correction&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> The 
scale-to-wavelength parameter (1.01 for Morlet, 1.389 for Paul). 
Automatically set based on wavelet if not otherwise specified. </span></dd>
<dt class="description_label">[chival &lt;chival&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> The value of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msubsup>
   <mrow><mi> χ </mi>
   </mrow>
   <mrow><mn>2</mn>
   </mrow>
   <mrow><mn>2</mn>
   </mrow>
  </msubsup>
 </mrow></math>at a particular confidence level </span></dd>
<dt class="description_label">[type &lt;wavelet&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Type of wavelet function to use &lt;morlet&gt; or &lt;paul&gt; </span></dd>
<dt class="description_label">[out &lt;filename&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Write results to file named &lt;filename&gt; </span></dd>
<dt class="description_label">[name &lt;setname&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Store results in data set with name &lt;setname&gt;</span></dd>
<dt class="description_label">[cluster]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Perform wavelet clustering i.e. wavelet feature extraction analysis.</span>

<dl class="description"><a id="magicparlabel-7968"></a><dt class="description_label">[minpoints &lt;#&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Minimum number of points necessary to form a region of interest.</span></dd>
<dt class="description_label">[epsilon &lt;value&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Minimum region of interest size.</span></dd>
<dt class="description_label">[clusterout &lt;file&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output for clustering (see below).</span></dd>
<dt class="description_label">[clustermapout &lt;file&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output cluster map (recommended gnuplot format, see below).</span></dd>
<dt class="description_label">[cmapdetail]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Instead of the map being smoothed to cluster regions, show full detail.</span></dd>
<dt class="description_label">[kdist]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Can be used to determine minpoints and epsilon - see below.</span></dd>
<dt class="description_label">[cprefix &lt;PDB prefix&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Output cluster region PDBs (only containing from minimum to maximum atom and minimum to maximum frame) with given prefix.</span></dd>
<dt class="description_label">[overlay &lt;trajfile&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> 
Create a trajectory that can be overlaid with the original trajectory to
 highlight atoms of interest. Atoms in cluster regions will get their 
normal coordinates - all others are set to the common center of mass. </span></dd>
<dt class="description_label">[overlayparm &lt;parmfile&gt;]</dt>
<dd class="description_item"><span style="font-family:monospace;"> Topology that can be used with the overlay trajectory.</span></dd>
</dl>
</dd></dl>
<div class="standard"><a id="magicparlabel-7977"></a><span style="font-family:monospace;">&lt;wavelet&gt;: morlet, paul</span></div>
</div>
<div class="standard"><a id="magicparlabel-7978"></a>Perform the wavelet
 analysis using fast Fourier transform (FFT) algorithm on specified 
trajectory and write out to a gnuplot-formatted file named 
&lt;name.gnu&gt;. The created Wavelet map provides a clear picture of 
the significant motions which are characterized both in time and space. 
Note that typically the trajectory in question should have rotational 
and translational movement removed (via e.g. the <em><b>rms</b></em> command); otherwise these will be reflected in the wavelet analysis results.</div>

<div class="standard"><a id="magicparlabel-7979"></a>Wavelet analysis 
contains two main steps which performs continues wavelet transform (CWT)
 and statistical significance testing as proposed by Torrence and Compo[<a href="#LyXCite-Torrence1998"><span class="bib-numericallabel">33</span></a>].
 Analysis is executed on one dimensional (1-D) coordinate which is 
defined as the displacement from the starting position. For each atom, 
CWT is calculated over a specified range of scales from <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>S</mi>
   </mrow>
   <mrow><mn>0</mn>
   </mrow>
  </msub>
 </mrow></math>up to <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>S</mi>
    </mrow>
    <mrow><mn>0</mn>
    </mrow>
   </msub>
   <msup>
    <mrow><mn>2</mn>
    </mrow>
    <mrow>
     <mrow><mo form="prefix" fence="true" stretchy="true" symmetric="true">(</mo>

      <mrow><mi>n</mi><mi>b</mi><mo>-</mo><mn>1</mn>
      </mrow>
<mo form="postfix" fence="true" stretchy="true" symmetric="true">)</mo>
<mi>d</mi><mi>s</mi>
     </mrow>
    </mrow>
   </msup>
  </mrow>
 </mrow></math>. To obtain the CWT of the trajectory the Fourier 
transform of atom's displacement and wavelets which scaled by S ( S is 
calculated from: <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>S</mi><mo>=</mo>
   <msub>
    <mrow><mi>S</mi>
    </mrow>
    <mrow><mn>0</mn>
    </mrow>
   </msub>
   <msup>
    <mrow><mn>2</mn>
    </mrow>
    <mrow>
     <mrow><mi>j</mi><mi>d</mi><mi>s</mi>
     </mrow>
    </mrow>
   </msup><mo>;</mo><mspace/><mi>j</mi><mo>=</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo>
   <mi>…
   </mi><mo>,</mo><mi>n</mi><mi>b</mi><mo>-</mo><mn>1</mn>
  </mrow>
 </mrow></math>) is computed and then the inverse Fourier transform of 
the product of Fourier transforms will be calculated as the CWT. After 
calculating the wavelet coordinates for all atoms, a significance 
testing is performed to determine the significance of each wavelet 
coordinate. For doing this test we need to have an appropriate 
background spectrum to consider as a mean or expected spectrum and 
compare our wavelet coordinates against this background. In order to 
calculate the background spectrum since wavelet spectrum (according to 
the convolution theorem) follows the Fourier spectrum, the Fourier 
coefficients over every atom's displacement is calculated using the 
following formula and a model (<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi> μ </mi>
   </mrow>
   <mrow><mi>k</mi>
   </mrow>
  </msub>
 </mrow></math>) is constructed on average which Fourier coefficients fit (<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>X</mi>
   </mrow>
   <mrow><mi>n</mi>
   </mrow>
  </msub>
 </mrow></math>) is the time series which is the atom’s displacement and k is the frequency index[<a href="#LyXCite-Benson2012"><span class="bib-numericallabel">4</span></a>].</div>

<div class="standard"><a id="magicparlabel-7980"></a><math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>f</mi>
    </mrow>
    <mrow>
     <mrow><mi>k</mi><mo>=</mo>
      <mfrac>
       <mrow><mn>1</mn>
       </mrow>
       <mrow><mi>N</mi>
       </mrow>
      </mfrac>
     </mrow>
    </mrow>
   </msub>
   <msubsup>
    <mrow><mo> ∑ </mo>
    </mrow>
    <mrow>
     <mrow><mi>n</mi><mo>=</mo><mn>0</mn>
     </mrow>
    </mrow>
    <mrow>
     <mrow><mi>N</mi><mo>-</mo><mn>1</mn>
     </mrow>
    </mrow>
   </msubsup><mo> exp </mo><mo form="prefix" fence="true" stretchy="true" symmetric="true">(</mo>

   <mfrac>
    <mrow>
     <mrow><mo>-</mo><mn>2</mn><mi> π </mi><mi>i</mi><mi>k</mi><mi>n</mi>
     </mrow>
    </mrow>
    <mrow><mi>N</mi>
    </mrow>
   </mfrac>
<mo form="postfix" fence="true" stretchy="true" symmetric="true">)</mo>

   <msub>
    <mrow><mi>X</mi>
    </mrow>
    <mrow><mi>n</mi>
    </mrow>
   </msub>
  </mrow>
 </mrow></math></div>

<div class="standard"><a id="magicparlabel-7981"></a>This test is 
implemented based on the null hypothesis that the assumption is that 
Fourier coordinates normally distributed around the expected value, then
 the wavelet coordinates should also be normally distributed. Assuming 
the expected background spectrum and since the square of a normally 
distributed variable is chi-square distributed, then the distribution 
for the square of the absolute values of wavelet coordinates (<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mo>|</mo>
   <msub>
    <mrow><mi>W</mi>
    </mrow>
    <mrow>
     <mrow><mi>i</mi><mo>,</mo><mi>k</mi>
     </mrow>
    </mrow>
   </msub>
   <msup>
    <mrow><mo>|</mo>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msup>
  </mrow>
 </mrow></math> is as follows (<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup>
   <mrow><mi> σ </mi>
   </mrow>
   <mrow><mn>2</mn>
   </mrow>
  </msup>
 </mrow></math>is the variance of the atom's displacement).</div>

<div class="standard"><a id="magicparlabel-7982"></a><math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msup>
    <mrow><mi> σ </mi>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msup>
   <msub>
    <mrow><mi> μ </mi>
    </mrow>
    <mrow><mi>k</mi>
    </mrow>
   </msub>
   <msubsup>
    <mrow><mi> χ </mi>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msubsup><mo>/</mo><mn>2</mn>
  </mrow>
 </mrow></math></div>

<div class="standard"><a id="magicparlabel-7983"></a>Then choosing a confidence level we can determine the minimum acceptable value for <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mo>|</mo>
   <msub>
    <mrow><mi>W</mi>
    </mrow>
    <mrow>
     <mrow><mi>i</mi><mo>,</mo><mi>k</mi>
     </mrow>
    </mrow>
   </msub>
   <msup>
    <mrow><mo>|</mo>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msup>
  </mrow>
 </mrow></math>to be considered as a significant coordinates at that 
certain confidence level. In the final map the scales of only those 
wavelet coordinates which are significantly above the expected 
distribution are stored.</div>

<div class="standard"><a id="magicparlabel-7984"></a>For example, to 
perform wavelet analysis on residues 1 to 17 with 40 scaling values 
starting from scaling of 0.2 with a spacing of 0.25 using the Morlet 
wavelet:</div>

<div class="lyx_code"><a id="magicparlabel-7985"></a><div class="lyx_code_item">parm nowat.withions.parm7</div>
<div class="lyx_code_item">trajin nowat.image.nc</div>
<div class="lyx_code_item">rms :1-17@C*,N*,O*,P* first mass</div>
<div class="lyx_code_item">wavelet nb 40 s0 0.2 ds 0.25 correction 1.01 chival 1.6094 type morlet \</div>
<div class="lyx_code_item">        :1-17 out wavelet.gnu usemap</div>
</div>
<h4 class="subsubsection_"><a id="magicparlabel-7990"></a>Wavelet Analysis Feature Extraction</h4>
<div class="standard"><a id="magicparlabel-7991"></a>Wavelet analysis feature extraction (WAFEX)[<a href="#LyXCite-Heidari2016"><span class="bib-numericallabel">15</span></a>]
 uses a density-based clustering algorithm (a modified version of the 
DBSCAN algorithm) to highlight physical and temporal regions that have 
significant motions from wavelet mapsand can extract the specific atoms 
and frames involved in these motions for further analysis. Cluster 
regions shown in the map will be smoother by default for easier 
visualization (unless <b>cmapdetail</b> is specified). Details of the clustering are provided via the <b>clusterout</b> keyword with format:</div>

<div class="lyx_code"><a id="magicparlabel-7992"></a><div class="lyx_code_item">#Cluster [points] [minatm] [maxatm] [minfrm] [maxfrm] [avgval]</div>

<dl class="description"><a id="magicparlabel-7993"></a><dt class="description_label">#Cluster</dt>
<dd class="description_item"><span style="font-family:monospace;"> Cluster region number.</span></dd>
<dt class="description_label">points</dt>
<dd class="description_item"><span style="font-family:monospace;"> Number of points in the cluster.</span></dd>
<dt class="description_label">minatm</dt>
<dd class="description_item"><span style="font-family:monospace;"> Starting atom of the region.</span></dd>
<dt class="description_label">maxatm</dt>
<dd class="description_item"><span style="font-family:monospace;"> End atom of the region.</span></dd>
<dt class="description_label">minfrm</dt>
<dd class="description_item"><span style="font-family:monospace;"> Starting frame of the region.</span></dd>
<dt class="description_label">maxfrm</dt>
<dd class="description_item"><span style="font-family:monospace;"> End frame of the region.</span></dd>
<dt class="description_label">avgval</dt>
<dd class="description_item"><span style="font-family:monospace;"> Average value of points in the region.</span></dd>
</dl>
</div>
<div class="standard"><a id="magicparlabel-8000"></a>For example, to create a 2D gnuplot map highlight regions of interest called 'cluster.gnu' one could use the following input.</div>

<div class="lyx_code"><a id="magicparlabel-8001"></a><div class="lyx_code_item">parm ../DPDP.parm7</div>
<div class="lyx_code_item">trajin ../DPDP.nc</div>
<div class="lyx_code_item">rms @C,CA,N first</div>
<div class="lyx_code_item">wavelet nb 10 s0 2 ds 0.25 type morlet correction 1.01 chival 0.25 \</div>
<div class="lyx_code_item">        :1-22 name DPDP \</div>
<div class="lyx_code_item">        cluster clustermapout cluster.gnu clusterout cluster.dat \</div>
<div class="lyx_code_item">          minpoints 66 epsilon 10.0</div>
<div class="lyx_code_item">datafile cluster.gnu usemap palette kbvyw</div>
</div>
<div class="standard"><a id="magicparlabel-8009"></a>Some experimentation with <b>kdist</b> may be required to obtain reasonable values for <b>minpoints</b> and <b>epsilon</b>. See <a href="#subsec_cpptraj_dbscan_Hints">11.4</a> as well as the Heidari et al paper for further discussion.</div>
<h2 class="section"><a id="magicparlabel-8010"></a><span class="section_label">12</span> Analysis Examples<a id="sec_cpptraj_Matrix_Vector_Analysis_Examples"></a>
</h2>
<div class="standard"><a id="magicparlabel-8011"></a>Please note that 
typically for principal component analysis (PCA) the trajectory needs to
 be aligned against a reference structure to remove overall global and 
translation motion. Use the <em><b><span style="font-family:sans-serif;">rms</span></b></em><!-- Output Error: Tried to close pending tag `b' when other tags were pending. Last pending tag is `<span style='font-family:sans-serif;'>'. Tag discarded. -->
 command for this. </div>
<h3 class="subsection"><a id="magicparlabel-8012"></a><span class="subsection_label">12.1</span> Cartesian covariance matrix calculation and projection (PCA)</h3>
<div class="standard"><a id="magicparlabel-8013"></a>After calculating 
modes, snapshots can be projected onto these in an additional pass 
through the trajectory. It is very important that the snapshots used 
when projecting are exactly the same as those used to generate the 
original covariance matrix. This example takes advantage of the COORDS 
data set functionality in cpptraj to save snapshots for the purposes of 
projection.</div>

<div class="lyx_code"><a id="magicparlabel-8014"></a><div class="lyx_code_item"><b># Step one. Generate average structure.</b></div>
<div class="lyx_code_item"><b># RMS-Fit to first frame to remove global translation/rotation.</b></div>
<div class="lyx_code_item">parm myparm.parm7</div>
<div class="lyx_code_item">trajin mytraj.nc</div>
<div class="lyx_code_item">rms first !@H=</div>
<div class="lyx_code_item">average crdset AVG</div>
<div class="lyx_code_item">run</div>
<div class="lyx_code_item"><b># Step two. RMS-Fit to average structure. Calculate covariance matrix.</b></div>
<div class="lyx_code_item"><b># Save the fit coordinates.</b></div>
<div class="lyx_code_item">rms ref AVG !@H=</div>
<div class="lyx_code_item">matrix covar name MyMatrix !@H=</div>
<div class="lyx_code_item">createcrd CRD1</div>
<div class="lyx_code_item">run</div>
<div class="lyx_code_item"><b># Step three. Diagonalize matrix.</b></div>
<div class="lyx_code_item">runanalysis diagmatrix MyMatrix vecs 2 name MyEvecs</div>
<div class="lyx_code_item"><b># Step four. Project saved fit coordinates along eigenvectors 1 and 2</b></div>
<div class="lyx_code_item">crdaction CRD1 projection evecs MyEvecs !@H= out project.dat beg 1 end 2</div>
</div>
<h3 class="subsection"><a id="magicparlabel-8031"></a><span class="subsection_label">12.2</span> Dihedral covariance matrix calculation and projection for backbone phi/psi (PCA)</h3>

<div class="lyx_code"><a id="magicparlabel-8032"></a><div class="lyx_code_item">parm ../1rrb_vac.prmtop </div>
<div class="lyx_code_item">trajin ../1rrb_vac.mdcrd</div>
<div class="lyx_code_item"><b># Generation of phi/psi dihedral data</b></div>
<div class="lyx_code_item">multidihedral BB phi psi resrange 2</div>
<div class="lyx_code_item">run</div>
<div class="lyx_code_item"><b># Calculate dihedral covariance matrix and obtain eigenvectors</b></div>
<div class="lyx_code_item">matrix dihcovar dihedrals BB[*] out dihcovar.dat name DIH</div>
<div class="lyx_code_item">diagmatrix DIH vecs 4 out modes.dihcovar.dat name DIHMODES</div>
<div class="lyx_code_item">run</div>
<div class="lyx_code_item"><b># Project along eigenvectors</b></div>
<div class="lyx_code_item">projection evecs DIHMODES out dih.project.dat beg 1 end 4 dihedrals BB[*] </div>
<div class="lyx_code_item">run</div>
</div>
<div class="standard"><a id="magicparlabel-8044"></a><h2 class="bibtex">References</h2><div class="bibtex"><div class="bibtexentry" id="LyXCite-Altona1972"><span class="bibtexlabel">1</span><span class="bibtexinfo"><span class="bib-author">Altona, C and Sundaralingam, M</span>, "<span class="bib-title">Conformational Analysis of the Sugar Ring in Nucleosides and Nucleotides. A New Description Using the Concept of Pseudorotation</span>", <i><span class="bib-journal">J Am Chem Soc</span></i>  <span class="bib-volume">94</span> (<span class="bib-year">1972</span>), pp. <span class="bib-pages">8205-8212</span>.</span></div>
<div class="bibtexentry" id="LyXCite-Babcock94"><span class="bibtexlabel">2</span><span class="bibtexinfo"><span class="bib-author">Babcock, M.S. and Pednault, E.P.D. and Olson, W.K.</span>, "<span class="bib-title">Nucleic Acid Structure Analysis</span>", <i><span class="bib-journal">J. Mol. Biol.</span></i>  <span class="bib-volume">237</span> (<span class="bib-year">1994</span>), pp. <span class="bib-pages">125-156</span>.</span></div>
<div class="bibtexentry" id="LyXCite-Bakan11"><span class="bibtexlabel">3</span><span class="bibtexinfo"><span class="bib-author">Bakan, A. and Meireles, L.M. and Bahar, I.</span>, "<span class="bib-title">ProDy: Protein Dynamics Inferred from Theory and Experiments</span>", <i><span class="bib-journal">Bioinformatics</span></i>  <span class="bib-volume">27</span>, <span class="bib-number">11</span> (<span class="bib-year">2011</span>), pp. <span class="bib-pages">1575-1577</span>.</span></div>
<div class="bibtexentry" id="LyXCite-Benson2012"><span class="bibtexlabel">4</span><span class="bibtexinfo"><span class="bib-author">N. C. Benson and V. Dagget</span>, "<span class="bib-title">Wavelet Analysis of Protein Motion</span>", <i><span class="bib-journal">Int. J. Wavelets Multi.</span></i>  <span class="bib-volume">10</span>, <span class="bib-number">4</span> (<span class="bib-year">2012</span>).</span></div>
<div class="bibtexentry" id="LyXCite-Chang2005"><span class="bibtexlabel">5</span><span class="bibtexinfo"><span class="bib-author">Chang, Chia-En and Chen, Wei and Gilson, Michael K.</span>, "<span class="bib-title">Evaluating the Accuracy of the Quasiharmonic Approximation</span>", <i><span class="bib-journal">Journal of Chemical Theory and Computation</span></i>  <span class="bib-volume">1</span>, <span class="bib-number">5</span> (<span class="bib-year">2005</span>), pp. <span class="bib-pages">1017-1028</span>. <span class="bib-note">PMID: 26641917</span></span></div>
<div class="bibtexentry" id="LyXCite-Chatterjee"><span class="bibtexlabel">6</span><span class="bibtexinfo"><span class="bib-author">Chatterjee, S. and Debenedetti, P. G. and Stillinger, F. H. and Lynden-Bell, R. M.</span>, "<span class="bib-title">A Computational Investigation of Thermodynamics, Structure, Dynamics and Solvation Behavior in Modified Water Models.</span>", <i><span class="bib-journal">J. Chem. Phys.</span></i>  <span class="bib-volume">128</span> (<span class="bib-year">2008</span>), pp. <span class="bib-pages">124511</span>.</span></div>
<div class="bibtexentry" id="LyXCite-Chou03"><span class="bibtexlabel">7</span><span class="bibtexinfo"><span class="bib-author">Chou, J.J. and Case, D.A. and Bax, A.</span>, "<span class="bib-title">Insights into the mobility of methyl-bearing side chains in proteins</span>", <i><span class="bib-journal">J. Am. Chem. Soc.</span></i>  <span class="bib-volume">125</span> (<span class="bib-year">2003</span>), pp. <span class="bib-pages">8959-8966</span>.</span></div>
<div class="bibtexentry" id="LyXCite-Connolly83"><span class="bibtexlabel">8</span><span class="bibtexinfo"><span class="bib-author">Connolly, M.L.</span>, "<span class="bib-title">Analytical molecular surface calculation</span>", <i><span class="bib-journal">J. Appl. Cryst.</span></i>  <span class="bib-volume">16</span> (<span class="bib-year">1983</span>), pp. <span class="bib-pages">548-558</span>.</span></div>
<div class="bibtexentry" id="LyXCite-Cremer1975"><span class="bibtexlabel">9</span><span class="bibtexinfo"><span class="bib-author">Cremer, D and Pople, JA</span>, "<span class="bib-title">A General Definition of Ring Puckering Coordinates</span>", <i><span class="bib-journal">J Am Chem Soc</span></i>  <span class="bib-volume">97</span> (<span class="bib-year">1975</span>), pp. <span class="bib-pages">1354-1358</span>.</span></div>
<div class="bibtexentry" id="LyXCite-Cui2013"><span class="bibtexlabel">10</span><span class="bibtexinfo"><span class="bib-author">Cui, G. and Swails, J. M. and Manas, E. S.</span>, "<span class="bib-title">SPAM: A Simple Approach for Profiling Bound Water Molecules</span>", <i><span class="bib-journal">J. Chem. Theory Comput.</span></i>  <span class="bib-volume">9</span> (<span class="bib-year">2013</span>), pp. <span class="bib-pages">5539-5549</span>.</span></div>
<div class="bibtexentry" id="LyXCite-Ester96"><span class="bibtexlabel">11</span><span class="bibtexinfo"><span class="bib-author">Ester, M. and Kriegel, H. and Sander, J. and Xu, X.</span>, "<span class="bib-title">A Density-Based Algorithm for Discovering Clusters in Large Spatial Databases with Noise</span>", <i><span class="bib-journal">Proc. Second Int. Conf. Knowledge Disc. Data Mining (KDD-96)</span></i>  (<span class="bib-year">1996</span>), pp. <span class="bib-pages">226-231</span>.</span></div>
<div class="bibtexentry" id="LyXCite-Galindo2015"><span class="bibtexlabel">12</span><span class="bibtexinfo"><span class="bib-author">Galindo-Murillo, Rodrigo and Roe, Daniel R. and Cheatham, III, T.E.</span>, "<span class="bib-title">Convergence and reproducibility in molecular dynamics simulations of the DNA duplex d(GCACGAACGAACGAACGC)</span>", <i><span class="bib-journal">Biochim. Biophys. Acta</span></i>  <span class="bib-volume">1850</span> (<span class="bib-year">2015</span>), pp. <span class="bib-pages">1041-1058</span>.</span></div>
<div class="bibtexentry" id="LyXCite-Harvey1986"><span class="bibtexlabel">13</span><span class="bibtexinfo"><span class="bib-author">Harvey, SC and Prabhakaran, M</span>, "<span class="bib-title">RIBOSE PUCKERING - STRUCTURE, DYNAMICS, ENERGETICS, AND THE PSEUDOROTATION CYCLE</span>", <i><span class="bib-journal">J Am Chem Soc</span></i>  <span class="bib-volume">108</span> (<span class="bib-year">1986</span>), pp. <span class="bib-pages">6128-6136</span>.</span></div>
<div class="bibtexentry" id="LyXCite-Hassan1998"><span class="bibtexlabel">14</span><span class="bibtexinfo"><span class="bib-author">M. A. El Hassan and C. R. Calladine</span>, "<span class="bib-title">Two Distinct Modes of Protein-induced Bending in DNA</span>", <i><span class="bib-journal">J. Mol. Biol.</span></i>  <span class="bib-volume">282</span> (<span class="bib-year">1998</span>), pp. <span class="bib-pages">331-343</span>.</span></div>
<div class="bibtexentry" id="LyXCite-Heidari2016"><span class="bibtexlabel">15</span><span class="bibtexinfo"><span class="bib-author">Heidari, Z. and Roe, D. R. and Galindo-Murillo, R. and Ghasemi, J. B. and Cheatham, III, T. E.</span>, "<span class="bib-title">Using Wavelet Analysis To Assist in Identification of Significant Events in Molecular Dynamics Simulations</span>", <i><span class="bib-journal">J. Chem. Inf. Model.</span></i>  <span class="bib-volume">56</span> (<span class="bib-year">2016</span>), pp. <span class="bib-pages">1282-1291</span>.</span></div>
<div class="bibtexentry" id="LyXCite-humprey"><span class="bibtexlabel">16</span><span class="bibtexinfo"><span class="bib-author">Humphrey, W. and Dalke, A. and Schulten, K.</span>, "<span class="bib-title">VMD Visual Molecular Dynamics.</span>", <i><span class="bib-journal">J. Molec. Graph.</span></i>  <span class="bib-volume">14</span> (<span class="bib-year">1996</span>), pp. <span class="bib-pages">33-38</span>.</span></div>
<div class="bibtexentry" id="LyXCite-Hunenberger1995"><span class="bibtexlabel">17</span><span class="bibtexinfo"><span class="bib-author">Hunenberger, P.H. and Mark, A.E. and van Gunsteren, W.F.</span>, "<span class="bib-title">Fluctuation and Cross-correlation Analysis of Protein Motions Observed in Nanosecond Molecular Dynamics Simulations</span>", <i><span class="bib-journal">J. Mol. Biol.</span></i>  <span class="bib-volume">252</span> (<span class="bib-year">1995</span>), pp. <span class="bib-pages">492-503</span>.</span></div>
<div class="bibtexentry" id="LyXCite-Kabsch83"><span class="bibtexlabel">18</span><span class="bibtexinfo"><span class="bib-author">Kabsch, W. and Sander, C.</span>, "<span class="bib-title">Dictionary of protein secondary structure: pattern recognition of hydrogen-bonded and geometrical features</span>", <i><span class="bib-journal">Biopolymers</span></i>  <span class="bib-volume">22</span> (<span class="bib-year">1983</span>), pp. <span class="bib-pages">2577-2637</span>.</span></div>
<div class="bibtexentry" id="LyXCite-Lazaridis"><span class="bibtexlabel">19</span><span class="bibtexinfo"><span class="bib-author">Lazaridis, T.</span>, "<span class="bib-title">Inhomogeneous Fluid Approach to Solvation Thermodynamics. 1 Theory</span>", <i><span class="bib-journal">J. Phys. Chem. B</span></i>  <span class="bib-volume">102</span> (<span class="bib-year">1998</span>), pp. <span class="bib-pages">3531-3541</span>.</span></div>
<div class="bibtexentry" id="LyXCite-Lu2003"><span class="bibtexlabel">20</span><span class="bibtexinfo"><span class="bib-author">Lu, XJ and Olson, WK</span>, "<span class="bib-title">3DNA: a software package for the analysis, rebuilding and visualization of three-dimensional nucleic acid structures</span>", <i><span class="bib-journal">NUCLEIC ACIDS RESEARCH</span></i>  <span class="bib-volume">31</span> (<span class="bib-year">2003</span>), pp. <span class="bib-pages">5108-5121</span>.</span></div>
<div class="bibtexentry" id="LyXCite-McQuarrie1973"><span class="bibtexlabel">21</span><span class="bibtexinfo"><span class="bib-author">Donald A. McQuarrie</span>, <i><span class="bib-title">Statistical Thermodynamics</span></i> (<span class="bib-publisher">Harper and Row, New York</span>, <span class="bib-year">1973</span>).</span></div>
<div class="bibtexentry" id="LyXCite-Nguyen_gist"><span class="bibtexlabel">22</span><span class="bibtexinfo"><span class="bib-author">Nguyen, C. N. and Kurtzman Young, T. and Gilson, M. K.</span>, "<span class="bib-title">Grid Inhomogeneous Solvation Theory: Hydration Structure and Thermodynamics of the Miniature Receptor cucurbit[7]uril.</span>", <i><span class="bib-journal">J. Chem. Phys.</span></i>  <span class="bib-volume">137</span> (<span class="bib-year">2012</span>), pp. <span class="bib-pages">044101</span>.</span></div>
<div class="bibtexentry" id="LyXCite-Olson2001"><span class="bibtexlabel">23</span><span class="bibtexinfo"><span class="bib-author">Olson, Wilma K. and Bansal, Manju and Burley, Stephen K. and Dickerson, Richard E. and Gerstein, Mark and Harvey, Stephen C. an…</span>, "<span class="bib-title">A Standard Reference Frame for the Description of Nucleic Acid Base-pair Geometry</span>", <i><span class="bib-journal">J. Mol. Biol.</span></i>  <span class="bib-volume">313</span> (<span class="bib-year">2001</span>), pp. <span class="bib-pages">229-237</span>.</span></div>
<div class="bibtexentry" id="LyXCite-Perez01"><span class="bibtexlabel">24</span><span class="bibtexinfo"><span class="bib-author">Perez, C. and Lohr, F. and Ruterjans, H. and Schmidt, J.M.</span>, "<span class="bib-title">Self-Consistent Karplus Parameterization of (3)J couplings depending on the polypeptide side-chain torsion chi(1)</span>", <i><span class="bib-journal">J. Am. Chem. Soc.</span></i>  <span class="bib-volume">123</span> (<span class="bib-year">2001</span>), pp. <span class="bib-pages">7081-7093</span>.</span></div>
<div class="bibtexentry" id="LyXCite-Prompers02"><span class="bibtexlabel">25</span><span class="bibtexinfo"><span class="bib-author">Prompers, J.J. and Brüschweiler, R.</span>, "<span class="bib-title">Dynamic and structural analysis of isotropically distributed molecular ensembles</span>", <i><span class="bib-journal">Proteins</span></i>  <span class="bib-volume">46</span> (<span class="bib-year">2002</span>), pp. <span class="bib-pages">177-189</span>.</span></div>
<div class="bibtexentry" id="LyXCite-Prompers02a"><span class="bibtexlabel">26</span><span class="bibtexinfo"><span class="bib-author">Prompers, J.J. and Brüschweiler, R.</span>, "<span class="bib-title">General framework for studying the dynamics of folded and nonfolded proteins by NMR relaxation spectroscopy and MD simulation</span>", <i><span class="bib-journal">J. Am. Chem. Soc.</span></i>  <span class="bib-volume">124</span> (<span class="bib-year">2002</span>), pp. <span class="bib-pages">4522-4534</span>.</span></div>
<div class="bibtexentry" id="LyXCite-Rodriguez2014"><span class="bibtexlabel">27</span><span class="bibtexinfo"><span class="bib-author">Alex Rodriguez and Alessandro Laio</span>, "<span class="bib-title">Clustering by fast search and find of density peaks</span>", <i><span class="bib-journal">Science</span></i>  <span class="bib-volume">344</span> (<span class="bib-year">2014</span>), pp. <span class="bib-pages">1492-1496</span>.</span></div>
<div class="bibtexentry" id="LyXCite-Roe13"><span class="bibtexlabel">28</span><span class="bibtexinfo"><span class="bib-author">Roe, Daniel R. and Cheatham, III, T.E.</span>, "<span class="bib-title">PTRAJ and CPPTRAJ: Software for Processing and Analysis of Molecular Dynamics Trajectory Data</span>", <i><span class="bib-journal">J. Chem. Theory Comput.</span></i>  <span class="bib-volume">9</span> (<span class="bib-year">2013</span>), pp. <span class="bib-pages">3084-3095</span>.</span></div>
<div class="bibtexentry" id="LyXCite-Roe2014"><span class="bibtexlabel">29</span><span class="bibtexinfo"><span class="bib-author">Daniel R. Roe and Christina Bergonzo and Thomas E. Cheatham III</span>, "<span class="bib-title">Evaluation of Enhanced Sampling Provided by Accelerated Molecular Dynamics with Hamiltonian Replica Exchange Methods</span>", <i><span class="bib-journal">J. Phys. Chem. B</span></i>  <span class="bib-volume">118</span>, <span class="bib-number">13</span> (<span class="bib-year">2014</span>), pp. <span class="bib-pages">3543-3552</span>.</span></div>
<div class="bibtexentry" id="LyXCite-Schneider1997"><span class="bibtexlabel">30</span><span class="bibtexinfo"><span class="bib-author">Schneider, B. and Neidle, S. and Berman, H. M.</span>, "<span class="bib-title">Conformations of the Sugar-Phosphate Backbone in Helical DNA Crystal Structures</span>", <i><span class="bib-journal">Biopolymers</span></i>  <span class="bib-volume">42</span>, <span class="bib-number">1</span> (<span class="bib-year">1997</span>), pp. <span class="bib-pages">113-124</span>.</span></div>
<div class="bibtexentry" id="LyXCite-Schneider2004"><span class="bibtexlabel">31</span><span class="bibtexinfo"><span class="bib-author">Schneider, B. and Moravek, Z. and Berman, H. M.</span>, "<span class="bib-title">RNA conformational classes</span>", <i><span class="bib-journal">Nucleic Acids Res.</span></i>  <span class="bib-volume">32</span>, <span class="bib-number">5</span> (<span class="bib-year">2004</span>), pp. <span class="bib-pages">1666-1677</span>.</span></div>
<div class="bibtexentry" id="LyXCite-Sindhikara"><span class="bibtexlabel">32</span><span class="bibtexinfo"><span class="bib-author">Sindhikara, D. J. and Yoshida, N. and Hirata, F.</span>, "<span class="bib-title">Placevent: An Algorithm for Prediction of Explicit Solvent Atom Distribution-Application to HIV-1 Protease and F-ATP Synthase.</span>", <i><span class="bib-journal">J. Comput. Chem.</span></i>  <span class="bib-volume">33</span> (<span class="bib-year">2012</span>), pp. <span class="bib-pages">1536-1543</span>.</span></div>
<div class="bibtexentry" id="LyXCite-Torrence1998"><span class="bibtexlabel">33</span><span class="bibtexinfo"><span class="bib-author">C. Torrence and G. P. Compo</span>, "<span class="bib-title">A practical guide to wavelet analysis</span>", <i><span class="bib-journal">Bull. Am. Meteorol. Soc.</span></i>  <span class="bib-volume">79</span>, <span class="bib-number">1</span> (<span class="bib-year">1998</span>), pp. <span class="bib-pages">61-78</span>.</span></div>
<div class="bibtexentry" id="LyXCite-Weiser99"><span class="bibtexlabel">34</span><span class="bibtexinfo"><span class="bib-author">Weiser, J. and Shenkin, P.S. and Still, W.C.</span>, "<span class="bib-title">Approximate Atomic Surfaces from Linear Combinations of Pairwise Overlaps (LCPO)</span>", <i><span class="bib-journal">J. Comput. Chem.</span></i>  <span class="bib-volume">20</span> (<span class="bib-year">1999</span>), pp. <span class="bib-pages">217-230</span>.</span></div>
<div class="bibtexentry" id="LyXCite-wong2008"><span class="bibtexlabel">35</span><span class="bibtexinfo"><span class="bib-author">Wong, V. and Case, D.A.</span>, "<span class="bib-title">Evaluating rotational diffusion from protein MD simulations</span>", <i><span class="bib-journal">J. Phys. Chem. B</span></i>  <span class="bib-volume">112</span> (<span class="bib-year">2008</span>), pp. <span class="bib-pages">6013-6024</span>.</span></div>
</div></div>
</body>
</html>